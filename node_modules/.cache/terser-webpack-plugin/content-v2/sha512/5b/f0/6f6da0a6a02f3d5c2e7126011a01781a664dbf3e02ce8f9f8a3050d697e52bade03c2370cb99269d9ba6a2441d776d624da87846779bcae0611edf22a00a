{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"CdInfoRModule\"],{\"052a\":function(t,e,a){t.exports={container:\"CdInfoRModule_container_32HK2\"}},\"38d2\":function(t,e,a){\"use strict\";var n=a(\"bf45\"),i=a.n(n);e[\"default\"]=i.a},\"824e\":function(t,e,a){\"use strict\";var n=a(\"9dda\"),i=a.n(n);e[\"default\"]=i.a},9948:function(t,e,a){\"use strict\";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{class:t.$style.container},[a(\"div\",[a(\"Toolbar\",{attrs:{bgc:\"#fff\"}},[a(\"InputRadio\",{staticStyle:{width:\"300px\"},attrs:{label:t.$_L.get(\"任务状态\"),options:[{label:t.$_L.get(\"未执行\"),value:0},{label:t.$_L.get(\"执行中\"),value:1},{label:t.$_L.get(\"执行完毕\"),value:2}]},model:{value:t.taskState,callback:function(e){t.taskState=e},expression:\"taskState\"}}),a(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:2==t.taskState,expression:\"taskState==2\"}],staticStyle:{display:\"flex\"}},[a(\"InputTree\",{staticStyle:{width:\"220px\",\"margin-left\":\"5px\"},attrs:{label:t.$_L.get(\"车辆\"),valueField:\"carId\",getTreeRoots:t.getTreeRoots,hasOwnField:\"carId\",setting:{view:{iconCssFunction:t.iconCssFunction}},clearable:\"\"},model:{value:t.carId,callback:function(e){t.carId=e},expression:\"carId\"}}),a(\"InputTree\",{staticStyle:{width:\"220px\",\"margin-left\":\"5px\"},attrs:{label:t.$_L.get(\"司机\"),valueField:\"userId\",getTreeRoots:t.getTreeRoots1,hasOwnField:\"userId\",setting:{view:{iconCssFunction:t.iconCssFunction1}},clearable:\"\"},model:{value:t.driverId,callback:function(e){t.driverId=e},expression:\"driverId\"}}),a(\"InputSelect\",{staticStyle:{width:\"220px\",\"margin-left\":\"5px\"},attrs:{label:t.$_L.get(\"工况\"),options:t.list,labelField:\"name\",valueField:\"id\",clearable:\"\"},model:{value:t.cdId,callback:function(e){t.cdId=e},expression:\"cdId\"}}),a(\"InputDateTime\",{staticStyle:{\"margin-left\":\"5px\"},attrs:{label:t.$_L.get(\"开始时间\"),type:\"YMDHNS\"},model:{value:t.stime,callback:function(e){t.stime=e},expression:\"stime\"}}),a(\"InputDateTime\",{staticStyle:{\"margin-left\":\"5px\"},attrs:{label:t.$_L.get(\"结束时间\"),type:\"YMDHNS\"},model:{value:t.etime,callback:function(e){t.etime=e},expression:\"etime\"}})],1),a(\"Button\",{attrs:{type:\"primary\",icon:t.querying?\"el-icon-close\":\"el-icon-search\"},on:{click:function(e){t.querying?t.toFinish():t.search()}}},[t._v(t._s(t.$_L.get(\"查询\")))]),a(\"div\",{attrs:{slot:\"right\"},slot:\"right\"},[a(\"Button\",{staticStyle:{\"margin-right\":\"6px\"},attrs:{icon:\"el-icon-plus\",type:\"primary\"},on:{click:function(e){return t.editClick()}}},[t._v(t._s(t.$_L.get(\"分配\")))])],1)],1)],1),a(\"div\",{staticStyle:{\"flex-shrink\":\"1\",height:\"100%\",position:\"relative\"}},[a(\"vxe-table\",{ref:\"grid\",staticStyle:{border:\"1px solid #AEBAC5\",\"border-top\":\"0\",position:\"absolute\",left:\"0\",top:\"0\",right:\"0\",bottom:\"0\"},attrs:{data:t.datas,loading:!t.datas},on:{\"cell-click\":function(e){var a=e.row;return t.selectedItem=a}}},[a(\"vxe-table-column\",{attrs:{type:\"index\",title:t.$_L.get(\"序号\"),width:\"50px\"}}),a(\"vxe-table-column\",{attrs:{field:\"taskName\",title:t.$_L.get(\"工况名称\")}}),a(\"vxe-table-column\",{attrs:{field:\"startMile\",title:t.$_L.get(\"开始里程\")}}),a(\"vxe-table-column\",{attrs:{field:\"endMile\",title:t.$_L.get(\"结束里程\")}}),a(\"vxe-table-column\",{attrs:{field:\"mile\",title:t.$_L.get(\"总里程\")}}),a(\"vxe-table-column\",{attrs:{field:\"score\",title:t.$_L.get(\"得分\")}}),a(\"vxe-table-column\",{attrs:{field:\"des\",title:t.$_L.get(\"描述\")}}),a(\"vxe-table-column\",{attrs:{field:\"atime\",title:t.$_L.get(\"创建时间\")}}),a(\"vxe-table-column\",{attrs:{field:\"auser\",title:t.$_L.get(\"创建用户\")}}),a(\"vxe-table-column\",{attrs:{field:\"auser\",title:t.$_L.get(\"扣分详情\"),width:\"100px\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var n=e.row;return[a(\"Button\",{staticStyle:{width:\"calc(100% - 40px)\",padding:\"0 4px\"},attrs:{type:\"primary\",height:28},on:{click:function(e){return t.ClickBtn(n)}}},[t._v(t._s(t.$_L.get(\"详情\")))])]}}])})],1)],1)])},i=[],l=a(\"75fc\"),s=(a(\"ac6a\"),a(\"386d\"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"Window\",{ref:\"w\",attrs:{title:t.$_L.get(\"分配工况\"),width:300,waiting:t.waiting}},[a(\"div\",{class:t.$style.content},[a(\"InputText\",{staticStyle:{width:\"100%\"},attrs:{label:t.$_L.get(\"任务名称\"),trim:\"\",required:\"\"},model:{value:t.taskName,callback:function(e){t.taskName=e},expression:\"taskName\"}}),a(\"InputSelect\",{staticStyle:{width:\"100%\",\"margin-top\":\"5px\",float:\"left\"},attrs:{label:t.$_L.get(\"工况\"),labelField:\"name\",valueField:\"id\",options:t.options,trim:\"\",required:\"\"},model:{value:t.cdId,callback:function(e){t.cdId=e},expression:\"cdId\"}}),a(\"InputTree\",{staticStyle:{width:\"100%\",\"margin-top\":\"5px\"},attrs:{label:t.$_L.get(\"车辆\"),valueField:\"carId\",required:\"\",getTreeRoots:t.getTreeRoots,hasOwnField:\"carId\",setting:{view:{iconCssFunction:t.iconCssFunction}},required:\"\"},model:{value:t.carId,callback:function(e){t.carId=e},expression:\"carId\"}})],1),a(\"template\",{slot:\"footer\"},[a(\"Button\",{staticStyle:{margin:\"8px 4px\",\"min-width\":\"80px\"},on:{click:function(e){return t.$refs.w.close()}}},[t._v(t._s(t.$_L.get(\"取消\")))]),a(\"Button\",{staticStyle:{margin:\"8px 4px\",\"min-width\":\"80px\"},attrs:{type:\"primary\"},on:{click:function(e){return t.submit()}}},[t._v(t._s(t.$_L.get(\"确定\")))])],1)],2)}),o=[],r=a(\"53b0\"),c=a(\"67ff\"),d={data:function(){return{taskName:null,options:[],carId:null,cdId:null,callback:null,waiting:!1}},mounted:function(){this.options=$_main.http.syncGet(\"rule/get\",{sessionId:$_main.sessionId,userId:$_main.userId})||[]},methods:{iconCssFunction:function(t,e){return t.carId?null:e?\"ico_open\":\"ico_close\"},getTreeRoots:function(t){$_main.http.get(\"data/getCars\",{sessionId:$_main.sessionId}).then(function(e){e.carList.forEach(function(t){t.name=t.carName}),e.teamList.forEach(function(t){t.name=t.teamName});var a={list:null,map:null,root:{id:\"0\",name:$_L.get(\"所有车辆\"),children:[]}},n={list:null,map:null,root:null};a.list=e.teamList||[],a.map=Object(r[\"f\"])(a.list,\"teamId\"),a.tree=Object(c[\"a\"])(a.list,\"teamId\",\"pid\",a.map,a.root,\"teams\"),n.list=e.carList||[],n.map=Object(r[\"f\"])(n.list,\"carId\"),n.root=a.root,n.root.teams&&(n.root.children=Object(l[\"a\"])(n.root.teams));for(var i,s=0,o=a.list.length;s<o;s++)i=a.list[s],i.teams&&(i.children=Object(l[\"a\"])(i.teams));n.tree=Object(c[\"a\"])(n.list,\"carId\",\"teamId\",a.map,n.root,\"children\"),t(n.root)})},submit:function(){var t=this;if(!this.taskName)return $_alert.warn($_L.get(\"请输入任务名称！\"));if(!this.cdId)return $_alert.warn($_L.get(\"请选择工况！\"));if(!this.carId)return $_alert.warn($_L.get(\"请选择关联车辆！\"));var e={cdId:this.cdId,carId:this.carId,taskName:this.taskName,auser:$_main.userId};$_main.http.post(\"info/allot\",e).then(function(e){t.callback(e),$_alert.success($_L.get(\"操作成功\")),t.$refs.w.close()}).catch(function(e){t.waiting=!1})}}},u=d,p=a(\"38d2\"),m=a(\"2877\");function f(t){this[\"$style\"]=p[\"default\"].locals||p[\"default\"]}var _=Object(m[\"a\"])(u,s,o,!1,f,null,null),g=_.exports,h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"Window\",{ref:\"w\",attrs:{title:t.$_L.get(\"扣分详情\"),width:1e3,waiting:t.waiting}},[a(\"InputText\",{staticStyle:{width:\"calc(100% - 10px)\",margin:\"5px 5px 0\"},attrs:{label:t.$_L.get(\"工况名称\"),trim:\"\",readonly:\"\"},model:{value:t.name,callback:function(e){t.name=e},expression:\"name\"}}),a(\"div\",{class:t.$style.content},[a(\"vxe-table\",{ref:\"grid\",staticStyle:{border:\"1px solid\",\"margin-top\":\"5px\",height:\"300px\"},style:{borderColor:t.theme.border_color_light},attrs:{data:t.deductedDetail}},[a(\"vxe-table-column\",{attrs:{type:\"index\",fixed:\"left\",title:t.$_L.get(\"序号\"),width:\"50\"}}),a(\"vxe-table-column\",{attrs:{field:\"type\",fixed:\"left\",title:t.$_L.get(\"区域\"),width:\"240\",align:\"left\"},scopedSlots:t._u([{key:\"default\",fn:function(e){var n=e.row;return[a(\"InputTree\",{staticStyle:{margin:\"5px -5px\",width:\"calc(100% + 10px)\"},attrs:{disabled:\"\",getTreeRoots:t.getTreeRoots2,setting:{type:\"all\",callback:{beforeClick:function(t){return\"0\"!=t.type&&\"0\"!=t.pid}},view:{iconCssFunction:t.iconCssFunction}}},model:{value:n.regionId,callback:function(e){t.$set(n,\"regionId\",e)},expression:\"row.regionId\"}})]}}])}),a(\"vxe-table-column\",{attrs:{field:\"target\",title:t.$_L.get(\"速度 / 扣分\")},scopedSlots:t._u([{key:\"default\",fn:function(e){var n=e.row;return[a(\"span\",[t._v(t._s(n.speed&&n.speed.value||0))]),a(\"span\",[t._v(\" / \")]),a(\"span\",[t._v(t._s(n.speed&&n.speed.deductionValue||0))])]}}])}),a(\"vxe-table-column\",{attrs:{field:\"content\",title:t.$_L.get(\"里程 / 扣分\")},scopedSlots:t._u([{key:\"default\",fn:function(e){var n=e.row;return[a(\"span\",[t._v(t._s(n.mile&&n.mile.value||0))]),a(\"span\",[t._v(\" / \")]),a(\"span\",[t._v(t._s(n.mile&&n.mile.deductionValue||0))])]}}])}),a(\"vxe-table-column\",{attrs:{field:\"content\",title:t.$_L.get(\"转速 / 扣分\")},scopedSlots:t._u([{key:\"default\",fn:function(e){var n=e.row;return[a(\"span\",[t._v(t._s(n.rev&&n.rev.value||0))]),a(\"span\",[t._v(\" / \")]),a(\"span\",[t._v(t._s(n.rev&&n.rev.deductionValue||0))])]}}])}),a(\"vxe-table-column\",{attrs:{field:\"content\",title:t.$_L.get(\"档位 / 扣分\")},scopedSlots:t._u([{key:\"default\",fn:function(e){var n=e.row;return[a(\"span\",[t._v(t._s(n.gear&&n.gear.value||0))]),a(\"span\",[t._v(\" / \")]),a(\"span\",[t._v(t._s(n.gear&&n.gear.deductionValue||0))])]}}])}),a(\"vxe-table-column\",{attrs:{field:\"content\",title:t.$_L.get(\"油门开合度 / 扣分\")},scopedSlots:t._u([{key:\"default\",fn:function(e){var n=e.row;return[a(\"span\",[t._v(t._s(n.appPid&&n.appPid.value||0))]),a(\"span\",[t._v(\" / \")]),a(\"span\",[t._v(t._s(n.appPid&&n.appPid.deductionValue||0))])]}}])})],1)],1),a(\"template\",{slot:\"footer\"},[a(\"Button\",{staticStyle:{margin:\"8px 4px\",\"min-width\":\"80px\"},on:{click:function(e){return t.$refs.w.close()}}},[t._v(t._s(t.$_L.get(\"关闭\")))])],1)],2)},v=[],b={data:function(){return{name:null,waiting:!1,deductedDetail:[],callback:null}},mounted:function(){},methods:{iconCssFunction:function(t,e){return\"0\"==t.type?e?\"ico_open\":\"ico_close\":null},getTreeRoots2:function(t){$_main.http.get(\"data/getRegions\",{sessionId:$_main.sessionId}).then(function(e){var a={id:\"0\",name:$_L.get(\"所有区域\"),children:[]},n=Object(c[\"a\"])(e);n.forEach(function(t){return t.parent=a}),a.children=n,t(a)})}}},I=b,$=a(\"824e\");function x(t){this[\"$style\"]=$[\"default\"].locals||$[\"default\"]}var w=Object(m[\"a\"])(I,h,v,!1,x,null,null),y=w.exports,k=a(\"d0ee\"),L={data:function(){return{querying:!1,datas:[],taskState:2,selectedItem:null,carId:null,stime:Object(k[\"a\"])(-1),etime:Object(k[\"a\"])(0),driverId:null,cdId:null,list:null}},created:function(){},mounted:function(){var t=this;$_main.http.get(\"rule/get\",{sessionId:$_main.sessionId,userId:$_main.userId}).then(function(e){t.list=e}),this.search()},methods:{getTreeRoots:function(t){$_main.http.get(\"data/getCars\",{sessionId:$_main.sessionId}).then(function(e){e.carList.forEach(function(t){t.name=t.carName}),e.teamList.forEach(function(t){t.name=t.teamName});var a={list:null,map:null,root:{id:\"0\",name:$_L.get(\"所有车辆\"),children:[]}},n={list:null,map:null,root:null};a.list=e.teamList||[],a.map=Object(r[\"f\"])(a.list,\"teamId\"),a.tree=Object(c[\"a\"])(a.list,\"teamId\",\"pid\",a.map,a.root,\"teams\"),n.list=e.carList||[],n.map=Object(r[\"f\"])(n.list,\"carId\"),n.root=a.root,n.root.teams&&(n.root.children=Object(l[\"a\"])(n.root.teams));for(var i,s=0,o=a.list.length;s<o;s++)i=a.list[s],i.teams&&(i.children=Object(l[\"a\"])(i.teams));n.tree=Object(c[\"a\"])(n.list,\"carId\",\"teamId\",a.map,n.root,\"children\"),t(n.root)})},getTreeRoots1:function(t){$_main.http.get(\"data/getSubUser\",{sessionId:$_main.sessionId}).then(function(e){e.forEach(function(t){t.name=t.cnName});var a={id:\"0\",name:$_L.get(\"所有司机\"),children:[]},n=Object(c[\"a\"])(e,\"userId\",\"pid\");a.children=n,t(a)})},iconCssFunction:function(t,e){return t.carId?null:e?\"ico_open\":\"ico_close\"},iconCssFunction1:function(t,e){return t.userId?null:e?\"ico_open\":\"ico_close\"},search:function(){var t=this;if(this.etime<this.stime)return $_alert.warn($_L.get(\"开始时间不能大于结束时间！\"));this.datas=[],this.querying=!0;var e=2==this.taskState?\"info/getInfoByH\":\"info/getInfo\",a=2==this.taskState?{carId:this.carId,stime:this.stime,etime:this.etime,driverId:this.driverId,cdId:this.cdId}:{taskState:this.taskState};$_main.http.get(e,Object.assign({sessionId:$_main.sessionId,userId:$_main.userId},a)).then(function(e){t.datas=e,t.toFinish()})},toFinish:function(){if(this.querying=!1,!this.datas||0==this.datas.length)return $_alert.warn($_L.get(\"暂无数据！\"))},editClick:function(){$_popup.open(g,{callback:this.addOrUpdateCallback})},addOrUpdateCallback:function(){this.search()},ClickBtn:function(t){var e=t.exts&&(\"string\"==typeof t.exts?JSON.parse(t.exts):t.exts)||{},a=[];if(e.deductedDetail)for(var n in e.deductedDetail)a.push(Object.assign({regionId:n},e.deductedDetail[n]));$_popup.open(y,{name:t.taskName,deductedDetail:a||[]})}}},S=L,O=a(\"e1fc7\");function C(t){this[\"$style\"]=O[\"default\"].locals||O[\"default\"]}var F=Object(m[\"a\"])(S,n,i,!1,C,null,null);e[\"default\"]=F.exports},\"9dda\":function(t,e,a){t.exports={content:\"deductedWindow_content_2q-Hn\",item:\"deductedWindow_item_3vpwb\"}},bf45:function(t,e,a){t.exports={content:\"EditWindow_content_JQbLp\",item:\"EditWindow_item_2Gdl-\"}},e1fc7:function(t,e,a){\"use strict\";var n=a(\"052a\"),i=a.n(n);e[\"default\"]=i.a}}]);","extractedComments":[]}