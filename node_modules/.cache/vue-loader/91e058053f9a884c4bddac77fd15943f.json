{"remainingRequest":"D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\cdRule\\src\\modules\\MgrPoiModule\\PoiPopup.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\cdRule\\src\\modules\\MgrPoiModule\\PoiPopup.vue","mtime":1656123105907},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nimport LabelValue from '@/common/gps/LabelValue.vue';\nimport { getPois } from '@/common/cache/CachePoi.js';\nimport { popupable } from \"@/components/util/Widget.js\";\n\nexport default {\n  id: 'PoiPopup',\n  components: { LabelValue },\n  data () {\n    return {\n      title: null,\n      zcode: null,\n      addr: null,\n      img: {id:null,format:null,updateTime:null,width:null},\n      widgets: null,\n    }\n  },\n  methods: {\n    setModel(model) {//由OverlayMgr.js调用\n      let hide = this.$el && (this._poi != model.lnglat);\n      hide && (this.$el.style.display = 'none');\n      this._poi = model.lnglat;\n      this.title = model.text;\n      this.zcode = model.lnglat.zcode ? model.lnglat.zcode.split('_')[1] : '';\n      this.addr = model.lnglat.addr;\n      this.img = {id:null,format:null,updateTime:null,width:null};\n\n      if (model.lnglat.format) {\n        this.$nextTick(()=>{\n          this.$nextTick(()=>{//要做两次nextTick，才能取到this.$el.clientWidth的值\n            this.img.width = Math.max(this.$el.clientWidth - 10, 200);\n            this.img.id = model.lnglat.id;\n            this.img.format = model.lnglat.format;\n            this.img.updateTime = model.lnglat.updateTime;\n          });\n        });\n      }\n      this.setWidgets(model.lnglat);\n      hide && this.$nextTick(()=>this.$el.style.display = '');\n    },\n    setWidgets(poi) {\n      let widgets = getPois().widgets;\n      if (!widgets || widgets.length == 0) return;\n      let exts = poi.exts ? (typeof poi.exts=='string' ? JSON.parse(poi.exts) : poi.exts) : {};\n      let _widgets = [];\n      widgets.forEach(widget => {\n        if (!popupable(widget)) return;\n        let v = exts[widget.id+'.text'] || exts[widget.id] || '', link = widget.type=='LINK';\n        (!link || v) && _widgets.push({label:$_L.get(widget.name), value:v, link:link});\n      });\n      this.widgets = _widgets.length ? _widgets : null;\n    },\n    onLinkClick(url) {\n      url = url.replace('{username}',encodeURI($_cache.user.userId));\n      url = url.replace('{password}',$_cache.user.pwdTxt);\n      url = url.replace('{password_md5}',$_cache.user.password);\n      url = url.replace('{sessionId}',$_cache.authorization);\n      window.open(url, '_blank');\n    },\n    closeClick() {\n      this.close();\n    },\n  }\n}\n",{"version":3,"sources":["PoiPopup.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PoiPopup.vue","sourceRoot":"src/modules/MgrPoiModule","sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"height:30px; color:#fff; width:100%; padding:5px; white-space:nowrap; display:flex; justify-content:space-between;\" :style=\"{backgroundColor:theme.color}\">\r\n      <span style=\"line-height:20px;\">{{title}}</span>\r\n      <i class=\"el-icon-close\" style=\"margin-left:5px; font-size:18px; cursor:pointer;\" @click=\"closeClick()\"></i>\r\n    </div>\r\n\r\n    <div v-if=\"img.format\" :style=\"{borderBottomColor:theme.color, backgroundColor:theme.bg_color}\" style=\"border-bottom: 1px solid;padding:5px;text-align:center;\">\r\n      <img :src=\"$_domain.WEB_ROOT+'images/poi/'+img.id+'.'+img.format+'?v='+img.updateTime\" :style=\"{width: img.width+'px'}\" style=\"margin-bottom:-4px;\"/>\r\n    </div>\r\n\r\n    <table ref=\"t\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"line-height: 1;\">\r\n      <LabelValue :label=\"$_L.get('所在区域')\" :value=\"zcode\" first/>\r\n      <LabelValue :label=\"$_L.get('详细地址')\" :value=\"addr\" :last=\"!widgets\"/>\r\n      <LabelValue v-for=\"(item,index) in widgets\" :key=\"index\" :label=\"item.label\" :value=\"item.value\" :link=\"item.link\" :onLinkClick=\"onLinkClick\" :last=\"index==widgets.length-1\"/>\r\n    </table>\r\n    \r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\n  import LabelValue from '@/common/gps/LabelValue.vue';\r\n  import { getPois } from '@/common/cache/CachePoi.js';\r\n  import { popupable } from \"@/components/util/Widget.js\";\r\n\r\n  export default {\r\n    id: 'PoiPopup',\r\n    components: { LabelValue },\r\n    data () {\r\n      return {\r\n        title: null,\r\n        zcode: null,\r\n        addr: null,\r\n        img: {id:null,format:null,updateTime:null,width:null},\r\n        widgets: null,\r\n      }\r\n    },\r\n    methods: {\r\n      setModel(model) {//由OverlayMgr.js调用\r\n        let hide = this.$el && (this._poi != model.lnglat);\r\n        hide && (this.$el.style.display = 'none');\r\n        this._poi = model.lnglat;\r\n        this.title = model.text;\r\n        this.zcode = model.lnglat.zcode ? model.lnglat.zcode.split('_')[1] : '';\r\n        this.addr = model.lnglat.addr;\r\n        this.img = {id:null,format:null,updateTime:null,width:null};\r\n\r\n        if (model.lnglat.format) {\r\n          this.$nextTick(()=>{\r\n            this.$nextTick(()=>{//要做两次nextTick，才能取到this.$el.clientWidth的值\r\n              this.img.width = Math.max(this.$el.clientWidth - 10, 200);\r\n              this.img.id = model.lnglat.id;\r\n              this.img.format = model.lnglat.format;\r\n              this.img.updateTime = model.lnglat.updateTime;\r\n            });\r\n          });\r\n        }\r\n        this.setWidgets(model.lnglat);\r\n        hide && this.$nextTick(()=>this.$el.style.display = '');\r\n      },\r\n      setWidgets(poi) {\r\n        let widgets = getPois().widgets;\r\n        if (!widgets || widgets.length == 0) return;\r\n        let exts = poi.exts ? (typeof poi.exts=='string' ? JSON.parse(poi.exts) : poi.exts) : {};\r\n        let _widgets = [];\r\n        widgets.forEach(widget => {\r\n          if (!popupable(widget)) return;\r\n          let v = exts[widget.id+'.text'] || exts[widget.id] || '', link = widget.type=='LINK';\r\n          (!link || v) && _widgets.push({label:$_L.get(widget.name), value:v, link:link});\r\n        });\r\n        this.widgets = _widgets.length ? _widgets : null;\r\n      },\r\n      onLinkClick(url) {\r\n        url = url.replace('{username}',encodeURI($_cache.user.userId));\r\n        url = url.replace('{password}',$_cache.user.pwdTxt);\r\n        url = url.replace('{password_md5}',$_cache.user.password);\r\n        url = url.replace('{sessionId}',$_cache.authorization);\r\n        window.open(url, '_blank');\r\n      },\r\n      closeClick() {\r\n        this.close();\r\n      },\r\n    }\r\n  }\r\n</script>\r\n"]}]}