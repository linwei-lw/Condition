{"remainingRequest":"D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\cdRule\\src\\modules\\cdRule\\AiAddOrUpdateWindow.vue?vue&type=style&index=0&module=true&lang=css&","dependencies":[{"path":"D:\\cdRule\\src\\modules\\cdRule\\AiAddOrUpdateWindow.vue","mtime":1677656455688},{"path":"D:\\cdRule\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.content {\r\n  width: 100%;\r\n  padding: 5px;\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n.item {\r\n  margin: 0 0 0 -10px;\r\n  padding: 0 10px;\r\n  /* border-bottom: 1px solid #E9EBED; */\r\n  width: calc(100% + 20px);\r\n  min-height: 37px;\r\n}\r\n",{"version":3,"sources":["AiAddOrUpdateWindow.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AiAddOrUpdateWindow.vue","sourceRoot":"src/modules/cdRule","sourcesContent":["<template>\r\n  <Window ref=\"w\" :title=\"$_L.get('工况规则维护')\" :width=\"1000\" :waiting=\"waiting\">\r\n    <div :class=\"$style.content\">\r\n      <InputText :label=\"$_L.get('工况名称')\" trim v-model=\"item.name\" required style=\"width:calc(50% - 2.5px);\"/>\r\n      <InputText :label=\"$_L.get('所在地区')\" trim v-model=\"item.region\" required style=\"width:calc(50% - 2.5px);float:right\"/>\r\n      <InputTree :label=\"$_L.get('车辆')\" v-model=\"item.cars\" :tree=\"CarTree\" :setting=\"{type:'all',callback:{beforeClick:o=>o.id!='0'&&o.pid!='0'}}\" required style=\"width:calc(50% - 2.5px);margin-top: 5px\"/>\r\n      <InputText :label=\"$_L.get('描述')\" trim v-model=\"item.des\"  style=\"width:calc(50% - 2.5px);float:right;margin-top: 5px\"/>\r\n      <vxe-table ref=\"grid\" :data=\"item.pois\" style=\"border:1px solid;margin-top:5px;height:300px;\" :style=\"{borderColor:theme.border_color_light}\">\r\n        <vxe-table-column type=\"index\"      :title=\"$_L.get('序号')\"    width=\"50\"/>\r\n        <vxe-table-column field=\"type\"      :title=\"$_L.get('标注点')\" width=\"240\" align=\"left\">\r\n          <template v-slot=\"{ row }\">\r\n              <InputTree v-model=\"row.id\" :tree=\"poiTree\" :setting=\"{type:'all',callback:{beforeClick:o=>o.type!='0'&&o.pid!='0'}}\" style=\"margin:5px -5px;width:calc(100% + 10px);\"/>\r\n          </template>\r\n        </vxe-table-column>\r\n        <vxe-table-column field=\"target\"    :title=\"$_L.get('速度')\">\r\n          <template v-slot=\"{ row }\">\r\n           <InputText v-model=\"row.speed\" :reg=\"/\\D/g\" style=\"margin:5px -5px;width:calc(100% + 10px);\" />\r\n          </template>\r\n        </vxe-table-column>\r\n        <vxe-table-column field=\"content\"   :title=\"$_L.get('里程')\">\r\n          <template v-slot=\"{ row }\">\r\n            <InputText v-model=\"row.mile\" :reg=\"/\\D/g\" style=\"margin:5px -5px;width:calc(100% + 10px);\" />\r\n          </template>\r\n        </vxe-table-column>\r\n        <vxe-table-column field=\"content\"   :title=\"$_L.get('转速')\">\r\n          <template v-slot=\"{ row }\">\r\n            <InputText v-model=\"row.rev\" :reg=\"/\\D/g\" style=\"margin:5px -5px;width:calc(100% + 10px);\" />\r\n          </template>\r\n        </vxe-table-column>\r\n        <vxe-table-column field=\"content\"   :title=\"$_L.get('档位')\">\r\n          <template v-slot=\"{ row }\">\r\n            <InputText v-model=\"row.gear\" :reg=\"/\\D/g\" style=\"margin:5px -5px;width:calc(100% + 10px);\" />\r\n          </template>\r\n        </vxe-table-column>\r\n        <vxe-table-column field=\"content\"   :title=\"$_L.get('油门开合度')\">\r\n          <template v-slot=\"{ row }\">\r\n            <InputText v-model=\"row.appPid\" :reg=\"/\\D/g\" style=\"margin:5px -5px;width:calc(100% + 10px);\" />\r\n          </template>\r\n        </vxe-table-column>\r\n        <vxe-table-column field=\"content\"   width=\"40\">\r\n          <template v-slot=\"{ row, rowIndex }\">\r\n              <i @click=\"item.pois.splice(rowIndex,1)\" class=\"el-icon-close\" style=\"margin:5px 0;font-size:16px;height:32px;cursor:pointer;padding-top:8px;\"/>\r\n          </template>\r\n        </vxe-table-column>\r\n      </vxe-table>\r\n    </div>\r\n\r\n    <template slot=\"footer\">\r\n      <div style=\"position:absolute;\">\r\n        <Button style=\"margin:8px\" @click=\"addAiItemClick()\" icon=\"el-icon-plus\">{{$_L.get('添加标注')}}</Button>\r\n      </div>\r\n      <Button style=\"margin:8px 4px;min-width:80px;\" @click=\"$refs.w.close()\">{{$_L.get('取消')}}</Button>\r\n      <Button style=\"margin:8px 4px;min-width:80px;\" @click=\"submit()\" type=\"primary\">{{$_L.get('确定')}}</Button>\r\n    </template>\r\n  </Window>\r\n</template>\r\n\r\n<script>\r\nimport CarTree                                      from '@/common/tree/CarTree.vue';\r\nimport PoiTree from '@/common/tree/PoiTree.vue';\r\nimport { objClone,objsClone } from '@/common/util/Objects.js';\r\nimport { domLeftTop } from '@/components/util/Dom.js';\r\n\r\nexport default {\r\n  data: function() {\r\n    return {\r\n      waiting:false,\r\n      item: {\r\n        name:null,\r\n        cars:[],\r\n        region:null,\r\n        pois:[]\r\n      },\r\n      smsList: null,\r\n      callback: null,\r\n      contacts: null,//{people:[], phone:null, style:null, way:null},\r\n    };\r\n  },\r\n  computed: {\r\n    poiTree: () => PoiTree,\r\n    CarTree: () => CarTree,\r\n    speedable: function() {\r\n      return !this.item.alarmTypeId || ['s1','s2','s4','s5','sl','sr','snr'].indexOf(this.item.alarmTypeId) == -1;\r\n    }\r\n  },\r\n  watch: {\r\n    // contacts: function(v) {\r\n    //   this._onMouseClick = this._onMouseClick || (event => !this.$refs.contacts.contains(event.target) && (this.contacts = null));\r\n    //   setTimeout(()=>document[v?'addEventListener':'removeEventListener']('click', this._onMouseClick), 100);\r\n    // },\r\n    // speedable: function(v) {\r\n    //   this.$refs.grid.getColumnByField('speed').visible = v;\r\n    //   this.$refs.grid.refreshColumn();\r\n    // }\r\n  },\r\n  mounted() {\r\n    if (this.item.pois.length == 0) {\r\n      // this.item.pois.push({poiId:null,speed:null,mile:null,rev:null,gear:null,appPid:null});\r\n      // this.item.ais.push({duration:'60',speed:null,ways:[{type:1,target:'00010000',content:''}]});\r\n      // this.item.ais.push({duration:'120',speed:null,ways:[{type:1,target:'00010000',content:''}]});\r\n    }\r\n    // window.$_http.get('/mgr/poi?getByUserId').then(res=>{\r\n    //   console.log(res)\r\n    // })\r\n  },\r\n  methods:{\r\n    // textValue(target) {\r\n    //   let v = [];\r\n    //   if (target) for (let i=0; i<target.length; i++) target.charAt(i) == '1' && v.push(i);\r\n    //   return v;\r\n    // },\r\n    // textInput(v,way) {\r\n    //   let array = [0,0,0,0,0,0,0,0];\r\n    //   v && v.forEach(i=>array[i]=1);\r\n    //   way.target = array.join('');\r\n    // },\r\n    // contactsClick(event, way) {\r\n    //   if (this.contacts && this.contacts.way==way) return this.contacts = null;\r\n    //   let people = [], phone = [];\r\n    //   way.target && way.target.split(',').forEach(v=>(v=='a'||v=='b')?people.push(v):phone.push(v));\r\n    //   let {left, top} = domLeftTop(event.target);\r\n    //   this.contacts = {way:way,people:people, phone:phone.join(','), style:{left:left+'px', top:(top+31)+'px', zIndex:$_theme.zindex()}};\r\n    // },\r\n    // getContacts(target) {\r\n    //   let array = [];\r\n    //   target && target.split(',').forEach(v => array.push(v=='a' ? $_L.get('驾驶员') : v=='b' ? $_L.get('车队联系人') : v));\r\n    //   return array.join(',');\r\n    // },\r\n\r\n    addAiItemClick() {\r\n      this.item.pois.push({poiId:null,speed:null,mile:null,rev:null,gear:null,appPid:null});\r\n    },\r\n\r\n    submit() {\r\n      if (!this.item.name) return $_alert.warn($_L.get('请输入工况名称！'));\r\n      // if (!this.item.alarmTypeId) return $_alert.warn($_L.get('请选择报警类型！'));\r\n      // if (this.item.pois.length == 0) return $_alert.warn($_L.get('请添加策略！'));\r\n      // let pre_duration = null;\r\n      // for (let i=0; i<this.item.pois.length; i++) {\r\n      //   let ai = this.item.pois[i];\r\n      //   ai.duration = ai.duration || 0;\r\n      //   if (i > 0 && pre_duration >= parseInt(ai.duration)) return $_alert.warn($_L.get('报警持续必须递增！'));\r\n      //   pre_duration = ai.duration = parseInt(ai.duration);\r\n      //   if (this.speedable) {\r\n      //     ai.speed = parseInt(ai.speed||0);\r\n      //     ai.speed = ai.speed > 0 ? ai.speed : null;\r\n      //   } else {\r\n      //     ai.speed = null;\r\n      //   }\r\n      //   for (let j=0; j<ai.ways.length; j++) {\r\n      //     let way = ai.ways[j];\r\n      //     if (!way.target || (way.type==1&&way.target=='00000000')) return $_alert.warn($_L.get('提醒目标不能为空！'));\r\n      //     if (!way.content) return $_alert.warn($_L.get('提醒内容不能为空！'));\r\n      //   }\r\n      // }\r\n      // this.waiting = true;\r\n      //\r\n      // let isadd = !this.item.id, item = objClone(this.item, new Set(['_XID']));\r\n      // item.pois = JSON.stringify(objsClone(item.ais, new Set(['_XID'])));\r\n      // item.teamIds = item.teamIds || '';\r\n      // $_http.post('/sys/alarm_ai?addOrUpdate',item).then(item => {\r\n      //   item.ais = JSON.parse(item.ais);\r\n      //   this.callback(item, isadd);\r\n      //   $_alert.success(isadd ? $_L.get('新增成功') : $_L.get('修改成功'));\r\n      //   this.$refs.w.close();\r\n      // }).catch(error => {\r\n      //   this.waiting = false;\r\n      // });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style module>\r\n.content {\r\n  width: 100%;\r\n  padding: 5px;\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n.item {\r\n  margin: 0 0 0 -10px;\r\n  padding: 0 10px;\r\n  /* border-bottom: 1px solid #E9EBED; */\r\n  width: calc(100% + 20px);\r\n  min-height: 37px;\r\n}\r\n</style>\r\n"]}]}