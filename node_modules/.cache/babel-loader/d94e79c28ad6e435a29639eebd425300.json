{"remainingRequest":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\cdRule\\src\\modules\\MgrPoiModule\\PoiPopup.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\cdRule\\src\\modules\\MgrPoiModule\\PoiPopup.vue","mtime":1656123105907},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport LabelValue from '@/common/gps/LabelValue.vue';\nimport { getPois } from '@/common/cache/CachePoi.js';\nimport { popupable } from \"@/components/util/Widget.js\";\nexport default {\n  id: 'PoiPopup',\n  components: {\n    LabelValue: LabelValue\n  },\n  data: function data() {\n    return {\n      title: null,\n      zcode: null,\n      addr: null,\n      img: {\n        id: null,\n        format: null,\n        updateTime: null,\n        width: null\n      },\n      widgets: null\n    };\n  },\n  methods: {\n    setModel: function setModel(model) {\n      var _this = this;\n\n      //由OverlayMgr.js调用\n      var hide = this.$el && this._poi != model.lnglat;\n      hide && (this.$el.style.display = 'none');\n      this._poi = model.lnglat;\n      this.title = model.text;\n      this.zcode = model.lnglat.zcode ? model.lnglat.zcode.split('_')[1] : '';\n      this.addr = model.lnglat.addr;\n      this.img = {\n        id: null,\n        format: null,\n        updateTime: null,\n        width: null\n      };\n\n      if (model.lnglat.format) {\n        this.$nextTick(function () {\n          _this.$nextTick(function () {\n            //要做两次nextTick，才能取到this.$el.clientWidth的值\n            _this.img.width = Math.max(_this.$el.clientWidth - 10, 200);\n            _this.img.id = model.lnglat.id;\n            _this.img.format = model.lnglat.format;\n            _this.img.updateTime = model.lnglat.updateTime;\n          });\n        });\n      }\n\n      this.setWidgets(model.lnglat);\n      hide && this.$nextTick(function () {\n        return _this.$el.style.display = '';\n      });\n    },\n    setWidgets: function setWidgets(poi) {\n      var widgets = getPois().widgets;\n      if (!widgets || widgets.length == 0) return;\n      var exts = poi.exts ? typeof poi.exts == 'string' ? JSON.parse(poi.exts) : poi.exts : {};\n      var _widgets = [];\n      widgets.forEach(function (widget) {\n        if (!popupable(widget)) return;\n        var v = exts[widget.id + '.text'] || exts[widget.id] || '',\n            link = widget.type == 'LINK';\n        (!link || v) && _widgets.push({\n          label: $_L.get(widget.name),\n          value: v,\n          link: link\n        });\n      });\n      this.widgets = _widgets.length ? _widgets : null;\n    },\n    onLinkClick: function onLinkClick(url) {\n      url = url.replace('{username}', encodeURI($_cache.user.userId));\n      url = url.replace('{password}', $_cache.user.pwdTxt);\n      url = url.replace('{password_md5}', $_cache.user.password);\n      url = url.replace('{sessionId}', $_cache.authorization);\n      window.open(url, '_blank');\n    },\n    closeClick: function closeClick() {\n      this.close();\n    }\n  }\n};",{"version":3,"sources":["PoiPopup.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"height:30px; color:#fff; width:100%; padding:5px; white-space:nowrap; display:flex; justify-content:space-between;\" :style=\"{backgroundColor:theme.color}\">\r\n      <span style=\"line-height:20px;\">{{title}}</span>\r\n      <i class=\"el-icon-close\" style=\"margin-left:5px; font-size:18px; cursor:pointer;\" @click=\"closeClick()\"></i>\r\n    </div>\r\n\r\n    <div v-if=\"img.format\" :style=\"{borderBottomColor:theme.color, backgroundColor:theme.bg_color}\" style=\"border-bottom: 1px solid;padding:5px;text-align:center;\">\r\n      <img :src=\"$_domain.WEB_ROOT+'images/poi/'+img.id+'.'+img.format+'?v='+img.updateTime\" :style=\"{width: img.width+'px'}\" style=\"margin-bottom:-4px;\"/>\r\n    </div>\r\n\r\n    <table ref=\"t\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"line-height: 1;\">\r\n      <LabelValue :label=\"$_L.get('所在区域')\" :value=\"zcode\" first/>\r\n      <LabelValue :label=\"$_L.get('详细地址')\" :value=\"addr\" :last=\"!widgets\"/>\r\n      <LabelValue v-for=\"(item,index) in widgets\" :key=\"index\" :label=\"item.label\" :value=\"item.value\" :link=\"item.link\" :onLinkClick=\"onLinkClick\" :last=\"index==widgets.length-1\"/>\r\n    </table>\r\n    \r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\n  import LabelValue from '@/common/gps/LabelValue.vue';\r\n  import { getPois } from '@/common/cache/CachePoi.js';\r\n  import { popupable } from \"@/components/util/Widget.js\";\r\n\r\n  export default {\r\n    id: 'PoiPopup',\r\n    components: { LabelValue },\r\n    data () {\r\n      return {\r\n        title: null,\r\n        zcode: null,\r\n        addr: null,\r\n        img: {id:null,format:null,updateTime:null,width:null},\r\n        widgets: null,\r\n      }\r\n    },\r\n    methods: {\r\n      setModel(model) {//由OverlayMgr.js调用\r\n        let hide = this.$el && (this._poi != model.lnglat);\r\n        hide && (this.$el.style.display = 'none');\r\n        this._poi = model.lnglat;\r\n        this.title = model.text;\r\n        this.zcode = model.lnglat.zcode ? model.lnglat.zcode.split('_')[1] : '';\r\n        this.addr = model.lnglat.addr;\r\n        this.img = {id:null,format:null,updateTime:null,width:null};\r\n\r\n        if (model.lnglat.format) {\r\n          this.$nextTick(()=>{\r\n            this.$nextTick(()=>{//要做两次nextTick，才能取到this.$el.clientWidth的值\r\n              this.img.width = Math.max(this.$el.clientWidth - 10, 200);\r\n              this.img.id = model.lnglat.id;\r\n              this.img.format = model.lnglat.format;\r\n              this.img.updateTime = model.lnglat.updateTime;\r\n            });\r\n          });\r\n        }\r\n        this.setWidgets(model.lnglat);\r\n        hide && this.$nextTick(()=>this.$el.style.display = '');\r\n      },\r\n      setWidgets(poi) {\r\n        let widgets = getPois().widgets;\r\n        if (!widgets || widgets.length == 0) return;\r\n        let exts = poi.exts ? (typeof poi.exts=='string' ? JSON.parse(poi.exts) : poi.exts) : {};\r\n        let _widgets = [];\r\n        widgets.forEach(widget => {\r\n          if (!popupable(widget)) return;\r\n          let v = exts[widget.id+'.text'] || exts[widget.id] || '', link = widget.type=='LINK';\r\n          (!link || v) && _widgets.push({label:$_L.get(widget.name), value:v, link:link});\r\n        });\r\n        this.widgets = _widgets.length ? _widgets : null;\r\n      },\r\n      onLinkClick(url) {\r\n        url = url.replace('{username}',encodeURI($_cache.user.userId));\r\n        url = url.replace('{password}',$_cache.user.pwdTxt);\r\n        url = url.replace('{password_md5}',$_cache.user.password);\r\n        url = url.replace('{sessionId}',$_cache.authorization);\r\n        window.open(url, '_blank');\r\n      },\r\n      closeClick() {\r\n        this.close();\r\n      },\r\n    }\r\n  }\r\n</script>\r\n"],"sourceRoot":"src/modules/MgrPoiModule"}]}