{"remainingRequest":"D:\\cdRule\\node_modules\\thread-loader\\dist\\cjs.js!D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\cdRule\\src\\modules\\cdRule\\CdRuleModule.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\cdRule\\src\\modules\\cdRule\\CdRuleModule.vue","mtime":1685000036289},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport AiAddOrUpdateWindow from './AiAddOrUpdateWindow.vue';\nimport DirAddOrUpdateWindow from './DirAddOrUpdateWindow.vue';\nimport { arrayRemoveItem } from '@/common/util/Arrays.js';\nimport { arrayToMap } from '@/common/util/Arrays.js';\nimport { objClone, objCopyTo } from '@/common/util/Objects.js';\nexport default {\n  data() {\n    return {\n      areas: [{\n        name: '黑龙江省'\n      }, {\n        name: '辽宁省'\n      }, {\n        name: '吉林省'\n      }, {\n        name: '河北省'\n      }, {\n        name: '河南省'\n      }, {\n        name: '湖北省'\n      }, {\n        name: '湖南省'\n      }, {\n        name: '山东省'\n      }, {\n        name: '山西省'\n      }, {\n        name: '陕西省'\n      }, {\n        name: '安徽省'\n      }, {\n        name: '浙江省'\n      }, {\n        name: '江苏省'\n      }, {\n        name: '福建省'\n      }, {\n        name: '广东省'\n      }, {\n        name: '海南省'\n      }, {\n        name: '四川省'\n      }, {\n        name: '云南省'\n      }, {\n        name: '贵州省'\n      }, {\n        name: '青海省'\n      }, {\n        name: '甘肃省'\n      }, {\n        name: '江西省'\n      }, {\n        name: '台湾省'\n      }, {\n        name: '内蒙古自治区'\n      }, {\n        name: '宁夏回族自治区'\n      }, {\n        name: '新疆维吾尔自治区'\n      }, {\n        name: '西藏自治区'\n      }, {\n        name: '广西壮族自治区'\n      }, {\n        name: '北京市'\n      }, {\n        name: '上海市'\n      }, {\n        name: '天津市'\n      }, {\n        name: '重庆市'\n      }, {\n        name: '香港特别行政区'\n      }, {\n        name: '澳门特别行政区'\n      }],\n      datas: [],\n      list: [],\n      place: [],\n      cmpIndex: {\n        id: null\n      },\n      selected: null,\n      selectedItem: null,\n      index: 0\n    };\n  },\n\n  created() {},\n\n  mounted() {\n    $_main.http.get('rule/get', {\n      sessionId: $_main.sessionId,\n      userId: $_main.userId\n    }).then(result => {\n      this.list = result;\n    });\n    this.getPlace();\n  },\n\n  methods: {\n    getPlace() {\n      $_main.http.get('place/get', {\n        sessionId: $_main.sessionId,\n        userId: $_main.userId\n      }).then(result => {\n        let areas = this.areas.filter(el => result.some(item => item.area == el.name)) || [],\n            place = [];\n        areas.forEach(el => {\n          el.isopen = false;\n          el.children = [];\n          result.forEach(item => {\n            if (el.name == item.area) {\n              el.children.push(item);\n            }\n          });\n          place.push(el);\n        });\n        this.place = place;\n      });\n    },\n\n    addClick() {\n      let item = {\n        name: null,\n        cars: [],\n        area: this.cmpIndex.area,\n        des: null,\n        regions: [],\n        auser: $_main.userId,\n        placeId: this.cmpIndex.id\n      };\n      $_popup.open(AiAddOrUpdateWindow, {\n        item: item,\n        callback: this.addOrUpdateCallback\n      });\n    },\n\n    updClick() {\n      $_popup.open(AiAddOrUpdateWindow, {\n        item: objClone(this.selectedItem),\n        callback: this.addOrUpdateCallback\n      });\n    },\n\n    addOrUpdateCallback(result, isddd) {\n      if (isddd) {\n        this.datas.push(result);\n        this.list.push(result);\n      } else {\n        objCopyTo(result, this.selectedItem);\n      }\n    },\n\n    delClick() {\n      $_alert.comfirm($_L.get('你确定要删除吗？'), yes => {\n        if (!yes) return;\n        $_main.http.get('rule/delete', {\n          id: this.selectedItem.id\n        }).then(e => {\n          arrayRemoveItem(this.datas, this.selectedItem);\n          arrayRemoveItem(this.list, this.selectedItem);\n          this.selectedItem = null;\n          $_alert.success($_L.get('删除成功'));\n        });\n      }, this.$el);\n    },\n\n    addDirClick() {\n      $_popup.open(DirAddOrUpdateWindow, {\n        areas: this.areas,\n        callback: this.addOrUpdateDirCallback\n      });\n    },\n\n    updDirClick() {\n      $_popup.open(DirAddOrUpdateWindow, {\n        areas: this.areas,\n        item: objClone(this.selected),\n        callback: this.addOrUpdateDirCallback\n      });\n    },\n\n    addOrUpdateDirCallback(result, isddd) {\n      if (isddd) {\n        let place = arrayToMap(this.place, 'name');\n\n        if (place[result.area]) {\n          place[result.area].children.push(result);\n          this.$forceUpdate();\n        } else {\n          this.place.push({\n            name: result.area,\n            isopen: false,\n            children: [result]\n          });\n        }\n      } else {\n        objCopyTo(result, this.selected);\n      }\n    },\n\n    delDirClick() {\n      if (this.datas && this.datas.length != 0) return $_alert.warn($_L.get('该场地下有工况，请先删除工况？'));\n      $_alert.comfirm($_L.get('你确定要删除吗？'), yes => {\n        if (!yes) return;\n        $_main.http.get('place/delete', {\n          id: this.selected.id\n        }).then(e => {\n          let obj;\n          this.place.forEach(el => {\n            if (el.name == this.selected.area) {\n              arrayRemoveItem(el.children, this.selected);\n\n              if (el.children == 0) {\n                obj = el;\n              }\n            }\n          });\n\n          if (obj) {\n            arrayRemoveItem(this.place, obj);\n          }\n\n          this.selected = null;\n          this.cmpIndex = {\n            id: null\n          };\n          $_alert.success($_L.get('删除成功'));\n        });\n      }, this.$el);\n    },\n\n    click(item) {\n      this.index++;\n\n      if (!item.children) {\n        this.cmpIndex = item;\n        this.datas = this.list.filter(el => el.placeId == item.id);\n      } else {\n        item.isopen = !item.isopen;\n      }\n\n      this.$forceUpdate();\n      this.selected = item;\n    }\n\n  }\n};",null]}