{"remainingRequest":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\src\\components\\Map\\core\\maptalks.es.js","dependencies":[{"path":"D:\\cdRule\\src\\components\\Map\\core\\maptalks.es.js","mtime":1667209173320},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.typed.uint16-array\";\nimport \"core-js/modules/es6.typed.int16-array\";\nimport \"core-js/modules/es6.typed.float32-array\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.set\";\nimport \"core-js/modules/es6.math.hypot\";\nimport \"core-js/modules/es6.string.repeat\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.string.sub\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.regexp.search\";\nimport \"core-js/modules/es6.array.fill\";\nimport \"core-js/modules/es6.object.freeze\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.typed.uint8-array\";\nimport \"core-js/modules/es6.math.log2\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.math.sign\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.typed.uint16-array\";\nimport \"core-js/modules/es6.typed.int16-array\";\nimport \"core-js/modules/es6.typed.float32-array\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.set\";\nimport \"core-js/modules/es6.math.hypot\";\nimport \"core-js/modules/es6.string.repeat\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.string.sub\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.regexp.search\";\nimport \"core-js/modules/es6.array.fill\";\nimport \"core-js/modules/es6.object.freeze\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.typed.uint8-array\";\nimport \"core-js/modules/es6.math.log2\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.math.sign\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport _typeof from \"D:\\\\cdRule\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/typeof\";\n/*!\n * maptalks v0.47.5\n * LICENSE : BSD-3-Clause\n * (c) 2016-2020 maptalks.org\n */\n\nvar version = \"0.47.5\";\nvar INTERNAL_LAYER_PREFIX = '_maptalks__internal_layer_';\nvar GEOMETRY_COLLECTION_TYPES = ['MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\nvar GEOJSON_TYPES = ['FeatureCollection', 'Feature', 'Point', 'LineString', 'Polygon'].concat(GEOMETRY_COLLECTION_TYPES);\nvar RESOURCE_PROPERTIES = ['markerFile', 'polygonPatternFile', 'linePatternFile', 'markerFillPatternFile', 'markerLinePatternFile'];\nvar RESOURCE_SIZE_PROPERTIES = [['markerWidth', 'markerHeight'], [], [null, 'lineWidth'], [], [null, 'markerLineWidth']];\nvar NUMERICAL_PROPERTIES = {\n  'lineWidth': 1,\n  'lineOpacity': 1,\n  'lineDx': 1,\n  'lineDy': 1,\n  'polygonOpacity': 1,\n  'markerWidth': 1,\n  'markerHeight': 1,\n  'markerDx': 1,\n  'markerDy': 1,\n  'markerOpacity': 1,\n  'markerFillOpacity': 1,\n  'markerLineWidth': 1,\n  'markerLineOpacity': 1,\n  'textSize': 1,\n  'textOpacity': 1,\n  'textHaloRadius': 1,\n  'textWrapWidth': 1,\n  'textLineSpacing': 1,\n  'textDx': 1,\n  'textDy': 1\n};\nvar COLOR_PROPERTIES = ['lineColor', 'polygonFill', 'markerFill', 'markerLineColor', 'textFill'];\nvar DEFAULT_TEXT_SIZE = 14;\n\nfunction now() {\n  return Date.now();\n}\n\nfunction extend(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    for (var k in src) {\n      dest[k] = src[k];\n    }\n  }\n\n  return dest;\n}\n\nfunction isNil(obj) {\n  return obj == null;\n}\n\nfunction isNumber(val) {\n  return typeof val === 'number' && !isNaN(val);\n}\n\nfunction isInteger(n) {\n  return (n | 0) === n;\n}\n\nfunction isObject(obj) {\n  return _typeof(obj) === 'object' && !!obj;\n}\n\nfunction isString(obj) {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  return typeof obj === 'string' || obj.constructor !== null && obj.constructor === String;\n}\n\nfunction isFunction(obj) {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  return typeof obj === 'function' || obj.constructor !== null && obj.constructor === Function;\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction hasOwn(obj, key) {\n  return hasOwnProperty.call(obj, key);\n}\n\nfunction join(arr, seperator) {\n  if (arr.join) {\n    return arr.join(seperator || ',');\n  } else {\n    return Array.prototype.join.call(arr, seperator || ',');\n  }\n}\n\nfunction isEmpty(object) {\n  var property;\n\n  for (property in object) {\n    return false;\n  }\n\n  return !property;\n}\n\nvar pi = Math.PI / 180;\n\nfunction toRadian(d) {\n  return d * pi;\n}\n\nfunction toDegree(r) {\n  return r / pi;\n}\n\nvar IS_NODE = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]' && !process.versions['electron'] && !process.versions['nw'] && !process.versions['node-webkit'];\nvar requestAnimFrame, cancelAnimFrame;\n\n(function () {\n  if (IS_NODE) {\n    requestAnimFrame = function requestAnimFrame(fn) {\n      return setTimeout(fn, 16);\n    };\n\n    cancelAnimFrame = clearTimeout;\n    return;\n  }\n\n  var requestFn, cancelFn;\n  var timeToCall = 1000 / 30;\n\n  function timeoutDefer(fn) {\n    return setTimeout(fn, timeToCall);\n  }\n\n  function getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n  }\n\n  if (typeof window != 'undefined') {\n    requestFn = window['requestAnimationFrame'] || getPrefixed('RequestAnimationFrame') || timeoutDefer;\n\n    cancelFn = window['cancelAnimationFrame'] || getPrefixed('CancelAnimationFrame') || getPrefixed('CancelRequestAnimationFrame') || function (id) {\n      window.clearTimeout(id);\n    };\n  } else {\n    requestFn = timeoutDefer;\n    cancelFn = clearTimeout;\n  }\n\n  requestAnimFrame = function requestAnimFrame(fn) {\n    return requestFn(fn);\n  };\n\n  cancelAnimFrame = function cancelAnimFrame(id) {\n    if (id) {\n      cancelFn(id);\n    }\n  };\n})();\n\nfunction isSVG(url) {\n  var prefix = 'data:image/svg+xml';\n\n  if (url.length > 4 && url.slice(-4) === '.svg') {\n    return 1;\n  } else if (url.slice(0, prefix.length) === prefix) {\n    return 2;\n  }\n\n  return 0;\n}\n\nfunction loadImage(img, imgDesc) {\n  if (IS_NODE && loadImage.node) {\n    loadImage.node(img, imgDesc);\n    return;\n  }\n\n  img.src = imgDesc[0];\n}\n\nvar uid = 0;\n\nfunction UID() {\n  return uid++;\n}\n\nvar GUID = UID;\n\nfunction parseJSON(str) {\n  if (!str || !isString(str)) {\n    return str;\n  }\n\n  return JSON.parse(str);\n}\n\nfunction pushIn(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    if (src) {\n      for (var ii = 0, ll = src.length; ii < ll; ii++) {\n        dest.push(src[ii]);\n      }\n    }\n  }\n\n  return dest.length;\n}\n\nfunction removeFromArray(obj, array) {\n  var i = array.indexOf(obj);\n\n  if (i > -1) {\n    array.splice(i, 1);\n  }\n}\n\nfunction forEachCoord(arr, fn, context) {\n  if (!Array.isArray(arr)) {\n    return context ? fn.call(context, arr) : fn(arr);\n  }\n\n  var result = [];\n  var p, pp;\n\n  for (var i = 0, len = arr.length; i < len; i++) {\n    p = arr[i];\n\n    if (isNil(p)) {\n      result.push(null);\n      continue;\n    }\n\n    if (Array.isArray(p)) {\n      result.push(forEachCoord(p, fn, context));\n    } else {\n      pp = context ? fn.call(context, p) : fn(p);\n      result.push(pp);\n    }\n  }\n\n  return result;\n}\n\nfunction getValueOrDefault(v, d) {\n  return v === undefined ? d : v;\n}\n\nfunction sign(x) {\n  if (Math.sign) {\n    return Math.sign(x);\n  }\n\n  x = +x;\n\n  if (x === 0 || isNaN(x)) {\n    return Number(x);\n  }\n\n  return x > 0 ? 1 : -1;\n}\n\nfunction log2(x) {\n  if (Math.log2) {\n    return Math.log2(x);\n  }\n\n  var v = Math.log(x) * Math.LOG2E;\n  var rounded = Math.round(v);\n\n  if (Math.abs(rounded - v) < 1E-14) {\n    return rounded;\n  } else {\n    return v;\n  }\n}\n\nfunction interpolate(a, b, t) {\n  return a * (1 - t) + b * t;\n}\n\nfunction wrap(n, min, max) {\n  if (n === max || n === min) {\n    return n;\n  }\n\n  var d = max - min;\n  var w = ((n - min) % d + d) % d + min;\n  return w;\n}\n\nfunction clamp(n, min, max) {\n  return Math.min(max, Math.max(min, n));\n}\n\nfunction isArrayHasData(obj) {\n  return Array.isArray(obj) && obj.length > 0;\n}\n\nvar urlPattern = /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i;\n\nfunction isURL(url) {\n  return urlPattern.test(url);\n}\n\nvar cssUrlReWithQuote = /^url\\((['\"])(.+)\\1\\)$/i;\nvar cssUrlRe = /^url\\(([^'\"].*[^'\"])\\)$/i;\n\nfunction isCssUrl(str) {\n  if (!isString(str)) {\n    return 0;\n  }\n\n  if (cssUrlRe.test(str)) {\n    return 1;\n  }\n\n  if (cssUrlReWithQuote.test(str)) {\n    return 2;\n  }\n\n  return 3;\n}\n\nfunction extractCssUrl(str) {\n  var test = isCssUrl(str);\n  var matches;\n\n  if (test === 3) {\n    return str;\n  } else if (test === 1) {\n    matches = cssUrlRe.exec(str);\n    return matches[1];\n  } else if (test === 2) {\n    matches = cssUrlReWithQuote.exec(str);\n    return matches[2];\n  } else {\n    return str;\n  }\n}\n\nvar b64chrs = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\nfunction btoa(input) {\n  if (typeof window !== 'undefined' && window.btoa) {\n    return window.btoa(input);\n  }\n\n  var str = String(input);\n  var output = '';\n\n  for (var block, charCode, idx = 0, map = b64chrs; str.charAt(idx | 0) || (map = '=', idx % 1); output += map.charAt(63 & block >> 8 - idx % 1 * 8)) {\n    charCode = str.charCodeAt(idx += 3 / 4);\n\n    if (charCode > 0xFF) {\n      throw new Error('\\'btoa\\' failed: The string to be encoded contains characters outside of the Latin1 range.');\n    }\n\n    block = block << 8 | charCode;\n  }\n\n  return output;\n}\n\nfunction b64toBlob(b64Data, contentType) {\n  var byteCharacters = atob(b64Data);\n  var arraybuffer = new ArrayBuffer(byteCharacters.length);\n  var view = new Uint8Array(arraybuffer);\n\n  for (var i = 0; i < byteCharacters.length; i++) {\n    view[i] = byteCharacters.charCodeAt(i) & 0xff;\n  }\n\n  var blob = new Blob([arraybuffer], {\n    type: contentType\n  });\n  return blob;\n}\n\nfunction computeDegree(x0, y0, x1, y1) {\n  var dx = x1 - x0;\n  var dy = y1 - y0;\n  return Math.atan2(dy, dx);\n}\n\nvar emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\n\nfunction equalMapView(obj1, obj2) {\n  if (!obj1 && !obj2) {\n    return true;\n  } else if (!obj1 || !obj2) {\n    return false;\n  }\n\n  for (var p in obj1) {\n    if (p === 'center') {\n      if (!obj2[p] || !approx(obj1[p][0], obj2[p][0]) || !approx(obj1[p][1], obj2[p][1])) {\n        return false;\n      }\n    } else if (obj1[p] !== obj2[p]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction approx(val, expected, delta) {\n  if (delta == null) {\n    delta = 1e-6;\n  }\n\n  return val >= expected - delta && val <= expected + delta;\n}\n\nfunction flash(interval, count, cb, context) {\n  if (!interval) {\n    interval = 100;\n  }\n\n  if (!count) {\n    count = 4;\n  }\n\n  var me = this;\n  count *= 2;\n\n  if (this._flashTimeout) {\n    clearTimeout(this._flashTimeout);\n  }\n\n  function flashGeo() {\n    if (count === 0) {\n      me.show();\n\n      if (cb) {\n        if (context) {\n          cb.call(context);\n        } else {\n          cb();\n        }\n      }\n\n      return;\n    }\n\n    if (count % 2 === 0) {\n      me.hide();\n    } else {\n      me.show();\n    }\n\n    count--;\n    me._flashTimeout = setTimeout(flashGeo, interval);\n  }\n\n  this._flashTimeout = setTimeout(flashGeo, interval);\n  return this;\n}\n\nfunction _defaults(obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n}\n\nvar types = ['Unknown', 'Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\n\nfunction createFilter(filter) {\n  return new Function('f', \"var p = (f && f.properties || {}); return \" + compile(filter));\n}\n\nfunction compile(filter) {\n  if (!filter) return 'true';\n  var op = filter[0];\n  if (filter.length <= 1) return op === 'any' ? 'false' : 'true';\n  var str = op === '==' ? compileComparisonOp(filter[1], filter[2], '===', false) : op === '!=' ? compileComparisonOp(filter[1], filter[2], '!==', false) : op === '<' || op === '>' || op === '<=' || op === '>=' ? compileComparisonOp(filter[1], filter[2], op, true) : op === 'any' ? compileLogicalOp(filter.slice(1), '||') : op === 'all' ? compileLogicalOp(filter.slice(1), '&&') : op === 'none' ? compileNegation(compileLogicalOp(filter.slice(1), '||')) : op === 'in' ? compileInOp(filter[1], filter.slice(2)) : op === '!in' ? compileNegation(compileInOp(filter[1], filter.slice(2))) : op === 'has' ? compileHasOp(filter[1]) : op === '!has' ? compileNegation(compileHasOp(filter[1])) : 'true';\n  return \"(\" + str + \")\";\n}\n\nfunction compilePropertyReference(property) {\n  return property[0] === '$' ? 'f.' + property.substring(1) : 'p[' + JSON.stringify(property) + ']';\n}\n\nfunction compileComparisonOp(property, value, op, checkType) {\n  var left = compilePropertyReference(property);\n  var right = property === '$type' ? types.indexOf(value) : JSON.stringify(value);\n  return (checkType ? \"typeof \" + left + \"=== typeof \" + right + \"&&\" : '') + left + op + right;\n}\n\nfunction compileLogicalOp(expressions, op) {\n  return expressions.map(compile).join(op);\n}\n\nfunction compileInOp(property, values) {\n  if (property === '$type') values = values.map(function (value) {\n    return types.indexOf(value);\n  });\n  var left = JSON.stringify(values.sort(compare));\n  var right = compilePropertyReference(property);\n  if (values.length <= 200) return left + \".indexOf(\" + right + \") !== -1\";\n  return \"function(v, a, i, j) {\\n        while (i <= j) { var m = (i + j) >> 1;\\n            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;\\n        }\\n    return false; }(\" + right + \", \" + left + \",0,\" + (values.length - 1) + \")\";\n}\n\nfunction compileHasOp(property) {\n  return property === '$id' ? '\"id\" in f' : JSON.stringify(property) + \" in p\";\n}\n\nfunction compileNegation(expression) {\n  return \"!(\" + expression + \")\";\n}\n\nfunction compare(a, b) {\n  return a < b ? -1 : a > b ? 1 : 0;\n}\n\nfunction getFilterFeature(geometry) {\n  var json = geometry._toJSON(),\n      g = json['feature'];\n\n  g['type'] = types.indexOf(g['geometry']['type']);\n  g['subType'] = json['subType'];\n  return g;\n}\n\nfunction compileStyle(styles) {\n  if (!Array.isArray(styles)) {\n    return compileStyle([styles]);\n  }\n\n  var compiled = [];\n\n  for (var i = 0; i < styles.length; i++) {\n    var filter = void 0;\n\n    if (styles[i]['filter'] === true) {\n      filter = function filter() {\n        return true;\n      };\n    } else {\n      filter = createFilter(styles[i]['filter']);\n    }\n\n    compiled.push(extend$1({}, styles[i], {\n      filter: filter\n    }));\n  }\n\n  return compiled;\n}\n\nfunction extend$1(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    for (var k in src) {\n      dest[k] = src[k];\n    }\n  }\n\n  return dest;\n}\n\nfunction createFunction(parameters, defaultType) {\n  var fun;\n  var isFeatureConstant, isZoomConstant;\n\n  if (!isFunctionDefinition(parameters)) {\n    fun = function fun() {\n      return parameters;\n    };\n\n    isFeatureConstant = true;\n    isZoomConstant = true;\n  } else {\n    var zoomAndFeatureDependent = parameters.stops && _typeof(parameters.stops[0][0]) === 'object';\n    var featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\n    var zoomDependent = zoomAndFeatureDependent || !featureDependent;\n    var type = parameters.type || defaultType || 'exponential';\n    var innerFun;\n\n    if (type === 'exponential') {\n      innerFun = evaluateExponentialFunction;\n    } else if (type === 'interval') {\n      innerFun = evaluateIntervalFunction;\n    } else if (type === 'categorical') {\n      innerFun = evaluateCategoricalFunction;\n    } else if (type === 'identity') {\n      innerFun = evaluateIdentityFunction;\n    } else {\n      throw new Error('Unknown function type \"' + type + '\"');\n    }\n\n    if (zoomAndFeatureDependent) {\n      var featureFunctions = {};\n      var featureFunctionStops = [];\n\n      for (var s = 0; s < parameters.stops.length; s++) {\n        var stop = parameters.stops[s];\n\n        if (featureFunctions[stop[0].zoom] === undefined) {\n          featureFunctions[stop[0].zoom] = {\n            zoom: stop[0].zoom,\n            type: parameters.type,\n            property: parameters.property,\n            default: parameters.default,\n            stops: []\n          };\n        }\n\n        featureFunctions[stop[0].zoom].stops.push([stop[0].value, stop[1]]);\n      }\n\n      for (var z in featureFunctions) {\n        featureFunctionStops.push([featureFunctions[z].zoom, createFunction(featureFunctions[z])]);\n      }\n\n      fun = function fun(zoom, feature) {\n        var value = evaluateExponentialFunction({\n          stops: featureFunctionStops,\n          base: parameters.base\n        }, zoom)(zoom, feature);\n        return typeof value === 'function' ? value(zoom, feature) : value;\n      };\n\n      isFeatureConstant = false;\n      isZoomConstant = false;\n    } else if (zoomDependent) {\n      fun = function fun(zoom) {\n        var value = innerFun(parameters, zoom);\n        return typeof value === 'function' ? value(zoom) : value;\n      };\n\n      isFeatureConstant = true;\n      isZoomConstant = false;\n    } else {\n      fun = function fun(zoom, feature) {\n        var value = innerFun(parameters, feature ? feature[parameters.property] : null);\n        return typeof value === 'function' ? value(zoom, feature) : value;\n      };\n\n      isFeatureConstant = false;\n      isZoomConstant = true;\n    }\n  }\n\n  fun.isZoomConstant = isZoomConstant;\n  fun.isFeatureConstant = isFeatureConstant;\n  return fun;\n}\n\nfunction coalesce(a, b, c) {\n  if (a !== undefined) return a;\n  if (b !== undefined) return b;\n  if (c !== undefined) return c;\n  return null;\n}\n\nfunction evaluateCategoricalFunction(parameters, input) {\n  for (var i = 0; i < parameters.stops.length; i++) {\n    if (input === parameters.stops[i][0]) {\n      return parameters.stops[i][1];\n    }\n  }\n\n  return parameters.default;\n}\n\nfunction evaluateIntervalFunction(parameters, input) {\n  for (var i = 0; i < parameters.stops.length; i++) {\n    if (input < parameters.stops[i][0]) break;\n  }\n\n  return parameters.stops[Math.max(i - 1, 0)][1];\n}\n\nfunction evaluateExponentialFunction(parameters, input) {\n  var base = parameters.base !== undefined ? parameters.base : 1;\n  var i = 0;\n\n  while (true) {\n    if (i >= parameters.stops.length) break;else if (input <= parameters.stops[i][0]) break;else i++;\n  }\n\n  if (i === 0) {\n    return parameters.stops[i][1];\n  } else if (i === parameters.stops.length) {\n    return parameters.stops[i - 1][1];\n  } else {\n    return interpolate$1(input, base, parameters.stops[i - 1][0], parameters.stops[i][0], parameters.stops[i - 1][1], parameters.stops[i][1]);\n  }\n}\n\nfunction evaluateIdentityFunction(parameters, input) {\n  return coalesce(input, parameters.default);\n}\n\nfunction interpolate$1(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  if (typeof outputLower === 'function') {\n    return function () {\n      var evaluatedLower = outputLower.apply(undefined, arguments);\n      var evaluatedUpper = outputUpper.apply(undefined, arguments);\n      return interpolate$1(input, base, inputLower, inputUpper, evaluatedLower, evaluatedUpper);\n    };\n  } else if (outputLower.length) {\n    return interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper);\n  } else {\n    return interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper);\n  }\n}\n\nfunction interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  var difference = inputUpper - inputLower;\n  var progress = input - inputLower;\n  var ratio;\n\n  if (base === 1) {\n    ratio = progress / difference;\n  } else {\n    ratio = (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\n  }\n\n  return outputLower * (1 - ratio) + outputUpper * ratio;\n}\n\nfunction interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  var output = [];\n\n  for (var i = 0; i < outputLower.length; i++) {\n    output[i] = interpolateNumber(input, base, inputLower, inputUpper, outputLower[i], outputUpper[i]);\n  }\n\n  return output;\n}\n\nfunction isFunctionDefinition(obj) {\n  return obj && _typeof(obj) === 'object' && (obj.stops || obj.property && obj.type === 'identity');\n}\n\nfunction hasFunctionDefinition(obj) {\n  for (var p in obj) {\n    if (isFunctionDefinition(obj[p])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction interpolated(parameters) {\n  return createFunction1(parameters, 'exponential');\n}\n\nfunction piecewiseConstant(parameters) {\n  return createFunction1(parameters, 'interval');\n}\n\nfunction loadFunctionTypes(obj, argFn) {\n  if (!obj) {\n    return null;\n  }\n\n  var hit = false;\n\n  if (Array.isArray(obj)) {\n    var multResult = [],\n        loaded;\n\n    for (var i = 0; i < obj.length; i++) {\n      loaded = loadFunctionTypes(obj[i], argFn);\n\n      if (!loaded) {\n        multResult.push(obj[i]);\n      } else {\n        multResult.push(loaded);\n        hit = true;\n      }\n    }\n\n    return hit ? multResult : obj;\n  }\n\n  var result = {\n    '__fn_types_loaded': true\n  },\n      props = [],\n      p;\n\n  for (p in obj) {\n    if (obj.hasOwnProperty(p)) {\n      props.push(p);\n    }\n  }\n\n  var buildFn = function buildFn(p) {\n    Object.defineProperty(result, p, {\n      get: function get() {\n        if (!this['__fn_' + p]) {\n          this['__fn_' + p] = interpolated(this['_' + p]);\n        }\n\n        return this['__fn_' + p].apply(this, argFn());\n      },\n      set: function set(v) {\n        this['_' + p] = v;\n      },\n      configurable: true,\n      enumerable: true\n    });\n  };\n\n  for (var _i = 0, len = props.length; _i < len; _i++) {\n    p = props[_i];\n\n    if (isFunctionDefinition(obj[p])) {\n      hit = true;\n      result['_' + p] = obj[p];\n      buildFn(p);\n    } else {\n      result[p] = obj[p];\n    }\n  }\n\n  return hit ? result : obj;\n}\n\nfunction getFunctionTypeResources(t) {\n  if (!t || !t.stops) {\n    return [];\n  }\n\n  var res = [];\n\n  for (var i = 0, l = t.stops.length; i < l; i++) {\n    res.push(t.stops[i][1]);\n  }\n\n  return res;\n}\n\nfunction createFunction1(parameters, defaultType) {\n  if (!isFunctionDefinition(parameters)) {\n    return function () {\n      return parameters;\n    };\n  }\n\n  parameters = JSON.parse(JSON.stringify(parameters));\n  var isZoomConstant = true;\n  var isFeatureConstant = true;\n  var stops = parameters.stops;\n\n  if (stops) {\n    for (var i = 0; i < stops.length; i++) {\n      if (isFunctionDefinition(stops[i][1])) {\n        var _fn = createFunction1(stops[i][1], defaultType);\n\n        isZoomConstant = isZoomConstant && _fn.isZoomConstant;\n        isFeatureConstant = isFeatureConstant && _fn.isFeatureConstant;\n        stops[i] = [stops[i][0], _fn];\n      }\n    }\n  }\n\n  var fn = createFunction(parameters, defaultType);\n  fn.isZoomConstant = isZoomConstant && fn.isZoomConstant;\n  fn.isFeatureConstant = isFeatureConstant && fn.isFeatureConstant;\n  return fn;\n}\n\nvar index =\n/*#__PURE__*/\nObject.freeze({\n  createFilter: createFilter,\n  getFilterFeature: getFilterFeature,\n  compileStyle: compileStyle,\n  isFunctionDefinition: isFunctionDefinition,\n  hasFunctionDefinition: hasFunctionDefinition,\n  interpolated: interpolated,\n  piecewiseConstant: piecewiseConstant,\n  loadFunctionTypes: loadFunctionTypes,\n  getFunctionTypeResources: getFunctionTypeResources\n});\n\nfunction translateToSVGStyles(s) {\n  var result = {\n    'stroke': {\n      'stroke': s['markerLineColor'],\n      'stroke-width': s['markerLineWidth'],\n      'stroke-opacity': s['markerLineOpacity'],\n      'stroke-dasharray': null,\n      'stroke-linecap': 'butt',\n      'stroke-linejoin': 'round'\n    },\n    'fill': {\n      'fill': s['markerFill'],\n      'fill-opacity': s['markerFillOpacity']\n    }\n  };\n\n  if (result['stroke']['stroke-width'] === 0) {\n    result['stroke']['stroke-opacity'] = 0;\n  }\n\n  return result;\n}\n\nfunction getMarkerPathBase64(symbol, width, height) {\n  if (!symbol['markerPath']) {\n    return null;\n  }\n\n  var op = 1;\n  var styles = translateToSVGStyles(symbol);\n\n  if (isNumber(symbol['markerOpacity'])) {\n    op = symbol['markerOpacity'];\n  }\n\n  if (isNumber(symbol['opacity'])) {\n    op *= symbol['opacity'];\n  }\n\n  var svgStyles = {};\n\n  if (styles) {\n    for (var p in styles['stroke']) {\n      if (styles['stroke'].hasOwnProperty(p)) {\n        if (!isNil(styles['stroke'][p])) {\n          svgStyles[p] = styles['stroke'][p];\n        }\n      }\n    }\n\n    for (var _p in styles['fill']) {\n      if (styles['fill'].hasOwnProperty(_p)) {\n        if (!isNil(styles['fill'][_p])) {\n          svgStyles[_p] = styles['fill'][_p];\n        }\n      }\n    }\n  }\n\n  var pathes = Array.isArray(symbol['markerPath']) ? symbol['markerPath'] : [symbol['markerPath']];\n  var path;\n  var pathesToRender = [];\n\n  for (var i = 0; i < pathes.length; i++) {\n    path = isString(pathes[i]) ? {\n      'path': pathes[i]\n    } : pathes[i];\n    path = extend({}, path, svgStyles);\n    path['d'] = path['path'];\n    delete path['path'];\n    pathesToRender.push(path);\n  }\n\n  var svg = ['<svg version=\"1.1\"', 'xmlns=\"http://www.w3.org/2000/svg\"'];\n\n  if (op < 1) {\n    svg.push('opacity=\"' + op + '\"');\n  }\n\n  if (symbol['markerPathWidth'] && symbol['markerPathHeight']) {\n    svg.push('viewBox=\"0 0 ' + symbol['markerPathWidth'] + ' ' + symbol['markerPathHeight'] + '\"');\n  }\n\n  svg.push('preserveAspectRatio=\"none\"');\n\n  if (width) {\n    svg.push('width=\"' + width + '\"');\n  }\n\n  if (height) {\n    svg.push('height=\"' + height + '\"');\n  }\n\n  svg.push('><defs></defs>');\n\n  for (var _i = 0; _i < pathesToRender.length; _i++) {\n    var strPath = '<path ';\n\n    for (var _p2 in pathesToRender[_i]) {\n      if (pathesToRender[_i].hasOwnProperty(_p2)) {\n        strPath += ' ' + _p2 + '=\"' + pathesToRender[_i][_p2] + '\"';\n      }\n    }\n\n    strPath += '></path>';\n    svg.push(strPath);\n  }\n\n  svg.push('</svg>');\n  var b64 = 'data:image/svg+xml;base64,' + btoa(svg.join(' '));\n  return b64;\n}\n\nfunction getExternalResources(symbol, toAbsolute) {\n  if (!symbol) {\n    return [];\n  }\n\n  var symbols = symbol;\n\n  if (!Array.isArray(symbol)) {\n    symbols = [symbol];\n  }\n\n  var resources = [];\n  var props = RESOURCE_PROPERTIES;\n  var res, resSizeProp;\n  var w, h;\n\n  for (var i = symbols.length - 1; i >= 0; i--) {\n    symbol = symbols[i];\n\n    if (!symbol) {\n      continue;\n    }\n\n    if (toAbsolute) {\n      symbol = convertResourceUrl(symbol);\n    }\n\n    for (var ii = 0; ii < props.length; ii++) {\n      res = symbol[props[ii]];\n\n      if (isFunctionDefinition(res)) {\n        res = getFunctionTypeResources(res);\n      }\n\n      if (!res) {\n        continue;\n      }\n\n      if (!Array.isArray(res)) {\n        res = [res];\n      }\n\n      for (var iii = 0; iii < res.length; iii++) {\n        if (res[iii].slice(0, 4) === 'url(') {\n          res[iii] = extractCssUrl(res[iii]);\n        }\n\n        resSizeProp = RESOURCE_SIZE_PROPERTIES[ii];\n        resources.push([res[iii], symbol[resSizeProp[0]], symbol[resSizeProp[1]]]);\n      }\n    }\n\n    if (symbol['markerType'] === 'path' && symbol['markerPath']) {\n      w = isFunctionDefinition(symbol['markerWidth']) ? 200 : symbol['markerWidth'];\n      h = isFunctionDefinition(symbol['markerHeight']) ? 200 : symbol['markerHeight'];\n\n      if (isFunctionDefinition(symbol['markerPath'])) {\n        res = getFunctionTypeResources(symbol['markerPath']);\n        var path = symbol['markerPath'];\n\n        for (var _iii = 0; _iii < res.length; _iii++) {\n          symbol['markerPath'] = res[_iii];\n          resources.push([getMarkerPathBase64(symbol), w, h]);\n        }\n\n        symbol['markerPath'] = path;\n      } else {\n        resources.push([getMarkerPathBase64(symbol), w, h]);\n      }\n    }\n  }\n\n  return resources;\n}\n\nfunction convertResourceUrl(symbol) {\n  if (!symbol) {\n    return null;\n  }\n\n  var s = symbol;\n\n  if (IS_NODE) {\n    return s;\n  }\n\n  var props = RESOURCE_PROPERTIES;\n  var res;\n\n  for (var ii = 0, len = props.length; ii < len; ii++) {\n    res = s[props[ii]];\n\n    if (!res) {\n      continue;\n    }\n\n    s[props[ii]] = _convertUrl(res);\n  }\n\n  return s;\n}\n\nfunction _convertUrl(res) {\n  if (isFunctionDefinition(res)) {\n    var stops = res.stops;\n\n    for (var i = 0; i < stops.length; i++) {\n      stops[i][1] = _convertUrl(stops[i][1]);\n    }\n\n    return res;\n  }\n\n  if (res.slice(0, 4) === 'url(') {\n    res = extractCssUrl(res);\n  }\n\n  return res;\n}\n\nfunction isGradient(g) {\n  return g && g['colorStops'];\n}\n\nfunction getGradientStamp(g) {\n  var keys = [g['type']];\n\n  if (g['places']) {\n    keys.push(g['places'].join());\n  }\n\n  if (g['colorStops']) {\n    var stops = [];\n\n    for (var i = g['colorStops'].length - 1; i >= 0; i--) {\n      stops.push(g['colorStops'][i].join());\n    }\n\n    keys.push(stops.join(','));\n  }\n\n  return keys.join('_');\n}\n\nfunction getSymbolStamp(symbol) {\n  var keys = [];\n\n  if (Array.isArray(symbol)) {\n    for (var i = 0; i < symbol.length; i++) {\n      keys.push(getSymbolStamp(symbol[i]));\n    }\n\n    return '[ ' + keys.join(' , ') + ' ]';\n  }\n\n  for (var p in symbol) {\n    if (hasOwn(symbol, p)) {\n      if (!isFunction(symbol[p])) {\n        if (isGradient(symbol[p])) {\n          keys.push(p + '=' + getGradientStamp(symbol[p]));\n        } else {\n          keys.push(p + '=' + symbol[p]);\n        }\n      }\n    }\n  }\n\n  return keys.join(';');\n}\n\nfunction lowerSymbolOpacity(symbol, ratio) {\n  function s(_symbol, _ratio) {\n    var op = _symbol['opacity'];\n\n    if (isNil(op)) {\n      _symbol['opacity'] = _ratio;\n    } else {\n      _symbol['opacity'] *= _ratio;\n    }\n  }\n\n  var lower;\n\n  if (Array.isArray(symbol)) {\n    lower = [];\n\n    for (var i = 0; i < symbol.length; i++) {\n      var d = extend({}, symbol[i]);\n      s(d, ratio);\n      lower.push(d);\n    }\n  } else {\n    lower = extend({}, symbol);\n    s(lower, ratio);\n  }\n\n  return lower;\n}\n\nfunction extendSymbol(symbol) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  if (!sources || !sources.length) {\n    sources = [{}];\n  }\n\n  if (Array.isArray(symbol)) {\n    var s, dest;\n    var result = [];\n\n    for (var i = 0, l = symbol.length; i < l; i++) {\n      s = symbol[i];\n      dest = {};\n\n      for (var ii = 0, ll = sources.length; ii < ll; ii++) {\n        if (!Array.isArray(sources[ii])) {\n          extend(dest, s, sources[ii] ? sources[ii] : {});\n        } else if (!isNil(sources[ii][i])) {\n          extend(dest, s, sources[ii][i]);\n        } else {\n          extend(dest, s ? s : {});\n        }\n      }\n\n      result.push(dest);\n    }\n\n    return result;\n  } else {\n    var args = [{}, symbol];\n    args.push.apply(args, sources);\n    return extend.apply(this, args);\n  }\n}\n\nvar index$1 =\n/*#__PURE__*/\nObject.freeze({\n  now: now,\n  extend: extend,\n  isNil: isNil,\n  isNumber: isNumber,\n  isInteger: isInteger,\n  isObject: isObject,\n  isString: isString,\n  isFunction: isFunction,\n  hasOwn: hasOwn,\n  join: join,\n  isEmpty: isEmpty,\n  toRadian: toRadian,\n  toDegree: toDegree,\n  IS_NODE: IS_NODE,\n\n  get requestAnimFrame() {\n    return requestAnimFrame;\n  },\n\n  get cancelAnimFrame() {\n    return cancelAnimFrame;\n  },\n\n  isSVG: isSVG,\n  loadImage: loadImage,\n  UID: UID,\n  GUID: GUID,\n  parseJSON: parseJSON,\n  pushIn: pushIn,\n  removeFromArray: removeFromArray,\n  forEachCoord: forEachCoord,\n  getValueOrDefault: getValueOrDefault,\n  sign: sign,\n  log2: log2,\n  interpolate: interpolate,\n  wrap: wrap,\n  clamp: clamp,\n  isArrayHasData: isArrayHasData,\n  isURL: isURL,\n  isCssUrl: isCssUrl,\n  extractCssUrl: extractCssUrl,\n  btoa: btoa,\n  b64toBlob: b64toBlob,\n  computeDegree: computeDegree,\n  emptyImageUrl: emptyImageUrl,\n  equalMapView: equalMapView,\n  flash: flash,\n  _defaults: _defaults,\n  translateToSVGStyles: translateToSVGStyles,\n  getMarkerPathBase64: getMarkerPathBase64,\n  getExternalResources: getExternalResources,\n  convertResourceUrl: convertResourceUrl,\n  isGradient: isGradient,\n  getGradientStamp: getGradientStamp,\n  getSymbolStamp: getSymbolStamp,\n  lowerSymbolOpacity: lowerSymbolOpacity,\n  extendSymbol: extendSymbol\n});\nvar Browser = {};\n\nif (!IS_NODE) {\n  var ua = navigator.userAgent.toLowerCase(),\n      doc = document.documentElement,\n      ie = 'ActiveXObject' in window,\n      webkit = ua.indexOf('webkit') !== -1,\n      phantomjs = ua.indexOf('phantom') !== -1,\n      android23 = ua.search('android [23]') !== -1,\n      chrome = ua.indexOf('chrome') !== -1,\n      gecko = ua.indexOf('gecko') !== -1 && !webkit && !window.opera && !ie,\n      mobile = typeof orientation !== 'undefined' || ua.indexOf('mobile') !== -1,\n      msPointer = !window.PointerEvent && window.MSPointerEvent,\n      pointer = window.PointerEvent && navigator.pointerEnabled || msPointer,\n      ie3d = ie && 'transition' in doc.style,\n      webkit3d = 'WebKitCSSMatrix' in window && 'm11' in new window.WebKitCSSMatrix() && !android23,\n      gecko3d = 'MozPerspective' in doc.style,\n      opera12 = 'OTransition' in doc.style,\n      any3d = (ie3d || webkit3d || gecko3d) && !opera12 && !phantomjs;\n  var chromeVersion = 0;\n\n  if (chrome) {\n    chromeVersion = ua.match(/chrome\\/([\\d.]+)/)[1];\n  }\n\n  var touch = !phantomjs && (pointer || 'ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch);\n  var webgl;\n\n  try {\n    var canvas = document.createElement('canvas');\n    var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    webgl = gl && gl instanceof WebGLRenderingContext;\n  } catch (err) {\n    webgl = false;\n  }\n\n  var devicePixelRatio = window.devicePixelRatio || window.screen.deviceXDPI / window.screen.logicalXDPI;\n  Browser = {\n    ie: ie,\n    ielt9: ie && !document.addEventListener,\n    edge: 'msLaunchUri' in navigator && !('documentMode' in document),\n    webkit: webkit,\n    gecko: gecko,\n    android: ua.indexOf('android') !== -1,\n    android23: android23,\n    chrome: chrome,\n    chromeVersion: chromeVersion,\n    safari: !chrome && ua.indexOf('safari') !== -1,\n    phantomjs: phantomjs,\n    ie3d: ie3d,\n    webkit3d: webkit3d,\n    gecko3d: gecko3d,\n    opera12: opera12,\n    any3d: any3d,\n    mobile: mobile,\n    mobileWebkit: mobile && webkit,\n    mobileWebkit3d: mobile && webkit3d,\n    mobileOpera: mobile && window.opera,\n    mobileGecko: mobile && gecko,\n    touch: !!touch,\n    msPointer: !!msPointer,\n    pointer: !!pointer,\n    retina: devicePixelRatio > 1,\n    devicePixelRatio: devicePixelRatio,\n    language: navigator.browserLanguage ? navigator.browserLanguage : navigator.language,\n    ie9: ie && document.documentMode === 9,\n    ie10: ie && document.documentMode === 10,\n    webgl: webgl\n  };\n}\n\nvar Browser$1 = Browser;\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nvar Position = function () {\n  function Position(x, y) {\n    if (!isNil(x) && !isNil(y)) {\n      this.x = +x;\n      this.y = +y;\n    } else if (!isNil(x.x) && !isNil(x.y)) {\n      this.x = +x.x;\n      this.y = +x.y;\n    } else if (Array.isArray(x)) {\n      this.x = +x[0];\n      this.y = +x[1];\n    }\n\n    if (this._isNaN()) {\n      throw new Error('Position is NaN');\n    }\n  }\n\n  var _proto = Position.prototype;\n\n  _proto.set = function set(x, y) {\n    this.x = x;\n    this.y = y;\n    return this;\n  };\n\n  _proto.abs = function abs() {\n    return new this.constructor(Math.abs(this.x), Math.abs(this.y));\n  };\n\n  _proto._abs = function _abs() {\n    this.x = Math.abs(this.x);\n    this.y = Math.abs(this.y);\n    return this;\n  };\n\n  _proto._round = function _round() {\n    this.x = Math.round(this.x);\n    this.y = Math.round(this.y);\n    return this;\n  };\n\n  _proto.round = function round() {\n    return new this.constructor(Math.round(this.x), Math.round(this.y));\n  };\n\n  _proto._ceil = function _ceil() {\n    this.x = Math.ceil(this.x);\n    this.y = Math.ceil(this.y);\n    return this;\n  };\n\n  _proto.ceil = function ceil() {\n    return new this.constructor(Math.ceil(this.x), Math.ceil(this.y));\n  };\n\n  _proto.distanceTo = function distanceTo(point) {\n    var x = point.x - this.x,\n        y = point.y - this.y;\n    return Math.sqrt(x * x + y * y);\n  };\n\n  _proto._floor = function _floor() {\n    this.x = Math.floor(this.x);\n    this.y = Math.floor(this.y);\n    return this;\n  };\n\n  _proto.floor = function floor() {\n    return new this.constructor(Math.floor(this.x), Math.floor(this.y));\n  };\n\n  _proto.copy = function copy() {\n    return new this.constructor(this.x, this.y);\n  };\n\n  _proto._add = function _add(x, y) {\n    if (!isNil(x.x)) {\n      this.x += x.x;\n      this.y += x.y;\n    } else if (!isNil(x[0])) {\n      this.x += x[0];\n      this.y += x[1];\n    } else {\n      this.x += x;\n      this.y += y;\n    }\n\n    return this;\n  };\n\n  _proto.add = function add(x, y) {\n    var nx, ny;\n\n    if (!isNil(x.x)) {\n      nx = this.x + x.x;\n      ny = this.y + x.y;\n    } else if (!isNil(x[0])) {\n      nx = this.x + x[0];\n      ny = this.y + x[1];\n    } else {\n      nx = this.x + x;\n      ny = this.y + y;\n    }\n\n    return new this.constructor(nx, ny);\n  };\n\n  _proto._sub = function _sub(x, y) {\n    if (!isNil(x.x)) {\n      this.x -= x.x;\n      this.y -= x.y;\n    } else if (!isNil(x[0])) {\n      this.x -= x[0];\n      this.y -= x[1];\n    } else {\n      this.x -= x;\n      this.y -= y;\n    }\n\n    return this;\n  };\n\n  _proto._substract = function _substract() {\n    return this._sub.apply(this, arguments);\n  };\n\n  _proto.sub = function sub(x, y) {\n    var nx, ny;\n\n    if (!isNil(x.x)) {\n      nx = this.x - x.x;\n      ny = this.y - x.y;\n    } else if (!isNil(x[0])) {\n      nx = this.x - x[0];\n      ny = this.y - x[1];\n    } else {\n      nx = this.x - x;\n      ny = this.y - y;\n    }\n\n    return new this.constructor(nx, ny);\n  };\n\n  _proto.substract = function substract() {\n    return this.sub.apply(this, arguments);\n  };\n\n  _proto.multi = function multi(ratio) {\n    return new this.constructor(this.x * ratio, this.y * ratio);\n  };\n\n  _proto._multi = function _multi(ratio) {\n    this.x *= ratio;\n    this.y *= ratio;\n    return this;\n  };\n\n  _proto.div = function div(n) {\n    return this.multi(1 / n);\n  };\n\n  _proto._div = function _div(n) {\n    return this._multi(1 / n);\n  };\n\n  _proto.equals = function equals(c) {\n    if (!(c instanceof this.constructor)) {\n      return false;\n    }\n\n    return this.x === c.x && this.y === c.y;\n  };\n\n  _proto._isNaN = function _isNaN() {\n    return isNaN(this.x) || isNaN(this.y);\n  };\n\n  _proto.isZero = function isZero() {\n    return this.x === 0 && this.y === 0;\n  };\n\n  _proto.toArray = function toArray() {\n    return [this.x, this.y];\n  };\n\n  _proto.toFixed = function toFixed(n) {\n    return new this.constructor(this.x.toFixed(n), this.y.toFixed(n));\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      x: this.x,\n      y: this.y\n    };\n  };\n\n  return Position;\n}();\n\nvar Point = function (_Position) {\n  _inheritsLoose(Point, _Position);\n\n  function Point() {\n    return _Position.apply(this, arguments) || this;\n  }\n\n  var _proto = Point.prototype;\n\n  _proto.closeTo = function closeTo(p, delta) {\n    if (!delta) {\n      delta = 0;\n    }\n\n    return this.x >= p.x - delta && this.x <= p.x + delta && this.y >= p.y - delta && this.y <= p.y + delta;\n  };\n\n  _proto.mag = function mag() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  };\n\n  _proto.unit = function unit() {\n    return this.copy()._unit();\n  };\n\n  _proto._unit = function _unit() {\n    this._div(this.mag());\n\n    return this;\n  };\n\n  _proto.perp = function perp() {\n    return this.copy()._perp();\n  };\n\n  _proto._perp = function _perp() {\n    var y = this.y;\n    this.y = this.x;\n    this.x = -y;\n    return this;\n  };\n\n  _proto.angleWith = function angleWith(b) {\n    return this.angleWithSep(b.x, b.y);\n  };\n\n  _proto.angleWithSep = function angleWithSep(x, y) {\n    return Math.atan2(this.x * y - this.y * x, this.x * x + this.y * y);\n  };\n\n  _proto._rotate = function _rotate(angle) {\n    var cos = Math.cos(angle),\n        sin = Math.sin(angle),\n        x = cos * this.x - sin * this.y,\n        y = sin * this.x + cos * this.y;\n    this.x = x;\n    this.y = y;\n    return this;\n  };\n\n  _proto.rotate = function rotate(a) {\n    return this.copy()._rotate(a);\n  };\n\n  return Point;\n}(Position);\n\nvar Size = function () {\n  function Size(width, height) {\n    if (isNumber(width) && isNumber(height)) {\n      this.width = width;\n      this.height = height;\n    } else if (isNumber(width['width'])) {\n      this.width = width.width;\n      this.height = width.height;\n    } else if (Array.isArray(width)) {\n      this.width = width[0];\n      this.height = width[1];\n    }\n  }\n\n  var _proto = Size.prototype;\n\n  _proto.copy = function copy() {\n    return new Size(this['width'], this['height']);\n  };\n\n  _proto.add = function add(x, y) {\n    var w, h;\n\n    if (x instanceof Size) {\n      w = this.width + x.width;\n      h = this.height + x.height;\n    } else {\n      w = this.width + x;\n      h = this.height + y;\n    }\n\n    return new Size(w, h);\n  };\n\n  _proto.equals = function equals(size) {\n    return this['width'] === size['width'] && this['height'] === size['height'];\n  };\n\n  _proto.multi = function multi(ratio) {\n    return new Size(this['width'] * ratio, this['height'] * ratio);\n  };\n\n  _proto._multi = function _multi(ratio) {\n    this['width'] *= ratio;\n    this['height'] *= ratio;\n    return this;\n  };\n\n  _proto._round = function _round() {\n    this['width'] = Math.round(this['width']);\n    this['height'] = Math.round(this['height']);\n    return this;\n  };\n\n  _proto.toPoint = function toPoint() {\n    return new Point(this['width'], this['height']);\n  };\n\n  _proto.toArray = function toArray() {\n    return [this['width'], this['height']];\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'width': this['width'],\n      'height': this['height']\n    };\n  };\n\n  return Size;\n}();\n\nfunction trim(str) {\n  return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\nvar specialPattern = /[\\b\\t\\r\\v\\f]/igm;\n\nfunction escapeSpecialChars(str) {\n  if (!isString(str)) {\n    return str;\n  }\n\n  return str.replace(specialPattern, '');\n}\n\nfunction splitWords(chr) {\n  return trim(chr).split(/\\s+/);\n}\n\nvar rulerCtx = typeof document !== 'undefined' ? document.createElement('canvas').getContext('2d') : null;\n\nfunction stringWidth(text, font) {\n  if (stringWidth.node) {\n    return stringWidth.node(text, font);\n  }\n\n  rulerCtx.font = font;\n  return rulerCtx.measureText(text).width;\n}\n\nfunction stringLength(text, font, size) {\n  var w = stringWidth(text, font);\n  return new Size(w, size || DEFAULT_TEXT_SIZE);\n}\n\nfunction getFontHeight(font) {\n  var domRuler = getDomRuler('span');\n\n  if (font !== '_default_') {\n    domRuler.style.font = font;\n  }\n\n  domRuler.innerHTML = '秦';\n  var h = domRuler.clientHeight;\n  removeDomNode(domRuler);\n  return h;\n}\n\nfunction splitContent(content, font, wrapWidth, textWidth) {\n  if (!content || content.length === 0) {\n    return [{\n      'text': '',\n      'width': 0\n    }];\n  }\n\n  var width = isNil(textWidth) ? stringWidth(content, font) : textWidth;\n  var chrWidth = width / content.length,\n      minChrCount = Math.floor(wrapWidth / chrWidth / 2);\n\n  if (chrWidth >= wrapWidth || minChrCount <= 0) {\n    return [{\n      'text': '',\n      'width': wrapWidth\n    }];\n  }\n\n  if (width <= wrapWidth) return [{\n    'text': content,\n    'width': width\n  }];\n  var result = [];\n  var testStr = content.substring(0, minChrCount),\n      prew = chrWidth * minChrCount;\n\n  for (var i = minChrCount, l = content.length; i < l; i++) {\n    var chr = content[i];\n    var w = stringWidth(testStr + chr);\n\n    if (w >= wrapWidth) {\n      result.push({\n        'text': testStr,\n        'width': prew\n      });\n      testStr = content.substring(i, minChrCount + i);\n      i += minChrCount - 1;\n      prew = chrWidth * minChrCount;\n    } else {\n      testStr += chr;\n      prew = w;\n    }\n\n    if (i >= l - 1) {\n      prew = stringWidth(testStr);\n      result.push({\n        'text': testStr,\n        'width': prew\n      });\n    }\n  }\n\n  return result;\n}\n\nvar contentExpRe = /\\{([\\w_]+)\\}/g;\n\nfunction replaceVariable(str, props) {\n  if (!isString(str)) {\n    return str;\n  }\n\n  return str.replace(contentExpRe, function (str, key) {\n    if (!props) {\n      return '';\n    }\n\n    var value = props[key];\n\n    if (isNil(value)) {\n      return '';\n    } else if (Array.isArray(value)) {\n      return value.join();\n    }\n\n    return value;\n  });\n}\n\nfunction getAlignPoint(size, horizontalAlignment, verticalAlignment) {\n  var width = size['width'],\n      height = size['height'];\n  var alignW, alignH;\n\n  if (horizontalAlignment === 'left') {\n    alignW = -width;\n  } else if (horizontalAlignment === 'right') {\n    alignW = 0;\n  } else {\n    alignW = -width / 2;\n  }\n\n  if (verticalAlignment === 'top') {\n    alignH = -height;\n  } else if (verticalAlignment === 'bottom') {\n    alignH = 0;\n  } else {\n    alignH = -height / 2;\n  }\n\n  return new Point(alignW, alignH);\n}\n\nvar DEFAULT_FONT = 'monospace';\n\nfunction getFont(style) {\n  if (style['textFont']) {\n    return style['textFont'];\n  } else {\n    return (style['textStyle'] && style['textStyle'] !== 'normal' ? style['textStyle'] + ' ' : '') + (style['textWeight'] && style['textWeight'] !== 'normal' ? style['textWeight'] + ' ' : '') + style['textSize'] + 'px ' + (!style['textFaceName'] ? DEFAULT_FONT : style['textFaceName'][0] === '\"' ? style['textFaceName'] : '\"' + style['textFaceName'] + '\"');\n  }\n}\n\nfunction splitTextToRow(text, style) {\n  var font = getFont(style),\n      lineSpacing = style['textLineSpacing'] || 0,\n      size = stringLength(text, font, style['textSize']),\n      textWidth = size['width'],\n      textHeight = size['height'],\n      wrapChar = style['textWrapCharacter'],\n      textRows = [];\n  var wrapWidth = style['textWrapWidth'];\n\n  if (!wrapWidth || wrapWidth > textWidth) {\n    wrapWidth = textWidth;\n  }\n\n  if (!isString(text)) {\n    text += '';\n  }\n\n  var actualWidth = 0;\n\n  if (wrapChar && text.indexOf(wrapChar) >= 0) {\n    var texts = text.split(wrapChar);\n\n    for (var i = 0, l = texts.length; i < l; i++) {\n      var t = texts[i];\n      var tWidth = stringWidth(t, font);\n\n      if (tWidth > wrapWidth) {\n        var contents = splitContent(t, font, wrapWidth, tWidth);\n\n        for (var ii = 0, ll = contents.length; ii < ll; ii++) {\n          var w = contents[ii].width;\n\n          if (w > actualWidth) {\n            actualWidth = w;\n          }\n\n          textRows.push({\n            'text': contents[ii].text,\n            'size': new Size(w, textHeight)\n          });\n        }\n      } else {\n        if (tWidth > actualWidth) {\n          actualWidth = tWidth;\n        }\n\n        textRows.push({\n          'text': t,\n          'size': new Size(tWidth, textHeight)\n        });\n      }\n    }\n  } else if (textWidth > wrapWidth) {\n    var _contents = splitContent(text, font, wrapWidth, textWidth);\n\n    for (var _i = 0; _i < _contents.length; _i++) {\n      var _w = _contents[_i].width;\n\n      if (_w > actualWidth) {\n        actualWidth = _w;\n      }\n\n      textRows.push({\n        'text': _contents[_i].text,\n        'size': new Size(_w, textHeight)\n      });\n    }\n  } else {\n    if (textWidth > actualWidth) {\n      actualWidth = textWidth;\n    }\n\n    textRows.push({\n      'text': text,\n      'size': size\n    });\n  }\n\n  var rowNum = textRows.length;\n  var textSize = new Size(actualWidth, textHeight * rowNum + lineSpacing * (rowNum - 1));\n  return {\n    'total': rowNum,\n    'size': textSize,\n    'rows': textRows,\n    'rawSize': size\n  };\n}\n\nvar strings =\n/*#__PURE__*/\nObject.freeze({\n  trim: trim,\n  escapeSpecialChars: escapeSpecialChars,\n  splitWords: splitWords,\n  stringWidth: stringWidth,\n  stringLength: stringLength,\n  getFontHeight: getFontHeight,\n  splitContent: splitContent,\n  replaceVariable: replaceVariable,\n  getAlignPoint: getAlignPoint,\n  getFont: getFont,\n  splitTextToRow: splitTextToRow\n});\n\nvar first = function first(props) {\n  return props[0];\n};\n\nvar testProp = IS_NODE ? first : function (props) {\n  var style = document.documentElement.style;\n\n  for (var i = 0; i < props.length; i++) {\n    if (props[i] in style) {\n      return props[i];\n    }\n  }\n\n  return false;\n};\nvar TRANSFORM = testProp(['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\nvar TRANSFORMORIGIN = testProp(['transformOrigin', 'WebkitTransformOrigin', 'OTransformOrigin', 'MozTransformOrigin', 'msTransformOrigin']);\nvar TRANSITION = testProp(['transition', 'WebkitTransition', 'OTransition', 'MozTransition', 'msTransition']);\nvar CSSFILTER = testProp(['filter', 'WebkitFilter', 'OFilter', 'MozFilter', 'msFilter']);\n\nfunction createEl(tagName, className) {\n  var el = document.createElement(tagName);\n\n  if (className) {\n    setClass(el, className);\n  }\n\n  return el;\n}\n\nfunction createElOn(tagName, style, container) {\n  var el = createEl(tagName);\n\n  if (style) {\n    setStyle(el, style);\n  }\n\n  if (container) {\n    container.appendChild(el);\n  }\n\n  return el;\n}\n\nfunction removeDomNode(node) {\n  if (!node) {\n    return this;\n  }\n\n  if (Browser$1.ielt9 || Browser$1.ie9) {\n    var d = createEl('div');\n    d.appendChild(node);\n    d.innerHTML = '';\n    d = null;\n  } else if (node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return this;\n}\n\nfunction addDomEvent(obj, typeArr, handler, context) {\n  if (!obj || !obj.addEventListener || !typeArr || !handler) {\n    return this;\n  }\n\n  var eventHandler = function eventHandler(e) {\n    if (!e) {\n      e = window.event;\n    }\n\n    handler.call(context || obj, e);\n    return;\n  };\n\n  var types = typeArr.split(' ');\n\n  for (var i = types.length - 1; i >= 0; i--) {\n    var type = types[i];\n\n    if (!type) {\n      continue;\n    }\n\n    if (!obj['Z__' + type]) {\n      obj['Z__' + type] = [];\n    }\n\n    var hit = listensDomEvent(obj, type, handler);\n\n    if (hit >= 0) {\n      removeDomEvent(obj, type, handler);\n    }\n\n    obj['Z__' + type].push({\n      callback: eventHandler,\n      src: handler\n    });\n\n    if (Browser$1.ie) {\n      obj.addEventListener(type, eventHandler, false);\n    } else {\n      obj.addEventListener(type, eventHandler, {\n        capture: false,\n        passive: false\n      });\n    }\n  }\n\n  return this;\n}\n\nfunction removeDomEvent(obj, typeArr, handler) {\n  function doRemove(type, callback) {\n    if (type === 'mousewheel' && Browser$1.gecko) {\n      type = 'DOMMouseScroll';\n    }\n\n    obj.removeEventListener(type, callback, false);\n  }\n\n  if (!obj || !obj.removeEventListener || !typeArr) {\n    return this;\n  }\n\n  var types = typeArr.split(' ');\n\n  for (var i = types.length - 1; i >= 0; i--) {\n    var type = types[i];\n\n    if (!type) {\n      continue;\n    }\n\n    if (!handler && obj['Z__' + type]) {\n      var handlers = obj['Z__' + type];\n\n      for (var j = 0, jlen = handlers.length; j < jlen; j++) {\n        doRemove(handlers[j].callback);\n      }\n\n      delete obj['Z__' + type];\n      return this;\n    }\n\n    var hit = listensDomEvent(obj, type, handler);\n\n    if (hit < 0) {\n      return this;\n    }\n\n    var hitHandler = obj['Z__' + type][hit];\n    doRemove(type, hitHandler.callback);\n    obj['Z__' + type].splice(hit, 1);\n  }\n\n  return this;\n}\n\nfunction listensDomEvent(obj, type, handler) {\n  if (!obj || !obj['Z__' + type] || !handler) {\n    return -1;\n  }\n\n  var handlers = obj['Z__' + type];\n\n  for (var i = 0, len = handlers.length; i < len; i++) {\n    if (handlers[i].src === handler) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\nfunction preventDefault(event) {\n  if (event.preventDefault) {\n    event.preventDefault();\n  } else {\n    event.returnValue = false;\n  }\n\n  return this;\n}\n\nfunction stopPropagation(e) {\n  if (e.stopPropagation) {\n    e.stopPropagation();\n  } else {\n    e.cancelBubble = true;\n  }\n\n  return this;\n}\n\nfunction preventSelection(dom) {\n  dom.onselectstart = function () {\n    return false;\n  };\n\n  dom.ondragstart = function () {\n    return false;\n  };\n\n  dom.setAttribute('unselectable', 'on');\n  return this;\n}\n\nfunction offsetDom(dom, offset) {\n  if (!dom) {\n    return null;\n  }\n\n  if (Browser$1.any3d) {\n    setTransform(dom, offset);\n  } else {\n    dom.style.left = offset.x + 'px';\n    dom.style.top = offset.y + 'px';\n  }\n\n  return offset;\n}\n\nfunction computeDomPosition(dom) {\n  var style = window.getComputedStyle(dom);\n  var padding = [parseInt(style['padding-left']), parseInt(style['padding-top'])];\n  var rect = dom.getBoundingClientRect();\n  var offsetWidth = dom.offsetWidth,\n      offsetHeight = dom.offsetHeight;\n  var scaleX = offsetWidth ? rect.width / offsetWidth : 1,\n      scaleY = offsetHeight ? rect.height / offsetHeight : 1;\n  dom.__position = [rect.left + padding[0], rect.top + padding[1], scaleX, scaleY];\n  return dom.__position;\n}\n\nfunction getEventContainerPoint(ev, dom) {\n  if (!ev) {\n    ev = window.event;\n  }\n\n  var domPos = dom.__position;\n\n  if (!domPos) {\n    domPos = computeDomPosition(dom);\n  }\n\n  return new Point((ev.clientX - domPos[0] - dom.clientLeft) / domPos[2], (ev.clientY - domPos[1] - dom.clientTop) / domPos[3]);\n}\n\nfunction endsWith(str, suffix) {\n  var l = str.length - suffix.length;\n  return l >= 0 && str.indexOf(suffix, l) === l;\n}\n\nfunction setStyle(dom, strCss) {\n  var cssText = dom.style.cssText;\n\n  if (!endsWith(cssText, ';')) {\n    cssText += ';';\n  }\n\n  dom.style.cssText = cssText + strCss;\n  return this;\n}\n\nfunction hasClass(el, name) {\n  if (el.classList !== undefined) {\n    return el.classList.contains(name);\n  }\n\n  var className = getClass(el);\n  return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\nfunction addClass(el, name) {\n  if (el.classList !== undefined && !hasClass(el, name)) {\n    var classes = splitWords(name);\n\n    for (var i = 0, len = classes.length; i < len; i++) {\n      el.classList.add(classes[i]);\n    }\n  } else {\n    var className = getClass(el);\n    setClass(el, (className ? className + ' ' : '') + name);\n  }\n\n  return this;\n}\n\nfunction setClass(el, name) {\n  if (isNil(el.className.baseVal)) {\n    el.className = name;\n  } else {\n    el.className.baseVal = name;\n  }\n\n  return this;\n}\n\nfunction getClass(el) {\n  return isNil(el.className.baseVal) ? el.className : el.className.baseVal;\n}\n\nfunction setOpacity(el, value) {\n  el.style.opacity = value;\n  return this;\n}\n\nfunction setTransform(el, offset) {\n  var pos = offset || new Point(0, 0);\n  el.style[TRANSFORM] = Browser$1.any3d ? 'translate3d(' + pos.x + 'px,' + pos.y + 'px,0px)' : 'translate(' + pos.x + 'px,' + pos.y + 'px)';\n  return this;\n}\n\nfunction setTransformMatrix(el, m) {\n  var text = 'matrix(' + (isString(m) ? m : m.join()) + ')';\n\n  if (el.style[TRANSFORM] !== text) {\n    el.style[TRANSFORM] = text;\n  }\n\n  return this;\n}\n\nfunction removeTransform(el) {\n  if (el.style[TRANSFORM]) {\n    el.style[TRANSFORM] = '';\n  }\n\n  return this;\n}\n\nfunction isHTML(str) {\n  return /<[a-z\\][\\s\\S]*>/i.test(str);\n}\n\nfunction measureDom(parentTag, dom) {\n  var ruler = getDomRuler(parentTag);\n\n  if (isString(dom)) {\n    ruler.innerHTML = dom;\n  } else {\n    ruler.appendChild(dom);\n  }\n\n  var result = new Size(ruler.clientWidth, ruler.clientHeight);\n  removeDomNode(ruler);\n  return result;\n}\n\nfunction getDomRuler(tag) {\n  var span = document.createElement(tag);\n  span.style.cssText = 'position:absolute;left:-10000px;top:-10000px;';\n  document.body.appendChild(span);\n  return span;\n}\n\nvar on = addDomEvent;\nvar off = removeDomEvent;\nvar dom =\n/*#__PURE__*/\nObject.freeze({\n  TRANSFORM: TRANSFORM,\n  TRANSFORMORIGIN: TRANSFORMORIGIN,\n  TRANSITION: TRANSITION,\n  CSSFILTER: CSSFILTER,\n  createEl: createEl,\n  createElOn: createElOn,\n  removeDomNode: removeDomNode,\n  addDomEvent: addDomEvent,\n  removeDomEvent: removeDomEvent,\n  listensDomEvent: listensDomEvent,\n  preventDefault: preventDefault,\n  stopPropagation: stopPropagation,\n  preventSelection: preventSelection,\n  offsetDom: offsetDom,\n  computeDomPosition: computeDomPosition,\n  getEventContainerPoint: getEventContainerPoint,\n  setStyle: setStyle,\n  hasClass: hasClass,\n  addClass: addClass,\n  setClass: setClass,\n  getClass: getClass,\n  setOpacity: setOpacity,\n  setTransform: setTransform,\n  setTransformMatrix: setTransformMatrix,\n  removeTransform: removeTransform,\n  isHTML: isHTML,\n  measureDom: measureDom,\n  getDomRuler: getDomRuler,\n  on: on,\n  off: off\n});\nvar Ajax = {\n  jsonp: function jsonp(url, callback) {\n    var name = '_maptalks_jsonp_' + UID();\n    if (url.match(/\\?/)) url += '&callback=' + name;else url += '?callback=' + name;\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = url;\n\n    window[name] = function (data) {\n      callback(null, data);\n      document.getElementsByTagName('head')[0].removeChild(script);\n      script = null;\n      delete window[name];\n    };\n\n    document.getElementsByTagName('head')[0].appendChild(script);\n    return this;\n  },\n  get: function get(url, options, cb) {\n    if (isFunction(options)) {\n      var t = cb;\n      cb = options;\n      options = t;\n    }\n\n    if (IS_NODE && Ajax.get.node) {\n      return Ajax.get.node(url, cb, options);\n    }\n\n    var client = Ajax._getClient(cb);\n\n    client.open('GET', url, true);\n\n    if (options) {\n      for (var k in options.headers) {\n        client.setRequestHeader(k, options.headers[k]);\n      }\n\n      client.withCredentials = options.credentials === 'include';\n\n      if (options['responseType']) {\n        client.responseType = options['responseType'];\n      }\n    }\n\n    client.send(null);\n    return client;\n  },\n  post: function post(url, options, cb) {\n    var postData;\n\n    if (!isString(url)) {\n      var t = cb;\n      postData = options;\n      options = url;\n      url = options.url;\n      cb = t;\n    } else {\n      if (isFunction(options)) {\n        var _t = cb;\n        cb = options;\n        options = _t;\n      }\n\n      options = options || {};\n      postData = options.postData;\n    }\n\n    if (IS_NODE && Ajax.post.node) {\n      options.url = url;\n      return Ajax.post.node(options, postData, cb);\n    }\n\n    var client = Ajax._getClient(cb);\n\n    client.open('POST', options.url, true);\n\n    if (!options.headers) {\n      options.headers = {};\n    }\n\n    if (!options.headers['Content-Type']) {\n      options.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n    }\n\n    if ('setRequestHeader' in client) {\n      for (var p in options.headers) {\n        if (options.headers.hasOwnProperty(p)) {\n          client.setRequestHeader(p, options.headers[p]);\n        }\n      }\n    }\n\n    if (!isString(postData)) {\n      postData = JSON.stringify(postData);\n    }\n\n    client.send(postData);\n    return client;\n  },\n  _wrapCallback: function _wrapCallback(client, cb) {\n    return function () {\n      if (client.readyState === 4) {\n        if (client.status === 200) {\n          if (client.responseType === 'arraybuffer') {\n            var response = client.response;\n\n            if (response.byteLength === 0) {\n              cb(new Error('http status 200 returned without content.'));\n            } else {\n              cb(null, {\n                data: client.response,\n                cacheControl: client.getResponseHeader('Cache-Control'),\n                expires: client.getResponseHeader('Expires'),\n                contentType: client.getResponseHeader('Content-Type')\n              });\n            }\n          } else {\n            cb(null, client.responseText);\n          }\n        } else {\n          cb(new Error(client.statusText + ',' + client.status));\n        }\n      }\n    };\n  },\n  _getClient: function _getClient(cb) {\n    var client;\n\n    try {\n      client = new XMLHttpRequest();\n    } catch (e) {\n      try {\n        client = new ActiveXObject('Msxml2.XMLHTTP');\n      } catch (e) {\n        try {\n          client = new ActiveXObject('Microsoft.XMLHTTP');\n        } catch (e) {}\n      }\n    }\n\n    client.onreadystatechange = Ajax._wrapCallback(client, cb);\n    return client;\n  },\n  getArrayBuffer: function getArrayBuffer(url, options, cb) {\n    if (isFunction(options)) {\n      var t = cb;\n      cb = options;\n      options = t;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    options['responseType'] = 'arraybuffer';\n    return Ajax.get(url, options, cb);\n  },\n  getImage: function getImage(img, url, options) {\n    return Ajax.getArrayBuffer(url, options, function (err, imgData) {\n      if (err) {\n        if (img.onerror) {\n          img.onerror(err);\n        }\n      } else if (imgData) {\n        var URL = window.URL || window.webkitURL;\n        var onload = img.onload;\n\n        img.onload = function () {\n          if (onload) {\n            onload();\n          }\n\n          URL.revokeObjectURL(img.src);\n        };\n\n        var blob = new Blob([new Uint8Array(imgData.data)], {\n          type: imgData.contentType\n        });\n        img.cacheControl = imgData.cacheControl;\n        img.expires = imgData.expires;\n        img.src = imgData.data.byteLength ? URL.createObjectURL(blob) : emptyImageUrl;\n      }\n    });\n  }\n};\n\nAjax.getJSON = function (url, options, cb) {\n  if (isFunction(options)) {\n    var t = cb;\n    cb = options;\n    options = t;\n  }\n\n  var callback = function callback(err, resp) {\n    var data = resp ? parseJSON(resp) : null;\n    cb(err, data);\n  };\n\n  if (options && options['jsonp']) {\n    return Ajax.jsonp(url, callback);\n  }\n\n  return Ajax.get(url, options, callback);\n};\n\nvar DEFAULT_STROKE_COLOR = '#000';\nvar DEFAULT_FILL_COLOR = 'rgba(255,255,255,0)';\nvar DEFAULT_TEXT_COLOR = '#000';\nvar hitTesting = false;\nvar TEMP_CANVAS = null;\nvar RADIAN = Math.PI / 180;\nvar textOffsetY = 1;\nvar Canvas = {\n  setHitTesting: function setHitTesting(testing) {\n    hitTesting = testing;\n  },\n  createCanvas: function createCanvas(width, height, canvasClass) {\n    var canvas;\n\n    if (!IS_NODE) {\n      canvas = createEl('canvas');\n      canvas.width = width;\n      canvas.height = height;\n    } else {\n      canvas = new canvasClass(width, height);\n    }\n\n    return canvas;\n  },\n  prepareCanvasFont: function prepareCanvasFont(ctx, style) {\n    ctx.textBaseline = 'top';\n    ctx.font = getFont(style);\n    var fill = style['textFill'];\n\n    if (!fill) {\n      fill = DEFAULT_TEXT_COLOR;\n    }\n\n    ctx.fillStyle = Canvas.getRgba(fill, style['textOpacity']);\n  },\n  prepareCanvas: function prepareCanvas(ctx, style, resources, testing) {\n    if (!style) {\n      return;\n    }\n\n    var strokeWidth = style['lineWidth'];\n\n    if (!isNil(strokeWidth) && ctx.lineWidth !== strokeWidth) {\n      ctx.lineWidth = strokeWidth;\n    }\n\n    var strokePattern = style['linePatternFile'];\n    var strokeColor = style['lineColor'] || DEFAULT_STROKE_COLOR;\n\n    if (testing) {\n      ctx.strokeStyle = '#000';\n    } else if (strokePattern && resources) {\n      var patternOffset;\n\n      if (style['linePatternDx'] || style['linePatternDy']) {\n        patternOffset = [style['linePatternDx'], style['linePatternDy']];\n      }\n\n      Canvas._setStrokePattern(ctx, strokePattern, strokeWidth, patternOffset, resources);\n\n      style['lineDasharray'] = [];\n    } else if (isGradient(strokeColor)) {\n      if (style['lineGradientExtent']) {\n        ctx.strokeStyle = Canvas._createGradient(ctx, strokeColor, style['lineGradientExtent']);\n      } else {\n        ctx.strokeStyle = DEFAULT_STROKE_COLOR;\n      }\n    } else {\n      ctx.strokeStyle = strokeColor;\n    }\n\n    if (style['lineJoin']) {\n      ctx.lineJoin = style['lineJoin'];\n    }\n\n    if (style['lineCap']) {\n      ctx.lineCap = style['lineCap'];\n    }\n\n    if (ctx.setLineDash && isArrayHasData(style['lineDasharray'])) {\n      ctx.setLineDash(style['lineDasharray']);\n    }\n\n    var polygonPattern = style['polygonPatternFile'];\n    var fill = style['polygonFill'] || DEFAULT_FILL_COLOR;\n\n    if (testing) {\n      ctx.fillStyle = '#000';\n    } else if (polygonPattern && resources) {\n      var fillImgUrl = extractImageUrl(polygonPattern);\n      var fillTexture = resources.getImage([fillImgUrl, null, null]);\n\n      if (!fillTexture) {\n        fillTexture = resources.getImage([fillImgUrl + '-texture', null, strokeWidth]);\n      }\n\n      if (isSVG(fillImgUrl) && fillTexture instanceof Image && (Browser$1.edge || Browser$1.ie)) {\n        var w = fillTexture.width || 20,\n            h = fillTexture.height || 20;\n        var canvas = Canvas.createCanvas(w, h);\n        Canvas.image(canvas.getContext('2d'), fillTexture, 0, 0, w, h);\n        fillTexture = canvas;\n      }\n\n      if (!fillTexture) {\n        if (typeof console !== 'undefined') {\n          console.warn('img not found for', fillImgUrl);\n        }\n      } else {\n        ctx.fillStyle = ctx.createPattern(fillTexture, 'repeat');\n\n        if (style['polygonPatternDx'] || style['polygonPatternDy']) {\n          ctx.fillStyle['polygonPatternOffset'] = [style['polygonPatternDx'], style['polygonPatternDy']];\n        }\n      }\n    } else if (isGradient(fill)) {\n      if (style['polygonGradientExtent']) {\n        ctx.fillStyle = Canvas._createGradient(ctx, fill, style['polygonGradientExtent']);\n      } else {\n        ctx.fillStyle = 'rgba(255,255,255,0)';\n      }\n    } else {\n      ctx.fillStyle = fill;\n    }\n  },\n  _createGradient: function _createGradient(ctx, g, extent) {\n    var gradient = null,\n        places = g['places'];\n    var min = extent.getMin(),\n        max = extent.getMax(),\n        width = extent.getWidth(),\n        height = extent.getHeight();\n\n    if (!g['type'] || g['type'] === 'linear') {\n      if (!places) {\n        places = [min.x, min.y, max.x, min.y];\n      } else {\n        if (places.length !== 4) {\n          throw new Error('A linear gradient\\'s places should have 4 numbers.');\n        }\n\n        places = [min.x + places[0] * width, min.y + places[1] * height, min.x + places[2] * width, min.y + places[3] * height];\n      }\n\n      gradient = ctx.createLinearGradient.apply(ctx, places);\n    } else if (g['type'] === 'radial') {\n      if (!places) {\n        var c = extent.getCenter()._round();\n\n        places = [c.x, c.y, Math.abs(c.x - min.x), c.x, c.y, 0];\n      } else {\n        if (places.length !== 6) {\n          throw new Error('A radial gradient\\'s places should have 6 numbers.');\n        }\n\n        places = [min.x + places[0] * width, min.y + places[1] * height, width * places[2], min.x + places[3] * width, min.y + places[4] * height, width * places[5]];\n      }\n\n      gradient = ctx.createRadialGradient.apply(ctx, places);\n    }\n\n    g['colorStops'].forEach(function (stop) {\n      gradient.addColorStop.apply(gradient, stop);\n    });\n    return gradient;\n  },\n  _setStrokePattern: function _setStrokePattern(ctx, strokePattern, strokeWidth, linePatternOffset, resources) {\n    var imgUrl = extractImageUrl(strokePattern);\n    var imageTexture;\n\n    if (IS_NODE) {\n      imageTexture = resources.getImage([imgUrl, null, strokeWidth]);\n    } else {\n      var key = imgUrl + '-texture-' + strokeWidth;\n      imageTexture = resources.getImage(key);\n\n      if (!imageTexture) {\n        var imageRes = resources.getImage([imgUrl, null, null]);\n\n        if (imageRes) {\n          var w;\n\n          if (!imageRes.width || !imageRes.height) {\n            w = strokeWidth;\n          } else {\n            w = Math.round(imageRes.width * strokeWidth / imageRes.height);\n          }\n\n          var patternCanvas = Canvas.createCanvas(w, strokeWidth, ctx.canvas.constructor);\n          Canvas.image(patternCanvas.getContext('2d'), imageRes, 0, 0, w, strokeWidth);\n          resources.addResource([key, null, strokeWidth], patternCanvas);\n          imageTexture = patternCanvas;\n        }\n      }\n    }\n\n    if (imageTexture) {\n      ctx.strokeStyle = ctx.createPattern(imageTexture, 'repeat');\n      ctx.strokeStyle['linePatternOffset'] = linePatternOffset;\n    } else if (typeof console !== 'undefined') {\n      console.warn('img not found for', imgUrl);\n    }\n  },\n  clearRect: function clearRect(ctx, x1, y1, x2, y2) {\n    ctx.canvas._drawn = false;\n    ctx.clearRect(x1, y1, x2, y2);\n  },\n  fillCanvas: function fillCanvas(ctx, fillOpacity, x, y) {\n    if (hitTesting) {\n      fillOpacity = 1;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (fillOpacity === 0) {\n      return;\n    }\n\n    var isPattern = Canvas._isPattern(ctx.fillStyle);\n\n    var offset = ctx.fillStyle && ctx.fillStyle['polygonPatternOffset'];\n    var dx = offset ? offset[0] : 0,\n        dy = offset ? offset[1] : 0;\n\n    if (isNil(fillOpacity)) {\n      fillOpacity = 1;\n    }\n\n    var alpha;\n\n    if (fillOpacity < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= fillOpacity;\n    }\n\n    if (isPattern) {\n      x = x || 0;\n      y = y || 0;\n      ctx.translate(x + dx, y + dy);\n    }\n\n    ctx.fill();\n\n    if (isPattern) {\n      ctx.translate(-x - dx, -y - dy);\n    }\n\n    if (fillOpacity < 1) {\n      ctx.globalAlpha = alpha;\n    }\n  },\n  getRgba: function getRgba(color, op) {\n    if (isNil(op)) {\n      op = 1;\n    }\n\n    if (color[0] !== '#') {\n      return color;\n    }\n\n    var r, g, b;\n\n    if (color.length === 7) {\n      r = parseInt(color.substring(1, 3), 16);\n      g = parseInt(color.substring(3, 5), 16);\n      b = parseInt(color.substring(5, 7), 16);\n    } else {\n      r = parseInt(color.substring(1, 2), 16) * 17;\n      g = parseInt(color.substring(2, 3), 16) * 17;\n      b = parseInt(color.substring(3, 4), 16) * 17;\n    }\n\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + op + ')';\n  },\n  image: function image(ctx, img, x, y, width, height) {\n    ctx.canvas._drawn = true;\n\n    try {\n      if (isNumber(width) && isNumber(height)) {\n        ctx.drawImage(img, x, y, width, height);\n      } else {\n        ctx.drawImage(img, x, y);\n      }\n    } catch (error) {\n      if (console) {\n        console.warn('error when drawing image on canvas:', error);\n        console.warn(img);\n      }\n    }\n  },\n  text: function text(ctx, _text, pt, style, textDesc) {\n    Canvas._textOnMultiRow(ctx, textDesc['rows'], style, pt, textDesc['size'], textDesc['rawSize']);\n  },\n  _textOnMultiRow: function _textOnMultiRow(ctx, texts, style, point, splitTextSize, textSize) {\n    var ptAlign = getAlignPoint(splitTextSize, style['textHorizontalAlignment'], style['textVerticalAlignment']),\n        lineHeight = textSize['height'] + style['textLineSpacing'],\n        basePoint = point.add(0, ptAlign.y),\n        maxHeight = style['textMaxHeight'];\n    var text,\n        rowAlign,\n        height = 0;\n\n    for (var i = 0, len = texts.length; i < len; i++) {\n      text = texts[i]['text'];\n      rowAlign = getAlignPoint(texts[i]['size'], style['textHorizontalAlignment'], style['textVerticalAlignment']);\n\n      Canvas._textOnLine(ctx, text, basePoint.add(rowAlign.x, i * lineHeight), style['textHaloRadius'], style['textHaloFill'], style['textHaloOpacity']);\n\n      if (maxHeight > 0) {\n        height += lineHeight;\n\n        if (height + textSize['height'] >= maxHeight) {\n          break;\n        }\n      }\n    }\n  },\n  _textOnLine: function _textOnLine(ctx, text, pt, textHaloRadius, textHaloFill, textHaloAlpha) {\n    if (hitTesting) {\n      textHaloAlpha = 1;\n    }\n\n    var drawHalo = textHaloAlpha !== 0 && textHaloRadius !== 0;\n    ctx.textBaseline = 'top';\n    var gco, fill;\n    var shadowBlur = ctx.shadowBlur,\n        shadowOffsetX = ctx.shadowOffsetX,\n        shadowOffsetY = ctx.shadowOffsetY;\n\n    if (drawHalo) {\n      var alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= textHaloAlpha;\n      ctx.miterLimit = 2;\n      ctx.lineJoin = 'round';\n      ctx.lineCap = 'round';\n      ctx.lineWidth = textHaloRadius * 2;\n      ctx.strokeStyle = textHaloFill;\n      ctx.strokeText(text, Math.round(pt.x), Math.round(pt.y + textOffsetY));\n      ctx.miterLimit = 10;\n      ctx.globalAlpha = alpha;\n      gco = ctx.globalCompositeOperation;\n      ctx.globalCompositeOperation = 'destination-out';\n      fill = ctx.fillStyle;\n      ctx.fillStyle = '#000';\n    }\n\n    if (shadowBlur && drawHalo) {\n      ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n    }\n\n    Canvas.fillText(ctx, text, pt);\n\n    if (gco) {\n      ctx.globalCompositeOperation = gco;\n      Canvas.fillText(ctx, text, pt, fill);\n\n      if (shadowBlur) {\n        ctx.shadowBlur = shadowBlur;\n        ctx.shadowOffsetX = shadowOffsetX;\n        ctx.shadowOffsetY = shadowOffsetY;\n      }\n    }\n  },\n  fillText: function fillText(ctx, text, pt, rgba) {\n    ctx.canvas._drawn = true;\n\n    if (rgba) {\n      ctx.fillStyle = rgba;\n    }\n\n    ctx.fillText(text, Math.round(pt.x), Math.round(pt.y + textOffsetY));\n  },\n  _stroke: function _stroke(ctx, strokeOpacity, x, y) {\n    if (hitTesting) {\n      strokeOpacity = 1;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (strokeOpacity === 0) {\n      return;\n    }\n\n    var offset = ctx.strokeStyle && ctx.strokeStyle['linePatternOffset'];\n    var dx = offset ? offset[0] : 0,\n        dy = offset ? offset[1] : 0;\n    var isPattern = Canvas._isPattern(ctx.strokeStyle) && (!isNil(x) && !isNil(y) || !isNil(dx) && !isNil(dy));\n\n    if (isNil(strokeOpacity)) {\n      strokeOpacity = 1;\n    }\n\n    var alpha;\n\n    if (strokeOpacity < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= strokeOpacity;\n    }\n\n    if (isPattern) {\n      x = x || 0;\n      y = y || 0;\n      ctx.translate(x + dx, y + dy);\n    }\n\n    ctx.stroke();\n\n    if (isPattern) {\n      ctx.translate(-x - dx, -y - dy);\n    }\n\n    if (strokeOpacity < 1) {\n      ctx.globalAlpha = alpha;\n    }\n  },\n  _path: function _path(ctx, points, lineDashArray, lineOpacity, ignoreStrokePattern) {\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    function fillWithPattern(p1, p2) {\n      var degree = computeDegree(p1.x, p1.y, p2.x, p2.y);\n      ctx.save();\n      var cosd = Math.cos(degree);\n\n      if (Math.abs(cosd) < 1E-7) {\n        ctx.translate(p1.x - ctx.lineWidth / 2, p1.y);\n      } else {\n        ctx.translate(p1.x, p1.y - ctx.lineWidth / 2 / cosd);\n      }\n\n      ctx.rotate(degree);\n\n      Canvas._stroke(ctx, lineOpacity);\n\n      ctx.restore();\n    }\n\n    var isDashed = isArrayHasData(lineDashArray);\n    var isPatternLine = ignoreStrokePattern === true ? false : Canvas._isPattern(ctx.strokeStyle);\n    var point, prePoint, nextPoint;\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      point = points[i];\n\n      if (!isDashed || ctx.setLineDash) {\n        ctx.lineTo(point.x, point.y);\n\n        if (isPatternLine && i > 0) {\n          prePoint = points[i - 1];\n          fillWithPattern(prePoint, point);\n          ctx.beginPath();\n          ctx.moveTo(point.x, point.y);\n        }\n      } else if (isDashed) {\n        if (i === len - 1) {\n          break;\n        }\n\n        nextPoint = points[i + 1];\n        drawDashLine(ctx, point, nextPoint, lineDashArray, isPatternLine);\n      }\n    }\n  },\n  path: function path(ctx, points, lineOpacity, fillOpacity, lineDashArray) {\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    Canvas._path(ctx, points, lineDashArray, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _multiClip: function _multiClip(ctx, points) {\n    if (!points || points.length === 0) return;\n    points = points[0];\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      var point = points[i];\n      var x = point.x,\n          y = point.y;\n\n      if (i === 0) {\n        ctx.moveTo(x, y);\n      } else {\n        ctx.lineTo(x, y);\n      }\n\n      if (i === len - 1) {\n        x = points[0].x;\n        y = points[0].y;\n        ctx.lineTo(x, y);\n      }\n    }\n  },\n  polygon: function polygon(ctx, points, lineOpacity, fillOpacity, lineDashArray, smoothness) {\n    if (ctx.isMultiClip) {\n      Canvas._multiClip(ctx, points);\n\n      return;\n    }\n\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    var isPatternLine = Canvas._isPattern(ctx.strokeStyle),\n        fillFirst = isArrayHasData(lineDashArray) && !ctx.setLineDash || isPatternLine && !smoothness;\n\n    if (!isArrayHasData(points[0])) {\n      points = [points];\n    }\n\n    var savedCtx = ctx;\n\n    if (points.length > 1 && !IS_NODE) {\n      if (!TEMP_CANVAS) {\n        TEMP_CANVAS = Canvas.createCanvas(1, 1);\n      }\n\n      ctx.canvas._drawn = false;\n      TEMP_CANVAS.width = ctx.canvas.width;\n      TEMP_CANVAS.height = ctx.canvas.height;\n      ctx = TEMP_CANVAS.getContext('2d');\n      copyProperties(ctx, savedCtx);\n    }\n\n    var op, i, len;\n\n    if (fillFirst) {\n      ctx.save();\n\n      for (i = 0, len = points.length; i < len; i++) {\n        if (!isArrayHasData(points[i])) {\n          continue;\n        }\n\n        Canvas._ring(ctx, points[i], null, 0, true);\n\n        op = fillOpacity;\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'destination-out';\n          op = 1;\n        }\n\n        Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'source-over';\n        } else if (len > 1) {\n          ctx.fillStyle = '#fff';\n        }\n\n        Canvas._stroke(ctx, 0);\n      }\n\n      ctx.restore();\n    }\n\n    for (i = 0, len = points.length; i < len; i++) {\n      if (!isArrayHasData(points[i])) {\n        continue;\n      }\n\n      if (smoothness) {\n        Canvas.paintSmoothLine(ctx, points[i], lineOpacity, smoothness, true);\n        ctx.closePath();\n      } else {\n        Canvas._ring(ctx, points[i], lineDashArray, lineOpacity);\n      }\n\n      if (!fillFirst) {\n        op = fillOpacity;\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'destination-out';\n          op = 1;\n        }\n\n        Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'source-over';\n        } else if (len > 1) {\n          ctx.fillStyle = '#fff';\n        }\n      }\n\n      Canvas._stroke(ctx, lineOpacity);\n    }\n\n    if (points.length > 1 && !IS_NODE) {\n      savedCtx.drawImage(TEMP_CANVAS, 0, 0);\n      savedCtx.canvas._drawn = ctx.canvas._drawn;\n      copyProperties(savedCtx, ctx);\n    }\n  },\n  _ring: function _ring(ctx, ring, lineDashArray, lineOpacity, ignorePattern) {\n    var isPattern = Canvas._isPattern(ctx.strokeStyle);\n\n    if (!ignorePattern && isPattern && !ring[0].equals(ring[ring.length - 1])) {\n      ring = ring.concat([ring[0]]);\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(ring[0].x, ring[0].y);\n\n    Canvas._path(ctx, ring, lineDashArray, lineOpacity, ignorePattern);\n\n    if (!isPattern) {\n      ctx.closePath();\n    }\n  },\n  paintSmoothLine: function paintSmoothLine(ctx, points, lineOpacity, smoothValue, close, tailIdx, tailRatio) {\n    if (!points) {\n      return;\n    }\n\n    if (points.length <= 2 || !smoothValue) {\n      Canvas.path(ctx, points, lineOpacity);\n      return;\n    }\n\n    function interpolate$$1(t0, t1, x1, y1, bx1, by1, bx2, by2, x2, y2) {\n      var u0 = 1.0 - t0;\n      var u1 = 1.0 - t1;\n      var qxa = x1 * u0 * u0 + bx1 * 2 * t0 * u0 + bx2 * t0 * t0;\n      var qxb = x1 * u1 * u1 + bx1 * 2 * t1 * u1 + bx2 * t1 * t1;\n      var qxc = bx1 * u0 * u0 + bx2 * 2 * t0 * u0 + x2 * t0 * t0;\n      var qxd = bx1 * u1 * u1 + bx2 * 2 * t1 * u1 + x2 * t1 * t1;\n      var qya = y1 * u0 * u0 + by1 * 2 * t0 * u0 + by2 * t0 * t0;\n      var qyb = y1 * u1 * u1 + by1 * 2 * t1 * u1 + by2 * t1 * t1;\n      var qyc = by1 * u0 * u0 + by2 * 2 * t0 * u0 + y2 * t0 * t0;\n      var qyd = by1 * u1 * u1 + by2 * 2 * t1 * u1 + y2 * t1 * t1;\n      var xb = qxa * u1 + qxc * t1;\n      var xc = qxb * u0 + qxd * t0;\n      var xd = qxb * u1 + qxd * t1;\n      var yb = qya * u1 + qyc * t1;\n      var yc = qyb * u0 + qyd * t0;\n      var yd = qyb * u1 + qyd * t1;\n      return [xb, yb, xc, yc, xd, yd];\n    }\n\n    function getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, t) {\n      var xc1 = (x0 + x1) / 2.0,\n          yc1 = (y0 + y1) / 2.0;\n      var xc2 = (x1 + x2) / 2.0,\n          yc2 = (y1 + y2) / 2.0;\n      var xc3 = (x2 + x3) / 2.0,\n          yc3 = (y2 + y3) / 2.0;\n      var len1 = Math.sqrt((x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0));\n      var len2 = Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n      var len3 = Math.sqrt((x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2));\n      var k1 = len1 / (len1 + len2);\n      var k2 = len2 / (len2 + len3);\n      var xm1 = xc1 + (xc2 - xc1) * k1,\n          ym1 = yc1 + (yc2 - yc1) * k1;\n      var xm2 = xc2 + (xc3 - xc2) * k2,\n          ym2 = yc2 + (yc3 - yc2) * k2;\n      var ctrl1X = xm1 + (xc2 - xm1) * smoothValue + x1 - xm1,\n          ctrl1Y = ym1 + (yc2 - ym1) * smoothValue + y1 - ym1,\n          ctrl2X = xm2 + (xc2 - xm2) * smoothValue + x2 - xm2,\n          ctrl2Y = ym2 + (yc2 - ym2) * smoothValue + y2 - ym2;\n      var ctrlPoints = [ctrl1X, ctrl1Y, ctrl2X, ctrl2Y];\n\n      if (t < 1) {\n        return interpolate$$1(0, t, x1, y1, ctrl1X, ctrl1Y, ctrl2X, ctrl2Y, x2, y2);\n      } else {\n        return ctrlPoints;\n      }\n    }\n\n    var count = points.length;\n    var l = close ? count : count - 1;\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n    if (tailRatio !== undefined) l -= Math.max(l - tailIdx - 1, 0);\n    var preCtrlPoints;\n\n    for (var i = 0; i < l; i++) {\n      var x1 = points[i].x,\n          y1 = points[i].y;\n      var x0 = void 0,\n          y0 = void 0,\n          x2 = void 0,\n          y2 = void 0,\n          x3 = void 0,\n          y3 = void 0;\n\n      if (i - 1 < 0) {\n        if (!close) {\n          x0 = points[i + 1].x;\n          y0 = points[i + 1].y;\n        } else {\n          x0 = points[l - 1].x;\n          y0 = points[l - 1].y;\n        }\n      } else {\n        x0 = points[i - 1].x;\n        y0 = points[i - 1].y;\n      }\n\n      if (i + 1 < count) {\n        x2 = points[i + 1].x;\n        y2 = points[i + 1].y;\n      } else {\n        x2 = points[i + 1 - count].x;\n        y2 = points[i + 1 - count].y;\n      }\n\n      if (i + 2 < count) {\n        x3 = points[i + 2].x;\n        y3 = points[i + 2].y;\n      } else if (!close) {\n        x3 = points[i].x;\n        y3 = points[i].y;\n      } else {\n        x3 = points[i + 2 - count].x;\n        y3 = points[i + 2 - count].y;\n      }\n\n      var ctrlPoints = getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, i === l - 1 ? tailRatio : 1);\n\n      if (i === l - 1 && tailRatio >= 0 && tailRatio < 1) {\n        ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], ctrlPoints[4], ctrlPoints[5]);\n        points.splice(l - 1, count - (l - 1) - 1);\n        var lastPoint = new Point(ctrlPoints[4], ctrlPoints[5]);\n        lastPoint.prevCtrlPoint = new Point(ctrlPoints[2], ctrlPoints[3]);\n        points.push(lastPoint);\n        count = points.length;\n      } else {\n        ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], x2, y2);\n      }\n\n      points[i].nextCtrlPoint = ctrlPoints.slice(0, 2);\n      points[i].prevCtrlPoint = preCtrlPoints ? preCtrlPoints.slice(2) : null;\n      preCtrlPoints = ctrlPoints;\n    }\n\n    if (!close && points[1].prevCtrlPoint) {\n      points[0].nextCtrlPoint = points[1].prevCtrlPoint;\n      delete points[0].prevCtrlPoint;\n    }\n\n    if (!points[count - 1].prevCtrlPoint) {\n      points[count - 1].prevCtrlPoint = points[count - 2].nextCtrlPoint;\n    }\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _arcBetween: function _arcBetween(ctx, p1, p2, degree) {\n    var a = degree,\n        dist = p1.distanceTo(p2),\n        r = dist / 2 / Math.sin(a / 2);\n    var p1p2 = Math.asin((p2.y - p1.y) / dist);\n\n    if (p1.x > p2.x) {\n      p1p2 = Math.PI - p1p2;\n    }\n\n    var cp2 = 90 * RADIAN - a / 2,\n        da = p1p2 - cp2;\n    var dx = Math.cos(da) * r,\n        dy = Math.sin(da) * r,\n        cx = p1.x + dx,\n        cy = p1.y + dy;\n    var startAngle = Math.asin((p2.y - cy) / r);\n\n    if (cx > p2.x) {\n      startAngle = Math.PI - startAngle;\n    }\n\n    var endAngle = startAngle + a;\n    ctx.beginPath();\n    ctx.arc(cx, cy, r, startAngle, endAngle);\n    return [cx, cy];\n  },\n  _lineTo: function _lineTo(ctx, p) {\n    ctx.lineTo(p.x, p.y);\n  },\n  bezierCurveAndFill: function bezierCurveAndFill(ctx, points, lineOpacity, fillOpacity) {\n    ctx.beginPath();\n    var start = points[0];\n    ctx.moveTo(start.x, start.y);\n    var args = [ctx];\n    args.push.apply(args, points.splice(1));\n\n    Canvas._bezierCurveTo.apply(Canvas, args);\n\n    Canvas.fillCanvas(ctx, fillOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _bezierCurveTo: function _bezierCurveTo(ctx, p1, p2, p3) {\n    ctx.bezierCurveTo(p1.x, p1.y, p2.x, p2.y, p3.x, p3.y);\n  },\n  ellipse: function ellipse(ctx, pt, width, heightTop, heightBottom, lineOpacity, fillOpacity) {\n    function bezierEllipse(x, y, a, b, b1) {\n      var k = 0.5522848,\n          ox = a * k,\n          oy = b * k,\n          oy1 = b1 * k;\n      ctx.moveTo(x - a, y);\n      ctx.bezierCurveTo(x - a, y - oy, x - ox, y - b, x, y - b);\n      ctx.bezierCurveTo(x + ox, y - b, x + a, y - oy, x + a, y);\n      ctx.bezierCurveTo(x + a, y + oy1, x + ox, y + b1, x, y + b1);\n      ctx.bezierCurveTo(x - ox, y + b1, x - a, y + oy1, x - a, y);\n      ctx.closePath();\n    }\n\n    ctx.beginPath();\n\n    if (width === heightTop && width === heightBottom) {\n      ctx.arc(pt.x, pt.y, width, 0, 2 * Math.PI);\n    } else if (ctx.ellipse) {\n      if (heightTop !== heightBottom) {\n        ctx.ellipse(pt.x, pt.y, width, heightTop, 0, RADIAN * 180, RADIAN * 360, false);\n        ctx.ellipse(pt.x, pt.y, width, heightBottom, 0, 0, RADIAN * 180, false);\n      } else {\n        ctx.ellipse(pt.x, pt.y, width, heightTop, 0, 0, RADIAN * 360, false);\n      }\n    } else {\n      bezierEllipse(pt.x, pt.y, width, heightTop, heightBottom);\n    }\n\n    Canvas.fillCanvas(ctx, fillOpacity, pt.x - width, pt.y - heightTop);\n\n    Canvas._stroke(ctx, lineOpacity, pt.x - width, pt.y - heightTop);\n  },\n  rectangle: function rectangle(ctx, pt, size, lineOpacity, fillOpacity) {\n    var x = pt.x,\n        y = pt.y;\n    ctx.beginPath();\n    ctx.rect(x, y, size['width'], size['height']);\n    Canvas.fillCanvas(ctx, fillOpacity, x, y);\n\n    Canvas._stroke(ctx, lineOpacity, x, y);\n  },\n  sector: function sector(ctx, pt, size, angles, lineOpacity, fillOpacity) {\n    var rad = RADIAN;\n    var startAngle = angles[0],\n        endAngle = angles[1];\n\n    function sector(ctx, x, y, radius, startAngle, endAngle) {\n      var sDeg = rad * -endAngle;\n      var eDeg = rad * -startAngle;\n      ctx.beginPath();\n      ctx.moveTo(x, y);\n      ctx.arc(x, y, radius, sDeg, eDeg);\n      ctx.lineTo(x, y);\n      Canvas.fillCanvas(ctx, fillOpacity, x - radius, y - radius);\n\n      Canvas._stroke(ctx, lineOpacity, x - radius, y - radius);\n    }\n\n    sector(ctx, pt.x, pt.y, size, startAngle, endAngle);\n  },\n  _isPattern: function _isPattern(style) {\n    return !isString(style) && !('addColorStop' in style);\n  },\n  drawCross: function drawCross(ctx, x, y, lineWidth, color) {\n    ctx.canvas._drawn = true;\n    ctx.strokeStyle = color;\n    ctx.lineWidth = lineWidth;\n    ctx.beginPath();\n    ctx.moveTo(x - 5, y);\n    ctx.lineTo(x + 5, y);\n    ctx.moveTo(x, y - 5);\n    ctx.lineTo(x, y + 5);\n    ctx.stroke();\n  },\n  copy: function copy(canvas, c) {\n    var target = c || createEl('canvas');\n    target.width = canvas.width;\n    target.height = canvas.height;\n    target.getContext('2d').drawImage(canvas, 0, 0);\n    return target;\n  }\n};\n\nfunction drawDashLine(ctx, startPoint, endPoint, dashArray) {\n  var fromX = startPoint.x,\n      fromY = startPoint.y,\n      toX = endPoint.x,\n      toY = endPoint.y;\n  var pattern = dashArray;\n\n  var lt = function lt(a, b) {\n    return a <= b;\n  };\n\n  var gt = function gt(a, b) {\n    return a >= b;\n  };\n\n  var capmin = function capmin(a, b) {\n    return Math.min(a, b);\n  };\n\n  var capmax = function capmax(a, b) {\n    return Math.max(a, b);\n  };\n\n  var checkX = {\n    thereYet: gt,\n    cap: capmin\n  };\n  var checkY = {\n    thereYet: gt,\n    cap: capmin\n  };\n\n  if (fromY - toY > 0) {\n    checkY.thereYet = lt;\n    checkY.cap = capmax;\n  }\n\n  if (fromX - toX > 0) {\n    checkX.thereYet = lt;\n    checkX.cap = capmax;\n  }\n\n  ctx.moveTo(fromX, fromY);\n  var offsetX = fromX;\n  var offsetY = fromY;\n  var idx = 0,\n      dash = true;\n  var ang, len;\n\n  while (!(checkX.thereYet(offsetX, toX) && checkY.thereYet(offsetY, toY))) {\n    ang = Math.atan2(toY - fromY, toX - fromX);\n    len = pattern[idx];\n    offsetX = checkX.cap(toX, offsetX + Math.cos(ang) * len);\n    offsetY = checkY.cap(toY, offsetY + Math.sin(ang) * len);\n\n    if (dash) {\n      ctx.lineTo(offsetX, offsetY);\n    } else {\n      ctx.moveTo(offsetX, offsetY);\n    }\n\n    idx = (idx + 1) % pattern.length;\n    dash = !dash;\n  }\n}\n\nvar prefix = 'data:image/';\n\nfunction extractImageUrl(url) {\n  if (url.substring(0, prefix.length) === prefix) {\n    return url;\n  }\n\n  return extractCssUrl(url);\n}\n\nfunction copyProperties(ctx, savedCtx) {\n  ctx.filter = savedCtx.filter;\n  ctx.fillStyle = savedCtx.fillStyle;\n  ctx.globalAlpha = savedCtx.globalAlpha;\n  ctx.lineCap = savedCtx.lineCap;\n  ctx.lineDashOffset = savedCtx.lineDashOffset;\n  ctx.lineJoin = savedCtx.lineJoin;\n  ctx.lineWidth = savedCtx.lineWidth;\n  ctx.shadowBlur = savedCtx.shadowBlur;\n  ctx.shadowColor = savedCtx.shadowColor;\n  ctx.shadowOffsetX = savedCtx.shadowOffsetX;\n  ctx.shadowOffsetY = savedCtx.shadowOffsetY;\n  ctx.strokeStyle = savedCtx.strokeStyle;\n}\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\n\nvar zousanMin = createCommonjsModule(function (module) {\n  !function (t) {\n    function e(t) {\n      if (t) {\n        var e = this;\n        t(function (t) {\n          e.resolve(t);\n        }, function (t) {\n          e.reject(t);\n        });\n      }\n    }\n\n    function n(t, e) {\n      if (\"function\" == typeof t.y) try {\n        var n = t.y.call(i, e);\n        t.p.resolve(n);\n      } catch (o) {\n        t.p.reject(o);\n      } else t.p.resolve(e);\n    }\n\n    function o(t, e) {\n      if (\"function\" == typeof t.n) try {\n        var n = t.n.call(i, e);\n        t.p.resolve(n);\n      } catch (o) {\n        t.p.reject(o);\n      } else t.p.reject(e);\n    }\n\n    var r,\n        i,\n        c = \"fulfilled\",\n        u = \"rejected\",\n        s = \"undefined\",\n        f = function () {\n      function e() {\n        for (; n.length - o;) {\n          try {\n            n[o]();\n          } catch (e) {\n            t.console && t.console.error(e);\n          }\n\n          n[o++] = i, o == r && (n.splice(0, r), o = 0);\n        }\n      }\n\n      var n = [],\n          o = 0,\n          r = 1024,\n          c = function () {\n        if ((typeof MutationObserver === \"undefined\" ? \"undefined\" : _typeof(MutationObserver)) !== s) {\n          var t = document.createElement(\"div\"),\n              n = new MutationObserver(e);\n          return n.observe(t, {\n            attributes: !0\n          }), function () {\n            t.setAttribute(\"a\", 0);\n          };\n        }\n\n        return (typeof setImmediate === \"undefined\" ? \"undefined\" : _typeof(setImmediate)) !== s ? function () {\n          setImmediate(e);\n        } : function () {\n          setTimeout(e, 0);\n        };\n      }();\n\n      return function (t) {\n        n.push(t), n.length - o == 1 && c();\n      };\n    }();\n\n    e.prototype = {\n      resolve: function resolve(t) {\n        if (this.state === r) {\n          if (t === this) return this.reject(new TypeError(\"Attempt to resolve promise with self\"));\n          var e = this;\n          if (t && (\"function\" == typeof t || \"object\" == _typeof(t))) try {\n            var o = !0,\n                i = t.then;\n            if (\"function\" == typeof i) return void i.call(t, function (t) {\n              o && (o = !1, e.resolve(t));\n            }, function (t) {\n              o && (o = !1, e.reject(t));\n            });\n          } catch (u) {\n            return void (o && this.reject(u));\n          }\n          this.state = c, this.v = t, e.c && f(function () {\n            for (var o = 0, r = e.c.length; r > o; o++) {\n              n(e.c[o], t);\n            }\n          });\n        }\n      },\n      reject: function reject(n) {\n        if (this.state === r) {\n          this.state = u, this.v = n;\n          var i = this.c;\n          i ? f(function () {\n            for (var t = 0, e = i.length; e > t; t++) {\n              o(i[t], n);\n            }\n          }) : !e.suppressUncaughtRejectionError && t.console && t.console.log(\"You upset Zousan. Please catch rejections: \", n, n ? n.stack : null);\n        }\n      },\n      then: function then(t, i) {\n        var u = new e(),\n            s = {\n          y: t,\n          n: i,\n          p: u\n        };\n        if (this.state === r) this.c ? this.c.push(s) : this.c = [s];else {\n          var l = this.state,\n              a = this.v;\n          f(function () {\n            l === c ? n(s, a) : o(s, a);\n          });\n        }\n        return u;\n      },\n      \"catch\": function _catch(t) {\n        return this.then(null, t);\n      },\n      \"finally\": function _finally(t) {\n        return this.then(t, t);\n      },\n      timeout: function timeout(t, n) {\n        n = n || \"Timeout\";\n        var o = this;\n        return new e(function (e, r) {\n          setTimeout(function () {\n            r(Error(n));\n          }, t), o.then(function (t) {\n            e(t);\n          }, function (t) {\n            r(t);\n          });\n        });\n      }\n    }, e.resolve = function (t) {\n      var n = new e();\n      return n.resolve(t), n;\n    }, e.reject = function (t) {\n      var n = new e();\n      return n.reject(t), n;\n    }, e.all = function (t) {\n      function n(n, c) {\n        n && \"function\" == typeof n.then || (n = e.resolve(n)), n.then(function (e) {\n          o[c] = e, r++, r == t.length && i.resolve(o);\n        }, function (t) {\n          i.reject(t);\n        });\n      }\n\n      for (var o = [], r = 0, i = new e(), c = 0; c < t.length; c++) {\n        n(t[c], c);\n      }\n\n      return t.length || i.resolve(o), i;\n    }, module.exports && (module.exports = e), t.define && t.define.amd && t.define([], function () {\n      return e;\n    }), t.Zousan = e, e.soon = f;\n  }(\"undefined\" != typeof commonjsGlobal ? commonjsGlobal : commonjsGlobal);\n});\nvar promise;\n\nif (typeof Promise !== 'undefined') {\n  promise = Promise;\n} else {\n  promise = zousanMin;\n}\n\nvar Promise$1 = promise;\n\nvar Eventable = function Eventable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.on = function on$$1(eventsOn, handler, context) {\n      if (!eventsOn) {\n        return this;\n      }\n\n      if (!isString(eventsOn)) {\n        return this._switch('on', eventsOn, handler);\n      }\n\n      if (!handler) {\n        return this;\n      }\n\n      if (!this._eventMap) {\n        this._eventMap = {};\n      }\n\n      var eventTypes = eventsOn.toLowerCase().split(' ');\n      var evtType;\n\n      if (!context) {\n        context = this;\n      }\n\n      var handlerChain;\n\n      for (var ii = 0, ll = eventTypes.length; ii < ll; ii++) {\n        evtType = eventTypes[ii];\n        handlerChain = this._eventMap[evtType];\n\n        if (!handlerChain) {\n          handlerChain = [];\n          this._eventMap[evtType] = handlerChain;\n        }\n\n        var l = handlerChain.length;\n\n        if (l > 0) {\n          for (var i = 0; i < l; i++) {\n            if (handler === handlerChain[i].handler && handlerChain[i].context === context) {\n              return this;\n            }\n          }\n        }\n\n        handlerChain.push({\n          handler: handler,\n          context: context\n        });\n      }\n\n      return this;\n    };\n\n    _proto.addEventListener = function addEventListener() {\n      return this.on.apply(this, arguments);\n    };\n\n    _proto.once = function once(eventTypes, handler, context) {\n      if (!isString(eventTypes)) {\n        var once = {};\n\n        for (var p in eventTypes) {\n          if (eventTypes.hasOwnProperty(p)) {\n            once[p] = this._wrapOnceHandler(p, eventTypes[p], context);\n          }\n        }\n\n        return this._switch('on', once);\n      }\n\n      var evetTypes = eventTypes.split(' ');\n\n      for (var i = 0, l = evetTypes.length; i < l; i++) {\n        this.on(evetTypes[i], this._wrapOnceHandler(evetTypes[i], handler, context));\n      }\n\n      return this;\n    };\n\n    _proto.off = function off$$1(eventsOff, handler, context) {\n      if (!this._eventMap || !eventsOff) {\n        return this;\n      }\n\n      if (!isString(eventsOff)) {\n        return this._switch('off', eventsOff, handler);\n      }\n\n      if (!handler) {\n        return this;\n      }\n\n      var eventTypes = eventsOff.split(' ');\n      var eventType, listeners, wrapKey;\n\n      if (!context) {\n        context = this;\n      }\n\n      for (var j = 0, jl = eventTypes.length; j < jl; j++) {\n        eventType = eventTypes[j].toLowerCase();\n        wrapKey = 'Z__' + eventType;\n        listeners = this._eventMap[eventType];\n\n        if (!listeners) {\n          return this;\n        }\n\n        for (var i = listeners.length - 1; i >= 0; i--) {\n          var listener = listeners[i];\n\n          if ((handler === listener.handler || handler === listener.handler[wrapKey]) && listener.context === context) {\n            delete listener.handler[wrapKey];\n            listeners.splice(i, 1);\n          }\n        }\n\n        if (!listeners.length) {\n          delete this._eventMap[eventType];\n        }\n      }\n\n      return this;\n    };\n\n    _proto.removeEventListener = function removeEventListener() {\n      return this.off.apply(this, arguments);\n    };\n\n    _proto.listens = function listens(eventType, handler, context) {\n      if (!this._eventMap || !isString(eventType)) {\n        return 0;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain || !handlerChain.length) {\n        return 0;\n      }\n\n      if (!handler) {\n        return handlerChain.length;\n      }\n\n      for (var i = 0, len = handlerChain.length; i < len; i++) {\n        if (handler === handlerChain[i].handler && (isNil(context) || handlerChain[i].context === context)) {\n          return 1;\n        }\n      }\n\n      return 0;\n    };\n\n    _proto.getListeningEvents = function getListeningEvents() {\n      if (!this._eventMap) {\n        return [];\n      }\n\n      return Object.keys(this._eventMap);\n    };\n\n    _proto.copyEventListeners = function copyEventListeners(target) {\n      var eventMap = target._eventMap;\n\n      if (!eventMap) {\n        return this;\n      }\n\n      var handlerChain;\n\n      for (var eventType in eventMap) {\n        handlerChain = eventMap[eventType];\n\n        for (var i = 0, len = handlerChain.length; i < len; i++) {\n          this.on(eventType, handlerChain[i].handler, handlerChain[i].context);\n        }\n      }\n\n      return this;\n    };\n\n    _proto.fire = function fire() {\n      if (this._eventParent) {\n        return this._eventParent.fire.apply(this._eventParent, arguments);\n      }\n\n      return this._fire.apply(this, arguments);\n    };\n\n    _proto._wrapOnceHandler = function _wrapOnceHandler(evtType, handler, context) {\n      var me = this;\n      var key = 'Z__' + evtType;\n      var called = false;\n\n      var fn = function onceHandler() {\n        if (called) {\n          return;\n        }\n\n        delete fn[key];\n        called = true;\n\n        if (context) {\n          handler.apply(context, arguments);\n        } else {\n          handler.apply(this, arguments);\n        }\n\n        me.off(evtType, onceHandler, this);\n      };\n\n      fn[key] = handler;\n      return fn;\n    };\n\n    _proto._switch = function _switch(to, eventKeys, context) {\n      for (var p in eventKeys) {\n        if (eventKeys.hasOwnProperty(p)) {\n          this[to](p, eventKeys[p], context);\n        }\n      }\n\n      return this;\n    };\n\n    _proto._clearListeners = function _clearListeners(eventType) {\n      if (!this._eventMap || !isString(eventType)) {\n        return;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain) {\n        return;\n      }\n\n      this._eventMap[eventType] = null;\n    };\n\n    _proto._clearAllListeners = function _clearAllListeners() {\n      this._eventMap = null;\n    };\n\n    _proto._setEventParent = function _setEventParent(parent) {\n      this._eventParent = parent;\n      return this;\n    };\n\n    _proto._setEventTarget = function _setEventTarget(target) {\n      this._eventTarget = target;\n      return this;\n    };\n\n    _proto._fire = function _fire(eventType, param) {\n      if (!this._eventMap) {\n        return this;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain) {\n        return this;\n      }\n\n      if (!param) {\n        param = {};\n      }\n\n      param['type'] = eventType;\n      param['target'] = this._eventTarget || this;\n      var queue = handlerChain.slice(0);\n      var context, bubble, passed;\n\n      for (var i = 0, len = queue.length; i < len; i++) {\n        if (!queue[i]) {\n          continue;\n        }\n\n        context = queue[i].context;\n        bubble = true;\n        passed = extend({}, param);\n\n        if (context) {\n          bubble = queue[i].handler.call(context, passed);\n        } else {\n          bubble = queue[i].handler(passed);\n        }\n\n        if (bubble === false) {\n          if (param['domEvent']) {\n            stopPropagation(param['domEvent']);\n          }\n        }\n      }\n\n      return this;\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar Handler = function () {\n  function Handler(target) {\n    this.target = target;\n  }\n\n  var _proto = Handler.prototype;\n\n  _proto.enable = function enable() {\n    if (this._enabled) {\n      return this;\n    }\n\n    this._enabled = true;\n    this.addHooks();\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this._enabled) {\n      return this;\n    }\n\n    this._enabled = false;\n    this.removeHooks();\n    return this;\n  };\n\n  _proto.enabled = function enabled() {\n    return !!this._enabled;\n  };\n\n  _proto.remove = function remove() {\n    this.disable();\n    delete this.target;\n    delete this.dom;\n  };\n\n  return Handler;\n}();\n\nvar Handler$1 = Eventable(Handler);\n\nvar Class = function () {\n  function Class(options) {\n    if (!this || !this.setOptions) {\n      throw new Error('Class instance is being created without \"new\" operator.');\n    }\n\n    this.setOptions(options);\n    this.callInitHooks();\n  }\n\n  var _proto = Class.prototype;\n\n  _proto.callInitHooks = function callInitHooks() {\n    var proto = Object.getPrototypeOf(this);\n\n    this._visitInitHooks(proto);\n\n    return this;\n  };\n\n  _proto.setOptions = function setOptions(options) {\n    if (!this.hasOwnProperty('options')) {\n      this.options = this.options ? Object.create(this.options) : {};\n    }\n\n    if (!options) {\n      return this;\n    }\n\n    for (var i in options) {\n      this.options[i] = options[i];\n    }\n\n    return this;\n  };\n\n  _proto.config = function config(conf) {\n    if (!conf) {\n      var config = {};\n\n      for (var p in this.options) {\n        if (this.options.hasOwnProperty(p)) {\n          config[p] = this.options[p];\n        }\n      }\n\n      return config;\n    } else {\n      if (arguments.length === 2) {\n        var t = {};\n        t[conf] = arguments[1];\n        conf = t;\n      }\n\n      for (var i in conf) {\n        this.options[i] = conf[i];\n\n        if (this[i] && this[i] instanceof Handler$1) {\n          if (conf[i]) {\n            this[i].enable();\n          } else {\n            this[i].disable();\n          }\n        }\n      }\n\n      this.onConfig(conf);\n    }\n\n    return this;\n  };\n\n  _proto.onConfig = function onConfig() {};\n\n  _proto._visitInitHooks = function _visitInitHooks(proto) {\n    if (this._initHooksCalled) {\n      return;\n    }\n\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (parentProto._visitInitHooks) {\n      parentProto._visitInitHooks.call(this, parentProto);\n    }\n\n    this._initHooksCalled = true;\n    var hooks = proto._initHooks;\n\n    if (hooks && hooks !== parentProto._initHooks) {\n      for (var i = 0; i < hooks.length; i++) {\n        hooks[i].call(this);\n      }\n    }\n  };\n\n  Class.addInitHook = function addInitHook(fn) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    var init = typeof fn === 'function' ? fn : function () {\n      this[fn].apply(this, args);\n    };\n    var proto = this.prototype;\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (!proto._initHooks || proto._initHooks === parentProto._initHooks) {\n      proto._initHooks = [];\n    }\n\n    proto._initHooks.push(init);\n\n    return this;\n  };\n\n  Class.include = function include() {\n    for (var i = 0; i < arguments.length; i++) {\n      extend(this.prototype, i < 0 || arguments.length <= i ? undefined : arguments[i]);\n    }\n\n    return this;\n  };\n\n  Class.mergeOptions = function mergeOptions(options) {\n    var proto = this.prototype;\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (!proto.options || proto.options === parentProto.options) {\n      proto.options = proto.options ? Object.create(proto.options) : {};\n    }\n\n    extend(proto.options, options);\n    return this;\n  };\n\n  return Class;\n}();\n\nvar registeredTypes = {};\n\nvar JSONAble = function JSONAble(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class.registerJSONType = function registerJSONType(type) {\n      if (!type) {\n        return this;\n      }\n\n      registeredTypes[type] = this;\n      return this;\n    };\n\n    _class.getJSONClass = function getJSONClass(type) {\n      if (!type) {\n        return null;\n      }\n\n      return registeredTypes[type];\n    };\n\n    var _proto = _class.prototype;\n\n    _proto.getJSONType = function getJSONType() {\n      if (this._jsonType === undefined) {\n        var clazz = Object.getPrototypeOf(this).constructor;\n\n        for (var p in registeredTypes) {\n          if (registeredTypes[p] === clazz) {\n            this._jsonType = p;\n            break;\n          }\n        }\n      }\n\n      if (!this._jsonType) {\n        throw new Error('Found an unregistered geometry class!');\n      }\n\n      return this._jsonType;\n    };\n\n    return _class;\n  }(Base);\n};\n\nfunction Handlerable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.addHandler = function addHandler(name, handlerClass) {\n      if (!handlerClass) {\n        return this;\n      }\n\n      if (!this._handlers) {\n        this._handlers = [];\n      }\n\n      if (this[name]) {\n        this[name].enable();\n        return this;\n      }\n\n      var handler = this[name] = new handlerClass(this);\n\n      this._handlers.push(handler);\n\n      if (this.options[name]) {\n        handler.enable();\n      }\n\n      return this;\n    };\n\n    _proto.removeHandler = function removeHandler(name) {\n      if (!name) {\n        return this;\n      }\n\n      var handler = this[name];\n\n      if (handler) {\n        var hit = this._handlers.indexOf(handler);\n\n        if (hit >= 0) {\n          this._handlers.splice(hit, 1);\n        }\n\n        this[name].remove();\n        delete this[name];\n      }\n\n      return this;\n    };\n\n    _proto._clearHandlers = function _clearHandlers() {\n      for (var i = 0, len = this._handlers.length; i < len; i++) {\n        this._handlers[i].remove();\n      }\n\n      this._handlers = [];\n    };\n\n    return _class;\n  }(Base);\n}\n\nvar START_EVENTS = 'touchstart mousedown';\nvar MOVE_EVENTS = {\n  mousedown: 'mousemove',\n  touchstart: 'touchmove',\n  pointerdown: 'touchmove',\n  MSPointerDown: 'touchmove'\n};\nvar END_EVENTS = {\n  mousedown: 'mouseup',\n  touchstart: 'touchend',\n  pointerdown: 'touchend',\n  MSPointerDown: 'touchend'\n};\n\nvar DragHandler = function (_Handler) {\n  _inheritsLoose(DragHandler, _Handler);\n\n  function DragHandler(dom, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _Handler.call(this, null) || this;\n    _this.dom = dom;\n    _this.options = options;\n    return _this;\n  }\n\n  var _proto = DragHandler.prototype;\n\n  _proto.enable = function enable() {\n    if (!this.dom) {\n      return this;\n    }\n\n    this._onMouseDown = function (e) {\n      return this.onMouseDown(e);\n    };\n\n    on(this.dom, START_EVENTS, this._onMouseDown, this);\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this.dom) {\n      return this;\n    }\n\n    this._offEvents();\n\n    off(this.dom, START_EVENTS, this._onMouseDown);\n    delete this._onMouseDown;\n    return this;\n  };\n\n  _proto.onMouseDown = function onMouseDown(event) {\n    if (!this.options['rightclick'] && event.button === 2) {\n      return;\n    }\n\n    if (event.touches && event.touches.length > 1) {\n      return;\n    }\n\n    if (this.options['cancelOn'] && this.options['cancelOn'](event) === true) {\n      return;\n    }\n\n    var dom = this.dom;\n\n    if (dom.setCapture) {\n      dom.setCapture();\n    } else if (window.captureEvents) {\n      window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n    }\n\n    dom['ondragstart'] = function () {\n      return false;\n    };\n\n    delete this.moved;\n    var actual = event.touches ? event.touches[0] : event;\n    this.startPos = new Point(actual.clientX, actual.clientY);\n    on(document, MOVE_EVENTS[event.type], this.onMouseMove, this);\n    on(document, END_EVENTS[event.type], this.onMouseUp, this);\n\n    if (!this.options['ignoreMouseleave']) {\n      on(this.dom, 'mouseleave', this.onMouseUp, this);\n    }\n\n    this.fire('mousedown', {\n      'domEvent': event,\n      'mousePos': new Point(actual.clientX, actual.clientY)\n    });\n  };\n\n  _proto.onMouseMove = function onMouseMove(event) {\n    if (event.touches && event.touches.length > 1) {\n      if (this.moved) {\n        this.interupted = true;\n        this.onMouseUp(event);\n      }\n\n      return;\n    }\n\n    var actual = event.touches ? event.touches[0] : event;\n    var newPos = new Point(actual.clientX, actual.clientY),\n        offset = newPos.sub(this.startPos);\n\n    if (!offset.x && !offset.y) {\n      return;\n    }\n\n    if (!this.moved) {\n      this.fire('dragstart', {\n        'domEvent': event,\n        'mousePos': this.startPos.copy()\n      });\n      this.moved = true;\n    } else {\n      this.fire('dragging', {\n        'domEvent': event,\n        'mousePos': new Point(actual.clientX, actual.clientY)\n      });\n    }\n  };\n\n  _proto.onMouseUp = function onMouseUp(event) {\n    var actual = event.changedTouches ? event.changedTouches[0] : event;\n\n    this._offEvents();\n\n    var param = {\n      'domEvent': event\n    };\n\n    if (isNumber(actual.clientX)) {\n      param['mousePos'] = new Point(parseInt(actual.clientX, 0), parseInt(actual.clientY, 0));\n    }\n\n    if (this.moved) {\n      param.interupted = this.interupted;\n      this.fire('dragend', param);\n      delete this.interupted;\n      delete this.moved;\n    }\n\n    this.fire('mouseup', param);\n  };\n\n  _proto._offEvents = function _offEvents() {\n    var dom = this.dom;\n    off(dom, 'mouseleave', this.onMouseUp, this);\n\n    if (typeof document === 'undefined' || typeof window === 'undefined') {\n      return;\n    }\n\n    for (var i in MOVE_EVENTS) {\n      off(document, MOVE_EVENTS[i], this.onMouseMove, this);\n      off(document, END_EVENTS[i], this.onMouseUp, this);\n    }\n\n    if (dom['releaseCapture']) {\n      dom['releaseCapture']();\n    } else if (window.captureEvents) {\n      window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n    }\n  };\n\n  return DragHandler;\n}(Handler$1);\n\nvar Coordinate = function (_Position) {\n  _inheritsLoose(Coordinate, _Position);\n\n  function Coordinate() {\n    return _Position.apply(this, arguments) || this;\n  }\n\n  Coordinate.toNumberArrays = function toNumberArrays(coordinates) {\n    if (!Array.isArray(coordinates)) {\n      return [coordinates.x, coordinates.y];\n    }\n\n    return forEachCoord(coordinates, function (coord) {\n      return [coord.x, coord.y];\n    });\n  };\n\n  Coordinate.toCoordinates = function toCoordinates(coordinates) {\n    if (isNumber(coordinates[0]) && isNumber(coordinates[1])) {\n      return new Coordinate(coordinates);\n    }\n\n    var result = [];\n\n    for (var i = 0, len = coordinates.length; i < len; i++) {\n      var child = coordinates[i];\n\n      if (Array.isArray(child)) {\n        if (isNumber(child[0])) {\n          result.push(new Coordinate(child));\n        } else {\n          result.push(Coordinate.toCoordinates(child));\n        }\n      } else {\n        result.push(new Coordinate(child));\n      }\n    }\n\n    return result;\n  };\n\n  return Coordinate;\n}(Position);\n\nvar CRS = function () {\n  function CRS(type, properties) {\n    this.type = type;\n    this.properties = properties;\n  }\n\n  CRS.createProj4 = function createProj4(proj) {\n    return new CRS('proj4', {\n      'proj': proj\n    });\n  };\n\n  CRS.fromProjectionCode = function fromProjectionCode(code) {\n    if (!code) {\n      return null;\n    }\n\n    code = code.toUpperCase().replace(':', '');\n    return CRS[code] || null;\n  };\n\n  return CRS;\n}();\n\nCRS.WGS84 = CRS.createProj4('+proj=longlat +datum=WGS84 +no_defs');\nCRS.EPSG4326 = CRS.WGS84;\nCRS.EPSG3857 = CRS.createProj4('+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs');\nCRS.IDENTITY = CRS.createProj4('+proj=identity +no_defs');\nCRS.CGCS2000 = CRS.createProj4('+proj=longlat +datum=CGCS2000');\nCRS.EPSG4490 = CRS.CGCS2000;\nCRS.BD09LL = CRS.createProj4('+proj=longlat +datum=BD09');\nCRS.GCJ02 = CRS.createProj4('+proj=longlat +datum=GCJ02');\nvar TEMP_POINT0 = new Point(0, 0);\nvar TEMP_COORD0 = new Coordinate(0, 0);\nvar TEMP_COORD1 = new Coordinate(0, 0);\nvar TEMP_COORD2 = new Coordinate(0, 0);\nvar TEMP_COORD3 = new Coordinate(0, 0);\nvar TEMP_COORD4 = new Coordinate(0, 0);\nvar TEMP_COORD5 = new Coordinate(0, 0);\nvar TEMP_COORD6 = new Coordinate(0, 0);\nvar TEMP_COORD7 = new Coordinate(0, 0);\nvar MINMAX = [];\nvar TEMP_EXTENT;\nvar TEMP_COMBINE = [];\n\nvar Extent = function () {\n  function Extent(p1, p2, p3, p4) {\n    this._clazz = Coordinate;\n    var l = arguments.length;\n    var proj = l > 0 ? arguments[l - 1] : null;\n\n    if (proj && proj.unproject) {\n      this.projection = arguments[l - 1];\n    }\n\n    this._dirty = true;\n\n    this._initialize(p1, p2, p3, p4);\n  }\n\n  var _proto = Extent.prototype;\n\n  _proto._initialize = function _initialize(p1, p2, p3, p4) {\n    this.xmin = null;\n    this.xmax = null;\n    this.ymin = null;\n    this.ymax = null;\n\n    if (isNil(p1)) {\n      return;\n    }\n\n    var projection = this.projection;\n\n    if (isNumber(p1) && isNumber(p2) && isNumber(p3) && isNumber(p4)) {\n      if (projection) {\n        this.set(p1, p2, p3, p4);\n      } else {\n        this.set(Math.min(p1, p3), Math.min(p2, p4), Math.max(p1, p3), Math.max(p2, p4));\n      }\n\n      return;\n    } else if (Array.isArray(p1)) {\n      if (projection) {\n        this.set(p1[0], p1[1], p1[2], p1[3]);\n      } else {\n        this.set(Math.min(p1[0], p1[2]), Math.min(p1[1], p1[3]), Math.max(p1[0], p1[2]), Math.max(p1[1], p1[3]));\n      }\n    } else if (isNumber(p1.x) && isNumber(p2.x) && isNumber(p1.y) && isNumber(p2.y)) {\n      if (projection) {\n        this.set(p1.x, p1.y, p2.x, p2.y);\n      } else {\n        if (p1.x > p2.x) {\n          this['xmin'] = p2.x;\n          this['xmax'] = p1.x;\n        } else {\n          this['xmin'] = p1.x;\n          this['xmax'] = p2.x;\n        }\n\n        if (p1.y > p2.y) {\n          this['ymin'] = p2.y;\n          this['ymax'] = p1.y;\n        } else {\n          this['ymin'] = p1.y;\n          this['ymax'] = p2.y;\n        }\n      }\n    } else if (isNumber(p1['xmin']) && isNumber(p1['xmax']) && isNumber(p1['ymin']) && isNumber(p1['ymax'])) {\n      this.set(p1['xmin'], p1['ymin'], p1['xmax'], p1['ymax']);\n    }\n  };\n\n  _proto._add = function _add(p) {\n    this._dirty = true;\n\n    if (!isNil(p.x)) {\n      this['xmin'] += p.x;\n      this['ymin'] += p.y;\n      this['xmax'] += p.x;\n      this['ymax'] += p.y;\n    } else if (!isNil(p.xmin)) {\n      this['xmin'] += p.xmin;\n      this['ymin'] += p.ymin;\n      this['xmax'] += p.xmax;\n      this['ymax'] += p.ymax;\n    } else if (!isNil(p[0])) {\n      this['xmin'] += p[0];\n      this['ymin'] += p[1];\n      this['xmax'] += p[0];\n      this['ymax'] += p[1];\n    }\n\n    return this;\n  };\n\n  _proto.add = function add() {\n    var e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    return e._add.apply(e, arguments);\n  };\n\n  _proto._scale = function _scale(s) {\n    this._dirty = true;\n    this['xmin'] *= s;\n    this['ymin'] *= s;\n    this['xmax'] *= s;\n    this['ymax'] *= s;\n    return this;\n  };\n\n  _proto._sub = function _sub(p) {\n    this._dirty = true;\n\n    if (!isNil(p.x)) {\n      this['xmin'] -= p.x;\n      this['ymin'] -= p.y;\n      this['xmax'] -= p.x;\n      this['ymax'] -= p.y;\n    } else if (!isNil(p.xmin)) {\n      this['xmin'] -= p.xmin;\n      this['ymin'] -= p.ymin;\n      this['xmax'] -= p.xmax;\n      this['ymax'] -= p.ymax;\n    } else if (!isNil(p[0])) {\n      this['xmin'] -= p[0];\n      this['ymin'] -= p[1];\n      this['xmax'] -= p[0];\n      this['ymax'] -= p[1];\n    }\n\n    return this;\n  };\n\n  _proto._substract = function _substract() {\n    return this._sub.apply(this, arguments);\n  };\n\n  _proto.sub = function sub() {\n    var e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    return e._sub.apply(e, arguments);\n  };\n\n  _proto.substract = function substract() {\n    return this.sub.apply(this, arguments);\n  };\n\n  _proto.round = function round() {\n    return new this.constructor(Math.round(this['xmin']), Math.round(this['ymin']), Math.round(this['xmax']), Math.round(this['ymax']), this.projection);\n  };\n\n  _proto._round = function _round() {\n    this._dirty = true;\n    this['xmin'] = Math.round(this['xmin']);\n    this['ymin'] = Math.round(this['ymin']);\n    this['xmax'] = Math.round(this['xmax']);\n    this['ymax'] = Math.round(this['ymax']);\n    return this;\n  };\n\n  _proto.getMin = function getMin(out) {\n    if (out) {\n      out.set(this['xmin'], this['ymin']);\n      return out;\n    }\n\n    return new this._clazz(this['xmin'], this['ymin']);\n  };\n\n  _proto.getMax = function getMax(out) {\n    if (out) {\n      out.set(this['xmax'], this['ymax']);\n      return out;\n    }\n\n    return new this._clazz(this['xmax'], this['ymax']);\n  };\n\n  _proto.getCenter = function getCenter(out) {\n    var x = (this['xmin'] + this['xmax']) / 2;\n    var y = (this['ymin'] + this['ymax']) / 2;\n\n    if (out) {\n      out.set(x, y);\n      return out;\n    }\n\n    return new this._clazz(x, y);\n  };\n\n  _proto.isValid = function isValid() {\n    return !isNil(this['xmin']) && !isNil(this['ymin']) && !isNil(this['xmax']) && !isNil(this['ymax']);\n  };\n\n  _proto.equals = function equals(ext2) {\n    return this['xmin'] === ext2['xmin'] && this['xmax'] === ext2['xmax'] && this['ymin'] === ext2['ymin'] && this['ymax'] === ext2['ymax'];\n  };\n\n  _proto.intersects = function intersects(ext2) {\n    this._project(this);\n\n    this._project(ext2);\n\n    var rxmin = Math.max(this['pxmin'], ext2['pxmin']);\n    var rymin = Math.max(this['pymin'], ext2['pymin']);\n    var rxmax = Math.min(this['pxmax'], ext2['pxmax']);\n    var rymax = Math.min(this['pymax'], ext2['pymax']);\n    var intersects = !(rxmin > rxmax || rymin > rymax);\n    return intersects;\n  };\n\n  _proto.within = function within(extent) {\n    this._project(this);\n\n    this._project(extent);\n\n    return this.pxmin >= extent.pxmin && this.pxmax <= extent.pxmax && this.pymin >= extent.pymin && this.pymax <= extent.pymax;\n  };\n\n  _proto.contains = function contains(c) {\n    if (!c) {\n      return false;\n    }\n\n    this._project(this);\n\n    var proj = this.projection;\n\n    if (proj) {\n      if (c.x !== undefined) {\n        var coord = TEMP_COORD0;\n\n        if (Array.isArray(c)) {\n          coord.x = c[0];\n          coord.y = c[1];\n        } else {\n          coord.x = c.x;\n          coord.y = c.y;\n        }\n\n        c = proj.project(coord, coord);\n      } else if (c.xmin !== undefined) {\n        this._project(c);\n      }\n    }\n\n    return (c.x || c.pxmin || 0) >= this.pxmin && (c.x || c.pxmax || 0) <= this.pxmax && (c.y || c.pymin || 0) >= this.pymin && (c.y || c.pymax || 0) <= this.pymax;\n  };\n\n  _proto.getWidth = function getWidth() {\n    return Math.abs(this['xmax'] - this['xmin']);\n  };\n\n  _proto.getHeight = function getHeight() {\n    return Math.abs(this['ymax'] - this['ymin']);\n  };\n\n  _proto.getSize = function getSize() {\n    return new Size(this.getWidth(), this.getHeight());\n  };\n\n  _proto.set = function set(xmin, ymin, xmax, ymax) {\n    this.xmin = xmin;\n    this.ymin = ymin;\n    this.xmax = xmax;\n    this.ymax = ymax;\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.__combine = function __combine(extent) {\n    if (extent.x !== undefined) {\n      TEMP_EXTENT.xmin = TEMP_EXTENT.xmax = extent.x;\n      TEMP_EXTENT.ymin = TEMP_EXTENT.ymax = extent.y;\n      extent = TEMP_EXTENT;\n    }\n\n    this._project(extent);\n\n    this._project(this);\n\n    var inited = isNumber(this.pxmin);\n    var xmin, ymin, xmax, ymax;\n\n    if (!inited) {\n      xmin = extent['pxmin'];\n      ymin = extent['pymin'];\n      xmax = extent['pxmax'];\n      ymax = extent['pymax'];\n    } else {\n      xmin = Math.min(this['pxmin'], extent['pxmin']);\n      ymin = Math.min(this['pymin'], extent['pymin']);\n      xmax = Math.max(this['pxmax'], extent['pxmax']);\n      ymax = Math.max(this['pymax'], extent['pymax']);\n    }\n\n    var proj = this.projection;\n\n    if (proj) {\n      TEMP_COORD1.set(xmin, ymin);\n      TEMP_COORD2.set(xmax, ymax);\n      var min = proj.unproject(TEMP_COORD1, TEMP_COORD1),\n          max = proj.unproject(TEMP_COORD2, TEMP_COORD2);\n      xmin = min.x;\n      ymin = min.y;\n      xmax = max.x;\n      ymax = max.y;\n    }\n\n    TEMP_COMBINE[0] = xmin;\n    TEMP_COMBINE[1] = ymin;\n    TEMP_COMBINE[2] = xmax;\n    TEMP_COMBINE[3] = ymax;\n    return TEMP_COMBINE;\n  };\n\n  _proto._combine = function _combine(extent) {\n    if (!extent || extent.isValid && !extent.isValid()) {\n      return this;\n    }\n\n    var ext = this.__combine(extent);\n\n    this.set(ext[0], ext[1], ext[2], ext[3]);\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.combine = function combine(extent) {\n    if (!extent || extent.isValid && !extent.isValid()) {\n      return this;\n    }\n\n    var ext = this.__combine(extent);\n\n    return new this.constructor(ext[0], ext[1], ext[2], ext[3], this.projection);\n  };\n\n  _proto.intersection = function intersection(extent) {\n    if (!this.intersects(extent)) {\n      return null;\n    }\n\n    TEMP_COORD3.x = Math.max(this['pxmin'], extent['pxmin']);\n    TEMP_COORD3.y = Math.max(this['pymin'], extent['pymin']);\n    TEMP_COORD4.x = Math.min(this['pxmax'], extent['pxmax']);\n    TEMP_COORD4.y = Math.min(this['pymax'], extent['pymax']);\n    var min = TEMP_COORD3,\n        max = TEMP_COORD4;\n    var proj = this.projection;\n\n    if (proj) {\n      min = proj.unproject(min, min);\n      max = proj.unproject(max, max);\n    }\n\n    return new this.constructor(min, max, proj);\n  };\n\n  _proto.expand = function expand(distance) {\n    var w, h;\n\n    if (!isNumber(distance)) {\n      w = distance['width'] || distance['x'] || distance[0] || 0;\n      h = distance['height'] || distance['y'] || distance[1] || 0;\n    } else {\n      w = h = distance;\n    }\n\n    return new this.constructor(this['xmin'] - w, this['ymin'] - h, this['xmax'] + w, this['ymax'] + h, this.projection);\n  };\n\n  _proto._expand = function _expand(distance) {\n    var w, h;\n\n    if (!isNumber(distance)) {\n      w = distance['width'] || distance['x'] || distance[0] || 0;\n      h = distance['height'] || distance['y'] || distance[1] || 0;\n    } else {\n      w = h = distance;\n    }\n\n    this['xmin'] -= w;\n    this['ymin'] -= h;\n    this['xmax'] += w;\n    this['ymax'] += h;\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'xmin': this['xmin'],\n      'ymin': this['ymin'],\n      'xmax': this['xmax'],\n      'ymax': this['ymax']\n    };\n  };\n\n  _proto.toArray = function toArray() {\n    var xmin = this['xmin'],\n        ymin = this['ymin'],\n        xmax = this['xmax'],\n        ymax = this['ymax'];\n    return [new this._clazz([xmin, ymax]), new this._clazz([xmax, ymax]), new this._clazz([xmax, ymin]), new this._clazz([xmin, ymin]), new this._clazz([xmin, ymax])];\n  };\n\n  _proto.toString = function toString() {\n    return this.xmin + \",\" + this.ymin + \",\" + this.xmax + \",\" + this.ymax;\n  };\n\n  _proto.copy = function copy() {\n    return new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n  };\n\n  _proto.convertTo = function convertTo(fn, out) {\n    if (!this.isValid()) {\n      return null;\n    }\n\n    var e = out || new this.constructor();\n\n    if (out) {\n      e.set(null, null, null, null);\n    }\n\n    var coord;\n\n    if (this._clazz === Coordinate) {\n      coord = TEMP_COORD5;\n    } else if (this._clazz === Point) {\n      coord = TEMP_POINT0;\n    }\n\n    coord.x = this.xmin;\n    coord.y = this.ymax;\n\n    e._combine(fn(coord));\n\n    coord.x = this.xmax;\n\n    e._combine(fn(coord));\n\n    coord.y = this.ymin;\n\n    e._combine(fn(coord));\n\n    coord.x = this.xmin;\n\n    e._combine(fn(coord));\n\n    return e;\n  };\n\n  _proto._project = function _project(ext) {\n    if (!ext || !ext.isValid()) {\n      if (ext) {\n        ext.pxmin = ext.pxmax = ext.pymin = ext.pymax = null;\n      }\n\n      return;\n    }\n\n    var proj = this.projection;\n\n    if (proj) {\n      if (ext._dirty) {\n        TEMP_COORD6.set(ext.xmax, ext.ymin);\n        TEMP_COORD7.set(ext.xmin, ext.ymax);\n        MINMAX[0] = TEMP_COORD6;\n        MINMAX[1] = TEMP_COORD7;\n        var minmax = proj.projectCoords(MINMAX);\n        var min = minmax[0],\n            max = minmax[1];\n        ext.pxmin = Math.min(min.x, max.x);\n        ext.pymin = Math.min(min.y, max.y);\n        ext.pxmax = Math.max(min.x, max.x);\n        ext.pymax = Math.max(min.y, max.y);\n      }\n\n      delete ext._dirty;\n    } else {\n      ext.pxmin = ext.xmin;\n      ext.pxmax = ext.xmax;\n      ext.pymin = ext.ymin;\n      ext.pymax = ext.ymax;\n    }\n  };\n\n  return Extent;\n}();\n\nTEMP_EXTENT = new Extent(0, 0, 0, 0);\n\nvar PointExtent = function (_Extent) {\n  _inheritsLoose(PointExtent, _Extent);\n\n  function PointExtent(p1, p2, p3, p4) {\n    var _this;\n\n    _this = _Extent.call(this, p1, p2, p3, p4) || this;\n    _this._clazz = Point;\n    return _this;\n  }\n\n  return PointExtent;\n}(Extent);\n\nvar Transformation = function () {\n  function Transformation(matrix) {\n    this.matrix = matrix;\n  }\n\n  var _proto = Transformation.prototype;\n\n  _proto.transform = function transform(coordinates, scale, out) {\n    var x = this.matrix[0] * (coordinates.x - this.matrix[2]) / scale;\n    var y = -this.matrix[1] * (coordinates.y - this.matrix[3]) / scale;\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Point(x, y);\n  };\n\n  _proto.untransform = function untransform(point, scale, out) {\n    var x = point.x * scale / this.matrix[0] + this.matrix[2];\n    var y = point.y * scale / -this.matrix[1] + this.matrix[3];\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Coordinate(x, y);\n  };\n\n  return Transformation;\n}();\n\nvar Common = {\n  project: function project() {},\n  unproject: function unproject() {},\n  projectCoords: function projectCoords(coordinates) {\n    var _this = this;\n\n    if (!coordinates) {\n      return [];\n    }\n\n    if (!Array.isArray(coordinates)) {\n      return this.project(coordinates);\n    }\n\n    if (coordinates.length === 0) {\n      return [];\n    }\n\n    if (!this.isSphere()) {\n      return forEachCoord(coordinates, this.project, this);\n    }\n\n    if (Array.isArray(coordinates[0])) {\n      return coordinates.map(function (coords) {\n        return _this.projectCoords(coords);\n      });\n    } else {\n      var circum = this.getCircum();\n      var extent = this.getSphereExtent(),\n          sx = extent.sx,\n          sy = extent.sy;\n      var wrapX, wrapY;\n      var pre = coordinates[0],\n          current,\n          dx,\n          dy,\n          p;\n      var prj = [this.project(pre)];\n\n      for (var i = 1, l = coordinates.length; i < l; i++) {\n        current = coordinates[i];\n        dx = current.x - pre.x;\n        dy = current.y - pre.y;\n        p = this.project(current);\n\n        if (Math.abs(dx) > 180) {\n          if (wrapX === undefined) {\n            wrapX = current.x > pre.x;\n          }\n\n          if (wrapX) {\n            p._add(-circum.x * sign(dx) * sx, 0);\n\n            current._add(-360 * sign(dx), 0);\n          }\n        }\n\n        if (Math.abs(dy) > 90) {\n          if (wrapY === undefined) {\n            wrapY = current.y < pre.y;\n          }\n\n          if (wrapY) {\n            p._add(0, -circum.y * sign(dy) * sy);\n\n            current._add(0, -180 * sign(dy));\n          }\n        }\n\n        pre = current;\n        prj.push(p);\n      }\n\n      return prj;\n    }\n  },\n  unprojectCoords: function unprojectCoords(projCoords) {\n    if (!projCoords) {\n      return [];\n    }\n\n    if (!Array.isArray(projCoords)) {\n      return this.unproject(projCoords);\n    }\n\n    return forEachCoord(projCoords, this.unproject, this);\n  },\n  isSphere: function isSphere() {\n    return !!this.sphere;\n  },\n  isOutSphere: function isOutSphere(pcoord) {\n    if (!this.isSphere()) {\n      return false;\n    }\n\n    var extent = this.getSphereExtent();\n    return !extent.contains(pcoord);\n  },\n  wrapCoord: function wrapCoord(pcoord) {\n    if (!this.isSphere()) {\n      return pcoord;\n    }\n\n    var extent = this.getSphereExtent();\n    var wrapped = new Coordinate(pcoord);\n\n    if (!extent.contains(wrapped)) {\n      wrapped.x = wrap(pcoord.x, extent.xmin, extent.xmax);\n      wrapped.y = wrap(pcoord.y, extent.ymin, extent.ymax);\n    }\n\n    return wrapped;\n  },\n  getCircum: function getCircum() {\n    if (!this.circum && this.isSphere()) {\n      var extent = this.getSphereExtent();\n      this.circum = {\n        x: extent.getWidth(),\n        y: extent.getHeight()\n      };\n    }\n\n    return this.circum;\n  },\n  getSphereExtent: function getSphereExtent() {\n    if (!this.extent && this.isSphere()) {\n      var max = this.project(new Coordinate(180, 90)),\n          min = this.project(new Coordinate(-180, -90));\n      this.extent = new Extent(min, max, this);\n      this.extent.sx = max.x > min.x ? 1 : -1;\n      this.extent.sy = max.y > min.y ? 1 : -1;\n    }\n\n    return this.extent;\n  }\n};\nvar Common$1 = {\n  measureLength: function measureLength(c1, c2) {\n    if (!Array.isArray(c1)) {\n      return this.measureLenBetween(c1, c2);\n    }\n\n    var len = 0;\n\n    for (var i = 0, l = c1.length; i < l - 1; i++) {\n      len += this.measureLenBetween(c1[i], c1[i + 1]);\n    }\n\n    return len;\n  }\n};\nvar Identity = extend({\n  'measure': 'IDENTITY',\n  measureLenBetween: function measureLenBetween(c1, c2) {\n    if (!c1 || !c2) {\n      return 0;\n    }\n\n    try {\n      return Math.sqrt(Math.pow(c1.x - c2.x, 2) + Math.pow(c1.y - c2.y, 2));\n    } catch (err) {\n      return 0;\n    }\n  },\n  measureArea: function measureArea(coordinates) {\n    if (!Array.isArray(coordinates)) {\n      return 0;\n    }\n\n    var area = 0;\n\n    for (var i = 0, len = coordinates.length; i < len; i++) {\n      var c1 = coordinates[i];\n      var c2 = null;\n\n      if (i === len - 1) {\n        c2 = coordinates[0];\n      } else {\n        c2 = coordinates[i + 1];\n      }\n\n      area += c1.x * c2.y - c1.y * c2.x;\n    }\n\n    return Math.abs(area / 2);\n  },\n  locate: function locate(c, xDist, yDist) {\n    c = new Coordinate(c.x, c.y);\n    return this._locate(c, xDist, yDist);\n  },\n  _locate: function _locate(c, xDist, yDist) {\n    if (!c) {\n      return null;\n    }\n\n    if (!xDist) {\n      xDist = 0;\n    }\n\n    if (!yDist) {\n      yDist = 0;\n    }\n\n    if (!xDist && !yDist) {\n      return c;\n    }\n\n    c.x = c.x + xDist;\n    c.y = c.y + yDist;\n    return c;\n  },\n  rotate: function rotate(c, pivot, angle) {\n    c = new Coordinate(c.x, c.y);\n    return this._rotate(c, pivot, angle);\n  },\n  _rotate: function () {\n    var tmp = new Point(0, 0);\n    return function (c, pivot, angle) {\n      tmp.x = c.x - pivot.x;\n      tmp.y = c.y - pivot.y;\n\n      tmp._rotate(angle * Math.PI / 180);\n\n      c.x = pivot.x + tmp.x;\n      c.y = pivot.y + tmp.y;\n      return c;\n    };\n  }()\n}, Common$1);\n\nvar Sphere = function () {\n  function Sphere(radius) {\n    this.radius = radius;\n  }\n\n  var _proto = Sphere.prototype;\n\n  _proto.measureLenBetween = function measureLenBetween(c1, c2) {\n    if (!c1 || !c2) {\n      return 0;\n    }\n\n    var b = toRadian(c1.y);\n    var d = toRadian(c2.y),\n        e = b - d,\n        f = toRadian(c1.x) - toRadian(c2.x);\n    b = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(e / 2), 2) + Math.cos(b) * Math.cos(d) * Math.pow(Math.sin(f / 2), 2)));\n    b *= this.radius;\n    return Math.round(b * 1E5) / 1E5;\n  };\n\n  _proto.measureArea = function measureArea(coordinates) {\n    var a = toRadian(this.radius);\n    var b = 0,\n        c = coordinates,\n        d = c.length;\n\n    if (d < 3) {\n      return 0;\n    }\n\n    var i;\n\n    for (i = 0; i < d - 1; i++) {\n      var e = c[i],\n          f = c[i + 1];\n      b += e.x * a * Math.cos(toRadian(e.y)) * f.y * a - f.x * a * Math.cos(toRadian(f.y)) * e.y * a;\n    }\n\n    d = c[i];\n    c = c[0];\n    b += d.x * a * Math.cos(toRadian(d.y)) * c.y * a - c.x * a * Math.cos(toRadian(c.y)) * d.y * a;\n    return 0.5 * Math.abs(b);\n  };\n\n  _proto.locate = function locate(c, xDist, yDist) {\n    c = new Coordinate(c.x, c.y);\n    return this._locate(c, xDist, yDist);\n  };\n\n  _proto._locate = function _locate(c, xDist, yDist) {\n    if (!c) {\n      return null;\n    }\n\n    if (!xDist) {\n      xDist = 0;\n    }\n\n    if (!yDist) {\n      yDist = 0;\n    }\n\n    if (!xDist && !yDist) {\n      return c;\n    }\n\n    var x, y;\n    var ry = toRadian(c.y);\n\n    if (yDist !== 0) {\n      var dy = Math.abs(yDist);\n      var sy = Math.sin(dy / (2 * this.radius)) * 2;\n      ry = ry + sy * (yDist > 0 ? 1 : -1);\n      y = wrap(ry * 180 / Math.PI, -90, 90);\n    } else {\n      y = c.y;\n    }\n\n    if (xDist !== 0) {\n      var dx = Math.abs(xDist);\n      var rx = toRadian(c.x);\n      var sx = 2 * Math.sqrt(Math.pow(Math.sin(dx / (2 * this.radius)), 2) / Math.pow(Math.cos(ry), 2));\n      rx = rx + sx * (xDist > 0 ? 1 : -1);\n      x = wrap(rx * 180 / Math.PI, -180, 180);\n    } else {\n      x = c.x;\n    }\n\n    c.x = x;\n    c.y = y;\n    return c;\n  };\n\n  _proto.rotate = function rotate(c, pivot, angle) {\n    c = new Coordinate(c);\n    return this._rotate(c, pivot, angle);\n  };\n\n  _proto._rotate = function _rotate(c, pivot, angle) {\n    var initialAngle = rhumbBearing(pivot, c);\n    var finalAngle = initialAngle - angle;\n    var distance = this.measureLenBetween(pivot, c);\n    c.x = pivot.x;\n    c.y = pivot.y;\n    return calculateRhumbDestination(c, distance, finalAngle, this.radius);\n  };\n\n  return Sphere;\n}();\n\nfunction rhumbBearing(start, end, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var bear360;\n  if (options.final) bear360 = calculateRhumbBearing(end, start);else bear360 = calculateRhumbBearing(start, end);\n  var bear180 = bear360 > 180 ? -(360 - bear360) : bear360;\n  return bear180;\n}\n\nfunction calculateRhumbBearing(from, to) {\n  var phi1 = toRadian(from.y);\n  var phi2 = toRadian(to.y);\n  var deltaLambda = toRadian(to.x - from.x);\n  if (deltaLambda > Math.PI) deltaLambda -= 2 * Math.PI;\n  if (deltaLambda < -Math.PI) deltaLambda += 2 * Math.PI;\n  var deltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n  var theta = Math.atan2(deltaLambda, deltaPsi);\n  return (toDegree(theta) + 360) % 360;\n}\n\nfunction calculateRhumbDestination(origin, distance, bearing, radius) {\n  var delta = distance / radius;\n  var lambda1 = origin.x * Math.PI / 180;\n  var phi1 = toRadian(origin.y);\n  var theta = toRadian(bearing);\n  var DeltaPhi = delta * Math.cos(theta);\n  var phi2 = phi1 + DeltaPhi;\n  if (Math.abs(phi2) > Math.PI / 2) phi2 = phi2 > 0 ? Math.PI - phi2 : -Math.PI - phi2;\n  var DeltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n  var q = Math.abs(DeltaPsi) > 10e-12 ? DeltaPhi / DeltaPsi : Math.cos(phi1);\n  var DeltaLambda = delta * Math.sin(theta) / q;\n  var lambda2 = lambda1 + DeltaLambda;\n  origin.x = (lambda2 * 180 / Math.PI + 540) % 360 - 180;\n  origin.y = phi2 * 180 / Math.PI;\n  return origin;\n}\n\nvar WGS84Sphere = extend({\n  'measure': 'EPSG:4326',\n  sphere: new Sphere(6378137),\n  measureLenBetween: function measureLenBetween() {\n    return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n  },\n  measureArea: function measureArea() {\n    return this.sphere.measureArea.apply(this.sphere, arguments);\n  },\n  _locate: function _locate() {\n    return this.sphere._locate.apply(this.sphere, arguments);\n  },\n  locate: function locate() {\n    return this.sphere.locate.apply(this.sphere, arguments);\n  },\n  _rotate: function _rotate() {\n    return this.sphere._rotate.apply(this.sphere, arguments);\n  },\n  rotate: function rotate() {\n    return this.sphere.rotate.apply(this.sphere, arguments);\n  }\n}, Common$1);\nvar BaiduSphere = extend({\n  'measure': 'BAIDU',\n  sphere: new Sphere(6370996.81),\n  measureLenBetween: function measureLenBetween() {\n    return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n  },\n  measureArea: function measureArea() {\n    return this.sphere.measureArea.apply(this.sphere, arguments);\n  },\n  _locate: function _locate() {\n    return this.sphere._locate.apply(this.sphere, arguments);\n  },\n  locate: function locate() {\n    return this.sphere.locate.apply(this.sphere, arguments);\n  },\n  _rotate: function _rotate() {\n    return this.sphere._rotate.apply(this.sphere, arguments);\n  },\n  rotate: function rotate() {\n    return this.sphere.rotate.apply(this.sphere, arguments);\n  }\n}, Common$1);\nvar DEFAULT = WGS84Sphere;\nvar measurers = {};\n\nfunction registerMeasurer(m) {\n  measurers[m.measure] = m;\n}\n\nregisterMeasurer(Identity);\nregisterMeasurer(WGS84Sphere);\nregisterMeasurer(BaiduSphere);\nvar Measurer = {\n  getInstance: function getInstance(name) {\n    if (!name) {\n      return DEFAULT;\n    }\n\n    for (var p in measurers) {\n      if (hasOwn(measurers, p)) {\n        var mName = measurers[p]['measure'];\n\n        if (!mName) {\n          continue;\n        }\n\n        if (name.toLowerCase() === mName.toLowerCase()) {\n          return measurers[p];\n        }\n      }\n    }\n\n    return null;\n  }\n};\nvar index$2 =\n/*#__PURE__*/\nObject.freeze({\n  Identity: Identity,\n  DEFAULT: DEFAULT,\n  Measurer: Measurer,\n  WGS84Sphere: WGS84Sphere,\n  BaiduSphere: BaiduSphere\n});\nvar delta = 1E-7;\nvar EPSG3857 = extend({}, Common, {\n  code: 'EPSG:3857',\n  rad: Math.PI / 180,\n  metersPerDegree: 6378137 * Math.PI / 180,\n  maxLatitude: 85.0511287798,\n  project: function project(lnglat, out) {\n    var rad = this.rad,\n        metersPerDegree = this.metersPerDegree,\n        max = this.maxLatitude;\n    var lng = lnglat.x,\n        lat = Math.max(Math.min(max, lnglat.y), -max);\n    var c;\n\n    if (lat === 0) {\n      c = 0;\n    } else {\n      c = Math.log(Math.tan((90 + lat) * rad / 2)) / rad;\n    }\n\n    var x = lng * metersPerDegree;\n    var y = c * metersPerDegree;\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Coordinate(x, y);\n  },\n  unproject: function unproject(pLnglat, out) {\n    var rad = this.rad;\n    var metersPerDegree = this.metersPerDegree;\n    var x = pLnglat.x / metersPerDegree;\n    var y = pLnglat.y;\n    var c;\n\n    if (y === 0) {\n      c = 0;\n    } else {\n      c = y / metersPerDegree;\n      c = (2 * Math.atan(Math.exp(c * rad)) - Math.PI / 2) / rad;\n    }\n\n    if (Math.abs(Math.abs(x) - 180) < delta) {\n      x = sign(x) * 180;\n    }\n\n    if (Math.abs(Math.abs(c) - this.maxLatitude) < delta) {\n      c = sign(c) * this.maxLatitude;\n    }\n\n    var rx = wrap(x, -180, 180);\n    var ry = wrap(c, -this.maxLatitude, this.maxLatitude);\n\n    if (out) {\n      out.x = rx;\n      out.y = ry;\n      return out;\n    }\n\n    return new Coordinate(rx, ry);\n  }\n}, WGS84Sphere);\nvar PROJ4326 = extend({}, Common, {\n  code: 'EPSG:4326',\n  project: function project(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return new Coordinate(p);\n  },\n  unproject: function unproject(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return new Coordinate(p);\n  }\n}, WGS84Sphere);\nvar Projection_EPSG4490 = extend({}, PROJ4326, {\n  code: 'EPSG:4490'\n});\nvar Projection_Baidu = extend({}, Common, {\n  code: 'BAIDU',\n  project: function project(p, out) {\n    return this.convertLL2MC(p, out);\n  },\n  unproject: function unproject(p, out) {\n    return this.convertMC2LL(p, out);\n  }\n}, BaiduSphere, {\n  EARTHRADIUS: 6370996.81,\n  MCBAND: [12890594.86, 8362377.87, 5591021, 3481989.83, 1678043.12, 0],\n  LLBAND: [75, 60, 45, 30, 15, 0],\n  MC2LL: [[1.410526172116255e-8, 0.00000898305509648872, -1.9939833816331, 200.9824383106796, -187.2403703815547, 91.6087516669843, -23.38765649603339, 2.57121317296198, -0.03801003308653, 17337981.2], [-7.435856389565537e-9, 0.000008983055097726239, -0.78625201886289, 96.32687599759846, -1.85204757529826, -59.36935905485877, 47.40033549296737, -16.50741931063887, 2.28786674699375, 10260144.86], [-3.030883460898826e-8, 0.00000898305509983578, 0.30071316287616, 59.74293618442277, 7.357984074871, -25.38371002664745, 13.45380521110908, -3.29883767235584, 0.32710905363475, 6856817.37], [-1.981981304930552e-8, 0.000008983055099779535, 0.03278182852591, 40.31678527705744, 0.65659298677277, -4.44255534477492, 0.85341911805263, 0.12923347998204, -0.04625736007561, 4482777.06], [3.09191371068437e-9, 0.000008983055096812155, 0.00006995724062, 23.10934304144901, -0.00023663490511, -0.6321817810242, -0.00663494467273, 0.03430082397953, -0.00466043876332, 2555164.4], [2.890871144776878e-9, 0.000008983055095805407, -3.068298e-8, 7.47137025468032, -0.00000353937994, -0.02145144861037, -0.00001234426596, 0.00010322952773, -0.00000323890364, 826088.5]],\n  LL2MC: [[-0.0015702102444, 111320.7020616939, 1704480524535203, -10338987376042340, 26112667856603880, -35149669176653700, 26595700718403920, -10725012454188240, 1800819912950474, 82.5], [0.0008277824516172526, 111320.7020463578, 647795574.6671607, -4082003173.641316, 10774905663.51142, -15171875531.51559, 12053065338.62167, -5124939663.577472, 913311935.9512032, 67.5], [0.00337398766765, 111320.7020202162, 4481351.045890365, -23393751.19931662, 79682215.47186455, -115964993.2797253, 97236711.15602145, -43661946.33752821, 8477230.501135234, 52.5], [0.00220636496208, 111320.7020209128, 51751.86112841131, 3796837.749470245, 992013.7397791013, -1221952.21711287, 1340652.697009075, -620943.6990984312, 144416.9293806241, 37.5], [-0.0003441963504368392, 111320.7020576856, 278.2353980772752, 2485758.690035394, 6070.750963243378, 54821.18345352118, 9540.606633304236, -2710.55326746645, 1405.483844121726, 22.5], [-0.0003218135878613132, 111320.7020701615, 0.00369383431289, 823725.6402795718, 0.46104986909093, 2351.343141331292, 1.58060784298199, 8.77738589078284, 0.37238884252424, 7.45]],\n  convertMC2LL: function convertMC2LL(cB, out) {\n    var cE;\n\n    for (var cD = 0, len = this.MCBAND.length; cD < len; cD++) {\n      if (Math.abs(cB.y) >= this.MCBAND[cD]) {\n        cE = this.MC2LL[cD];\n        break;\n      }\n    }\n\n    var T = this.convertor(cB, cE, out);\n    return T;\n  },\n  convertLL2MC: function convertLL2MC(T, out) {\n    var cD, cC, len;\n    T.x = this.getLoop(T.x, -180, 180);\n    T.y = this.getRange(T.y, -74, 74);\n    var cB = new Coordinate(T.x, T.y);\n\n    for (cC = 0, len = this.LLBAND.length; cC < len; cC++) {\n      if (cB.y >= this.LLBAND[cC]) {\n        cD = this.LL2MC[cC];\n        break;\n      }\n    }\n\n    if (!cD) {\n      for (cC = this.LLBAND.length - 1; cC >= 0; cC--) {\n        if (cB.y <= -this.LLBAND[cC]) {\n          cD = this.LL2MC[cC];\n          break;\n        }\n      }\n    }\n\n    var cE = this.convertor(T, cD, out);\n    return cE;\n  },\n  convertor: function convertor(cC, cD, out) {\n    if (!cC || !cD) {\n      return null;\n    }\n\n    var T = cD[0] + cD[1] * Math.abs(cC.x);\n    var cB = Math.abs(cC.y) / cD[9];\n    var cE = cD[2] + cD[3] * cB + cD[4] * cB * cB + cD[5] * cB * cB * cB + cD[6] * cB * cB * cB * cB + cD[7] * cB * cB * cB * cB * cB + cD[8] * cB * cB * cB * cB * cB * cB;\n    T *= cC.x < 0 ? -1 : 1;\n    cE *= cC.y < 0 ? -1 : 1;\n\n    if (out) {\n      out.x = T;\n      out.y = cE;\n      return out;\n    }\n\n    return new Coordinate(T, cE);\n  },\n  toRadians: function toRadians(T) {\n    return Math.PI * T / 180;\n  },\n  toDegrees: function toDegrees(T) {\n    return 180 * T / Math.PI;\n  },\n  getRange: function getRange(cC, cB, T) {\n    if (cB != null) {\n      cC = Math.max(cC, cB);\n    }\n\n    if (T != null) {\n      cC = Math.min(cC, T);\n    }\n\n    return cC;\n  },\n  getLoop: function getLoop(cC, cB, T) {\n    if (cC === Infinity) {\n      return T;\n    } else if (cC === -Infinity) {\n      return cB;\n    }\n\n    while (cC > T) {\n      cC -= T - cB;\n    }\n\n    while (cC < cB) {\n      cC += T - cB;\n    }\n\n    return cC;\n  }\n});\nvar Projection_IDENTITY = extend({}, Common, {\n  code: 'IDENTITY',\n  project: function project(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return p.copy();\n  },\n  unproject: function unproject(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return p.copy();\n  }\n}, Identity);\nvar DEFAULT$1 = EPSG3857;\nvar projections =\n/*#__PURE__*/\nObject.freeze({\n  EPSG3857: EPSG3857,\n  DEFAULT: DEFAULT$1,\n  EPSG4326: PROJ4326,\n  EPSG4490: Projection_EPSG4490,\n  BAIDU: Projection_Baidu,\n  IDENTITY: Projection_IDENTITY,\n  Common: Common\n});\n\nvar Renderable = function Renderable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class.registerRenderer = function registerRenderer(name, clazz) {\n      var proto = this.prototype;\n      var parentProto = Object.getPrototypeOf(proto);\n\n      if (!proto._rendererClasses || proto._rendererClasses === parentProto._rendererClasses) {\n        proto._rendererClasses = proto._rendererClasses ? Object.create(proto._rendererClasses) : {};\n      }\n\n      proto._rendererClasses[name.toLowerCase()] = clazz;\n      return this;\n    };\n\n    _class.getRendererClass = function getRendererClass(name) {\n      var proto = this.prototype;\n\n      if (!proto._rendererClasses) {\n        return null;\n      }\n\n      return proto._rendererClasses[name.toLowerCase()];\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar CanvasRenderer = function (_Class) {\n  _inheritsLoose(CanvasRenderer, _Class);\n\n  function CanvasRenderer(layer) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.layer = layer;\n    _this._painted = false;\n    _this._drawTime = 0;\n\n    _this.setToRedraw();\n\n    return _this;\n  }\n\n  var _proto = CanvasRenderer.prototype;\n\n  _proto.render = function render(framestamp) {\n    this.prepareRender();\n\n    if (!this.getMap() || !this.layer.isVisible()) {\n      return;\n    }\n\n    if (!this.resources) {\n      this.resources = new ResourceCache();\n    }\n\n    this.checkAndDraw(this._tryToDraw, framestamp);\n  };\n\n  _proto.checkAndDraw = function checkAndDraw(drawFn) {\n    var _this2 = this;\n\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (this.checkResources) {\n      var resources = this.checkResources();\n\n      if (resources.length > 0) {\n        this._loadingResource = true;\n        this.loadResources(resources).then(function () {\n          _this2._loadingResource = false;\n\n          if (_this2.layer) {\n            _this2.layer.fire('resourceload');\n\n            _this2.setToRedraw();\n          }\n        });\n      } else {\n        drawFn.call.apply(drawFn, [this].concat(args));\n      }\n    } else {\n      drawFn.call.apply(drawFn, [this].concat(args));\n    }\n  };\n\n  _proto.testIfNeedRedraw = function testIfNeedRedraw() {\n    var map = this.getMap();\n\n    if (this._loadingResource) {\n      return false;\n    }\n\n    if (this._toRedraw) {\n      return true;\n    }\n\n    if (map.isInteracting() && !this.drawOnInteracting) {\n      return false;\n    }\n\n    if (this.needToRedraw()) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isInteracting() || map.getRenderer().isViewChanged()) {\n      return !(!map.getPitch() && map.isMoving() && !map.isZooming() && !map.isRotating() && !this.layer.options['forceRenderOnMoving']);\n    }\n\n    return false;\n  };\n\n  _proto.onSkipDrawOnInteracting = function onSkipDrawOnInteracting() {};\n\n  _proto.isLoadingResource = function isLoadingResource() {\n    return this._loadingResource;\n  };\n\n  _proto.isRenderComplete = function isRenderComplete() {\n    return !!this._renderComplete;\n  };\n\n  _proto.mustRenderOnInteracting = function mustRenderOnInteracting() {\n    return !this._painted;\n  };\n\n  _proto.setToRedraw = function setToRedraw() {\n    this._toRedraw = true;\n    return this;\n  };\n\n  _proto.setCanvasUpdated = function setCanvasUpdated() {\n    this._canvasUpdated = true;\n    return this;\n  };\n\n  _proto.isCanvasUpdated = function isCanvasUpdated() {\n    return !!this._canvasUpdated;\n  };\n\n  _proto.remove = function remove() {\n    this.onRemove();\n    delete this._loadingResource;\n    delete this.southWest;\n    delete this.canvas;\n    delete this.context;\n    delete this.canvasExtent2D;\n    delete this._extent2D;\n    delete this.resources;\n    delete this.layer;\n  };\n\n  _proto.onRemove = function onRemove() {};\n\n  _proto.onAdd = function onAdd() {};\n\n  _proto.getMap = function getMap() {\n    if (!this.layer) {\n      return null;\n    }\n\n    return this.layer.getMap();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    var map = this.getMap();\n    this._canvasUpdated = false;\n\n    if (this._renderZoom !== map.getZoom() || !this.canvas || !this._extent2D) {\n      return null;\n    }\n\n    if (this.isBlank()) {\n      return null;\n    }\n\n    if (this.layer.isEmpty && this.layer.isEmpty()) {\n      return null;\n    }\n\n    var containerPoint = map._pointToContainerPoint(this.southWest)._add(0, -map.height);\n\n    return {\n      'image': this.canvas,\n      'layer': this.layer,\n      'point': containerPoint\n    };\n  };\n\n  _proto.clear = function clear() {\n    this.clearCanvas();\n  };\n\n  _proto.isBlank = function isBlank() {\n    if (!this._painted) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.show = function show() {\n    this.setToRedraw();\n  };\n\n  _proto.hide = function hide() {\n    this.clear();\n    this.setToRedraw();\n  };\n\n  _proto.setZIndex = function setZIndex() {\n    this.setToRedraw();\n  };\n\n  _proto.hitDetect = function hitDetect(point) {\n    if (!this.context || this.layer.isEmpty && this.layer.isEmpty() || this.isBlank() || this._errorThrown) {\n      return false;\n    }\n\n    var map = this.getMap();\n    var r = map.getDevicePixelRatio();\n    var size = map.getSize();\n\n    if (point.x < 0 || point.x > size['width'] * r || point.y < 0 || point.y > size['height'] * r) {\n      return false;\n    }\n\n    try {\n      var imgData = this.context.getImageData(r * point.x, r * point.y, 1, 1).data;\n\n      if (imgData[3] > 0) {\n        return true;\n      }\n    } catch (error) {\n      if (!this._errorThrown) {\n        if (console) {\n          console.warn('hit detect failed with tainted canvas, some geometries have external resources in another domain:\\n', error);\n        }\n\n        this._errorThrown = true;\n      }\n\n      return false;\n    }\n\n    return false;\n  };\n\n  _proto.loadResources = function loadResources(resourceUrls) {\n    if (!this.resources) {\n      this.resources = new ResourceCache();\n    }\n\n    var resources = this.resources,\n        promises = [];\n\n    if (isArrayHasData(resourceUrls)) {\n      var cache = {};\n\n      for (var i = resourceUrls.length - 1; i >= 0; i--) {\n        var url = resourceUrls[i];\n\n        if (!url || !url.length || cache[url.join('-')]) {\n          continue;\n        }\n\n        cache[url.join('-')] = 1;\n\n        if (!resources.isResourceLoaded(url, true)) {\n          promises.push(new Promise$1(this._promiseResource(url)));\n        }\n      }\n    }\n\n    return Promise$1.all(promises);\n  };\n\n  _proto.prepareRender = function prepareRender() {\n    delete this._renderComplete;\n    var map = this.getMap();\n    this._renderZoom = map.getZoom();\n    this.canvasExtent2D = this._extent2D = map._get2DExtent();\n    this.southWest = map._containerPointToPoint(new Point(0, map.height));\n  };\n\n  _proto.createCanvas = function createCanvas() {\n    if (this.canvas) {\n      return;\n    }\n\n    var map = this.getMap();\n    var size = map.getSize();\n    var r = map.getDevicePixelRatio(),\n        w = r * size.width,\n        h = r * size.height;\n\n    if (this.layer._canvas) {\n      var canvas = this.layer._canvas;\n      canvas.width = w;\n      canvas.height = h;\n\n      if (canvas.style) {\n        canvas.style.width = size.width + 'px';\n        canvas.style.height = size.height + 'px';\n      }\n\n      this.canvas = this.layer._canvas;\n    } else {\n      this.canvas = Canvas.createCanvas(w, h, map.CanvasClass);\n    }\n\n    this.onCanvasCreate();\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {};\n\n  _proto.createContext = function createContext() {\n    if (this.gl && this.gl.canvas === this.canvas || this.context) {\n      return;\n    }\n\n    this.context = this.canvas.getContext('2d');\n\n    if (!this.context) {\n      return;\n    }\n\n    if (this.layer.options['globalCompositeOperation']) {\n      this.context.globalCompositeOperation = this.layer.options['globalCompositeOperation'];\n    }\n\n    var dpr = this.getMap().getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      this.context.scale(dpr, dpr);\n    }\n  };\n\n  _proto.resetCanvasTransform = function resetCanvasTransform() {\n    if (!this.context) {\n      return;\n    }\n\n    var dpr = this.getMap().getDevicePixelRatio();\n    this.context.setTransform(dpr, 0, 0, dpr, 0, 0);\n  };\n\n  _proto.resizeCanvas = function resizeCanvas(canvasSize) {\n    var canvas = this.canvas;\n\n    if (!canvas) {\n      return;\n    }\n\n    var size = canvasSize || this.getMap().getSize();\n    var r = this.getMap().getDevicePixelRatio();\n\n    if (canvas.width === r * size.width && canvas.height === r * size.height) {\n      return;\n    }\n\n    canvas.height = r * size.height;\n    canvas.width = r * size.width;\n\n    if (r !== 1 && this.context) {\n      this.context.scale(r, r);\n    }\n\n    if (this.layer._canvas && canvas.style) {\n      canvas.style.width = size.width + 'px';\n      canvas.style.height = size.height + 'px';\n    }\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.context) {\n      return;\n    }\n\n    Canvas.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  _proto.prepareCanvas = function prepareCanvas() {\n    if (!this.canvas) {\n      this.createCanvas();\n      this.createContext();\n      this.layer.onCanvasCreate();\n      this.layer.fire('canvascreate', {\n        'context': this.context,\n        'gl': this.gl\n      });\n    } else {\n      this.resetCanvasTransform();\n      this.clearCanvas();\n      this.resizeCanvas();\n    }\n\n    delete this._maskExtent;\n    var mask = this.layer.getMask();\n\n    if (!mask) {\n      this.layer.fire('renderstart', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      return null;\n    }\n\n    var maskExtent2D = this._maskExtent = mask._getPainter().get2DExtent();\n\n    if (!maskExtent2D.intersects(this._extent2D)) {\n      this.layer.fire('renderstart', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      return maskExtent2D;\n    }\n\n    this.layer.fire('renderstart', {\n      'context': this.context,\n      'gl': this.gl\n    });\n    return maskExtent2D;\n  };\n\n  _proto.clipCanvas = function clipCanvas(context) {\n    var mask = this.layer.getMask();\n\n    if (!mask) {\n      return false;\n    }\n\n    var old = this.southWest;\n    var map = this.getMap();\n    this.southWest = map._containerPointToPoint(new Point(0, map.height));\n    context.save();\n    var dpr = map.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      context.save();\n      context.scale(dpr, dpr);\n    }\n\n    if (mask.getGeometries) {\n      context.isMultiClip = true;\n      var masks = mask.getGeometries() || [];\n      context.beginPath();\n      masks.forEach(function (_mask) {\n        var painter = _mask._getPainter();\n\n        painter.paint(null, context);\n      });\n      context.stroke();\n      delete context.isMultiClip;\n    } else {\n      var painter = mask._getPainter();\n\n      painter.paint(null, context);\n    }\n\n    if (dpr !== 1) {\n      context.restore();\n    }\n\n    context.clip();\n    this.southWest = old;\n    return true;\n  };\n\n  _proto.getViewExtent = function getViewExtent() {\n    return {\n      'extent': this._extent2D,\n      'maskExtent': this._maskExtent,\n      'zoom': this._renderZoom,\n      'southWest': this.southWest\n    };\n  };\n\n  _proto.completeRender = function completeRender() {\n    if (this.getMap()) {\n      this._renderComplete = true;\n      this.layer.fire('renderend', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      this.setCanvasUpdated();\n    }\n  };\n\n  _proto.getEvents = function getEvents() {\n    return {\n      '_zoomstart': this.onZoomStart,\n      '_zooming': this.onZooming,\n      '_zoomend': this.onZoomEnd,\n      '_resize': this.onResize,\n      '_movestart': this.onMoveStart,\n      '_moving': this.onMoving,\n      '_moveend': this.onMoveEnd,\n      '_dragrotatestart': this.onDragRotateStart,\n      '_dragrotating': this.onDragRotating,\n      '_dragrotateend': this.onDragRotateEnd,\n      '_spatialreferencechange': this.onSpatialReferenceChange\n    };\n  };\n\n  _proto.onZoomStart = function onZoomStart() {};\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onZooming = function onZooming() {};\n\n  _proto.onMoveStart = function onMoveStart() {};\n\n  _proto.onMoving = function onMoving() {};\n\n  _proto.onMoveEnd = function onMoveEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onResize = function onResize() {\n    delete this._extent2D;\n    this.resizeCanvas();\n    this.setToRedraw();\n  };\n\n  _proto.onDragRotateStart = function onDragRotateStart() {};\n\n  _proto.onDragRotating = function onDragRotating() {};\n\n  _proto.onDragRotateEnd = function onDragRotateEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onSpatialReferenceChange = function onSpatialReferenceChange() {};\n\n  _proto.getDrawTime = function getDrawTime() {\n    return this._drawTime;\n  };\n\n  _proto._tryToDraw = function _tryToDraw(framestamp) {\n    this._toRedraw = false;\n\n    if (!this.canvas && this.layer.isEmpty && this.layer.isEmpty()) {\n      this._renderComplete = true;\n      return;\n    }\n\n    this._drawAndRecord(framestamp);\n  };\n\n  _proto._drawAndRecord = function _drawAndRecord(framestamp) {\n    if (!this.getMap()) {\n      return;\n    }\n\n    var painted = this._painted;\n    this._painted = true;\n    var t = now();\n    this.draw(framestamp);\n    t = now() - t;\n    this._drawTime = painted ? t : t / 2;\n\n    if (painted && this.layer && this.layer.options['logDrawTime']) {\n      console.log(this.layer.getId(), 'frameTimeStamp:', framestamp, 'drawTime:', this._drawTime);\n    }\n  };\n\n  _proto._promiseResource = function _promiseResource(url) {\n    var me = this,\n        resources = this.resources,\n        crossOrigin = this.layer.options['crossOrigin'];\n    return function (resolve) {\n      if (resources.isResourceLoaded(url, true)) {\n        resolve(url);\n        return;\n      }\n\n      var img = new Image();\n\n      if (!isNil(crossOrigin)) {\n        img['crossOrigin'] = crossOrigin;\n      }\n\n      if (isSVG(url[0]) && !IS_NODE) {\n        if (url[1]) {\n          url[1] *= 2;\n        }\n\n        if (url[2]) {\n          url[2] *= 2;\n        }\n      }\n\n      img.onload = function () {\n        me._cacheResource(url, img);\n\n        resolve(url);\n      };\n\n      img.onabort = function (err) {\n        if (console) {\n          console.warn('image loading aborted: ' + url[0]);\n        }\n\n        if (err) {\n          if (console) {\n            console.warn(err);\n          }\n        }\n\n        resolve(url);\n      };\n\n      img.onerror = function (err) {\n        if (err && typeof console !== 'undefined') {\n          console.warn(err);\n        }\n\n        resources.markErrorResource(url);\n        resolve(url);\n      };\n\n      loadImage(img, url);\n    };\n  };\n\n  _proto._cacheResource = function _cacheResource(url, img) {\n    if (!this.layer || !this.resources) {\n      return;\n    }\n\n    var w = url[1],\n        h = url[2];\n\n    if (this.layer.options['cacheSvgOnCanvas'] && isSVG(url[0]) === 1 && (Browser$1.edge || Browser$1.ie)) {\n      if (isNil(w)) {\n        w = img.width || this.layer.options['defaultIconSize'][0];\n      }\n\n      if (isNil(h)) {\n        h = img.height || this.layer.options['defaultIconSize'][1];\n      }\n\n      var canvas = Canvas.createCanvas(w, h);\n      Canvas.image(canvas.getContext('2d'), img, 0, 0, w, h);\n      img = canvas;\n    }\n\n    this.resources.addResource(url, img);\n  };\n\n  return CanvasRenderer;\n}(Class);\n\nvar ResourceCache = function () {\n  function ResourceCache() {\n    this.resources = {};\n    this._errors = {};\n  }\n\n  var _proto2 = ResourceCache.prototype;\n\n  _proto2.addResource = function addResource(url, img) {\n    this.resources[url[0]] = {\n      image: img,\n      width: +url[1],\n      height: +url[2]\n    };\n  };\n\n  _proto2.isResourceLoaded = function isResourceLoaded(url, checkSVG) {\n    if (!url) {\n      return false;\n    }\n\n    var imgUrl = this._getImgUrl(url);\n\n    if (this._errors[imgUrl]) {\n      return true;\n    }\n\n    var img = this.resources[imgUrl];\n\n    if (!img) {\n      return false;\n    }\n\n    if (checkSVG && isSVG(url[0]) && (+url[1] > img.width || +url[2] > img.height)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto2.getImage = function getImage(url) {\n    var imgUrl = this._getImgUrl(url);\n\n    if (!this.isResourceLoaded(url) || this._errors[imgUrl]) {\n      return null;\n    }\n\n    return this.resources[imgUrl].image;\n  };\n\n  _proto2.markErrorResource = function markErrorResource(url) {\n    this._errors[this._getImgUrl(url)] = 1;\n  };\n\n  _proto2.merge = function merge(res) {\n    if (!res) {\n      return this;\n    }\n\n    for (var p in res.resources) {\n      var img = res.resources[p];\n      this.addResource([p, img.width, img.height], img.image);\n    }\n\n    return this;\n  };\n\n  _proto2.forEach = function forEach(fn) {\n    if (!this.resources) {\n      return this;\n    }\n\n    for (var p in this.resources) {\n      if (hasOwn(this.resources, p)) {\n        fn(p, this.resources[p]);\n      }\n    }\n\n    return this;\n  };\n\n  _proto2._getImgUrl = function _getImgUrl(url) {\n    if (!Array.isArray(url)) {\n      return url;\n    }\n\n    return url[0];\n  };\n\n  return ResourceCache;\n}();\n\nfunction clipLine(points, bounds, round, noCut) {\n  var parts = [];\n  var k = 0,\n      segment;\n\n  for (var j = 0, l = points.length; j < l - 1; j++) {\n    segment = clipSegment(points[j], points[j + 1], bounds, j, round, noCut);\n\n    if (!segment) {\n      continue;\n    }\n\n    parts[k] = parts[k] || [];\n    parts[k].push({\n      'point': segment[0],\n      'index': j\n    });\n\n    if (segment[1] !== points[j + 1] || j === l - 2) {\n      parts[k].push({\n        'point': segment[1],\n        'index': j + 1\n      });\n      k++;\n    }\n  }\n\n  return parts;\n}\n\nvar _lastCode;\n\nfunction clipSegment(a, b, bounds, useLastCode, round, noCut) {\n  var codeA = useLastCode ? _lastCode : _getBitCode(a, bounds),\n      codeB = _getBitCode(b, bounds),\n      codeOut,\n      p,\n      newCode;\n\n  _lastCode = codeB;\n\n  while (true) {\n    if (!(codeA | codeB)) {\n      return [a, b];\n    }\n\n    if (codeA & codeB) {\n      return false;\n    }\n\n    if (noCut) {\n      return [a, b];\n    }\n\n    codeOut = codeA || codeB;\n    p = _getEdgeIntersection(a, b, codeOut, bounds, round);\n    newCode = _getBitCode(p, bounds);\n\n    if (codeOut === codeA) {\n      a = p;\n      codeA = newCode;\n    } else {\n      b = p;\n      codeB = newCode;\n    }\n  }\n}\n\nfunction clipPolygon(points, bounds, round) {\n  var edges = [1, 4, 2, 8];\n  var clippedPoints, i, j, k, a, b, len, edge, p;\n\n  for (i = 0, len = points.length; i < len; i++) {\n    points[i]._code = _getBitCode(points[i], bounds);\n  }\n\n  for (k = 0; k < 4; k++) {\n    edge = edges[k];\n    clippedPoints = [];\n\n    for (i = 0, len = points.length, j = len - 1; i < len; j = i++) {\n      a = points[i];\n      b = points[j];\n\n      if (!(a._code & edge)) {\n        if (b._code & edge) {\n          p = _getEdgeIntersection(b, a, edge, bounds, round);\n          p._code = _getBitCode(p, bounds);\n          clippedPoints.push(p);\n        }\n\n        clippedPoints.push(a);\n      } else if (!(b._code & edge)) {\n        p = _getEdgeIntersection(b, a, edge, bounds, round);\n        p._code = _getBitCode(p, bounds);\n        clippedPoints.push(p);\n      }\n    }\n\n    points = clippedPoints;\n  }\n\n  return points;\n}\n\nfunction _getEdgeIntersection(a, b, code, bounds, round) {\n  var dx = b.x - a.x,\n      dy = b.y - a.y,\n      min = bounds.getMin(),\n      max = bounds.getMax();\n  var x, y;\n\n  if (code & 8) {\n    x = a.x + dx * (max.y - a.y) / dy;\n    y = max.y;\n  } else if (code & 4) {\n    x = a.x + dx * (min.y - a.y) / dy;\n    y = min.y;\n  } else if (code & 2) {\n    x = max.x;\n    y = a.y + dy * (max.x - a.x) / dx;\n  } else if (code & 1) {\n    x = min.x;\n    y = a.y + dy * (min.x - a.x) / dx;\n  }\n\n  var p = new Point(x, y);\n\n  if (round) {\n    p._round();\n  }\n\n  return p;\n}\n\nfunction _getBitCode(p, bounds) {\n  var code = 0;\n\n  if (p.x < bounds.getMin().x) {\n    code |= 1;\n  } else if (p.x > bounds.getMax().x) {\n    code |= 2;\n  }\n\n  if (p.y < bounds.getMin().y) {\n    code |= 4;\n  } else if (p.y > bounds.getMax().y) {\n    code |= 8;\n  }\n\n  return code;\n}\n\nfunction withInEllipse(point, center, southeast, tolerance) {\n  point = new Point(point);\n  var a = Math.abs(southeast.x - center.x),\n      b = Math.abs(southeast.y - center.y),\n      c = Math.sqrt(Math.abs(a * a - b * b)),\n      xfocus = a >= b;\n  var f1, f2, d;\n\n  if (xfocus) {\n    f1 = new Point(center.x - c, center.y);\n    f2 = new Point(center.x + c, center.y);\n    d = a * 2;\n  } else {\n    f1 = new Point(center.x, center.y - c);\n    f2 = new Point(center.x, center.y + c);\n    d = b * 2;\n  }\n\n  return point.distanceTo(f1) + point.distanceTo(f2) <= d + 2 * tolerance;\n}\n\nvar Symbolizer = function () {\n  function Symbolizer() {}\n\n  var _proto = Symbolizer.prototype;\n\n  _proto.getMap = function getMap() {\n    return this.geometry.getMap();\n  };\n\n  _proto.getPainter = function getPainter() {\n    return this.painter;\n  };\n\n  _proto.isDynamicSize = function isDynamicSize() {\n    return false;\n  };\n\n  Symbolizer.testColor = function testColor(prop) {\n    if (!prop || !isString(prop)) {\n      return false;\n    }\n\n    if (COLOR_PROPERTIES.indexOf(prop) >= 0) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return Symbolizer;\n}();\n\nvar CanvasSymbolizer = function (_Symbolizer) {\n  _inheritsLoose(CanvasSymbolizer, _Symbolizer);\n\n  function CanvasSymbolizer() {\n    return _Symbolizer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasSymbolizer.prototype;\n\n  _proto._prepareContext = function _prepareContext(ctx) {\n    if (isNumber(this.symbol['opacity'])) {\n      if (ctx.globalAlpha !== this.symbol['opacity']) {\n        ctx.globalAlpha = this.symbol['opacity'];\n      }\n    } else if (ctx.globalAlpha !== 1) {\n      ctx.globalAlpha = 1;\n    }\n  };\n\n  _proto.prepareCanvas = function prepareCanvas(ctx, style, resources) {\n    Canvas.prepareCanvas(ctx, style, resources, this.getPainter().isHitTesting());\n  };\n\n  _proto.remove = function remove() {};\n\n  _proto.setZIndex = function setZIndex() {};\n\n  _proto.show = function show() {};\n\n  _proto.hide = function hide() {};\n\n  _proto._defineStyle = function _defineStyle(style) {\n    return function () {\n      var _this = this;\n\n      var arr = [],\n          prop = {};\n      return loadFunctionTypes(style, function () {\n        var map = _this.getMap();\n\n        return set$1(arr, map.getZoom(), extend({}, _this.geometry.getProperties(), setProp(prop, map.getBearing(), map.getPitch(), map.getZoom())));\n      });\n    }.bind(this)();\n  };\n\n  return CanvasSymbolizer;\n}(Symbolizer);\n\nfunction set$1(arr, a0, a1) {\n  arr[0] = a0;\n  arr[1] = a1;\n  return arr;\n}\n\nfunction setProp(prop, b, p, z) {\n  prop['{bearing}'] = b;\n  prop['{pitch}'] = p;\n  prop['{zoom}'] = z;\n  return prop;\n}\n\nvar TEMP_POINT0$1 = new Point(0, 0);\nvar TEMP_POINT1 = new Point(0, 0);\n\nvar PointSymbolizer = function (_CanvasSymbolizer) {\n  _inheritsLoose(PointSymbolizer, _CanvasSymbolizer);\n\n  function PointSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _CanvasSymbolizer.call(this) || this;\n    _this.symbol = symbol;\n    _this.geometry = geometry;\n    _this.painter = painter;\n    return _this;\n  }\n\n  var _proto = PointSymbolizer.prototype;\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n    var glZoom = map.getGLZoom();\n    var extent = new PointExtent();\n\n    var renderPoints = this._getRenderPoints()[0];\n\n    for (var i = renderPoints.length - 1; i >= 0; i--) {\n      if (renderPoints[i]) {\n        extent._combine(map._pointToPoint(renderPoints[i], glZoom));\n      }\n    }\n\n    return extent;\n  };\n\n  _proto.isDynamicSize = function isDynamicSize() {\n    var symbol = this.symbol;\n    return isFunctionDefinition(symbol['markerWidth']) || isFunctionDefinition(symbol['markerHeight']) || isFunctionDefinition(symbol['textSize']);\n  };\n\n  _proto._rotateExtent = function _rotateExtent(fixedExtent, angle) {\n    return fixedExtent.convertTo(function (p) {\n      return p._rotate(angle);\n    });\n  };\n\n  _proto._getRenderPoints = function _getRenderPoints() {\n    var painter = this.getPainter();\n    var placement = painter.isSpriting() ? 'center' : this.getPlacement();\n    return this.getPainter().getRenderPoints(placement);\n  };\n\n  _proto._getRenderContainerPoints = function _getRenderContainerPoints(ignoreAltitude) {\n    var painter = this.getPainter(),\n        points = this._getRenderPoints()[0];\n\n    if (painter.isSpriting()) {\n      return points;\n    }\n\n    var dxdy = this.getDxDy();\n\n    var cpoints = this.painter._pointContainerPoints(points, dxdy.x, dxdy.y, ignoreAltitude, true, this.getPlacement());\n\n    if (!cpoints || !Array.isArray(cpoints[0])) {\n      return cpoints;\n    }\n\n    var flat = [];\n\n    for (var i = 0, l = cpoints.length; i < l; i++) {\n      for (var ii = 0, ll = cpoints[i].length; ii < ll; ii++) {\n        flat.push(cpoints[i][ii]);\n      }\n    }\n\n    return flat;\n  };\n\n  _proto._getRotationAt = function _getRotationAt(i) {\n    var r = this.getRotation();\n\n    if (!r) {\n      r = 0;\n    }\n\n    var rotations = this._getRenderPoints()[1];\n\n    if (!rotations || !rotations[i]) {\n      return r;\n    }\n\n    var map = this.getMap();\n    var p0 = rotations[i][0],\n        p1 = rotations[i][1];\n\n    if (map.isTransforming()) {\n      var maxZoom = map.getGLZoom();\n      p0 = map._pointToContainerPoint(rotations[i][0], maxZoom, 0, TEMP_POINT0$1);\n      p1 = map._pointToContainerPoint(rotations[i][1], maxZoom, 0, TEMP_POINT1);\n      return r + computeDegree(p0.x, p0.y, p1.x, p1.y);\n    } else {\n      return r + -computeDegree(p0.x, p0.y, p1.x, p1.y);\n    }\n  };\n\n  _proto._rotate = function _rotate(ctx, origin, rotation) {\n    if (rotation) {\n      var dxdy = this.getDxDy();\n      var p = origin.sub(dxdy);\n      ctx.save();\n      ctx.translate(p.x, p.y);\n      ctx.rotate(rotation);\n      return this.getDxDy();\n    }\n\n    return null;\n  };\n\n  return PointSymbolizer;\n}(CanvasSymbolizer);\n\nvar VectorMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(VectorMarkerSymbolizer, _PointSymbolizer);\n\n  VectorMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (isNil(symbol['markerFile']) && !isNil(symbol['markerType']) && symbol['markerType'] !== 'path') {\n      return true;\n    }\n\n    return false;\n  };\n\n  function VectorMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this._dynamic = hasFunctionDefinition(symbol);\n    _this.style = _this._defineStyle(_this.translate());\n    _this.strokeAndFill = _this._defineStyle(VectorMarkerSymbolizer.translateLineAndFill(_this.style));\n    var lineWidth = _this.strokeAndFill['lineWidth'];\n\n    if (lineWidth % 2 === 0) {\n      _this.padding = 2;\n    } else {\n      _this.padding = 1.5;\n    }\n\n    return _this;\n  }\n\n  var _proto = VectorMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['polygonOpacity'] === 0 && style['lineOpacity'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    if (this.getPainter().isSpriting() || this.geometry.getLayer().getMask() === this.geometry || this._dynamic || this.geometry.getLayer().options['cacheVectorOnCanvas'] === false) {\n      this._drawMarkers(ctx, cookedPoints, resources);\n    } else {\n      this._drawMarkersWithCache(ctx, cookedPoints, resources);\n    }\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    var dx = s['markerDx'],\n        dy = s['markerDy'];\n    return new Point(dx, dy);\n  };\n\n  _proto._drawMarkers = function _drawMarkers(ctx, cookedPoints, resources) {\n    var strokeAndFill = this.strokeAndFill;\n    var gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n\n    if (!gradient) {\n      this.prepareCanvas(ctx, strokeAndFill, resources);\n    }\n\n    for (var i = cookedPoints.length - 1; i >= 0; i--) {\n      var point = cookedPoints[i];\n\n      var origin = this._rotate(ctx, point, this._getRotationAt(i));\n\n      if (origin) {\n        point = origin;\n      }\n\n      this._drawVectorMarker(ctx, point, resources);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto._drawMarkersWithCache = function _drawMarkersWithCache(ctx, cookedPoints, resources) {\n    var stamp = this._stampSymbol();\n\n    var image = resources.getImage(stamp);\n\n    if (!image) {\n      image = this._createMarkerImage(ctx, resources);\n      resources.addResource([stamp, image.width, image.height], image);\n    }\n\n    var anchor = this._getAnchor(image.width, image.height);\n\n    for (var i = cookedPoints.length - 1; i >= 0; i--) {\n      var point = cookedPoints[i];\n\n      var origin = this._rotate(ctx, point, this._getRotationAt(i));\n\n      if (origin) {\n        point = origin;\n      }\n\n      Canvas.image(ctx, image, point.x + anchor.x, point.y + anchor.y);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto._calMarkerSize = function _calMarkerSize() {\n    if (!this._size) {\n      var lineWidth = this.strokeAndFill['lineWidth'],\n          shadow = 2 * (this.symbol['shadowBlur'] || 0),\n          w = Math.round(this.style['markerWidth'] + lineWidth + 2 * shadow + this.padding * 2),\n          h = Math.round(this.style['markerHeight'] + lineWidth + 2 * shadow + this.padding * 2);\n\n      if (isFunctionDefinition(this.symbol['markerWidth']) || isFunctionDefinition(this.symbol['markerHeight'])) {\n        return [w, h];\n      }\n\n      this._size = [w, h];\n    }\n\n    return this._size;\n  };\n\n  _proto._createMarkerImage = function _createMarkerImage(ctx, resources) {\n    var canvasClass = ctx.canvas.constructor,\n        size = this._calMarkerSize(),\n        canvas = Canvas.createCanvas(size[0], size[1], canvasClass),\n        point = this._getCacheImageAnchor(size[0], size[1]);\n\n    var context = canvas.getContext('2d');\n    var gradient = isGradient(this.strokeAndFill['lineColor']) || isGradient(this.strokeAndFill['polygonFill']);\n\n    if (!gradient) {\n      this.prepareCanvas(context, this.strokeAndFill, resources);\n    }\n\n    this._drawVectorMarker(context, point, resources);\n\n    return canvas;\n  };\n\n  _proto._stampSymbol = function _stampSymbol() {\n    if (!this._stamp) {\n      this._stamp = [this.style['markerType'], isGradient(this.style['markerFill']) ? getGradientStamp(this.style['markerFill']) : this.style['markerFill'], this.style['markerFillOpacity'], this.style['markerFillPatternFile'], isGradient(this.style['markerLineColor']) ? getGradientStamp(this.style['markerLineColor']) : this.style['markerLineColor'], this.style['markerLineWidth'], this.style['markerLineOpacity'], this.style['markerLineDasharray'] ? this.style['markerLineDasharray'].join(',') : '', this.style['markerLinePatternFile'], this.style['markerWidth'], this.style['markerHeight'], this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']].join('_');\n    }\n\n    return this._stamp;\n  };\n\n  _proto._getAnchor = function _getAnchor(w, h) {\n    var shadow = 2 * (this.symbol['shadowBlur'] || 0),\n        margin = shadow + this.padding;\n    var p = getAlignPoint(new Size(w, h), this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']);\n\n    if (p.x !== -w / 2) {\n      p.x -= sign(p.x + w / 2) * margin;\n    }\n\n    if (p.y !== -h / 2) {\n      p.y -= sign(p.y + h / 2) * margin;\n    }\n\n    return p;\n  };\n\n  _proto._getCacheImageAnchor = function _getCacheImageAnchor(w, h) {\n    var shadow = 2 * (this.symbol['shadowBlur'] || 0),\n        margin = shadow + this.padding;\n    var markerType = this.style['markerType'];\n\n    if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n      return new Point(w / 2, h - margin);\n    } else if (markerType === 'rectangle') {\n      return new Point(margin, margin);\n    } else {\n      return new Point(w / 2, h / 2);\n    }\n  };\n\n  _proto._getGraidentExtent = function _getGraidentExtent(points) {\n    var e = new PointExtent(),\n        dxdy = this.getDxDy(),\n        m = this.getFixedExtent();\n\n    if (Array.isArray(points)) {\n      for (var i = points.length - 1; i >= 0; i--) {\n        e._combine(points[i]);\n      }\n    } else {\n      e._combine(points);\n    }\n\n    e['xmin'] += m['xmin'] - dxdy.x;\n    e['ymin'] += m['ymin'] - dxdy.y;\n    e['xmax'] += m['xmax'] - dxdy.x;\n    e['ymax'] += m['ymax'] - dxdy.y;\n    return e;\n  };\n\n  _proto._drawVectorMarker = function _drawVectorMarker(ctx, point, resources) {\n    var style = this.style,\n        strokeAndFill = this.strokeAndFill,\n        markerType = style['markerType'].toLowerCase(),\n        vectorArray = VectorMarkerSymbolizer._getVectorPoints(markerType, style['markerWidth'], style['markerHeight']),\n        lineOpacity = strokeAndFill['lineOpacity'],\n        fillOpacity = strokeAndFill['polygonOpacity'];\n\n    var gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n\n    if (gradient) {\n      var gradientExtent;\n\n      if (isGradient(strokeAndFill['lineColor'])) {\n        gradientExtent = this._getGraidentExtent(point);\n        strokeAndFill['lineGradientExtent'] = gradientExtent.expand(strokeAndFill['lineWidth']);\n      }\n\n      if (isGradient(strokeAndFill['polygonFill'])) {\n        if (!gradientExtent) {\n          gradientExtent = this._getGraidentExtent(point);\n        }\n\n        strokeAndFill['polygonGradientExtent'] = gradientExtent;\n      }\n\n      this.prepareCanvas(ctx, strokeAndFill, resources);\n    }\n\n    var width = style['markerWidth'],\n        height = style['markerHeight'],\n        hLineWidth = style['markerLineWidth'] / 2;\n\n    if (markerType === 'ellipse') {\n      Canvas.ellipse(ctx, point, width / 2, height / 2, height / 2, lineOpacity, fillOpacity);\n    } else if (markerType === 'cross' || markerType === 'x') {\n      for (var j = vectorArray.length - 1; j >= 0; j--) {\n        vectorArray[j]._add(point);\n      }\n\n      Canvas.path(ctx, vectorArray.slice(0, 2), lineOpacity);\n      Canvas.path(ctx, vectorArray.slice(2, 4), lineOpacity);\n    } else if (markerType === 'diamond' || markerType === 'bar' || markerType === 'square' || markerType === 'rectangle' || markerType === 'triangle') {\n      if (markerType === 'bar') {\n        point = point.add(0, -hLineWidth);\n      } else if (markerType === 'rectangle') {\n        point = point.add(hLineWidth, hLineWidth);\n      }\n\n      for (var _j = vectorArray.length - 1; _j >= 0; _j--) {\n        vectorArray[_j]._add(point);\n      }\n\n      Canvas.polygon(ctx, vectorArray, lineOpacity, fillOpacity);\n    } else if (markerType === 'pin') {\n      point = point.add(0, -hLineWidth);\n\n      for (var _j2 = vectorArray.length - 1; _j2 >= 0; _j2--) {\n        vectorArray[_j2]._add(point);\n      }\n\n      var lineCap = ctx.lineCap;\n      ctx.lineCap = 'round';\n      Canvas.bezierCurveAndFill(ctx, vectorArray, lineOpacity, fillOpacity);\n      ctx.lineCap = lineCap;\n    } else if (markerType === 'pie') {\n      point = point.add(0, hLineWidth);\n      var angle = Math.atan(width / 2 / height) * 180 / Math.PI;\n      var _lineCap = ctx.lineCap;\n      ctx.lineCap = 'round';\n      Canvas.sector(ctx, point, height, [90 - angle, 90 + angle], lineOpacity, fillOpacity);\n      ctx.lineCap = _lineCap;\n    } else {\n      throw new Error('unsupported markerType: ' + markerType);\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['markerPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['markerRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var dxdy = this.getDxDy(),\n        padding = this.padding * 2;\n\n    var size = this._calMarkerSize().map(function (d) {\n      return d - padding;\n    });\n\n    var alignPoint = this._getAnchor(size[0], size[1]);\n\n    var result = new PointExtent(dxdy.add(0, 0), dxdy.add(size[0], size[1]));\n\n    result._add(alignPoint);\n\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'markerType': getValueOrDefault(s['markerType'], 'ellipse'),\n      'markerFill': getValueOrDefault(s['markerFill'], '#00f'),\n      'markerFillOpacity': getValueOrDefault(s['markerFillOpacity'], 1),\n      'markerFillPatternFile': getValueOrDefault(s['markerFillPatternFile'], null),\n      'markerLineColor': getValueOrDefault(s['markerLineColor'], '#000'),\n      'markerLineWidth': getValueOrDefault(s['markerLineWidth'], 1),\n      'markerLineOpacity': getValueOrDefault(s['markerLineOpacity'], 1),\n      'markerLineDasharray': getValueOrDefault(s['markerLineDasharray'], []),\n      'markerLinePatternFile': getValueOrDefault(s['markerLinePatternFile'], null),\n      'markerDx': getValueOrDefault(s['markerDx'], 0),\n      'markerDy': getValueOrDefault(s['markerDy'], 0),\n      'markerWidth': getValueOrDefault(s['markerWidth'], 10),\n      'markerHeight': getValueOrDefault(s['markerHeight'], 10),\n      'markerRotation': getValueOrDefault(s['markerRotation'], 0)\n    };\n    var markerType = result['markerType'];\n    var ha, va;\n\n    if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n      ha = 'middle';\n      va = 'top';\n    } else if (markerType === 'rectangle') {\n      ha = 'right';\n      va = 'bottom';\n    } else {\n      ha = 'middle';\n      va = 'middle';\n    }\n\n    result['markerHorizontalAlignment'] = getValueOrDefault(s['markerHorizontalAlignment'], ha);\n    result['markerVerticalAlignment'] = getValueOrDefault(s['markerVerticalAlignment'], va);\n\n    if (isNumber(s['markerOpacity'])) {\n      if (isNumber(s['markerFillOpacity'])) {\n        result['markerFillOpacity'] *= s['markerOpacity'];\n      }\n\n      if (isNumber(s['markerLineOpacity'])) {\n        result['markerLineOpacity'] *= s['markerOpacity'];\n      }\n    }\n\n    return result;\n  };\n\n  VectorMarkerSymbolizer.translateLineAndFill = function translateLineAndFill(s) {\n    var result = {\n      'lineColor': s['markerLineColor'],\n      'linePatternFile': s['markerLinePatternFile'],\n      'lineWidth': s['markerLineWidth'],\n      'lineOpacity': s['markerLineOpacity'],\n      'lineDasharray': s['markerLineDasharray'],\n      'lineCap': 'butt',\n      'lineJoin': 'round',\n      'polygonFill': s['markerFill'],\n      'polygonPatternFile': s['markerFillPatternFile'],\n      'polygonOpacity': s['markerFillOpacity']\n    };\n\n    if (result['lineWidth'] === 0) {\n      result['lineOpacity'] = 0;\n    }\n\n    return result;\n  };\n\n  VectorMarkerSymbolizer._getVectorPoints = function _getVectorPoints(markerType, width, height) {\n    var hh = height / 2,\n        hw = width / 2;\n    var left = 0,\n        top = 0;\n    var v0, v1, v2, v3;\n\n    if (markerType === 'triangle') {\n      v0 = new Point(left, top - hh);\n      v1 = new Point(left - hw, top + hh);\n      v2 = new Point(left + hw, top + hh);\n      return [v0, v1, v2];\n    } else if (markerType === 'cross') {\n      v0 = new Point(left - hw, top);\n      v1 = new Point(left + hw, top);\n      v2 = new Point(left, top - hh);\n      v3 = new Point(left, top + hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'diamond') {\n      v0 = new Point(left - hw, top);\n      v1 = new Point(left, top - hh);\n      v2 = new Point(left + hw, top);\n      v3 = new Point(left, top + hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'square') {\n      v0 = new Point(left - hw, top + hh);\n      v1 = new Point(left + hw, top + hh);\n      v2 = new Point(left + hw, top - hh);\n      v3 = new Point(left - hw, top - hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'rectangle') {\n      v0 = new Point(left, top);\n      v1 = v0.add(width, 0);\n      v2 = v0.add(width, height);\n      v3 = v0.add(0, height);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'x') {\n      v0 = new Point(left - hw, top + hh);\n      v1 = new Point(left + hw, top - hh);\n      v2 = new Point(left + hw, top + hh);\n      v3 = new Point(left - hw, top - hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'bar') {\n      v0 = new Point(left - hw, top - height);\n      v1 = new Point(left + hw, top - height);\n      v2 = new Point(left + hw, top);\n      v3 = new Point(left - hw, top);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'pin') {\n      var extWidth = height * Math.atan(hw / hh);\n      v0 = new Point(left, top);\n      v1 = new Point(left - extWidth, top - height);\n      v2 = new Point(left + extWidth, top - height);\n      v3 = new Point(left, top);\n      return [v0, v1, v2, v3];\n    }\n\n    return [];\n  };\n\n  return VectorMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar DebugSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(DebugSymbolizer, _PointSymbolizer);\n\n  function DebugSymbolizer() {\n    return _PointSymbolizer.apply(this, arguments) || this;\n  }\n\n  var _proto = DebugSymbolizer.prototype;\n\n  _proto.getPlacement = function getPlacement() {\n    return 'point';\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    return new Point(0, 0);\n  };\n\n  _proto.symbolize = function symbolize(ctx) {\n    var geometry = this.geometry,\n        layer = geometry.getLayer();\n\n    if (!geometry.options['debug'] && layer && !layer.options['debug']) {\n      return;\n    }\n\n    var map = this.getMap();\n\n    if (!map || map.isZooming()) {\n      return;\n    }\n\n    var color = layer.options['debugOutline'],\n        op = 1;\n    ctx.strokeStyle = color;\n    ctx.fillStyle = color;\n    var outline = this.getPainter().getContainerExtent().toArray();\n    Canvas.polygon(ctx, [outline], op, 0);\n\n    var points = this._getRenderContainerPoints(),\n        id = this.geometry.getId(),\n        cross = VectorMarkerSymbolizer._getVectorPoints('cross', 10, 10);\n\n    for (var i = 0; i < points.length; i++) {\n      var p = points[i];\n\n      if (!isNil(id)) {\n        Canvas.fillText(ctx, id, p.add(8, -4), color);\n      }\n\n      var c = [];\n\n      for (var ii = 0; ii < cross.length; ii++) {\n        c.push(cross[ii].add(p));\n      }\n\n      Canvas.path(ctx, c.slice(0, 2), op);\n      Canvas.path(ctx, c.slice(2, 4), op);\n    }\n  };\n\n  return DebugSymbolizer;\n}(PointSymbolizer);\n\nvar ImageMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(ImageMarkerSymbolizer, _PointSymbolizer);\n\n  ImageMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (!isNil(symbol['markerFile'])) {\n      return true;\n    }\n\n    return false;\n  };\n\n  function ImageMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this.style = _this._defineStyle(_this.translate());\n    return _this;\n  }\n\n  var _proto = ImageMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['markerOpacity'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    var img = this._getImage(resources);\n\n    if (!img) {\n      if (typeof console !== 'undefined') {\n        console.warn('no img found for ' + (this.style['markerFile'] || this._url[0]));\n      }\n\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    var width = style['markerWidth'];\n    var height = style['markerHeight'];\n\n    if (!isNumber(width) || !isNumber(height)) {\n      width = img.width;\n      height = img.height;\n      style['markerWidth'] = width;\n      style['markerHeight'] = height;\n      var imgURL = [style['markerFile'], style['markerWidth'], style['markerHeight']];\n\n      if (!resources.isResourceLoaded(imgURL)) {\n        resources.addResource(imgURL, img);\n      }\n\n      var painter = this.getPainter();\n\n      if (!painter.isSpriting()) {\n        painter.removeCache();\n      }\n    }\n\n    var alpha;\n\n    if (this.symbol['markerType'] !== 'path' && isNumber(style['markerOpacity']) && style['markerOpacity'] < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= style['markerOpacity'];\n    }\n\n    var alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n\n    for (var i = 0, len = cookedPoints.length; i < len; i++) {\n      var p = cookedPoints[i];\n\n      var origin = this._rotate(ctx, p, this._getRotationAt(i));\n\n      if (origin) {\n        p = origin;\n      }\n\n      Canvas.image(ctx, img, p.x + alignPoint.x, p.y + alignPoint.y, width, height);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n\n    if (alpha !== undefined) {\n      ctx.globalAlpha = alpha;\n    }\n  };\n\n  _proto._getImage = function _getImage(resources) {\n    var img = !resources ? null : resources.getImage([this.style['markerFile'], this.style['markerWidth'], this.style['markerHeight']]);\n    return img;\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['markerPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['markerRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    var dx = s['markerDx'],\n        dy = s['markerDy'];\n    return new Point(dx, dy);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent(resources) {\n    var style = this.style;\n    var url = style['markerFile'],\n        img = resources ? resources.getImage(url) : null;\n    var width = style['markerWidth'] || (img ? img.width : 0),\n        height = style['markerHeight'] || (img ? img.height : 0);\n    var dxdy = this.getDxDy();\n    var alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n    var result = new PointExtent(dxdy.add(0, 0), dxdy.add(width, height));\n\n    result._add(alignPoint);\n\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    return {\n      'markerFile': s['markerFile'],\n      'markerOpacity': getValueOrDefault(s['markerOpacity'], 1),\n      'markerWidth': getValueOrDefault(s['markerWidth'], null),\n      'markerHeight': getValueOrDefault(s['markerHeight'], null),\n      'markerRotation': getValueOrDefault(s['markerRotation'], 0),\n      'markerDx': getValueOrDefault(s['markerDx'], 0),\n      'markerDy': getValueOrDefault(s['markerDy'], 0),\n      'markerHorizontalAlignment': getValueOrDefault(s['markerHorizontalAlignment'], 'middle'),\n      'markerVerticalAlignment': getValueOrDefault(s['markerVerticalAlignment'], 'top')\n    };\n  };\n\n  return ImageMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar TEMP_COORD0$1 = new Coordinate(0, 0);\nvar TEMP_COORD1$1 = new Coordinate(0, 0);\n\nvar StrokeAndFillSymbolizer = function (_CanvasSymbolizer) {\n  _inheritsLoose(StrokeAndFillSymbolizer, _CanvasSymbolizer);\n\n  StrokeAndFillSymbolizer.test = function test(symbol, geometry) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (geometry && geometry.type === 'Point') {\n      return false;\n    }\n\n    for (var p in symbol) {\n      var f = p.slice(0, 4);\n\n      if (f === 'line' || f === 'poly') {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  function StrokeAndFillSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _CanvasSymbolizer.call(this) || this;\n    _this.symbol = symbol;\n    _this.geometry = geometry;\n    _this.painter = painter;\n\n    if (geometry.type === 'Point') {\n      return _assertThisInitialized(_this);\n    }\n\n    _this.style = _this._defineStyle(_this.translate());\n    return _this;\n  }\n\n  var _proto = StrokeAndFillSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (style['polygonOpacity'] === 0 && style['lineOpacity'] === 0 && !this.painter.isHitTesting()) {\n      return;\n    }\n\n    var paintParams = this._getPaintParams();\n\n    if (!paintParams) {\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    var isGradient$$1 = isGradient(style['lineColor']),\n        isPath = this.geometry.getJSONType() === 'Polygon' || this.geometry.type === 'LineString';\n\n    if (isGradient$$1 && (style['lineColor']['places'] || !isPath)) {\n      style['lineGradientExtent'] = this.getPainter().getContainerExtent()._expand(style['lineWidth']);\n    }\n\n    if (isGradient(style['polygonFill'])) {\n      style['polygonGradientExtent'] = this.getPainter().getContainerExtent();\n    }\n\n    var points = paintParams[0],\n        isSplitted = this.geometry.getJSONType() === 'Polygon' && points.length > 0 && Array.isArray(points[0][0]) || this.geometry.type === 'LineString' && points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      for (var i = 0; i < points.length; i++) {\n        this.prepareCanvas(ctx, style, resources);\n\n        if (isGradient$$1 && isPath && !style['lineColor']['places']) {\n          this._createGradient(ctx, points[i], style['lineColor']);\n        }\n\n        var params = [ctx, points[i]];\n\n        if (paintParams.length > 1) {\n          params.push.apply(params, paintParams.slice(1));\n        }\n\n        params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n\n        this.geometry._paintOn.apply(this.geometry, params);\n      }\n    } else {\n      this.prepareCanvas(ctx, style, resources);\n\n      if (isGradient$$1 && isPath && !style['lineColor']['places']) {\n        this._createGradient(ctx, points, style['lineColor']);\n      }\n\n      var _params = [ctx];\n\n      _params.push.apply(_params, paintParams);\n\n      _params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n\n      this.geometry._paintOn.apply(this.geometry, _params);\n    }\n\n    if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n      ctx.setLineDash([]);\n    }\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n\n    var extent = this.geometry._getPrjExtent();\n\n    if (!extent) {\n      return null;\n    }\n\n    if (!this._extMin || !this._extMax) {\n      this._extMin = new Coordinate(0, 0);\n      this._extMax = new Coordinate(0, 0);\n    }\n\n    this._extMin.x = extent['xmin'];\n    this._extMin.y = extent['ymin'];\n    this._extMax.x = extent['xmax'];\n    this._extMax.y = extent['ymax'];\n\n    var min = map._prjToPoint(this._extMin, undefined, TEMP_COORD0$1),\n        max = map._prjToPoint(this._extMax, undefined, TEMP_COORD1$1);\n\n    if (!this._pxExtent) {\n      this._pxExtent = new PointExtent(min, max);\n    } else {\n      this._pxExtent.set(Math.min(min.x, max.x), Math.min(min.y, max.y), Math.max(min.x, max.x), Math.max(min.y, max.y));\n    }\n\n    return this._pxExtent;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var t = this.style['lineWidth'] / 2;\n    return new PointExtent(-t, -t, t, t);\n  };\n\n  _proto._getPaintParams = function _getPaintParams() {\n    return this.getPainter().getPaintParams(this.style['lineDx'], this.style['lineDy']);\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'lineColor': getValueOrDefault(s['lineColor'], '#000'),\n      'lineWidth': getValueOrDefault(s['lineWidth'], 2),\n      'lineOpacity': getValueOrDefault(s['lineOpacity'], 1),\n      'lineDasharray': getValueOrDefault(s['lineDasharray'], []),\n      'lineCap': getValueOrDefault(s['lineCap'], 'butt'),\n      'lineJoin': getValueOrDefault(s['lineJoin'], 'miter'),\n      'linePatternFile': getValueOrDefault(s['linePatternFile'], null),\n      'lineDx': getValueOrDefault(s['lineDx'], 0),\n      'lineDy': getValueOrDefault(s['lineDy'], 0),\n      'polygonFill': getValueOrDefault(s['polygonFill'], null),\n      'polygonOpacity': getValueOrDefault(s['polygonOpacity'], 1),\n      'polygonPatternFile': getValueOrDefault(s['polygonPatternFile'], null),\n      'polygonPatternDx': getValueOrDefault(s['polygonPatternDx'], 0),\n      'polygonPatternDy': getValueOrDefault(s['polygonPatternDy'], 0),\n      'linePatternDx': getValueOrDefault(s['linePatternDx'], 0),\n      'linePatternDy': getValueOrDefault(s['linePatternDy'], 0)\n    };\n\n    if (result['lineWidth'] === 0) {\n      result['lineOpacity'] = 0;\n    }\n\n    if (this.geometry.type === 'LineString' && !result['polygonFill']) {\n      result['polygonFill'] = result['lineColor'];\n    }\n\n    return result;\n  };\n\n  _proto._createGradient = function _createGradient(ctx, points, lineColor) {\n    if (!Array.isArray(points) || !points.length) {\n      return;\n    }\n\n    var len = points.length;\n    var grad = ctx.createLinearGradient(points[0].x, points[0].y, points[len - 1].x, points[len - 1].y);\n    lineColor['colorStops'].forEach(function (stop) {\n      grad.addColorStop.apply(grad, stop);\n    });\n    ctx.strokeStyle = grad;\n  };\n\n  return StrokeAndFillSymbolizer;\n}(CanvasSymbolizer);\n\nvar CACHE_KEY = '___text_symbol_cache';\n\nvar TextMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(TextMarkerSymbolizer, _PointSymbolizer);\n\n  TextMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (!isNil(symbol['textName'])) {\n      return true;\n    }\n\n    return false;\n  };\n\n  function TextMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this._dynamic = hasFunctionDefinition(symbol);\n    _this.style = _this._defineStyle(_this.translate());\n\n    if (_this.style['textWrapWidth'] === 0) {\n      return _assertThisInitialized(_this);\n    }\n\n    _this.strokeAndFill = _this._defineStyle(_this.translateLineAndFill(_this.style));\n    var textContent = replaceVariable(_this.style['textName'], _this.geometry.getProperties());\n\n    if (!_this._dynamic) {\n      _this._cacheKey = genCacheKey(textContent, _this.style);\n    }\n\n    _this._descText(textContent);\n\n    return _this;\n  }\n\n  var _proto = TextMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    if (!this.painter.isHitTesting() && (this.style['textSize'] === 0 || !this.style['textOpacity'] && (!this.style['textHaloRadius'] || !this.style['textHaloOpacity']) || this.style['textWrapWidth'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    var style = this.style,\n        strokeAndFill = this.strokeAndFill;\n    var textContent = replaceVariable(this.style['textName'], this.geometry.getProperties());\n\n    this._descText(textContent);\n\n    this._prepareContext(ctx);\n\n    this.prepareCanvas(ctx, strokeAndFill, resources);\n    Canvas.prepareCanvasFont(ctx, style);\n\n    for (var i = 0, len = cookedPoints.length; i < len; i++) {\n      var p = cookedPoints[i];\n\n      var origin = this._rotate(ctx, p, this._getRotationAt(i));\n\n      if (origin) {\n        p = origin;\n      }\n\n      Canvas.text(ctx, textContent, p, style, this.textDesc);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['textPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['textRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    return new Point(s['textDx'], s['textDy']);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var dxdy = this.getDxDy(),\n        style = this.style;\n    var size = this.textDesc['size'];\n    var alignPoint = getAlignPoint(size, style['textHorizontalAlignment'], style['textVerticalAlignment']);\n    var alignW = alignPoint.x,\n        alignH = alignPoint.y;\n\n    if (style['textHaloRadius']) {\n      var r = style['textHaloRadius'];\n      size = size.add(r * 2, r * 2);\n    }\n\n    var result = new PointExtent(dxdy.add(alignW, alignH), dxdy.add(alignW + size['width'], alignH + size['height']));\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'textName': s['textName'],\n      'textFaceName': getValueOrDefault(s['textFaceName'], 'monospace'),\n      'textWeight': getValueOrDefault(s['textWeight'], 'normal'),\n      'textStyle': getValueOrDefault(s['textStyle'], 'normal'),\n      'textSize': getValueOrDefault(s['textSize'], DEFAULT_TEXT_SIZE),\n      'textFont': getValueOrDefault(s['textFont'], null),\n      'textFill': getValueOrDefault(s['textFill'], '#000'),\n      'textOpacity': getValueOrDefault(s['textOpacity'], 1),\n      'textHaloFill': getValueOrDefault(s['textHaloFill'], '#ffffff'),\n      'textHaloRadius': getValueOrDefault(s['textHaloRadius'], 0),\n      'textHaloOpacity': getValueOrDefault(s['textHaloOpacity'], 1),\n      'textWrapWidth': getValueOrDefault(s['textWrapWidth'], null),\n      'textWrapCharacter': getValueOrDefault(s['textWrapCharacter'], '\\n'),\n      'textLineSpacing': getValueOrDefault(s['textLineSpacing'], 0),\n      'textDx': getValueOrDefault(s['textDx'], 0),\n      'textDy': getValueOrDefault(s['textDy'], 0),\n      'textHorizontalAlignment': getValueOrDefault(s['textHorizontalAlignment'], 'middle'),\n      'textVerticalAlignment': getValueOrDefault(s['textVerticalAlignment'], 'middle'),\n      'textAlign': getValueOrDefault(s['textAlign'], 'center'),\n      'textRotation': getValueOrDefault(s['textRotation'], 0),\n      'textMaxWidth': getValueOrDefault(s['textMaxWidth'], 0),\n      'textMaxHeight': getValueOrDefault(s['textMaxHeight'], 0)\n    };\n\n    if (result['textMaxWidth'] > 0 && (!result['textWrapWidth'] || result['textWrapWidth'] > result['textMaxWidth'])) {\n      if (!result['textWrapWidth']) {\n        result['textMaxHeight'] = 1;\n      }\n\n      result['textWrapWidth'] = result['textMaxWidth'];\n    }\n\n    return result;\n  };\n\n  _proto.translateLineAndFill = function translateLineAndFill(s) {\n    return {\n      'lineColor': s['textHaloRadius'] ? s['textHaloFill'] : s['textFill'],\n      'lineWidth': s['textHaloRadius'],\n      'lineOpacity': s['textOpacity'],\n      'lineDasharray': null,\n      'lineCap': 'butt',\n      'lineJoin': 'round',\n      'polygonFill': s['textFill'],\n      'polygonOpacity': s['textOpacity']\n    };\n  };\n\n  _proto._descText = function _descText(textContent) {\n    if (this._dynamic) {\n      this.textDesc = this._measureText(textContent);\n      return;\n    }\n\n    this.textDesc = this._loadFromCache();\n\n    if (!this.textDesc) {\n      this.textDesc = this._measureText(textContent);\n\n      this._storeToCache(this.textDesc);\n    }\n  };\n\n  _proto._measureText = function _measureText(textContent) {\n    var maxHeight = this.style['textMaxHeight'];\n    var textDesc = splitTextToRow(textContent, this.style);\n\n    if (maxHeight && maxHeight < textDesc.size.height) {\n      textDesc.size.height = maxHeight;\n    }\n\n    return textDesc;\n  };\n\n  _proto._storeToCache = function _storeToCache(textDesc) {\n    if (IS_NODE) {\n      return;\n    }\n\n    if (!this.geometry[CACHE_KEY]) {\n      this.geometry[CACHE_KEY] = {};\n    }\n\n    this.geometry[CACHE_KEY][this._cacheKey] = {\n      'desc': textDesc,\n      'active': true\n    };\n  };\n\n  _proto._loadFromCache = function _loadFromCache() {\n    if (!this.geometry[CACHE_KEY]) {\n      return null;\n    }\n\n    var cache = this.geometry[CACHE_KEY][this._cacheKey];\n\n    if (!cache) {\n      return null;\n    }\n\n    cache.active = true;\n    return cache.desc;\n  };\n\n  return TextMarkerSymbolizer;\n}(PointSymbolizer);\n\nTextMarkerSymbolizer.CACHE_KEY = CACHE_KEY;\n\nfunction genCacheKey(textContent, style) {\n  var key = [textContent];\n\n  for (var p in style) {\n    if (style.hasOwnProperty(p) && p.length > 4 && p.substring(0, 4) === 'text') {\n      key.push(p + '=' + style[p]);\n    }\n  }\n\n  return key.join('-');\n}\n\nvar VectorPathMarkerSymbolizer = function (_ImageMarkerSymbolize) {\n  _inheritsLoose(VectorPathMarkerSymbolizer, _ImageMarkerSymbolize);\n\n  VectorPathMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (isNil(symbol['markerFile']) && symbol['markerType'] === 'path') {\n      return true;\n    }\n\n    return false;\n  };\n\n  function VectorPathMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    if (isNil(symbol['markerWidth'])) {\n      symbol['markerWidth'] = 80;\n    }\n\n    if (isNil(symbol['markerHeight'])) {\n      symbol['markerHeight'] = 80;\n    }\n\n    _this = _ImageMarkerSymbolize.call(this, symbol, geometry, painter) || this;\n    symbol = extend(symbol, _this.translate());\n\n    var style = _this.style = _this._defineStyle(symbol);\n\n    if (Browser$1.gecko) {\n      _this._url = [getMarkerPathBase64(style, style['markerWidth'], style['markerHeight']), style['markerWidth'], style['markerHeight']];\n    } else {\n      _this._url = [getMarkerPathBase64(style), style['markerWidth'], style['markerHeight']];\n    }\n\n    return _this;\n  }\n\n  var _proto = VectorPathMarkerSymbolizer.prototype;\n\n  _proto._prepareContext = function _prepareContext() {};\n\n  _proto._getImage = function _getImage(resources) {\n    var _this2 = this;\n\n    if (resources && resources.isResourceLoaded(this._url)) {\n      return resources.getImage(this._url);\n    }\n\n    var painter = this.painter;\n    var image = new Image();\n\n    image.onload = function () {\n      var renderer = painter.getLayer() && painter.getLayer().getRenderer();\n\n      if (renderer) {\n        renderer.setToRedraw();\n      }\n    };\n\n    image.onerror = function (err) {\n      if (err && typeof console !== 'undefined') {\n        console.warn(err);\n      }\n\n      resources.markErrorResource(_this2._url);\n    };\n\n    image.src = this._url[0];\n\n    if (resources) {\n      resources.addResource(this._url, image);\n    }\n\n    return image;\n  };\n\n  return VectorPathMarkerSymbolizer;\n}(ImageMarkerSymbolizer);\n\nvar defaultSymbol = {\n  lineWidth: 1,\n  polygonFill: '#fff',\n  polygonOpacity: 0.5\n};\n\nvar DrawAltitudeSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(DrawAltitudeSymbolizer, _PointSymbolizer);\n\n  DrawAltitudeSymbolizer.test = function test(symbol, geometry) {\n    var layer = geometry.getLayer();\n\n    if (!layer) {\n      return false;\n    }\n\n    var type = geometry.getJSONType();\n    return type === 'Marker' || type === 'LineString';\n  };\n\n  function DrawAltitudeSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this.style = geometry.getLayer().options['drawAltitude'];\n\n    if (!_this.style || !isObject(_this.style)) {\n      _this.style = {\n        'lineWidth': 2\n      };\n    }\n\n    if (!_this.style['lineWidth']) {\n      _this.style['lineWidth'] = 0;\n    }\n\n    _this.dxdy = _this._defineStyle({\n      'dx': symbol['textDx'] || symbol['markerDx'],\n      'dy': symbol['textDy'] || symbol['markerDy']\n    });\n    return _this;\n  }\n\n  var _proto = DrawAltitudeSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx) {\n    var layer = this.geometry.getLayer();\n\n    if (!layer.options['drawAltitude']) {\n      return;\n    }\n\n    var properties = this.geometry.getProperties();\n\n    if (!properties || !properties[layer.options['altitudeProperty']]) {\n      return;\n    }\n\n    var style = this._getStyle();\n\n    this._prepareContext(ctx);\n\n    if (this.geometry.type === 'LineString') {\n      var paintParams = this._getPaintParams(style['lineDx'], style['lineDy']);\n\n      if (!paintParams) {\n        return;\n      }\n\n      var groundPoints = this.getPainter().getPaintParams(style['lineDx'], style['lineDy'], true)[0];\n\n      this._drawLineAltitude(ctx, paintParams[0], groundPoints);\n    } else {\n      var point = this._getRenderContainerPoints(),\n          groundPoint = this._getRenderContainerPoints(true);\n\n      if (!point || point.length === 0) {\n        return;\n      }\n\n      this._drawMarkerAltitude(ctx, point[0], groundPoint[0]);\n    }\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.dxdy;\n    return new Point(s['dx'] || 0, s['dy'] || 0);\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    if (this.geometry.type === 'LineString') {\n      return StrokeAndFillSymbolizer.prototype.get2DExtent.apply(this);\n    } else {\n      return _PointSymbolizer.prototype.get2DExtent.call(this);\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return 'point';\n  };\n\n  _proto._getPaintParams = function _getPaintParams(dx, dy) {\n    return this.getPainter().getPaintParams(dx || 0, dy || 0);\n  };\n\n  _proto._drawMarkerAltitude = function _drawMarkerAltitude(ctx, point, groundPoint) {\n    var style = this._getStyle();\n\n    this.prepareCanvas(ctx, style);\n    Canvas.path(ctx, [point, groundPoint], style['lineOpacity'], null, style['lineDasharray']);\n  };\n\n  _proto._drawLineAltitude = function _drawLineAltitude(ctx, points, groundPoints) {\n    var style = this._getStyle();\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      for (var i = 0; i < points.length; i++) {\n        this._drawLine(ctx, points[i], groundPoints[i]);\n      }\n    } else {\n      this._drawLine(ctx, points, groundPoints);\n    }\n\n    if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n      ctx.setLineDash([]);\n    }\n  };\n\n  _proto._drawLine = function _drawLine(ctx, points, groundPoints) {\n    var style = this._getStyle();\n\n    this.prepareCanvas(ctx, style);\n\n    for (var i = 0, l = points.length - 1; i < l; i++) {\n      Canvas.polygon(ctx, [points[i], points[i + 1], groundPoints[i + 1], groundPoints[i]], style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n    }\n  };\n\n  _proto._getStyle = function _getStyle() {\n    var style = this.geometry.getLayer().options['drawAltitude'];\n\n    if (!isObject(style)) {\n      style = defaultSymbol;\n    }\n\n    if (!style['lineWidth']) {\n      style['lineWidth'] = 0;\n      style['lineOpacity'] = 0;\n    }\n\n    return style;\n  };\n\n  return DrawAltitudeSymbolizer;\n}(PointSymbolizer);\n\nvar index$3 =\n/*#__PURE__*/\nObject.freeze({\n  Symbolizer: Symbolizer,\n  CanvasSymbolizer: CanvasSymbolizer,\n  DebugSymbolizer: DebugSymbolizer,\n  ImageMarkerSymbolizer: ImageMarkerSymbolizer,\n  PointSymbolizer: PointSymbolizer,\n  StrokeAndFillSymbolizer: StrokeAndFillSymbolizer,\n  TextMarkerSymbolizer: TextMarkerSymbolizer,\n  VectorMarkerSymbolizer: VectorMarkerSymbolizer,\n  VectorPathMarkerSymbolizer: VectorPathMarkerSymbolizer,\n  DrawAltitudeSymbolizer: DrawAltitudeSymbolizer\n});\nvar registerSymbolizers = [DrawAltitudeSymbolizer, StrokeAndFillSymbolizer, ImageMarkerSymbolizer, VectorPathMarkerSymbolizer, VectorMarkerSymbolizer, TextMarkerSymbolizer];\nvar testCanvas;\nvar TEMP_POINT0$2 = new Point(0, 0);\nvar TEMP_PAINT_EXTENT = new PointExtent();\nvar TEMP_EXTENT$1 = new PointExtent();\nvar TEMP_FIXED_EXTENT = new PointExtent();\nvar TEMP_CLIP_EXTENT0 = new PointExtent();\nvar TEMP_CLIP_EXTENT1 = new PointExtent();\n\nvar Painter = function (_Class) {\n  _inheritsLoose(Painter, _Class);\n\n  function Painter(geometry) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.geometry = geometry;\n    _this.symbolizers = _this._createSymbolizers();\n    _this._altAtGLZoom = _this._getGeometryAltitude();\n    return _this;\n  }\n\n  var _proto = Painter.prototype;\n\n  _proto.getMap = function getMap() {\n    return this.geometry.getMap();\n  };\n\n  _proto.getLayer = function getLayer() {\n    return this.geometry.getLayer();\n  };\n\n  _proto._createSymbolizers = function _createSymbolizers() {\n    var geoSymbol = this.getSymbol(),\n        symbolizers = [],\n        regSymbolizers = registerSymbolizers;\n    var symbols = geoSymbol;\n\n    if (!Array.isArray(geoSymbol)) {\n      symbols = [geoSymbol];\n    }\n\n    for (var ii = symbols.length - 1; ii >= 0; ii--) {\n      var symbol = symbols[ii];\n\n      for (var i = regSymbolizers.length - 1; i >= 0; i--) {\n        if (regSymbolizers[i].test(symbol, this.geometry)) {\n          var symbolizer = new regSymbolizers[i](symbol, this.geometry, this);\n          symbolizers.push(symbolizer);\n\n          if (symbolizer instanceof PointSymbolizer) {\n            this._hasPoint = true;\n          }\n        }\n      }\n    }\n\n    if (!symbolizers.length) {\n      if (console) {\n        var id = this.geometry.getId();\n        console.warn('invalid symbol for geometry(' + (this.geometry ? this.geometry.getType() + (id ? ':' + id : '') : '') + ') to draw : ' + JSON.stringify(geoSymbol));\n      }\n    }\n\n    this._debugSymbolizer = new DebugSymbolizer(geoSymbol, this.geometry, this);\n    return symbolizers;\n  };\n\n  _proto.hasPoint = function hasPoint() {\n    return !!this._hasPoint;\n  };\n\n  _proto.getRenderPoints = function getRenderPoints(placement) {\n    if (!this._renderPoints) {\n      this._renderPoints = {};\n    }\n\n    if (!placement) {\n      placement = 'center';\n    }\n\n    if (!this._renderPoints[placement]) {\n      this._renderPoints[placement] = this.geometry._getRenderPoints(placement);\n    }\n\n    return this._renderPoints[placement];\n  };\n\n  _proto.getPaintParams = function getPaintParams(dx, dy, ignoreAltitude) {\n    var map = this.getMap(),\n        geometry = this.geometry,\n        res = map.getResolution(),\n        pitched = map.getPitch() !== 0,\n        rotated = map.getBearing() !== 0;\n    var params = this._cachedParams;\n\n    var paintAsPath = geometry._paintAsPath && geometry._paintAsPath();\n\n    if (paintAsPath && this._unsimpledParams && res <= this._unsimpledParams._res) {\n      params = this._unsimpledParams;\n    } else if (!params || params._res !== map.getResolution() || this._pitched !== pitched && geometry._redrawWhenPitch() || this._rotated !== rotated && geometry._redrawWhenRotate()) {\n      params = geometry._getPaintParams();\n\n      if (!params) {\n        return null;\n      }\n\n      params._res = res;\n\n      if (!geometry._simplified && paintAsPath) {\n        if (!this._unsimpledParams) {\n          this._unsimpledParams = params;\n        }\n\n        if (res > this._unsimpledParams._res) {\n          this._unsimpledParams._res = res;\n        }\n      }\n\n      this._cachedParams = params;\n    }\n\n    if (!params) {\n      return null;\n    }\n\n    this._pitched = pitched;\n    this._rotated = rotated;\n    var zoomScale = map.getGLScale(),\n        tr = [],\n        points = params[0];\n    var mapExtent = map.getContainerExtent();\n\n    var cPoints = this._pointContainerPoints(points, dx, dy, ignoreAltitude, this._hitPoint && !mapExtent.contains(this._hitPoint));\n\n    if (!cPoints) {\n      return null;\n    }\n\n    tr.push(cPoints);\n\n    for (var i = 1, l = params.length; i < l; i++) {\n      if (isNumber(params[i]) || params[i] instanceof Size) {\n        if (isNumber(params[i])) {\n          tr.push(params[i] / zoomScale);\n        } else {\n          tr.push(params[i].multi(1 / zoomScale));\n        }\n      } else {\n        tr.push(params[i]);\n      }\n    }\n\n    return tr;\n  };\n\n  _proto._pointContainerPoints = function _pointContainerPoints(points, dx, dy, ignoreAltitude, disableClip, pointPlacement) {\n    if (this._aboveCamera()) {\n      return null;\n    }\n\n    var map = this.getMap(),\n        glZoom = map.getGLZoom(),\n        containerOffset = this.containerOffset;\n    var cPoints;\n\n    function pointContainerPoint(point, alt) {\n      var p = map._pointToContainerPoint(point, glZoom, alt)._sub(containerOffset);\n\n      if (dx || dy) {\n        p._add(dx || 0, dy || 0);\n      }\n\n      return p;\n    }\n\n    var altitude = this.getAltitude();\n\n    if (Array.isArray(points)) {\n      var geometry = this.geometry;\n      var clipped;\n\n      if (!disableClip && geometry.options['enableClip']) {\n        clipped = this._clip(points, altitude);\n      } else {\n        clipped = {\n          points: points,\n          altitude: altitude\n        };\n      }\n\n      var clipPoints = clipped.points;\n      altitude = clipped.altitude;\n\n      if (ignoreAltitude) {\n        altitude = 0;\n      }\n\n      var alt = altitude;\n      cPoints = [];\n\n      for (var i = 0, l = clipPoints.length; i < l; i++) {\n        var c = clipPoints[i];\n\n        if (Array.isArray(c)) {\n          var cring = [];\n\n          for (var ii = 0, ll = c.length; ii < ll; ii++) {\n            var cc = c[ii];\n\n            if (Array.isArray(altitude)) {\n              if (altitude[i]) {\n                alt = altitude[i][ii];\n              } else {\n                alt = 0;\n              }\n            }\n\n            cring.push(pointContainerPoint(cc, alt));\n          }\n\n          cPoints.push(cring);\n        } else {\n          if (Array.isArray(altitude)) {\n            if (pointPlacement === 'vertex-last') {\n              alt = altitude[altitude.length - 1 - i];\n            } else if (pointPlacement === 'line') {\n              alt = (altitude[i] + altitude[i + 1]) / 2;\n            } else {\n              alt = altitude[i];\n            }\n          }\n\n          cPoints.push(pointContainerPoint(c, alt));\n        }\n      }\n    } else if (points instanceof Point) {\n      if (ignoreAltitude) {\n        altitude = 0;\n      }\n\n      cPoints = map._pointToContainerPoint(points, glZoom, altitude)._sub(containerOffset);\n\n      if (dx || dy) {\n        cPoints._add(dx, dy);\n      }\n    }\n\n    return cPoints;\n  };\n\n  _proto._clip = function _clip(points, altitude) {\n    var map = this.getMap(),\n        geometry = this.geometry;\n    var lineWidth = this.getSymbol()['lineWidth'];\n\n    if (!isNumber(lineWidth)) {\n      lineWidth = 4;\n    }\n\n    var extent2D = map._get2DExtent(undefined, TEMP_CLIP_EXTENT0)._expand(lineWidth);\n\n    if (map.getPitch() > 0 && altitude) {\n      var c = map.cameraLookAt;\n      var pos = map.cameraPosition;\n      TEMP_POINT0$2.set(pos.x, pos.y);\n      extent2D = extent2D._combine(TEMP_POINT0$2._add(sign(c[0] - pos[0]), sign(c[1] - pos[1])));\n    }\n\n    var e = this.get2DExtent(null, TEMP_CLIP_EXTENT1);\n    var clipPoints = points;\n\n    if (e.within(extent2D)) {\n      return {\n        points: clipPoints,\n        altitude: altitude\n      };\n    }\n\n    var glExtent2D = map._get2DExtent(map.getGLZoom(), TEMP_CLIP_EXTENT0)._expand(lineWidth * map._glScale);\n\n    var smoothness = geometry.options['smoothness'];\n\n    if (geometry.getShell && this.geometry.getHoles && !smoothness) {\n      if (!Array.isArray(points[0])) {\n        clipPoints = clipPolygon(points, glExtent2D);\n      } else {\n        clipPoints = [];\n\n        for (var i = 0; i < points.length; i++) {\n          var part = clipPolygon(points[i], glExtent2D);\n\n          if (part.length) {\n            clipPoints.push(part);\n          }\n        }\n      }\n    } else if (geometry.getJSONType() === 'LineString' && !smoothness) {\n      if (!Array.isArray(points[0])) {\n        clipPoints = clipLine(points, glExtent2D, false, !!smoothness);\n      } else {\n        clipPoints = [];\n\n        for (var _i = 0; _i < points.length; _i++) {\n          pushIn(clipPoints, clipLine(points[_i], glExtent2D, false, !!smoothness));\n        }\n      }\n\n      return this._interpolateSegAlt(clipPoints, points, altitude);\n    }\n\n    return {\n      points: clipPoints,\n      altitude: altitude\n    };\n  };\n\n  _proto._interpolateSegAlt = function _interpolateSegAlt(clipSegs, orig, altitude) {\n    if (!Array.isArray(altitude)) {\n      var fn = function fn(cc) {\n        return cc.point;\n      };\n\n      return {\n        points: clipSegs.map(function (c) {\n          if (Array.isArray(c)) {\n            return c.map(fn);\n          }\n\n          return c.point;\n        }),\n        altitude: altitude\n      };\n    }\n\n    var segsWithAlt = interpolateAlt(clipSegs, orig, altitude);\n    altitude = [];\n    var points = segsWithAlt.map(function (p) {\n      if (Array.isArray(p)) {\n        var alt = [];\n        var cp = p.map(function (pp) {\n          alt.push(pp.altitude);\n          return pp.point;\n        });\n        altitude.push(alt);\n        return cp;\n      }\n\n      altitude.push(p.altitude);\n      return p.point;\n    });\n    return {\n      points: points,\n      altitude: altitude\n    };\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    return this.geometry._getInternalSymbol();\n  };\n\n  _proto.paint = function paint(extent, context, offset) {\n    if (!this.symbolizers) {\n      return;\n    }\n\n    var renderer = this.getLayer()._getRenderer();\n\n    if (!renderer || !renderer.context && !context) {\n      return;\n    }\n\n    if (extent && !extent.intersects(this.get2DExtent(renderer.resources, TEMP_PAINT_EXTENT))) {\n      return;\n    }\n\n    var map = this.getMap();\n    var minAltitude = this.getMinAltitude();\n    var frustumAlt = map.getFrustumAltitude();\n\n    if (minAltitude && frustumAlt && frustumAlt < minAltitude) {\n      return;\n    }\n\n    this.containerOffset = offset || map._pointToContainerPoint(renderer.southWest)._add(0, -map.height);\n\n    this._beforePaint();\n\n    var ctx = context || renderer.context;\n    var contexts = [ctx, renderer.resources];\n\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      this._prepareShadow(ctx, this.symbolizers[i].symbol);\n\n      this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n    }\n\n    this._afterPaint();\n\n    this._painted = true;\n\n    this._debugSymbolizer.symbolize.apply(this._debugSymbolizer, contexts);\n  };\n\n  _proto.getSprite = function getSprite(resources, canvasClass) {\n    if (this.geometry.type !== 'Point') {\n      return null;\n    }\n\n    this._spriting = true;\n\n    if (!this._sprite && this.symbolizers.length > 0) {\n      var extent = new PointExtent();\n      this.symbolizers.forEach(function (s) {\n        var markerExtent = s.getFixedExtent(resources);\n\n        extent._combine(markerExtent);\n      });\n      var origin = extent.getMin().multi(-1);\n      var clazz = canvasClass || (this.getMap() ? this.getMap().CanvasClass : null);\n      var canvas = Canvas.createCanvas(extent.getWidth(), extent.getHeight(), clazz);\n      var bak;\n\n      if (this._renderPoints) {\n        bak = this._renderPoints;\n      }\n\n      var ctx = canvas.getContext('2d');\n      var contexts = [ctx, resources];\n\n      for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n        var dxdy = this.symbolizers[i].getDxDy();\n        this._renderPoints = {\n          'center': [[origin.add(dxdy)]]\n        };\n\n        this._prepareShadow(ctx, this.symbolizers[i].symbol);\n\n        this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n      }\n\n      if (bak) {\n        this._renderPoints = bak;\n      }\n\n      this._sprite = {\n        'canvas': canvas,\n        'offset': extent.getCenter()\n      };\n    }\n\n    this._spriting = false;\n    return this._sprite;\n  };\n\n  _proto.isSpriting = function isSpriting() {\n    return !!this._spriting;\n  };\n\n  _proto.hitTest = function hitTest(cp, tolerance) {\n    if (!tolerance || tolerance < 0.5) {\n      tolerance = 0.5;\n    }\n\n    if (!testCanvas) {\n      testCanvas = Canvas.createCanvas(1, 1);\n    }\n\n    Canvas.setHitTesting(true);\n    testCanvas.width = testCanvas.height = 2 * tolerance;\n    var ctx = testCanvas.getContext('2d');\n    this._hitPoint = cp.sub(tolerance, tolerance);\n\n    try {\n      this.paint(null, ctx, this._hitPoint);\n    } catch (e) {\n      throw e;\n    } finally {\n      Canvas.setHitTesting(false);\n    }\n\n    delete this._hitPoint;\n    var imgData = ctx.getImageData(0, 0, testCanvas.width, testCanvas.height).data;\n\n    for (var i = 3, l = imgData.length; i < l; i += 4) {\n      if (imgData[i] > 0) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.isHitTesting = function isHitTesting() {\n    return !!this._hitPoint;\n  };\n\n  _proto._prepareShadow = function _prepareShadow(ctx, symbol) {\n    if (symbol['shadowBlur']) {\n      ctx.shadowBlur = this.isHitTesting() ? 0 : symbol['shadowBlur'];\n      ctx.shadowColor = symbol['shadowColor'] || '#000';\n      ctx.shadowOffsetX = symbol['shadowOffsetX'] || 0;\n      ctx.shadowOffsetY = symbol['shadowOffsetY'] || 0;\n    } else if (ctx.shadowBlur) {\n      ctx.shadowBlur = null;\n      ctx.shadowColor = null;\n      ctx.shadowOffsetX = null;\n      ctx.shadowOffsetY = null;\n    }\n  };\n\n  _proto._eachSymbolizer = function _eachSymbolizer(fn, context) {\n    if (!this.symbolizers) {\n      return;\n    }\n\n    if (!context) {\n      context = this;\n    }\n\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      fn.apply(context, [this.symbolizers[i]]);\n    }\n  };\n\n  _proto.get2DExtent = function get2DExtent(resources, out) {\n    this._verifyProjection();\n\n    var map = this.getMap();\n    resources = resources || this.getLayer()._getRenderer().resources;\n    var zoom = map.getZoom();\n\n    var isDynamicSize = this._isDynamicSize();\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom || !this._fixedExtent) {\n      if (this._extent2D && this._extent2D._zoom !== zoom) {\n        delete this._extent2D;\n      }\n\n      if (this.symbolizers) {\n        if (!this._extent2D) {\n          this._extent2D = this._computeExtent2D(new PointExtent());\n          this._extent2D._zoom = zoom;\n        }\n\n        if (!this._fixedExtent) {\n          this._fixedExtent = this._computeFixedExtent(resources, new PointExtent());\n        }\n      }\n    }\n\n    if (!this._extent2D) {\n      if (isDynamicSize) {\n        delete this._fixedExtent;\n      }\n\n      return null;\n    }\n\n    var _this$_fixedExtent = this._fixedExtent,\n        xmin = _this$_fixedExtent.xmin,\n        ymin = _this$_fixedExtent.ymin,\n        xmax = _this$_fixedExtent.xmax,\n        ymax = _this$_fixedExtent.ymax;\n\n    if (isDynamicSize) {\n      delete this._fixedExtent;\n    }\n\n    TEMP_FIXED_EXTENT.set(xmin, -ymax, xmax, -ymin);\n\n    if (out) {\n      out.set(this._extent2D['xmin'], this._extent2D['ymin'], this._extent2D['xmax'], this._extent2D['ymax']);\n\n      out._add(TEMP_FIXED_EXTENT);\n\n      return out;\n    }\n\n    return this._extent2D.add(TEMP_FIXED_EXTENT);\n  };\n\n  _proto._computeExtent2D = function _computeExtent2D(extent) {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      extent._combine(symbolizer.get2DExtent());\n    }\n\n    return extent;\n  };\n\n  _proto._computeFixedExtent = function _computeFixedExtent(resources, extent) {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      if (symbolizer.getFixedExtent) {\n        extent._combine(symbolizer.getFixedExtent(resources));\n      }\n    }\n\n    return extent;\n  };\n\n  _proto._isDynamicSize = function _isDynamicSize() {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      if (symbolizer.isDynamicSize()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.getContainerExtent = function getContainerExtent(out) {\n    if (this._aboveCamera()) {\n      return null;\n    }\n\n    this._verifyProjection();\n\n    var map = this.getMap();\n    var zoom = map.getZoom();\n    var glScale = map._glScale;\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom) {\n      this.get2DExtent(null, TEMP_EXTENT$1);\n    }\n\n    var altitude = this.getMinAltitude();\n\n    var extent = this._extent2D.convertTo(function (c) {\n      return map._pointToContainerPoint(c, zoom, altitude / glScale, TEMP_POINT0$2);\n    }, out);\n\n    var maxAltitude = this.getMaxAltitude();\n\n    if (maxAltitude !== altitude) {\n      var extent2 = this._extent2D.convertTo(function (c) {\n        return map._pointToContainerPoint(c, zoom, maxAltitude / glScale, TEMP_POINT0$2);\n      }, TEMP_EXTENT$1);\n\n      extent._combine(extent2);\n    }\n\n    var layer = this.geometry.getLayer();\n\n    if (this.geometry.type === 'LineString' && maxAltitude && layer.options['drawAltitude']) {\n      var groundExtent = this._extent2D.convertTo(function (c) {\n        return map._pointToContainerPoint(c, zoom, 0, TEMP_POINT0$2);\n      }, TEMP_EXTENT$1);\n\n      extent._combine(groundExtent);\n    }\n\n    if (extent) {\n      extent._add(this._fixedExtent || this._computeFixedExtent(null, new PointExtent()));\n    }\n\n    var smoothness = this.geometry.options['smoothness'];\n\n    if (smoothness) {\n      extent._expand(extent.getWidth() * 0.15);\n    }\n\n    return extent;\n  };\n\n  _proto._aboveCamera = function _aboveCamera() {\n    var altitude = this.getMinAltitude();\n    var map = this.getMap();\n    var frustumAlt = map.getFrustumAltitude();\n    return altitude && frustumAlt && frustumAlt < altitude;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var map = this.getMap();\n    var zoom = map.getZoom();\n\n    if (this._isDynamicSize()) {\n      return this._computeFixedExtent(null, new PointExtent());\n    }\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom) {\n      this.get2DExtent(null, TEMP_FIXED_EXTENT);\n    }\n\n    return this._fixedExtent;\n  };\n\n  _proto.setZIndex = function setZIndex(change) {\n    this._eachSymbolizer(function (symbolizer) {\n      symbolizer.setZIndex(change);\n    });\n  };\n\n  _proto.show = function show() {\n    if (!this._painted) {\n      var layer = this.getLayer();\n\n      if (!layer.isCanvasRender()) {\n        this.paint();\n      }\n    } else {\n      this.removeCache();\n\n      this._eachSymbolizer(function (symbolizer) {\n        symbolizer.show();\n      });\n    }\n  };\n\n  _proto.hide = function hide() {\n    this._eachSymbolizer(function (symbolizer) {\n      symbolizer.hide();\n    });\n  };\n\n  _proto.repaint = function repaint() {\n    this._altAtGLZoom = this._getGeometryAltitude();\n    this.removeCache();\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return;\n    }\n\n    var renderer = layer.getRenderer();\n\n    if (!renderer || !renderer.setToRedraw()) {\n      return;\n    }\n\n    renderer.setToRedraw();\n  };\n\n  _proto.refreshSymbol = function refreshSymbol() {\n    this.removeCache();\n\n    this._removeSymbolizers();\n\n    this.symbolizers = this._createSymbolizers();\n  };\n\n  _proto.remove = function remove() {\n    this.removeCache();\n\n    this._removeSymbolizers();\n  };\n\n  _proto._removeSymbolizers = function _removeSymbolizers() {\n    this._eachSymbolizer(function (symbolizer) {\n      delete symbolizer.painter;\n      symbolizer.remove();\n    });\n\n    delete this.symbolizers;\n  };\n\n  _proto.removeCache = function removeCache() {\n    delete this._renderPoints;\n    delete this._paintParams;\n    delete this._sprite;\n    delete this._extent2D;\n    delete this._fixedExtent;\n    delete this._cachedParams;\n    delete this._unsimpledParams;\n\n    if (this.geometry) {\n      delete this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n    }\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    var propAlt = this.geometry.getAltitude();\n\n    if (propAlt !== this._propAlt) {\n      this._altAtGLZoom = this._getGeometryAltitude();\n    }\n\n    if (!this._altAtGLZoom) {\n      return 0;\n    }\n\n    return this._altAtGLZoom;\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    if (!this.minAltitude) {\n      return 0;\n    }\n\n    return this.minAltitude;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    if (!this.maxAltitude) {\n      return 0;\n    }\n\n    return this.maxAltitude;\n  };\n\n  _proto._getGeometryAltitude = function _getGeometryAltitude() {\n    var _this2 = this;\n\n    var map = this.getMap();\n\n    if (!map) {\n      return 0;\n    }\n\n    var altitude = this.geometry.getAltitude();\n    this._propAlt = altitude;\n\n    if (!altitude) {\n      this.minAltitude = this.maxAltitude = 0;\n      return 0;\n    }\n\n    var center = this.geometry.getCenter();\n\n    if (!center) {\n      return 0;\n    }\n\n    if (Array.isArray(altitude)) {\n      this.minAltitude = Number.MAX_VALUE;\n      this.maxAltitude = Number.MIN_VALUE;\n      return altitude.map(function (alt) {\n        var a = _this2._meterToPoint(center, alt);\n\n        if (a < _this2.minAltitude) {\n          _this2.minAltitude = a;\n        }\n\n        if (a > _this2.maxAltitude) {\n          _this2.maxAltitude = a;\n        }\n\n        return a;\n      });\n    } else {\n      this.minAltitude = this.maxAltitude = this._meterToPoint(center, altitude);\n      return this.minAltitude;\n    }\n  };\n\n  _proto._meterToPoint = function _meterToPoint(center, altitude) {\n    var map = this.getMap();\n    var z = map.getGLZoom();\n    return map.distanceToPoint(altitude, 0, z, center).x * sign(altitude);\n  };\n\n  _proto._verifyProjection = function _verifyProjection() {\n    var projection = this.geometry._getProjection();\n\n    if (this._projCode && this._projCode !== projection.code) {\n      this.removeCache();\n    }\n\n    this._projCode = projection.code;\n  };\n\n  _proto._beforePaint = function _beforePaint() {\n    var textcache = this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n\n    if (!textcache) {\n      return;\n    }\n\n    for (var p in textcache) {\n      if (hasOwn(textcache, p)) {\n        textcache[p].active = false;\n      }\n    }\n  };\n\n  _proto._afterPaint = function _afterPaint() {\n    var textcache = this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n\n    if (!textcache) {\n      return;\n    }\n\n    for (var p in textcache) {\n      if (hasOwn(textcache, p)) {\n        if (!textcache[p].active) {\n          delete textcache[p];\n        }\n      }\n    }\n  };\n\n  return Painter;\n}(Class);\n\nfunction interpolateAlt(points, orig, altitude) {\n  if (!Array.isArray(altitude)) {\n    return points;\n  }\n\n  var parts = [];\n\n  for (var i = 0, l = points.length; i < l; i++) {\n    if (Array.isArray(points[i])) {\n      parts.push(interpolateAlt(points[i], orig, altitude));\n    } else {\n      var p = points[i];\n\n      if (!p.point.equals(orig[p.index])) {\n        var w0 = void 0,\n            w1 = void 0;\n\n        if (p.index === 0) {\n          w0 = p.index;\n          w1 = p.index + 1;\n        } else {\n          w0 = p.index - 1;\n          w1 = p.index;\n        }\n\n        var t0 = p.point.distanceTo(orig[w1]);\n        var t = t0 / (t0 + orig[w0].distanceTo(p.point));\n        var alt = interpolate(altitude[w0], altitude[w1], 1 - t);\n        p.altitude = alt;\n        parts.push(p);\n      } else {\n        p.altitude = altitude[p.index];\n        parts.push(p);\n      }\n    }\n  }\n\n  return parts;\n}\n\nvar TEMP_EXTENT$2 = new PointExtent();\n\nvar CollectionPainter = function (_Class) {\n  _inheritsLoose(CollectionPainter, _Class);\n\n  function CollectionPainter(geometry) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.geometry = geometry;\n    return _this;\n  }\n\n  var _proto = CollectionPainter.prototype;\n\n  _proto._eachPainter = function _eachPainter(fn) {\n    var geometries = this.geometry.getGeometries();\n    var painter;\n\n    for (var i = 0, len = geometries.length; i < len; i++) {\n      painter = geometries[i]._getPainter();\n\n      if (!painter) {\n        continue;\n      }\n\n      if (painter) {\n        if (fn.call(this, painter) === false) {\n          break;\n        }\n      }\n    }\n  };\n\n  _proto.paint = function paint(extent) {\n    if (!this.geometry) {\n      return;\n    }\n\n    this._eachPainter(function (painter) {\n      painter.paint(extent);\n    });\n  };\n\n  _proto.get2DExtent = function get2DExtent(resources, out) {\n    if (out) {\n      out.set(null, null, null, null);\n    }\n\n    var extent = out || new PointExtent();\n\n    this._eachPainter(function (painter) {\n      extent = extent._combine(painter.get2DExtent(resources, TEMP_EXTENT$2));\n    });\n\n    return extent;\n  };\n\n  _proto.getContainerExtent = function getContainerExtent() {\n    var extent = new PointExtent();\n\n    this._eachPainter(function (painter) {\n      extent = extent.combine(painter.getContainerExtent());\n    });\n\n    return extent;\n  };\n\n  _proto.remove = function remove() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.remove.apply(painter, args);\n    });\n  };\n\n  _proto.setZIndex = function setZIndex() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.setZIndex.apply(painter, args);\n    });\n  };\n\n  _proto.show = function show() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.show.apply(painter, args);\n    });\n  };\n\n  _proto.hide = function hide() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.hide.apply(painter, args);\n    });\n  };\n\n  _proto.repaint = function repaint() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.repaint.apply(painter, args);\n    });\n  };\n\n  _proto.refreshSymbol = function refreshSymbol() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.refreshSymbol.apply(painter, args);\n    });\n  };\n\n  _proto.hasPoint = function hasPoint() {\n    var result = false;\n\n    this._eachPainter(function (painter) {\n      if (painter.hasPoint()) {\n        result = true;\n        return false;\n      }\n\n      return true;\n    });\n\n    return result;\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    var first = true;\n    var result = 0;\n\n    this._eachPainter(function (painter) {\n      var alt = painter.getMinAltitude();\n\n      if (first || alt < result) {\n        first = false;\n        result = alt;\n      }\n    });\n\n    return result;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    var result = 0;\n\n    this._eachPainter(function (painter) {\n      var alt = painter.getMaxAltitude();\n\n      if (alt > result) {\n        result = alt;\n      }\n    });\n\n    return result;\n  };\n\n  return CollectionPainter;\n}(Class);\n\nvar DefaultSpatialReference = {\n  'EPSG:3857': {\n    'resolutions': function () {\n      var resolutions = [];\n      var d = 2 * 6378137 * Math.PI;\n\n      for (var i = 0; i < 21; i++) {\n        resolutions[i] = d / (256 * Math.pow(2, i));\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 6378137 * Math.PI,\n      'left': -6378137 * Math.PI,\n      'bottom': -6378137 * Math.PI,\n      'right': 6378137 * Math.PI\n    }\n  },\n  'EPSG:4326': {\n    'fullExtent': {\n      'top': 90,\n      'left': -180,\n      'bottom': -90,\n      'right': 180\n    },\n    'resolutions': function () {\n      var resolutions = [];\n\n      for (var i = 0; i < 20; i++) {\n        resolutions[i] = 180 / (Math.pow(2, i) * 128);\n      }\n\n      return resolutions;\n    }()\n  },\n  'BAIDU': {\n    'resolutions': function () {\n      var res = Math.pow(2, 18);\n      var resolutions = [];\n\n      for (var i = 0; i < 20; i++) {\n        resolutions[i] = res;\n        res *= 0.5;\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 33554432,\n      'left': -33554432,\n      'bottom': -33554432,\n      'right': 33554432\n    }\n  },\n  'IDENTITY': {\n    'resolutions': function () {\n      var res = Math.pow(2, 8);\n      var resolutions = [];\n\n      for (var i = 0; i < 18; i++) {\n        resolutions[i] = res;\n        res *= 0.5;\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 200000,\n      'left': -200000,\n      'bottom': -200000,\n      'right': 200000\n    }\n  }\n};\nDefaultSpatialReference['EPSG:4490'] = DefaultSpatialReference['EPSG:4326'];\n\nvar SpatialReference = function () {\n  function SpatialReference(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.options = options;\n\n    this._initSpatialRef();\n  }\n\n  SpatialReference.getProjectionInstance = function getProjectionInstance(prjName) {\n    if (!prjName) {\n      return null;\n    }\n\n    if (isObject(prjName)) {\n      return prjName;\n    }\n\n    prjName = (prjName + '').toLowerCase();\n\n    for (var p in projections) {\n      if (hasOwn(projections, p)) {\n        var code = projections[p]['code'];\n\n        if (code && code.toLowerCase() === prjName) {\n          return projections[p];\n        }\n      }\n    }\n\n    return null;\n  };\n\n  SpatialReference.equals = function equals(sp1, sp2) {\n    if (!sp1 && !sp2) {\n      return true;\n    } else if (!sp1 || !sp2) {\n      return false;\n    }\n\n    if (sp1.projection !== sp2.projection) {\n      return false;\n    }\n\n    var f1 = sp1.fullExtent,\n        f2 = sp2.fullExtent;\n\n    if (f1 && !f2 || !f1 && f2) {\n      return false;\n    }\n\n    if (f1 && f2) {\n      if (f1.top !== f2.top || f1.bottom !== f2.bottom || f1.left !== f2.left || f1.right !== f2.right) {\n        return false;\n      }\n    }\n\n    var r1 = sp1.resolutions,\n        r2 = sp2.resolutions;\n\n    if (r1 && r2) {\n      if (r1.length !== r2.length) {\n        return false;\n      }\n\n      for (var i = 0; i < r1.length; i++) {\n        if (r1[i] !== r2[i]) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  };\n\n  var _proto = SpatialReference.prototype;\n\n  _proto._initSpatialRef = function _initSpatialRef() {\n    var projection = this.options['projection'];\n\n    if (projection) {\n      projection = SpatialReference.getProjectionInstance(projection);\n    } else {\n      projection = DEFAULT$1;\n    }\n\n    if (!projection) {\n      throw new Error('must provide a valid projection in map\\'s spatial reference.');\n    }\n\n    projection = extend({}, Common, projection);\n\n    if (!projection.measureLength) {\n      extend(projection, Measurer.DEFAULT);\n    }\n\n    this._projection = projection;\n    var defaultSpatialRef,\n        resolutions = this.options['resolutions'];\n\n    if (!resolutions) {\n      if (projection['code']) {\n        defaultSpatialRef = DefaultSpatialReference[projection['code']];\n\n        if (defaultSpatialRef) {\n          resolutions = defaultSpatialRef['resolutions'];\n          this.isEPSG = projection['code'] !== 'IDENTITY';\n        }\n      }\n\n      if (!resolutions) {\n        throw new Error('must provide valid resolutions in map\\'s spatial reference.');\n      }\n    }\n\n    this._resolutions = resolutions;\n    var fullExtent = this.options['fullExtent'];\n\n    if (!fullExtent) {\n      if (projection['code']) {\n        defaultSpatialRef = DefaultSpatialReference[projection['code']];\n\n        if (defaultSpatialRef) {\n          fullExtent = defaultSpatialRef['fullExtent'];\n        }\n      }\n\n      if (!fullExtent) {\n        throw new Error('must provide a valid fullExtent in map\\'s spatial reference.');\n      }\n    }\n\n    if (!isNil(fullExtent['left'])) {\n      this._fullExtent = new Extent(new Coordinate(fullExtent['left'], fullExtent['top']), new Coordinate(fullExtent['right'], fullExtent['bottom']));\n    } else {\n      this._fullExtent = new Extent(fullExtent);\n      fullExtent['left'] = fullExtent['xmin'];\n      fullExtent['right'] = fullExtent['xmax'];\n      fullExtent['top'] = fullExtent['ymax'];\n      fullExtent['bottom'] = fullExtent['ymin'];\n    }\n\n    if (isNil(fullExtent['top']) || isNil(fullExtent['bottom']) || isNil(fullExtent['left']) || isNil(fullExtent['right'])) {\n      throw new Error('must provide valid top/bottom/left/right in fullExtent.');\n    }\n\n    extend(this._fullExtent, fullExtent);\n    this._projection.fullExtent = fullExtent;\n    var a = fullExtent['right'] >= fullExtent['left'] ? 1 : -1,\n        b = fullExtent['top'] >= fullExtent['bottom'] ? -1 : 1;\n    this._transformation = new Transformation([a, b, 0, 0]);\n  };\n\n  _proto.getResolutions = function getResolutions() {\n    return this._resolutions || [];\n  };\n\n  _proto.getResolution = function getResolution(zoom) {\n    var z = zoom | 0;\n\n    if (z < 0) {\n      z = 0;\n    } else if (z > this._resolutions.length - 1) {\n      z = this._resolutions.length - 1;\n    }\n\n    var res = this._resolutions[z];\n\n    if (z !== zoom && zoom > 0 && z < this._resolutions.length - 1) {\n      var next = this._resolutions[z + 1];\n      return res + (next - res) * (zoom - z);\n    }\n\n    return res;\n  };\n\n  _proto.getProjection = function getProjection() {\n    return this._projection;\n  };\n\n  _proto.getFullExtent = function getFullExtent() {\n    return this._fullExtent;\n  };\n\n  _proto.getTransformation = function getTransformation() {\n    return this._transformation;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    for (var i = 0; i < this._resolutions.length; i++) {\n      if (!isNil(this._resolutions[i])) {\n        return i;\n      }\n    }\n\n    return 0;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    for (var i = this._resolutions.length - 1; i >= 0; i--) {\n      if (!isNil(this._resolutions[i])) {\n        return i;\n      }\n    }\n\n    return this._resolutions.length - 1;\n  };\n\n  _proto.getZoomDirection = function getZoomDirection() {\n    return sign(this._resolutions[this.getMinZoom()] - this._resolutions[this.getMaxZoom()]);\n  };\n\n  _proto.toJSON = function toJSON() {\n    if (!this.json) {\n      this.json = {\n        'resolutions': this._resolutions,\n        'fullExtent': {\n          'top': this._fullExtent.top,\n          'left': this._fullExtent.left,\n          'bottom': this._fullExtent.bottom,\n          'right': this._fullExtent.right\n        },\n        'projection': this._projection.code\n      };\n    }\n\n    return this.json;\n  };\n\n  return SpatialReference;\n}();\n\nvar options = {\n  'id': null,\n  'visible': true,\n  'interactive': true,\n  'editable': true,\n  'cursor': null,\n  'defaultProjection': 'EPSG:4326'\n};\n\nvar Geometry = function (_JSONAble) {\n  _inheritsLoose(Geometry, _JSONAble);\n\n  function Geometry(options) {\n    var _this;\n\n    var opts = extend({}, options);\n    var symbol = opts['symbol'];\n    var properties = opts['properties'];\n    var id = opts['id'];\n    delete opts['symbol'];\n    delete opts['id'];\n    delete opts['properties'];\n    _this = _JSONAble.call(this, opts) || this;\n\n    if (symbol) {\n      _this.setSymbol(symbol);\n    }\n\n    if (properties) {\n      _this.setProperties(properties);\n    }\n\n    if (!isNil(id)) {\n      _this.setId(id);\n    }\n\n    return _this;\n  }\n\n  var _proto = Geometry.prototype;\n\n  _proto.getFirstCoordinate = function getFirstCoordinate() {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n\n      if (!geometries.length) {\n        return null;\n      }\n\n      return geometries[0].getFirstCoordinate();\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      return coordinates;\n    }\n\n    do {\n      coordinates = coordinates[0];\n    } while (Array.isArray(coordinates) && coordinates.length > 0);\n\n    return coordinates;\n  };\n\n  _proto.getLastCoordinate = function getLastCoordinate() {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n\n      if (!geometries.length) {\n        return null;\n      }\n\n      return geometries[geometries.length - 1].getLastCoordinate();\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      return coordinates;\n    }\n\n    do {\n      coordinates = coordinates[coordinates.length - 1];\n    } while (Array.isArray(coordinates) && coordinates.length > 0);\n\n    return coordinates;\n  };\n\n  _proto.addTo = function addTo(layer, fitview) {\n    layer.addGeometry(this, fitview);\n    return this;\n  };\n\n  _proto.getLayer = function getLayer() {\n    if (!this._layer) {\n      return null;\n    }\n\n    return this._layer;\n  };\n\n  _proto.getMap = function getMap() {\n    if (!this._layer) {\n      return null;\n    }\n\n    return this._layer.getMap();\n  };\n\n  _proto.getId = function getId() {\n    return this._id;\n  };\n\n  _proto.setId = function setId(id) {\n    var oldId = this.getId();\n    this._id = id;\n\n    this._fireEvent('idchange', {\n      'old': oldId,\n      'new': id\n    });\n\n    return this;\n  };\n\n  _proto.getProperties = function getProperties() {\n    if (!this.properties) {\n      if (this._getParent()) {\n        return this._getParent().getProperties();\n      }\n\n      return null;\n    }\n\n    return this.properties;\n  };\n\n  _proto.setProperties = function setProperties(properties) {\n    var old = this.properties;\n    this.properties = isObject(properties) ? extend({}, properties) : properties;\n\n    this._repaint();\n\n    this._fireEvent('propertieschange', {\n      'old': old,\n      'new': properties\n    });\n\n    return this;\n  };\n\n  _proto.getType = function getType() {\n    return this.type;\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var s = this._symbol;\n\n    if (s) {\n      if (!Array.isArray(s)) {\n        return extend({}, s);\n      } else {\n        return extendSymbol(s);\n      }\n    }\n\n    return null;\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    this._symbol = this._prepareSymbol(symbol);\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto.updateSymbol = function updateSymbol(props) {\n    if (!props) {\n      return this;\n    }\n\n    var s = this._getSymbol();\n\n    if (s) {\n      s = extendSymbol(s, props);\n    } else {\n      s = extendSymbol(this._getInternalSymbol(), props);\n    }\n\n    this._eventSymbolProperties = props;\n    return this.setSymbol(s);\n  };\n\n  _proto.getCenter = function getCenter() {\n    return this._computeCenter(this._getMeasurer());\n  };\n\n  _proto.getExtent = function getExtent() {\n    var prjExt = this._getPrjExtent();\n\n    var projection = this._getProjection();\n\n    if (prjExt && projection) {\n      var min = projection.unproject(new Coordinate(prjExt['xmin'], prjExt['ymin'])),\n          max = projection.unproject(new Coordinate(prjExt['xmax'], prjExt['ymax']));\n      return new Extent(min, max, projection);\n    } else {\n      return this._computeExtent(this._getMeasurer());\n    }\n  };\n\n  _proto.getContainerExtent = function getContainerExtent(out) {\n    var painter = this._getPainter();\n\n    return painter ? painter.getContainerExtent(out) : null;\n  };\n\n  _proto.getSize = function getSize() {\n    var extent = this.getContainerExtent();\n    return extent ? extent.getSize() : null;\n  };\n\n  _proto.containsPoint = function containsPoint(containerPoint, t) {\n    if (!this.getMap()) {\n      throw new Error('The geometry is required to be added on a map to perform \"containsPoint\".');\n    }\n\n    if (containerPoint instanceof Coordinate) {\n      containerPoint = this.getMap().coordToContainerPoint(containerPoint);\n    }\n\n    return this._containsPoint(containerPoint, t);\n  };\n\n  _proto._containsPoint = function _containsPoint(containerPoint, t) {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return false;\n    }\n\n    if (isNil(t) && this._hitTestTolerance) {\n      t = this._hitTestTolerance();\n    }\n\n    return painter.hitTest(containerPoint, t);\n  };\n\n  _proto.show = function show() {\n    this.options['visible'] = true;\n\n    if (this.getMap()) {\n      var painter = this._getPainter();\n\n      if (painter) {\n        painter.show();\n      }\n\n      this._fireEvent('show');\n    }\n\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.options['visible'] = false;\n\n    if (this.getMap()) {\n      this.onHide();\n\n      var painter = this._getPainter();\n\n      if (painter) {\n        painter.hide();\n      }\n\n      this._fireEvent('hide');\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!this.options['visible']) {\n      return false;\n    }\n\n    var symbol = this._getInternalSymbol();\n\n    if (!symbol) {\n      return true;\n    }\n\n    if (Array.isArray(symbol)) {\n      if (!symbol.length) {\n        return true;\n      }\n\n      for (var i = 0, l = symbol.length; i < l; i++) {\n        if (isNil(symbol[i]['opacity']) || symbol[i]['opacity'] > 0) {\n          return true;\n        }\n      }\n\n      return false;\n    } else {\n      return isNil(symbol['opacity']) || isNumber(symbol['opacity']) && symbol['opacity'] > 0;\n    }\n  };\n\n  _proto.getZIndex = function getZIndex() {\n    return this.options['zIndex'] || 0;\n  };\n\n  _proto.setZIndex = function setZIndex(zIndex) {\n    var old = this.options['zIndex'];\n    this.options['zIndex'] = zIndex;\n\n    this._fireEvent('zindexchange', {\n      'old': old,\n      'new': zIndex\n    });\n\n    return this;\n  };\n\n  _proto.setZIndexSilently = function setZIndexSilently(zIndex) {\n    this.options['zIndex'] = zIndex;\n    return this;\n  };\n\n  _proto.bringToFront = function bringToFront() {\n    var layer = this.getLayer();\n\n    if (!layer || !layer.getGeoMaxZIndex) {\n      return this;\n    }\n\n    var topZ = layer.getGeoMaxZIndex();\n    this.setZIndex(topZ + 1);\n    return this;\n  };\n\n  _proto.bringToBack = function bringToBack() {\n    var layer = this.getLayer();\n\n    if (!layer || !layer.getGeoMinZIndex) {\n      return this;\n    }\n\n    var bottomZ = layer.getGeoMinZIndex();\n    this.setZIndex(bottomZ - 1);\n    return this;\n  };\n\n  _proto.translate = function translate(x, y) {\n    if (isNil(x)) {\n      return this;\n    }\n\n    var offset = new Coordinate(x, y);\n\n    if (offset.x === 0 && offset.y === 0) {\n      return this;\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (coordinates) {\n      if (Array.isArray(coordinates)) {\n        var translated = forEachCoord(coordinates, function (coord) {\n          return coord.add(offset);\n        });\n        this.setCoordinates(translated);\n      } else {\n        this.setCoordinates(coordinates.add(offset));\n      }\n    }\n\n    return this;\n  };\n\n  _proto.flash = function flash$$1(interval, count, cb, context) {\n    return flash.call(this, interval, count, cb, context);\n  };\n\n  _proto.copy = function copy() {\n    var json = this.toJSON();\n    var ret = Geometry.fromJSON(json);\n    ret.options['visible'] = true;\n    return ret;\n  };\n\n  _proto.remove = function remove() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return this;\n    }\n\n    this._fireEvent('removestart');\n\n    this._unbind();\n\n    this._fireEvent('removeend');\n\n    this._fireEvent('remove');\n\n    return this;\n  };\n\n  _proto.toGeoJSONGeometry = function toGeoJSONGeometry() {\n    var gJson = this._exportGeoJSONGeometry();\n\n    return gJson;\n  };\n\n  _proto.toGeoJSON = function toGeoJSON(opts) {\n    if (!opts) {\n      opts = {};\n    }\n\n    var feature = {\n      'type': 'Feature',\n      'geometry': null\n    };\n\n    if (isNil(opts['geometry']) || opts['geometry']) {\n      var geoJSON = this._exportGeoJSONGeometry();\n\n      feature['geometry'] = geoJSON;\n    }\n\n    var id = this.getId();\n\n    if (!isNil(id)) {\n      feature['id'] = id;\n    }\n\n    var properties;\n\n    if (isNil(opts['properties']) || opts['properties']) {\n      properties = this._exportProperties();\n    }\n\n    feature['properties'] = properties;\n    return feature;\n  };\n\n  _proto.toJSON = function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var json = this._toJSON(options);\n\n    var other = this._exportGraphicOptions(options);\n\n    extend(json, other);\n    return json;\n  };\n\n  _proto.getLength = function getLength() {\n    return this._computeGeodesicLength(this._getMeasurer());\n  };\n\n  _proto.getArea = function getArea() {\n    return this._computeGeodesicArea(this._getMeasurer());\n  };\n\n  _proto.rotate = function rotate(angle, pivot) {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n      geometries.forEach(function (g) {\n        return g.rotate(angle, pivot);\n      });\n      return this;\n    }\n\n    if (!pivot) {\n      pivot = this.getCenter();\n    } else {\n      pivot = new Coordinate(pivot);\n    }\n\n    var measurer = this._getMeasurer();\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      if (pivot.x !== coordinates.x || pivot.y !== coordinates.y) {\n        var c = measurer._rotate(coordinates, pivot, angle);\n\n        this.setCoordinates(c);\n      }\n\n      return this;\n    }\n\n    forEachCoord(coordinates, function (c) {\n      return measurer._rotate(c, pivot, angle);\n    });\n    this.setCoordinates(coordinates);\n    return this;\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    return [this.getCenter()];\n  };\n\n  _proto._initOptions = function _initOptions(options) {\n    var opts = extend({}, options);\n    var symbol = opts['symbol'];\n    var properties = opts['properties'];\n    var id = opts['id'];\n    delete opts['symbol'];\n    delete opts['id'];\n    delete opts['properties'];\n    this.setOptions(opts);\n\n    if (symbol) {\n      this.setSymbol(symbol);\n    }\n\n    if (properties) {\n      this.setProperties(properties);\n    }\n\n    if (!isNil(id)) {\n      this.setId(id);\n    }\n  };\n\n  _proto._bindLayer = function _bindLayer(layer) {\n    if (this.getLayer()) {\n      throw new Error('Geometry cannot be added to two or more layers at the same time.');\n    }\n\n    this._layer = layer;\n\n    this._clearCache();\n  };\n\n  _proto._prepareSymbol = function _prepareSymbol(symbol) {\n    if (Array.isArray(symbol)) {\n      var cookedSymbols = [];\n\n      for (var i = 0; i < symbol.length; i++) {\n        cookedSymbols.push(convertResourceUrl(this._checkAndCopySymbol(symbol[i])));\n      }\n\n      return cookedSymbols;\n    } else if (symbol) {\n      symbol = this._checkAndCopySymbol(symbol);\n      return convertResourceUrl(symbol);\n    }\n\n    return null;\n  };\n\n  _proto._checkAndCopySymbol = function _checkAndCopySymbol(symbol) {\n    var s = {};\n\n    for (var i in symbol) {\n      if (NUMERICAL_PROPERTIES[i] && isString(symbol[i])) {\n        s[i] = +symbol[i];\n      } else {\n        s[i] = symbol[i];\n      }\n    }\n\n    return s;\n  };\n\n  _proto._getSymbol = function _getSymbol() {\n    return this._symbol;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    this._externSymbol = this._prepareSymbol(symbol);\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._getInternalSymbol = function _getInternalSymbol() {\n    if (this._symbol) {\n      return this._symbol;\n    } else if (this._externSymbol) {\n      return this._externSymbol;\n    } else if (this.options['symbol']) {\n      return this.options['symbol'];\n    }\n\n    return null;\n  };\n\n  _proto._getPrjExtent = function _getPrjExtent() {\n    var p = this._getProjection();\n\n    this._verifyProjection();\n\n    if (!this._extent && p) {\n      this._extent = this._computePrjExtent(p);\n    }\n\n    return this._extent;\n  };\n\n  _proto._unbind = function _unbind() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return;\n    }\n\n    if (this._animPlayer) {\n      this._animPlayer.finish();\n    }\n\n    this._clearHandlers();\n\n    this._unbindMenu();\n\n    this._unbindInfoWindow();\n\n    if (this.isEditing()) {\n      this.endEdit();\n    }\n\n    this._removePainter();\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    if (layer.onRemoveGeometry) {\n      layer.onRemoveGeometry(this);\n    }\n\n    delete this._layer;\n    delete this._internalId;\n    delete this._extent;\n  };\n\n  _proto._getInternalId = function _getInternalId() {\n    return this._internalId;\n  };\n\n  _proto._setInternalId = function _setInternalId(id) {\n    this._internalId = id;\n  };\n\n  _proto._getMeasurer = function _getMeasurer() {\n    if (this._getProjection()) {\n      return this._getProjection();\n    }\n\n    return SpatialReference.getProjectionInstance(this.options['defaultProjection']);\n  };\n\n  _proto._getProjection = function _getProjection() {\n    var map = this.getMap();\n\n    if (map) {\n      return map.getProjection();\n    }\n\n    return null;\n  };\n\n  _proto._verifyProjection = function _verifyProjection() {\n    var projection = this._getProjection();\n\n    if (this._projCode && projection && this._projCode !== projection.code) {\n      this._clearProjection();\n    }\n\n    this._projCode = projection ? projection.code : this._projCode;\n  };\n\n  _proto._getExternalResources = function _getExternalResources() {\n    var symbol = this._getInternalSymbol();\n\n    return getExternalResources(symbol);\n  };\n\n  _proto._getPainter = function _getPainter() {\n    if (!this._painter && this.getMap()) {\n      if (GEOMETRY_COLLECTION_TYPES.indexOf(this.type) !== -1) {\n        this._painter = new CollectionPainter(this);\n      } else {\n        this._painter = new Painter(this);\n      }\n    }\n\n    return this._painter;\n  };\n\n  _proto._removePainter = function _removePainter() {\n    if (this._painter) {\n      this._painter.remove();\n    }\n\n    delete this._painter;\n  };\n\n  _proto._paint = function _paint(extent) {\n    if (this._painter) {\n      this._painter.paint(extent);\n    }\n  };\n\n  _proto._clearCache = function _clearCache() {\n    delete this._extent;\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    delete this._extent;\n  };\n\n  _proto._repaint = function _repaint() {\n    if (this._painter) {\n      this._painter.repaint();\n    }\n  };\n\n  _proto.onHide = function onHide() {\n    this.closeMenu();\n    this.closeInfoWindow();\n  };\n\n  _proto.onShapeChanged = function onShapeChanged() {\n    this._clearCache();\n\n    this._repaint();\n\n    this._fireEvent('shapechange');\n  };\n\n  _proto.onPositionChanged = function onPositionChanged() {\n    this._clearCache();\n\n    this._repaint();\n\n    this._fireEvent('positionchange');\n  };\n\n  _proto.onSymbolChanged = function onSymbolChanged() {\n    if (this._painter) {\n      this._painter.refreshSymbol();\n    }\n\n    var e = {};\n\n    if (this._eventSymbolProperties) {\n      e.properties = this._eventSymbolProperties;\n      delete this._eventSymbolProperties;\n    }\n\n    this._fireEvent('symbolchange', e);\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    var properties;\n\n    if (conf['properties']) {\n      properties = conf['properties'];\n      delete conf['properties'];\n    }\n\n    var needRepaint = false;\n\n    for (var p in conf) {\n      if (conf.hasOwnProperty(p)) {\n        var prefix = p.slice(0, 5);\n\n        if (prefix === 'arrow' || prefix === 'smoot') {\n          needRepaint = true;\n          break;\n        }\n      }\n    }\n\n    if (properties) {\n      this.setProperties(properties);\n\n      this._repaint();\n    } else if (needRepaint) {\n      this._repaint();\n    }\n  };\n\n  _proto._setParent = function _setParent(geometry) {\n    if (geometry) {\n      this._parent = geometry;\n    }\n  };\n\n  _proto._getParent = function _getParent() {\n    return this._parent;\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (this.getLayer() && this.getLayer()._onGeometryEvent) {\n      if (!param) {\n        param = {};\n      }\n\n      param['type'] = eventName;\n      param['target'] = this;\n\n      this.getLayer()._onGeometryEvent(param);\n    }\n\n    this.fire(eventName, param);\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options)\n    };\n  };\n\n  _proto._exportGraphicOptions = function _exportGraphicOptions(options) {\n    var json = {};\n\n    if (isNil(options['options']) || options['options']) {\n      json['options'] = this.config();\n    }\n\n    if (isNil(options['symbol']) || options['symbol']) {\n      json['symbol'] = this.getSymbol();\n    }\n\n    if (isNil(options['infoWindow']) || options['infoWindow']) {\n      if (this._infoWinOptions) {\n        json['infoWindow'] = this._infoWinOptions;\n      }\n    }\n\n    return json;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var points = this.getCoordinates();\n    var coordinates = Coordinate.toNumberArrays(points);\n    return {\n      'type': this.getType(),\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._exportProperties = function _exportProperties() {\n    var properties = null;\n    var geoProperties = this.getProperties();\n\n    if (!isNil(geoProperties)) {\n      if (isObject(geoProperties)) {\n        properties = extend({}, geoProperties);\n      } else {\n        properties = geoProperties;\n      }\n    }\n\n    return properties;\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return 0;\n    }\n\n    var layerOpts = layer.options,\n        properties = this.getProperties();\n    var altitude = layerOpts['enableAltitude'] ? properties ? properties[layerOpts['altitudeProperty']] : 0 : 0;\n    return altitude;\n  };\n\n  return Geometry;\n}(JSONAble(Eventable(Handlerable(Class))));\n\nGeometry.mergeOptions(options);\nvar options$1 = {\n  'attribution': null,\n  'minZoom': null,\n  'maxZoom': null,\n  'visible': true,\n  'opacity': 1,\n  'globalCompositeOperation': null,\n  'renderer': 'canvas',\n  'debugOutline': '#0f0',\n  'cssFilter': null,\n  'forceRenderOnMoving': false,\n  'forceRenderOnZooming': false,\n  'forceRenderOnRotating': false,\n  'hitDetect': function () {\n    return !Browser$1.mobile;\n  }()\n};\n\nvar Layer = function (_JSONAble) {\n  _inheritsLoose(Layer, _JSONAble);\n\n  function Layer(id, options) {\n    var _this;\n\n    var canvas;\n\n    if (options) {\n      canvas = options.canvas;\n      delete options.canvas;\n    }\n\n    _this = _JSONAble.call(this, options) || this;\n    _this._canvas = canvas;\n\n    _this.setId(id);\n\n    if (options) {\n      _this.setZIndex(options.zIndex);\n\n      if (options.mask) {\n        _this.setMask(Geometry.fromJSON(options.mask));\n      }\n    }\n\n    return _this;\n  }\n\n  var _proto = Layer.prototype;\n\n  _proto.load = function load() {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (this.onLoad()) {\n      this._initRenderer();\n\n      var zIndex = this.getZIndex();\n\n      if (!isNil(zIndex)) {\n        this._renderer.setZIndex(zIndex);\n\n        if (!this.isCanvasRender()) {\n          this._renderer.render();\n        }\n      }\n\n      this.onLoadEnd();\n    }\n\n    return this;\n  };\n\n  _proto.getId = function getId() {\n    return this._id;\n  };\n\n  _proto.setId = function setId(id) {\n    var old = this._id;\n\n    if (!isNil(id)) {\n      id = id + '';\n    }\n\n    this._id = id;\n    this.fire('idchange', {\n      'old': old,\n      'new': id\n    });\n    return this;\n  };\n\n  _proto.addTo = function addTo(map) {\n    map.addLayer(this);\n    return this;\n  };\n\n  _proto.setZIndex = function setZIndex(zIndex) {\n    this._zIndex = zIndex;\n\n    if (isNil(zIndex)) {\n      delete this.options['zIndex'];\n    } else {\n      this.options.zIndex = zIndex;\n    }\n\n    if (this.map) {\n      this.map._sortLayersByZIndex();\n    }\n\n    if (this._renderer) {\n      this._renderer.setZIndex(zIndex);\n    }\n\n    return this;\n  };\n\n  _proto.getZIndex = function getZIndex() {\n    return this._zIndex || 0;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    var map = this.getMap();\n    var minZoom = this.options['minZoom'];\n    return map ? Math.max(map.getMinZoom(), minZoom || 0) : minZoom;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    var map = this.getMap();\n    var maxZoom = this.options['maxZoom'];\n    return map ? Math.min(map.getMaxZoom(), isNil(maxZoom) ? Infinity : maxZoom) : maxZoom;\n  };\n\n  _proto.getOpacity = function getOpacity() {\n    return this.options['opacity'];\n  };\n\n  _proto.setOpacity = function setOpacity(op) {\n    this.config('opacity', op);\n    return this;\n  };\n\n  _proto.isCanvasRender = function isCanvasRender() {\n    var renderer = this._getRenderer();\n\n    return renderer && renderer instanceof CanvasRenderer;\n  };\n\n  _proto.getMap = function getMap() {\n    if (this.map) {\n      return this.map;\n    }\n\n    return null;\n  };\n\n  _proto.getProjection = function getProjection() {\n    var map = this.getMap();\n    return map ? map.getProjection() : null;\n  };\n\n  _proto.bringToFront = function bringToFront() {\n    var layers = this._getLayerList();\n\n    if (!layers.length) {\n      return this;\n    }\n\n    var topLayer = layers[layers.length - 1];\n\n    if (layers.length === 1 || topLayer === this) {\n      return this;\n    }\n\n    var max = topLayer.getZIndex();\n    this.setZIndex(max + 1);\n    return this;\n  };\n\n  _proto.bringToBack = function bringToBack() {\n    var layers = this._getLayerList();\n\n    if (!layers.length) {\n      return this;\n    }\n\n    var bottomLayer = layers[0];\n\n    if (layers.length === 1 || bottomLayer === this) {\n      return this;\n    }\n\n    var min = bottomLayer.getZIndex();\n    this.setZIndex(min - 1);\n    return this;\n  };\n\n  _proto.show = function show() {\n    var _this2 = this;\n\n    if (!this.options['visible']) {\n      this.options['visible'] = true;\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.show();\n      }\n\n      var map = this.getMap();\n\n      if (renderer && map) {\n        map.once('renderend', function () {\n          _this2.fire('show');\n        });\n      } else {\n        this.fire('show');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    var _this3 = this;\n\n    if (this.options['visible']) {\n      this.options['visible'] = false;\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.hide();\n      }\n\n      var map = this.getMap();\n\n      if (renderer && map) {\n        map.once('renderend', function () {\n          _this3.fire('hide');\n        });\n      } else {\n        this.fire('hide');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (isNumber(this.options['opacity']) && this.options['opacity'] <= 0) {\n      return false;\n    }\n\n    var map = this.getMap();\n\n    if (map) {\n      var zoom = map.getZoom();\n\n      if (!isNil(this.options['maxZoom']) && this.options['maxZoom'] < zoom || !isNil(this.options['minZoom']) && this.options['minZoom'] > zoom) {\n        return false;\n      }\n    }\n\n    if (isNil(this.options['visible'])) {\n      this.options['visible'] = true;\n    }\n\n    return this.options['visible'];\n  };\n\n  _proto.remove = function remove() {\n    if (this.map) {\n      this.map.removeLayer(this);\n    }\n\n    return this;\n  };\n\n  _proto.getMask = function getMask() {\n    return this._mask;\n  };\n\n  _proto.setMask = function setMask(mask) {\n    if (!(mask.type === 'Point' && mask._isVectorMarker() || mask.type === 'Polygon' || mask.type === 'MultiPolygon')) {\n      throw new Error('Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).');\n    }\n\n    mask._bindLayer(this);\n\n    if (mask.type === 'Point') {\n      mask.updateSymbol({\n        'markerLineColor': 'rgba(0, 0, 0, 0)',\n        'markerFillOpacity': 0\n      });\n    } else {\n      mask.setSymbol({\n        'lineColor': 'rgba(0, 0, 0, 0)',\n        'polygonOpacity': 0\n      });\n    }\n\n    this._mask = mask;\n    this.options.mask = mask.toJSON();\n\n    if (!this.getMap() || this.getMap().isZooming()) {\n      return this;\n    }\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.setToRedraw) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.removeMask = function removeMask() {\n    delete this._mask;\n    delete this.options.mask;\n\n    if (!this.getMap() || this.getMap().isZooming()) {\n      return this;\n    }\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.setToRedraw) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.onLoad = function onLoad() {\n    return true;\n  };\n\n  _proto.onLoadEnd = function onLoadEnd() {};\n\n  _proto.isLoaded = function isLoaded() {\n    return !!this._loaded;\n  };\n\n  _proto.getRenderer = function getRenderer() {\n    return this._getRenderer();\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    if (isNumber(conf['opacity']) || conf['cssFilter']) {\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.onAdd = function onAdd() {};\n\n  _proto.onRendererCreate = function onRendererCreate() {};\n\n  _proto.onCanvasCreate = function onCanvasCreate() {};\n\n  _proto.onRemove = function onRemove() {};\n\n  _proto._bindMap = function _bindMap(map, zIndex) {\n    if (!map) {\n      return;\n    }\n\n    this.map = map;\n\n    if (!isNil(zIndex)) {\n      this.setZIndex(zIndex);\n    }\n\n    this._switchEvents('on', this);\n\n    this.onAdd();\n    this.fire('add');\n  };\n\n  _proto._initRenderer = function _initRenderer() {\n    var renderer = this.options['renderer'];\n\n    if (!this.constructor.getRendererClass) {\n      return;\n    }\n\n    var clazz = this.constructor.getRendererClass(renderer);\n\n    if (!clazz) {\n      throw new Error('Invalid renderer for Layer(' + this.getId() + '):' + renderer);\n    }\n\n    this._renderer = new clazz(this);\n    this._renderer.layer = this;\n\n    this._renderer.setZIndex(this.getZIndex());\n\n    this._switchEvents('on', this._renderer);\n\n    if (this._renderer.onAdd) {\n      this._renderer.onAdd();\n    }\n\n    this.onRendererCreate();\n    this.fire('renderercreate', {\n      'renderer': this._renderer\n    });\n  };\n\n  _proto._doRemove = function _doRemove() {\n    this._loaded = false;\n    this.onRemove();\n\n    this._switchEvents('off', this);\n\n    if (this._renderer) {\n      this._switchEvents('off', this._renderer);\n\n      this._renderer.remove();\n\n      delete this._renderer;\n    }\n\n    delete this.map;\n  };\n\n  _proto._switchEvents = function _switchEvents(to, emitter) {\n    if (emitter && emitter.getEvents) {\n      this.getMap()[to](emitter.getEvents(), emitter);\n    }\n  };\n\n  _proto._getRenderer = function _getRenderer() {\n    return this._renderer;\n  };\n\n  _proto._getLayerList = function _getLayerList() {\n    if (!this.map) {\n      return [];\n    }\n\n    return this.map._layers;\n  };\n\n  _proto._getMask2DExtent = function _getMask2DExtent() {\n    if (!this._mask || !this.getMap()) {\n      return null;\n    }\n\n    var painter = this._mask._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    return painter.get2DExtent();\n  };\n\n  return Layer;\n}(JSONAble(Eventable(Renderable(Class))));\n\nLayer.mergeOptions(options$1);\nvar fire = Layer.prototype.fire;\n\nLayer.prototype.fire = function (eventType, param) {\n  if (eventType === 'layerload') {\n    this._loaded = true;\n  }\n\n  if (this.map) {\n    if (!param) {\n      param = {};\n    }\n\n    param['type'] = eventType;\n    param['target'] = this;\n\n    this.map._onLayerEvent(param);\n  }\n\n  return fire.apply(this, arguments);\n};\n\nvar options$2 = {\n  'maxVisualPitch': 70,\n  'maxPitch': 80,\n  'centerCross': false,\n  'zoomInCenter': false,\n  'zoomOrigin': null,\n  'zoomAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'zoomAnimationDuration': 330,\n  'panAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'panAnimationDuration': 600,\n  'zoomable': true,\n  'enableInfoWindow': true,\n  'hitDetect': function () {\n    return !Browser$1.mobile;\n  }(),\n  'hitDetectLimit': 5,\n  'fpsOnInteracting': 25,\n  'layerCanvasLimitOnInteracting': -1,\n  'maxZoom': null,\n  'minZoom': null,\n  'maxExtent': null,\n  'fixCenterOnResize': false,\n  'checkSize': true,\n  'checkSizeInterval': 1000,\n  'renderer': 'canvas',\n  'cascadePitches': [10, 60]\n};\n\nvar Map$1 = function (_Handlerable) {\n  _inheritsLoose(Map, _Handlerable);\n\n  function Map(container, options) {\n    var _this;\n\n    if (!options) {\n      throw new Error('Invalid options when creating map.');\n    }\n\n    if (!options['center']) {\n      throw new Error('Invalid center when creating map.');\n    }\n\n    var opts = extend({}, options);\n    var zoom = opts['zoom'];\n    delete opts['zoom'];\n    var center = new Coordinate(opts['center']);\n    delete opts['center'];\n    var baseLayer = opts['baseLayer'];\n    delete opts['baseLayer'];\n    var layers = opts['layers'];\n    delete opts['layers'];\n    _this = _Handlerable.call(this, opts) || this;\n    _this.VERSION = Map.VERSION;\n    Object.defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), 'id', {\n      value: UID(),\n      writable: false\n    });\n    _this._loaded = false;\n\n    _this._initContainer(container);\n\n    _this._panels = {};\n    _this._baseLayer = null;\n    _this._layers = [];\n    _this._zoomLevel = zoom;\n    _this._center = center;\n\n    _this.setSpatialReference(opts['spatialReference'] || opts['view']);\n\n    _this.setMaxExtent(opts['maxExtent']);\n\n    _this._mapViewPoint = new Point(0, 0);\n\n    _this._initRenderer();\n\n    _this._updateMapSize(_this._getContainerDomSize());\n\n    if (baseLayer) {\n      _this.setBaseLayer(baseLayer);\n    }\n\n    if (layers) {\n      _this.addLayer(layers);\n    }\n\n    _this._Load();\n\n    return _this;\n  }\n\n  Map.addOnLoadHook = function addOnLoadHook(fn) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    var onload = typeof fn === 'function' ? fn : function () {\n      this[fn].apply(this, args);\n    };\n    this.prototype._onLoadHooks = this.prototype._onLoadHooks || [];\n\n    this.prototype._onLoadHooks.push(onload);\n\n    return this;\n  };\n\n  var _proto = Map.prototype;\n\n  _proto.isLoaded = function isLoaded() {\n    return !!this._loaded;\n  };\n\n  _proto.getContainer = function getContainer() {\n    return this._containerDOM;\n  };\n\n  _proto.getSpatialReference = function getSpatialReference() {\n    return this._spatialReference;\n  };\n\n  _proto.setSpatialReference = function setSpatialReference(ref) {\n    var oldRef = this.options['spatialReference'];\n\n    if (this._loaded && SpatialReference.equals(oldRef, ref)) {\n      return this;\n    }\n\n    this._updateSpatialReference(ref, oldRef);\n\n    return this;\n  };\n\n  _proto._updateSpatialReference = function _updateSpatialReference(ref, oldRef) {\n    ref = extend({}, ref);\n    this._center = this.getCenter();\n    this.options['spatialReference'] = ref;\n    this._spatialReference = new SpatialReference(ref);\n\n    if (this.options['spatialReference'] && isFunction(this.options['spatialReference']['projection'])) {\n      var projection = this._spatialReference.getProjection();\n\n      this.options['spatialReference']['projection'] = projection['code'];\n    }\n\n    this._resetMapStatus();\n\n    this._fireEvent('spatialreferencechange', {\n      'old': oldRef,\n      'new': extend({}, this.options['spatialReference'])\n    });\n\n    return this;\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    var ref = conf['spatialReference'] || conf['view'];\n\n    if (!isNil(ref)) {\n      this._updateSpatialReference(ref, null);\n    }\n\n    return this;\n  };\n\n  _proto.getProjection = function getProjection() {\n    if (!this._spatialReference) {\n      return null;\n    }\n\n    return this._spatialReference.getProjection();\n  };\n\n  _proto.getFullExtent = function getFullExtent() {\n    if (!this._spatialReference) {\n      return null;\n    }\n\n    return this._spatialReference.getFullExtent();\n  };\n\n  _proto.setCursor = function setCursor(cursor) {\n    delete this._cursor;\n\n    this._trySetCursor(cursor);\n\n    this._cursor = cursor;\n    return this;\n  };\n\n  _proto.resetCursor = function resetCursor() {\n    return this.setCursor(null);\n  };\n\n  _proto.getCenter = function getCenter() {\n    if (!this._loaded || !this._prjCenter) {\n      return this._center;\n    }\n\n    var projection = this.getProjection();\n    return projection.unproject(this._prjCenter);\n  };\n\n  _proto.setCenter = function setCenter(center) {\n    if (!center) {\n      return this;\n    }\n\n    center = new Coordinate(center);\n    var projection = this.getProjection();\n    var pcenter = projection.project(center);\n\n    if (!this._verifyExtent(pcenter)) {\n      return this;\n    }\n\n    if (!this._loaded) {\n      this._center = center;\n      return this;\n    }\n\n    this.onMoveStart();\n\n    this._setPrjCenter(pcenter);\n\n    this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n    return this;\n  };\n\n  _proto.getSize = function getSize() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return this._getContainerDomSize();\n    }\n\n    return new Size(this.width, this.height);\n  };\n\n  _proto.getContainerExtent = function getContainerExtent() {\n    var visualHeight = this.height;\n    var pitch = this.getPitch(),\n        maxVisualPitch = this.options['maxVisualPitch'];\n\n    if (maxVisualPitch && pitch > maxVisualPitch) {\n      visualHeight = this._getVisualHeight(maxVisualPitch);\n    }\n\n    return new PointExtent(0, this.height - visualHeight, this.width, this.height);\n  };\n\n  _proto._getVisualHeight = function _getVisualHeight(visualPitch) {\n    var pitch = (90 - this.getPitch()) * Math.PI / 180;\n    var fov = this.getFov() * Math.PI / 180;\n    visualPitch *= Math.PI / 180;\n    var cameraToCenter = this.cameraCenterDistance / this.getGLScale();\n    var tanB = Math.tan(fov / 2);\n    var tanP = Math.tan(visualPitch);\n    var visualDistance = cameraToCenter * tanB / (1 / tanP - tanB) / Math.sin(visualPitch);\n    var x = cameraToCenter * (Math.sin(pitch) * visualDistance / (cameraToCenter + Math.cos(pitch) * visualDistance));\n    return this.height / 2 + x;\n  };\n\n  _proto.getExtent = function getExtent() {\n    return this._pointToExtent(this._get2DExtent());\n  };\n\n  _proto.getProjExtent = function getProjExtent() {\n    var extent2D = this._get2DExtent();\n\n    return new Extent(this._pointToPrj(extent2D.getMin()), this._pointToPrj(extent2D.getMax()));\n  };\n\n  _proto.getPrjExtent = function getPrjExtent() {\n    return this.getProjExtent();\n  };\n\n  _proto.getMaxExtent = function getMaxExtent() {\n    if (!this.options['maxExtent']) {\n      return null;\n    }\n\n    return new Extent(this.options['maxExtent'], this.getProjection());\n  };\n\n  _proto.setMaxExtent = function setMaxExtent(extent) {\n    if (extent) {\n      var maxExt = new Extent(extent, this.getProjection());\n      this.options['maxExtent'] = maxExt;\n\n      if (!this._verifyExtent(this._getPrjCenter())) {\n        this._panTo(this._prjMaxExtent().getCenter());\n      }\n\n      var projection = this.getProjection();\n      this._prjMaxExtent = maxExt.convertTo(function (c) {\n        return projection.project(c);\n      });\n    } else {\n      delete this.options['maxExtent'];\n      delete this._prjMaxExtent;\n    }\n\n    return this;\n  };\n\n  _proto.getZoom = function getZoom() {\n    return this._zoomLevel;\n  };\n\n  _proto.getZoomForScale = function getZoomForScale(scale, fromZoom, isFraction) {\n    var zoom = this.getZoom();\n\n    if (isNil(fromZoom)) {\n      fromZoom = zoom;\n    }\n\n    if (scale === 1 && fromZoom === zoom) {\n      return zoom;\n    }\n\n    var res = this._getResolution(fromZoom),\n        targetRes = res / scale;\n\n    var scaleZoom = this.getZoomFromRes(targetRes);\n\n    if (isFraction) {\n      return scaleZoom;\n    } else {\n      var delta = 1E-6;\n      return this.getSpatialReference().getZoomDirection() < 0 ? Math.ceil(scaleZoom - delta) : Math.floor(scaleZoom + delta);\n    }\n  };\n\n  _proto.getZoomFromRes = function getZoomFromRes(res) {\n    var resolutions = this._getResolutions(),\n        minRes = this._getResolution(this.getMinZoom()),\n        maxRes = this._getResolution(this.getMaxZoom());\n\n    if (minRes <= maxRes) {\n      if (res <= minRes) {\n        return this.getMinZoom();\n      } else if (res >= maxRes) {\n        return this.getMaxZoom();\n      }\n    } else if (res >= minRes) {\n      return this.getMinZoom();\n    } else if (res <= maxRes) {\n      return this.getMaxZoom();\n    }\n\n    var l = resolutions.length;\n\n    for (var i = 0; i < l - 1; i++) {\n      if (!resolutions[i]) {\n        continue;\n      }\n\n      var gap = resolutions[i + 1] - resolutions[i];\n      var test = res - resolutions[i];\n\n      if (sign(gap) === sign(test) && Math.abs(gap) >= Math.abs(test)) {\n        return i + test / gap;\n      }\n    }\n\n    return l - 1;\n  };\n\n  _proto.setZoom = function setZoom(zoom, options) {\n    if (options === void 0) {\n      options = {\n        'animation': true\n      };\n    }\n\n    if (isNaN(zoom) || isNil(zoom)) {\n      return this;\n    }\n\n    zoom = +zoom;\n\n    if (this._loaded && this.options['zoomAnimation'] && options['animation']) {\n      this._zoomAnimation(zoom);\n    } else {\n      this._zoom(zoom);\n    }\n\n    return this;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    if (!isNil(this.options['maxZoom'])) {\n      return this.options['maxZoom'];\n    }\n\n    return this.getMaxNativeZoom();\n  };\n\n  _proto.setMaxZoom = function setMaxZoom(maxZoom) {\n    var viewMaxZoom = this.getMaxNativeZoom();\n\n    if (maxZoom > viewMaxZoom) {\n      maxZoom = viewMaxZoom;\n    }\n\n    if (maxZoom !== null && maxZoom < this._zoomLevel) {\n      this.setZoom(maxZoom);\n      maxZoom = +maxZoom;\n    }\n\n    this.options['maxZoom'] = maxZoom;\n    return this;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    if (!isNil(this.options['minZoom'])) {\n      return this.options['minZoom'];\n    }\n\n    return this._spatialReference.getMinZoom();\n  };\n\n  _proto.setMinZoom = function setMinZoom(minZoom) {\n    if (minZoom !== null) {\n      minZoom = +minZoom;\n\n      var viewMinZoom = this._spatialReference.getMinZoom();\n\n      if (minZoom < viewMinZoom) {\n        minZoom = viewMinZoom;\n      }\n\n      if (minZoom > this._zoomLevel) {\n        this.setZoom(minZoom);\n      }\n    }\n\n    this.options['minZoom'] = minZoom;\n    return this;\n  };\n\n  _proto.getMaxNativeZoom = function getMaxNativeZoom() {\n    var ref = this.getSpatialReference();\n\n    if (!ref) {\n      return null;\n    }\n\n    return ref.getMaxZoom();\n  };\n\n  _proto.getGLZoom = function getGLZoom() {\n    return this.getMaxNativeZoom() / 2;\n  };\n\n  _proto.getGLScale = function getGLScale(zoom) {\n    if (isNil(zoom)) {\n      zoom = this.getZoom();\n    }\n\n    return this._getResolution(zoom) / this._getResolution(this.getGLZoom());\n  };\n\n  _proto.zoomIn = function zoomIn() {\n    return this.setZoom(this.getZoom() + 1);\n  };\n\n  _proto.zoomOut = function zoomOut() {\n    return this.setZoom(this.getZoom() - 1);\n  };\n\n  _proto.isZooming = function isZooming() {\n    return !!this._zooming;\n  };\n\n  _proto.isInteracting = function isInteracting() {\n    return this.isZooming() || this.isMoving() || this.isRotating();\n  };\n\n  _proto.setCenterAndZoom = function setCenterAndZoom(center, zoom) {\n    if (!isNil(zoom) && this._zoomLevel !== zoom) {\n      this.setCenter(center);\n      this.setZoom(zoom, {\n        animation: false\n      });\n    } else {\n      this.setCenter(center);\n    }\n\n    return this;\n  };\n\n  _proto.getFitZoom = function getFitZoom(extent, isFraction) {\n    var _this2 = this;\n\n    if (!extent || !(extent instanceof Extent)) {\n      return this._zoomLevel;\n    }\n\n    if (extent['xmin'] === extent['xmax'] && extent['ymin'] === extent['ymax']) {\n      return this.getMaxZoom();\n    }\n\n    var size = this.getSize();\n    var containerExtent = extent.convertTo(function (p) {\n      return _this2.coordToContainerPoint(p);\n    });\n    var w = containerExtent.getWidth(),\n        h = containerExtent.getHeight();\n    var scaleX = size['width'] / w,\n        scaleY = size['height'] / h;\n    var scale = this.getSpatialReference().getZoomDirection() < 0 ? Math.max(scaleX, scaleY) : Math.min(scaleX, scaleY);\n    var zoom = this.getZoomForScale(scale, null, isFraction);\n    return zoom;\n  };\n\n  _proto.getView = function getView() {\n    return {\n      'center': this.getCenter().toArray(),\n      'zoom': this.getZoom(),\n      'pitch': this.getPitch(),\n      'bearing': this.getBearing()\n    };\n  };\n\n  _proto.setView = function setView(view) {\n    if (!view) {\n      return this;\n    }\n\n    if (view['center']) {\n      this.setCenter(view['center']);\n    }\n\n    if (view['zoom'] !== null && !isNaN(+view['zoom'])) {\n      this.setZoom(+view['zoom'], {\n        'animation': false\n      });\n    }\n\n    if (view['pitch'] !== null && !isNaN(+view['pitch'])) {\n      this.setPitch(+view['pitch']);\n    }\n\n    if (view['pitch'] !== null && !isNaN(+view['bearing'])) {\n      this.setBearing(+view['bearing']);\n    }\n\n    return this;\n  };\n\n  _proto.getResolution = function getResolution(zoom) {\n    return this._getResolution(zoom);\n  };\n\n  _proto.getScale = function getScale(zoom) {\n    var z = isNil(zoom) ? this.getZoom() : zoom;\n\n    var max = this._getResolution(this.getMaxNativeZoom()),\n        res = this._getResolution(z);\n\n    return res / max;\n  };\n\n  _proto.fitExtent = function fitExtent(extent, zoomOffset, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!extent) {\n      return this;\n    }\n\n    extent = new Extent(extent, this.getProjection());\n    var zoom = this.getFitZoom(extent) + (zoomOffset || 0);\n    var center = extent.getCenter();\n    if (typeof options['animation'] === 'undefined' || options['animation']) return this._animateTo({\n      center: center,\n      zoom: zoom\n    }, {\n      'duration': options['duration'] || this.options['zoomAnimationDuration'],\n      'easing': options['easing'] || 'out'\n    }, step);else return this.setCenterAndZoom(center, zoom);\n  };\n\n  _proto.getBaseLayer = function getBaseLayer() {\n    return this._baseLayer;\n  };\n\n  _proto.setBaseLayer = function setBaseLayer(baseLayer) {\n    var isChange = false;\n\n    if (this._baseLayer) {\n      isChange = true;\n\n      this._fireEvent('baselayerchangestart');\n\n      this._baseLayer.remove();\n    }\n\n    if (!baseLayer) {\n      delete this._baseLayer;\n\n      this._fireEvent('baselayerchangeend');\n\n      this._fireEvent('setbaselayer');\n\n      return this;\n    }\n\n    this._baseLayer = baseLayer;\n\n    baseLayer._bindMap(this, -1);\n\n    function onbaseLayerload() {\n      this._fireEvent('baselayerload');\n\n      if (isChange) {\n        isChange = false;\n\n        this._fireEvent('baselayerchangeend');\n      }\n    }\n\n    this._baseLayer.on('layerload', onbaseLayerload, this);\n\n    if (this._loaded) {\n      this._baseLayer.load();\n    }\n\n    this._fireEvent('setbaselayer');\n\n    return this;\n  };\n\n  _proto.removeBaseLayer = function removeBaseLayer() {\n    if (this._baseLayer) {\n      this._baseLayer.remove();\n\n      delete this._baseLayer;\n\n      this._fireEvent('baselayerremove');\n    }\n\n    return this;\n  };\n\n  _proto.getLayers = function getLayers(filter) {\n    return this._getLayers(function (layer) {\n      if (layer === this._baseLayer || layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n        return false;\n      }\n\n      if (filter) {\n        return filter(layer);\n      }\n\n      return true;\n    });\n  };\n\n  _proto.getLayer = function getLayer(id) {\n    if (!id) {\n      return null;\n    }\n\n    var layer = this._layerCache ? this._layerCache[id] : null;\n\n    if (layer) {\n      return layer;\n    }\n\n    var baseLayer = this.getBaseLayer();\n\n    if (baseLayer && baseLayer.getId() === id) {\n      return baseLayer;\n    }\n\n    return null;\n  };\n\n  _proto.addLayer = function addLayer(layers) {\n    if (!layers) {\n      return this;\n    }\n\n    if (!Array.isArray(layers)) {\n      layers = Array.prototype.slice.call(arguments, 0);\n      return this.addLayer(layers);\n    }\n\n    if (!this._layerCache) {\n      this._layerCache = {};\n    }\n\n    var mapLayers = this._layers;\n\n    for (var i = 0, len = layers.length; i < len; i++) {\n      var layer = layers[i];\n      var id = layer.getId();\n\n      if (isNil(id)) {\n        throw new Error('Invalid id for the layer: ' + id);\n      }\n\n      if (layer.getMap() === this) {\n        continue;\n      }\n\n      if (this._layerCache[id]) {\n        throw new Error('Duplicate layer id in the map: ' + id);\n      }\n\n      this._layerCache[id] = layer;\n\n      layer._bindMap(this);\n\n      mapLayers.push(layer);\n\n      if (this._loaded) {\n        layer.load();\n      }\n    }\n\n    this._sortLayersByZIndex();\n\n    this._fireEvent('addlayer', {\n      'layers': layers\n    });\n\n    return this;\n  };\n\n  _proto.removeLayer = function removeLayer(layers) {\n    if (!layers) {\n      return this;\n    }\n\n    if (!Array.isArray(layers)) {\n      return this.removeLayer([layers]);\n    }\n\n    var removed = [];\n\n    for (var i = 0, len = layers.length; i < len; i++) {\n      var layer = layers[i];\n\n      if (!(layer instanceof Layer)) {\n        layer = this.getLayer(layer);\n      }\n\n      if (!layer) {\n        continue;\n      }\n\n      var map = layer.getMap();\n\n      if (!map || map !== this) {\n        continue;\n      }\n\n      removed.push(layer);\n\n      this._removeLayer(layer, this._layers);\n\n      if (this._loaded) {\n        layer._doRemove();\n      }\n\n      var id = layer.getId();\n\n      if (this._layerCache) {\n        delete this._layerCache[id];\n      }\n    }\n\n    if (removed.length > 0) {\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.setLayerCanvasUpdated();\n      }\n\n      this.once('frameend', function () {\n        removed.forEach(function (layer) {\n          layer.fire('remove');\n        });\n      });\n    }\n\n    this._fireEvent('removelayer', {\n      'layers': layers\n    });\n\n    return this;\n  };\n\n  _proto.sortLayers = function sortLayers(layers) {\n    if (!layers || !Array.isArray(layers)) {\n      return this;\n    }\n\n    var layersToOrder = [];\n    var minZ = Number.MAX_VALUE;\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var layer = layers[i];\n\n      if (isString(layers[i])) {\n        layer = this.getLayer(layer);\n      }\n\n      if (!(layer instanceof Layer) || !layer.getMap() || layer.getMap() !== this) {\n        throw new Error('It must be a layer added to this map to order.');\n      }\n\n      if (layer.getZIndex() < minZ) {\n        minZ = layer.getZIndex();\n      }\n\n      layersToOrder.push(layer);\n    }\n\n    for (var _i = 0, _l = layersToOrder.length; _i < _l; _i++) {\n      layersToOrder[_i].setZIndex(minZ + _i);\n    }\n\n    return this;\n  };\n\n  _proto.toDataURL = function toDataURL(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var mimeType = options['mimeType'];\n\n    if (!mimeType) {\n      mimeType = 'image/png';\n    }\n\n    var save = options['save'];\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.toDataURL) {\n      var file = options['fileName'];\n\n      if (!file) {\n        file = 'export';\n      }\n\n      var dataURL = renderer.toDataURL(mimeType);\n\n      if (save && dataURL) {\n        var imgURL;\n\n        if (typeof Blob !== 'undefined' && typeof atob !== 'undefined') {\n          var blob = b64toBlob(dataURL.replace(/^data:image\\/(png|jpeg|jpg);base64,/, ''), mimeType);\n          imgURL = URL.createObjectURL(blob);\n        } else {\n          imgURL = dataURL;\n        }\n\n        var dlLink = document.createElement('a');\n        dlLink.download = file;\n        dlLink.href = imgURL;\n        document.body.appendChild(dlLink);\n        dlLink.click();\n        document.body.removeChild(dlLink);\n      }\n\n      return dataURL;\n    }\n\n    return null;\n  };\n\n  _proto.coordToPoint = function coordToPoint(coordinate, zoom, out) {\n    return this.coordinateToPoint(coordinate, zoom, out);\n  };\n\n  _proto.pointToCoord = function pointToCoord(point, zoom, out) {\n    return this.pointToCoordinate(point, zoom, out);\n  };\n\n  _proto.coordToViewPoint = function coordToViewPoint(coordinate, out, altitude) {\n    return this.coordinateToViewPoint(coordinate, out, altitude);\n  };\n\n  _proto.viewPointToCoord = function viewPointToCoord(viewPoint, out) {\n    return this.viewPointToCoordinate(viewPoint, out);\n  };\n\n  _proto.coordToContainerPoint = function coordToContainerPoint(coordinate, zoom, out) {\n    return this.coordinateToContainerPoint(coordinate, zoom, out);\n  };\n\n  _proto.containerPointToCoord = function containerPointToCoord(containerPoint, out) {\n    return this.containerPointToCoordinate(containerPoint, out);\n  };\n\n  _proto.containerPointToViewPoint = function containerPointToViewPoint(containerPoint, out) {\n    if (out) {\n      out.set(containerPoint.x, containerPoint.y);\n    } else {\n      out = containerPoint.copy();\n    }\n\n    return out._sub(this.getViewPoint());\n  };\n\n  _proto.viewPointToContainerPoint = function viewPointToContainerPoint(viewPoint, out) {\n    if (out) {\n      out.set(viewPoint.x, viewPoint.y);\n    } else {\n      out = viewPoint.copy();\n    }\n\n    return out._add(this.getViewPoint());\n  };\n\n  _proto.checkSize = function checkSize() {\n    var justStart = now() - this._initTime < 1500 && this.width === 0 || this.height === 0;\n\n    var watched = this._getContainerDomSize(),\n        oldHeight = this.height,\n        oldWidth = this.width;\n\n    if (watched['width'] === oldWidth && watched['height'] === oldHeight) {\n      return this;\n    }\n\n    var center = this.getCenter();\n\n    this._updateMapSize(watched);\n\n    if (!this.options['fixCenterOnResize']) {\n      var resizeOffset = new Point((oldWidth - watched.width) / 2, (oldHeight - watched.height) / 2);\n\n      this._offsetCenterByPixel(resizeOffset);\n\n      this._mapViewCoord = this._getPrjCenter();\n    }\n\n    var hided = watched['width'] === 0 || watched['height'] === 0 || oldWidth === 0 || oldHeight === 0;\n\n    if (justStart || hided) {\n      this._noEvent = true;\n      this.setCenter(center);\n      delete this._noEvent;\n    }\n\n    this._fireEvent('resize');\n\n    return this;\n  };\n\n  _proto.locate = function locate(coordinate, dx, dy) {\n    return this.getProjection()._locate(new Coordinate(coordinate), dx, dy);\n  };\n\n  _proto.getMainPanel = function getMainPanel() {\n    return this._getRenderer().getMainPanel();\n  };\n\n  _proto.getPanels = function getPanels() {\n    return this._panels;\n  };\n\n  _proto.remove = function remove() {\n    if (this.isRemoved()) {\n      return this;\n    }\n\n    this._fireEvent('removestart');\n\n    this._removeDomEvents();\n\n    this._clearHandlers();\n\n    this.removeBaseLayer();\n    var layers = this.getLayers();\n\n    for (var i = 0; i < layers.length; i++) {\n      layers[i].remove();\n    }\n\n    if (this._getRenderer()) {\n      this._getRenderer().remove();\n    }\n\n    if (this._containerDOM.innerHTML) {\n      this._containerDOM.innerHTML = '';\n    }\n\n    delete this._panels;\n    delete this._containerDOM;\n    delete this.renderer;\n\n    this._fireEvent('removeend');\n\n    this._clearAllListeners();\n\n    return this;\n  };\n\n  _proto.isRemoved = function isRemoved() {\n    return !this._containerDOM;\n  };\n\n  _proto.isMoving = function isMoving() {\n    return !!this._moving;\n  };\n\n  _proto.onMoveStart = function onMoveStart(param) {\n    var prjCenter = this._getPrjCenter();\n\n    if (!this._originCenter || this._verifyExtent(prjCenter)) {\n      this._originCenter = prjCenter;\n    }\n\n    this._moving = true;\n\n    this._trySetCursor('move');\n\n    this._fireEvent('movestart', this._parseEvent(param ? param['domEvent'] : null, 'movestart'));\n  };\n\n  _proto.onMoving = function onMoving(param) {\n    this._fireEvent('moving', this._parseEvent(param ? param['domEvent'] : null, 'moving'));\n  };\n\n  _proto.onMoveEnd = function onMoveEnd(param) {\n    this._moving = false;\n\n    this._trySetCursor('default');\n\n    this._fireEvent('moveend', param && param['domEvent'] ? this._parseEvent(param['domEvent'], 'moveend') : param);\n\n    if (!this._verifyExtent(this._getPrjCenter()) && this._originCenter) {\n      var moveTo = this._originCenter;\n\n      this._panTo(moveTo);\n    }\n  };\n\n  _proto.onDragRotateStart = function onDragRotateStart(param) {\n    this._dragRotating = true;\n\n    this._fireEvent('dragrotatestart', this._parseEvent(param ? param['domEvent'] : null, 'dragrotatestart'));\n  };\n\n  _proto.onDragRotating = function onDragRotating(param) {\n    this._fireEvent('dragrotating', this._parseEvent(param ? param['domEvent'] : null, 'dragrotating'));\n  };\n\n  _proto.onDragRotateEnd = function onDragRotateEnd(param) {\n    this._dragRotating = false;\n\n    this._fireEvent('dragrotateend', this._parseEvent(param ? param['domEvent'] : null, 'dragrotateend'));\n  };\n\n  _proto.isDragRotating = function isDragRotating() {\n    return !!this._dragRotating;\n  };\n\n  _proto.getRenderer = function getRenderer() {\n    return this._getRenderer();\n  };\n\n  _proto.getDevicePixelRatio = function getDevicePixelRatio() {\n    return this.options['devicePixelRatio'] || Browser$1.devicePixelRatio || 1;\n  };\n\n  _proto._initContainer = function _initContainer(container) {\n    if (isString(container)) {\n      this._containerDOM = document.getElementById(container);\n\n      if (!this._containerDOM) {\n        throw new Error('Invalid container when creating map: \\'' + container + '\\'');\n      }\n    } else {\n      this._containerDOM = container;\n\n      if (IS_NODE) {\n        this.CanvasClass = this._containerDOM.constructor;\n      }\n    }\n\n    if (this._containerDOM.childNodes && this._containerDOM.childNodes.length > 0) {\n      if (this._containerDOM.childNodes[0].className === 'maptalks-wrapper') {\n        throw new Error('Container is already loaded with another map instance, use map.remove() to clear it.');\n      }\n    }\n  };\n\n  _proto._trySetCursor = function _trySetCursor(cursor) {\n    if (!this._cursor && !this._priorityCursor) {\n      if (!cursor) {\n        cursor = 'default';\n      }\n\n      this._setCursorToPanel(cursor);\n    }\n\n    return this;\n  };\n\n  _proto._setPriorityCursor = function _setPriorityCursor(cursor) {\n    if (!cursor) {\n      var hasCursor = false;\n\n      if (this._priorityCursor) {\n        hasCursor = true;\n      }\n\n      delete this._priorityCursor;\n\n      if (hasCursor) {\n        this.setCursor(this._cursor);\n      }\n    } else {\n      this._priorityCursor = cursor;\n\n      this._setCursorToPanel(cursor);\n    }\n\n    return this;\n  };\n\n  _proto._setCursorToPanel = function _setCursorToPanel(cursor) {\n    var panel = this.getMainPanel();\n\n    if (panel && panel.style && panel.style.cursor !== cursor) {\n      panel.style.cursor = cursor;\n    }\n  };\n\n  _proto._removeLayer = function _removeLayer(layer, layerList) {\n    if (!layer || !layerList) {\n      return;\n    }\n\n    var index = layerList.indexOf(layer);\n\n    if (index > -1) {\n      layerList.splice(index, 1);\n    }\n  };\n\n  _proto._sortLayersByZIndex = function _sortLayersByZIndex() {\n    if (!this._layers) {\n      return;\n    }\n\n    for (var i = 0, l = this._layers.length; i < l; i++) {\n      this._layers[i]._order = i;\n    }\n\n    this._layers.sort(function (a, b) {\n      var c = a.getZIndex() - b.getZIndex();\n\n      if (c === 0) {\n        return a._order - b._order;\n      }\n\n      return c;\n    });\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (this._noEvent) {\n      return;\n    }\n\n    this.fire('_' + eventName, param);\n    this.fire(eventName, param);\n  };\n\n  _proto._Load = function _Load() {\n    this._resetMapStatus();\n\n    if (this.options['pitch']) {\n      this.setPitch(this.options['pitch']);\n      delete this.options['pitch'];\n    }\n\n    if (this.options['bearing']) {\n      this.setBearing(this.options['bearing']);\n      delete this.options['bearing'];\n    }\n\n    this._loadAllLayers();\n\n    this._getRenderer().onLoad();\n\n    this._loaded = true;\n\n    this._callOnLoadHooks();\n\n    this._initTime = now();\n  };\n\n  _proto._initRenderer = function _initRenderer() {\n    var renderer = this.options['renderer'];\n    var clazz = Map.getRendererClass(renderer);\n    this._renderer = new clazz(this);\n\n    this._renderer.load();\n  };\n\n  _proto._getRenderer = function _getRenderer() {\n    return this._renderer;\n  };\n\n  _proto._loadAllLayers = function _loadAllLayers() {\n    function loadLayer(layer) {\n      if (layer) {\n        layer.load();\n      }\n    }\n\n    if (this._baseLayer) {\n      this._baseLayer.load();\n    }\n\n    this._eachLayer(loadLayer, this.getLayers());\n  };\n\n  _proto._getLayers = function _getLayers(filter) {\n    var layers = this._baseLayer ? [this._baseLayer].concat(this._layers) : this._layers;\n    var result = [];\n\n    for (var i = 0; i < layers.length; i++) {\n      if (!filter || filter.call(this, layers[i])) {\n        result.push(layers[i]);\n      }\n    }\n\n    return result;\n  };\n\n  _proto._eachLayer = function _eachLayer(fn) {\n    if (arguments.length < 2) {\n      return;\n    }\n\n    var layerLists = Array.prototype.slice.call(arguments, 1);\n\n    if (layerLists && !Array.isArray(layerLists)) {\n      layerLists = [layerLists];\n    }\n\n    var layers = [];\n\n    for (var i = 0, len = layerLists.length; i < len; i++) {\n      layers = layers.concat(layerLists[i]);\n    }\n\n    for (var j = 0, jlen = layers.length; j < jlen; j++) {\n      fn.call(fn, layers[j]);\n    }\n  };\n\n  _proto._onLayerEvent = function _onLayerEvent(param) {\n    if (!param) {\n      return;\n    }\n\n    if (param['type'] === 'idchange') {\n      delete this._layerCache[param['old']];\n      this._layerCache[param['new']] = param['target'];\n    }\n  };\n\n  _proto._resetMapStatus = function _resetMapStatus() {\n    var maxZoom = this.getMaxZoom(),\n        minZoom = this.getMinZoom();\n\n    var viewMaxZoom = this._spatialReference.getMaxZoom(),\n        viewMinZoom = this._spatialReference.getMinZoom();\n\n    if (isNil(maxZoom) || maxZoom === -1 || maxZoom > viewMaxZoom) {\n      this.setMaxZoom(viewMaxZoom);\n    }\n\n    if (isNil(minZoom) || minZoom === -1 || minZoom < viewMinZoom) {\n      this.setMinZoom(viewMinZoom);\n    }\n\n    maxZoom = this.getMaxZoom();\n    minZoom = this.getMinZoom();\n\n    if (maxZoom < minZoom) {\n      this.setMaxZoom(minZoom);\n    }\n\n    if (isNil(this._zoomLevel) || this._zoomLevel > maxZoom) {\n      this._zoomLevel = maxZoom;\n    }\n\n    if (this._zoomLevel < minZoom) {\n      this._zoomLevel = minZoom;\n    }\n\n    delete this._prjCenter;\n    var projection = this.getProjection();\n    this._prjCenter = projection.project(this._center);\n\n    this._calcMatrices();\n\n    var renderer = this._getRenderer();\n\n    if (renderer) {\n      renderer.resetContainer();\n    }\n  };\n\n  _proto._getContainerDomSize = function _getContainerDomSize() {\n    if (!this._containerDOM) {\n      return null;\n    }\n\n    var containerDOM = this._containerDOM;\n    var width, height;\n\n    if (!isNil(containerDOM.width) && !isNil(containerDOM.height)) {\n      width = containerDOM.width;\n      height = containerDOM.height;\n      var dpr = this.getDevicePixelRatio();\n\n      if (dpr !== 1 && containerDOM['layer']) {\n        width /= dpr;\n        height /= dpr;\n      }\n    } else if (!isNil(containerDOM.clientWidth) && !isNil(containerDOM.clientHeight)) {\n      width = parseInt(containerDOM.clientWidth, 0);\n      height = parseInt(containerDOM.clientHeight, 0);\n    } else {\n      throw new Error('can not get size of container');\n    }\n\n    return new Size(width, height);\n  };\n\n  _proto._updateMapSize = function _updateMapSize(mSize) {\n    this.width = mSize['width'];\n    this.height = mSize['height'];\n\n    this._getRenderer().updateMapSize(mSize);\n\n    this._calcMatrices();\n\n    return this;\n  };\n\n  _proto._getPrjCenter = function _getPrjCenter() {\n    return this._prjCenter;\n  };\n\n  _proto._setPrjCenter = function _setPrjCenter(pcenter) {\n    this._prjCenter = pcenter;\n\n    if (this.isInteracting() && !this.isMoving()) {\n      this._mapViewCoord = pcenter;\n    }\n\n    this._calcMatrices();\n  };\n\n  _proto._setPrjCoordAtContainerPoint = function _setPrjCoordAtContainerPoint(coordinate, point) {\n    if (point.x === this.width / 2 && point.y === this.height / 2) {\n      return this;\n    }\n\n    var t = this._containerPointToPoint(point)._sub(this._prjToPoint(this._getPrjCenter()));\n\n    var pcenter = this._pointToPrj(this._prjToPoint(coordinate).sub(t));\n\n    this._setPrjCenter(pcenter);\n\n    return this;\n  };\n\n  _proto._verifyExtent = function _verifyExtent(prjCenter) {\n    if (!prjCenter) {\n      return false;\n    }\n\n    var maxExt = this._prjMaxExtent;\n\n    if (!maxExt) {\n      return true;\n    }\n\n    return maxExt.contains(prjCenter);\n  };\n\n  _proto._offsetCenterByPixel = function _offsetCenterByPixel(pixel) {\n    var pos = new Point(this.width / 2 - pixel.x, this.height / 2 - pixel.y);\n\n    var pCenter = this._containerPointToPrj(pos);\n\n    this._setPrjCenter(pCenter);\n\n    return pCenter;\n  };\n\n  _proto.offsetPlatform = function offsetPlatform(offset) {\n    if (!offset) {\n      return this._mapViewPoint;\n    } else {\n      this._getRenderer().offsetPlatform(offset);\n\n      this._mapViewCoord = this._getPrjCenter();\n      this._mapViewPoint = this._mapViewPoint.add(offset);\n      return this;\n    }\n  };\n\n  _proto.getViewPoint = function getViewPoint() {\n    var offset = this._getViewPointFrameOffset();\n\n    var panelOffset = this.offsetPlatform();\n\n    if (offset) {\n      panelOffset = panelOffset.add(offset);\n    }\n\n    return panelOffset;\n  };\n\n  _proto._resetMapViewPoint = function _resetMapViewPoint() {\n    this._mapViewPoint = new Point(0, 0);\n    this._mapViewCoord = this._getPrjCenter();\n  };\n\n  _proto._getResolution = function _getResolution(zoom) {\n    if ((zoom === undefined || zoom === this._zoomLevel) && this._mapRes !== undefined) {\n      return this._mapRes;\n    } else if (zoom === this.getGLZoom() && this._mapGlRes !== undefined) {\n      return this._mapGlRes;\n    }\n\n    if (isNil(zoom)) {\n      zoom = this._zoomLevel;\n    }\n\n    return this._spatialReference.getResolution(zoom);\n  };\n\n  _proto._getResolutions = function _getResolutions() {\n    return this._spatialReference.getResolutions();\n  };\n\n  _proto._prjToPoint = function _prjToPoint(pCoord, zoom, out) {\n    zoom = isNil(zoom) ? this.getZoom() : zoom;\n    return this._spatialReference.getTransformation().transform(pCoord, this._getResolution(zoom), out);\n  };\n\n  _proto._pointToPrj = function _pointToPrj(point, zoom, out) {\n    zoom = isNil(zoom) ? this.getZoom() : zoom;\n    return this._spatialReference.getTransformation().untransform(point, this._getResolution(zoom), out);\n  };\n\n  _proto._pointToPoint = function _pointToPoint(point, zoom, out) {\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    if (!isNil(zoom)) {\n      return out._multi(this._getResolution(zoom) / this._getResolution());\n    }\n\n    return out;\n  };\n\n  _proto._pointToPointAtZoom = function _pointToPointAtZoom(point, zoom, out) {\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    if (!isNil(zoom)) {\n      return out._multi(this._getResolution() / this._getResolution(zoom));\n    }\n\n    return out;\n  };\n\n  _proto._containerPointToPrj = function _containerPointToPrj(containerPoint, out) {\n    return this._pointToPrj(this._containerPointToPoint(containerPoint, undefined, out), undefined, out);\n  };\n\n  _proto._callOnLoadHooks = function _callOnLoadHooks() {\n    var proto = Map.prototype;\n\n    if (!proto._onLoadHooks) {\n      return;\n    }\n\n    for (var i = 0, l = proto._onLoadHooks.length; i < l; i++) {\n      proto._onLoadHooks[i].call(this);\n    }\n  };\n\n  return Map;\n}(Handlerable(Eventable(Renderable(Class))));\n\nMap$1.include({\n  coordinateToPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, zoom, out) {\n      var prjCoord = this.getProjection().project(coordinate, COORD);\n      return this._prjToPoint(prjCoord, zoom, out);\n    };\n  }(),\n  pointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, zoom, out) {\n      var prjCoord = this._pointToPrj(point, zoom, COORD);\n\n      return this.getProjection().unproject(prjCoord, out);\n    };\n  }(),\n  coordinateToViewPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, out, altitude) {\n      return this._prjToViewPoint(this.getProjection().project(coordinate, COORD), out, altitude);\n    };\n  }(),\n  viewPointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (viewPoint, out) {\n      return this.getProjection().unproject(this._viewPointToPrj(viewPoint, COORD), out);\n    };\n  }(),\n  coordinateToContainerPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, zoom, out) {\n      var pCoordinate = this.getProjection().project(coordinate, COORD);\n      return this._prjToContainerPoint(pCoordinate, zoom, out);\n    };\n  }(),\n  containerPointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (containerPoint, out) {\n      var pCoordinate = this._containerPointToPrj(containerPoint, COORD);\n\n      return this.getProjection().unproject(pCoordinate, out);\n    };\n  }(),\n  containerToExtent: function () {\n    var POINT0 = new Point(0, 0);\n    var POINT1 = new Point(0, 0);\n    return function (containerExtent) {\n      var extent2D = new PointExtent(this._containerPointToPoint(containerExtent.getMin(POINT0), undefined, POINT0), this._containerPointToPoint(containerExtent.getMax(POINT1), undefined, POINT1));\n      return this._pointToExtent(extent2D);\n    };\n  }(),\n  distanceToPixel: function () {\n    var POINT0 = new Point(0, 0);\n    var POINT1 = new Point(0, 0);\n    return function (xDist, yDist, zoom) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var scale = this.getScale() / this.getScale(zoom);\n      var center = this.getCenter(),\n          target = projection.locate(center, xDist, yDist);\n      var p0 = this.coordToContainerPoint(center, undefined, POINT0),\n          p1 = this.coordToContainerPoint(target, undefined, POINT1);\n\n      p1._sub(p0)._multi(scale)._abs();\n\n      return new Size(p1.x, p1.y);\n    };\n  }(),\n  distanceToPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (xDist, yDist, zoom, paramCenter) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var center = paramCenter || this.getCenter(),\n          target = projection.locate(center, xDist, yDist);\n      var p0 = this.coordToPoint(center, zoom, POINT),\n          p1 = this.coordToPoint(target, zoom);\n\n      p1._sub(p0)._abs();\n\n      return p1;\n    };\n  }(),\n  pixelToDistance: function () {\n    var COORD0 = new Coordinate(0, 0);\n    var COORD1 = new Coordinate(0, 0);\n    return function (width, height) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var fullExt = this.getFullExtent();\n      var d = fullExt['top'] > fullExt['bottom'] ? -1 : 1;\n      var target = COORD0.set(this.width / 2 + width, this.height / 2 + d * height);\n      var coord = this.containerPointToCoord(target, COORD1);\n      return projection.measureLength(this.getCenter(), coord);\n    };\n  }(),\n  pointToDistance: function () {\n    var POINT = new Point(0, 0);\n    var COORD = new Coordinate(0, 0);\n    return function (dx, dy, zoom) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var c = this._prjToPoint(this._getPrjCenter(), zoom, POINT);\n\n      c._add(dx, dy);\n\n      var target = this.pointToCoord(c, zoom, COORD);\n      return projection.measureLength(this.getCenter(), target);\n    };\n  }(),\n  locateByPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (coordinate, px, py) {\n      var point = this.coordToContainerPoint(coordinate, undefined, POINT);\n      return this.containerPointToCoord(point._add(px, py));\n    };\n  }(),\n  _get2DExtent: function () {\n    var POINT = new Point(0, 0);\n    return function (zoom, out) {\n      var _this3 = this;\n\n      var cached;\n\n      if ((zoom === undefined || zoom === this._zoomLevel) && this._mapExtent2D) {\n        cached = this._mapExtent2D;\n      } else if (zoom === this.getGLZoom() && this._mapGlExtent2D) {\n        cached = this._mapGlExtent2D;\n      }\n\n      if (cached) {\n        if (out) {\n          out.set(cached['xmin'], cached['ymin'], cached['xmax'], cached['ymax']);\n          return out;\n        }\n\n        return cached.copy();\n      }\n\n      var cExtent = this.getContainerExtent();\n      return cExtent.convertTo(function (c) {\n        return _this3._containerPointToPoint(c, zoom, POINT);\n      }, out);\n    };\n  }(),\n  _pointToExtent: function () {\n    var COORD0 = new Coordinate(0, 0);\n    var COORD1 = new Coordinate(0, 0);\n    return function (extent2D) {\n      var min2d = extent2D.getMin(),\n          max2d = extent2D.getMax();\n      var fullExtent = this.getFullExtent();\n\n      var _ref = !fullExtent || fullExtent.left <= fullExtent.right ? [min2d.x, max2d.x] : [max2d.x, min2d.x],\n          minx = _ref[0],\n          maxx = _ref[1];\n\n      var _ref2 = !fullExtent || fullExtent.top > fullExtent.bottom ? [max2d.y, min2d.y] : [min2d.y, max2d.y],\n          miny = _ref2[0],\n          maxy = _ref2[1];\n\n      var min = min2d.set(minx, maxy);\n      var max = max2d.set(maxx, miny);\n      return new Extent(this.pointToCoord(min, undefined, COORD0), this.pointToCoord(max, undefined, COORD1), this.getProjection());\n    };\n  }(),\n  _getViewPointFrameOffset: function () {\n    var POINT = new Point(0, 0);\n    return function () {\n      if (this.isZooming()) {\n        return null;\n      }\n\n      var pcenter = this._getPrjCenter();\n\n      if (this._mapViewCoord && !this._mapViewCoord.equals(pcenter)) {\n        return this._prjToContainerPoint(this._mapViewCoord)._sub(this._prjToContainerPoint(pcenter, undefined, POINT));\n      }\n\n      return null;\n    };\n  }(),\n  _viewPointToPrj: function () {\n    var POINT = new Point(0, 0);\n    return function (viewPoint, out) {\n      return this._containerPointToPrj(this.viewPointToContainerPoint(viewPoint, POINT), out);\n    };\n  }(),\n  _prjToContainerPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (pCoordinate, zoom, out, altitude) {\n      return this._pointToContainerPoint(this._prjToPoint(pCoordinate, zoom, POINT), zoom, altitude || 0, out);\n    };\n  }(),\n  _prjToViewPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (pCoordinate, out, altitude) {\n      var containerPoint = this._prjToContainerPoint(pCoordinate, undefined, POINT, altitude);\n\n      return this.containerPointToViewPoint(containerPoint, out);\n    };\n  }(),\n  _viewPointToPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (viewPoint, zoom, out) {\n      return this._containerPointToPoint(this.viewPointToContainerPoint(viewPoint, POINT), zoom, out);\n    };\n  }(),\n  _pointToViewPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, zoom, out) {\n      return this._prjToViewPoint(this._pointToPrj(point, zoom, COORD), out);\n    };\n  }()\n});\nMap$1.mergeOptions(options$2);\n\nvar MapDoubleClickZoomHandler = function (_Handler) {\n  _inheritsLoose(MapDoubleClickZoomHandler, _Handler);\n\n  function MapDoubleClickZoomHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapDoubleClickZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.on('_dblclick', this._onDoubleClick, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.off('_dblclick', this._onDoubleClick, this);\n  };\n\n  _proto._onDoubleClick = function _onDoubleClick(param) {\n    var map = this.target;\n\n    if (map.options['doubleClickZoom']) {\n      var oldZoom = map.getZoom(),\n          zoom = param['domEvent']['shiftKey'] ? Math.ceil(oldZoom) - 1 : Math.floor(oldZoom) + 1;\n\n      map._zoomAnimation(zoom, param['containerPoint']);\n    }\n  };\n\n  return MapDoubleClickZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'doubleClickZoom': true\n});\nMap$1.addOnLoadHook('addHandler', 'doubleClickZoom', MapDoubleClickZoomHandler);\n\nvar MapDragHandler = function (_Handler) {\n  _inheritsLoose(MapDragHandler, _Handler);\n\n  function MapDragHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapDragHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    var map = this.target;\n\n    if (!map) {\n      return;\n    }\n\n    var dom = map._panels.mapWrapper || map._containerDOM;\n    this._dragHandler = new DragHandler(dom, {\n      'cancelOn': this._cancelOn.bind(this),\n      'rightclick': true\n    });\n\n    this._dragHandler.on('mousedown', this._onMouseDown, this).on('dragstart', this._onDragStart, this).on('dragging', this._onDragging, this).on('dragend', this._onDragEnd, this).enable();\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this._dragHandler.off('mousedown', this._onMouseDown, this).off('dragstart', this._onDragStart, this).off('dragging', this._onDragging, this).off('dragend', this._onDragEnd, this);\n\n    this._dragHandler.remove();\n\n    delete this._dragHandler;\n  };\n\n  _proto._cancelOn = function _cancelOn(domEvent) {\n    if (this.target.isZooming() || this._ignore(domEvent)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto._ignore = function _ignore(param) {\n    if (!param) {\n      return false;\n    }\n\n    if (param.domEvent) {\n      param = param.domEvent;\n    }\n\n    return this.target._ignoreEvent(param);\n  };\n\n  _proto._onMouseDown = function _onMouseDown(param) {\n    delete this.startDragTime;\n    delete this._mode;\n\n    if (param.domEvent.button === 2 || param.domEvent.ctrlKey) {\n      if (this.target.options['dragRotate'] || this.target.options['dragPitch']) {\n        this._mode = 'rotatePitch';\n      }\n    } else if (this.target.options['dragPan']) {\n      this._mode = 'move';\n    }\n\n    this.target._stopAnim(this.target._mapAnimPlayer);\n\n    preventDefault(param['domEvent']);\n  };\n\n  _proto._onDragStart = function _onDragStart(param) {\n    this.startDragTime = now();\n\n    if (this._mode === 'move') {\n      this._moveStart(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotateStart(param);\n    }\n  };\n\n  _proto._onDragging = function _onDragging(param) {\n    var map = this.target;\n\n    if (map._isEventOutMap(param['domEvent'])) {\n      return;\n    }\n\n    if (this._mode === 'move') {\n      this._moving(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotating(param);\n    }\n  };\n\n  _proto._onDragEnd = function _onDragEnd(param) {\n    if (this._mode === 'move') {\n      this._moveEnd(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotateEnd(param);\n    }\n\n    delete this.startDragTime;\n    delete this.startBearing;\n  };\n\n  _proto._start = function _start(param) {\n    this.preX = param['mousePos'].x;\n    this.preY = param['mousePos'].y;\n    this.startX = this.preX;\n    this.startY = this.preY;\n  };\n\n  _proto._moveStart = function _moveStart(param) {\n    this._start(param);\n\n    var map = this.target;\n    map.onMoveStart(param);\n    var p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n    this.startPrjCoord = map._containerPointToPrj(p);\n  };\n\n  _proto._moving = function _moving(param) {\n    if (!this.startDragTime) {\n      return;\n    }\n\n    var map = this.target;\n    var p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n\n    map._setPrjCoordAtContainerPoint(this.startPrjCoord, p);\n\n    map.onMoving(param);\n  };\n\n  _proto._moveEnd = function _moveEnd(param) {\n    if (!this.startDragTime) {\n      return;\n    }\n\n    var map = this.target;\n    var t = now() - this.startDragTime;\n    var mx = param['mousePos'].x,\n        my = param['mousePos'].y;\n    var dx = mx - this.startX;\n    var dy = my - this.startY;\n\n    this._clear();\n\n    if (map.options['panAnimation'] && !param.interupted && map._verifyExtent(map._getPrjCenter()) && t < 280 && Math.abs(dy) + Math.abs(dx) > 5) {\n      t = 5 * t * (Math.abs(dx) + Math.abs(dy)) / 500;\n      map.panBy(new Point(dx, dy), {\n        'duration': t\n      });\n    } else {\n      map.onMoveEnd(param);\n    }\n  };\n\n  _proto._rotateStart = function _rotateStart(param) {\n    this._start(param);\n\n    delete this._rotateMode;\n    this.startBearing = this.target.getBearing();\n    this.target.onDragRotateStart(param);\n    this._db = 0;\n  };\n\n  _proto._rotating = function _rotating(param) {\n    var map = this.target;\n    var mx = param['mousePos'].x,\n        my = param['mousePos'].y;\n    var prePitch = map.getPitch(),\n        preBearing = map.getBearing();\n    var dx = Math.abs(mx - this.preX),\n        dy = Math.abs(my - this.preY);\n\n    if (!this._rotateMode) {\n      if (map.options['dragRotatePitch']) {\n        this._rotateMode = 'rotate_pitch';\n      } else if (dx > dy) {\n        this._rotateMode = 'rotate';\n      } else if (dx < dy) {\n        this._rotateMode = 'pitch';\n      } else {\n        this._rotateMode = 'rotate';\n      }\n    }\n\n    if (this._rotateMode === 'pitch' && prePitch === 0 && dy < 10) {\n      return;\n    }\n\n    if (this._rotateMode.indexOf('rotate') >= 0 && map.options['dragRotate']) {\n      var db = 0;\n\n      if (map.options['dragPitch'] || dx > dy) {\n        db = -0.6 * (this.preX - mx);\n      } else if (mx > map.width / 2) {\n        db = 0.6 * (this.preY - my);\n      } else {\n        db = -0.6 * (this.preY - my);\n      }\n\n      var bearing = map.getBearing() + db;\n      this._db = this._db || 0;\n      this._db += db;\n      map.setBearing(bearing);\n    }\n\n    if (this._rotateMode.indexOf('pitch') >= 0 && map.options['dragPitch']) {\n      map.setPitch(map.getPitch() + (this.preY - my) * 0.4);\n    }\n\n    this.preX = mx;\n    this.preY = my;\n\n    if (map.getBearing() !== preBearing || map.getPitch() !== prePitch) {\n      map.onDragRotating(param);\n    }\n  };\n\n  _proto._rotateEnd = function _rotateEnd(param) {\n    var map = this.target;\n    var bearing = map.getBearing();\n\n    this._clear();\n\n    var t = now() - this.startDragTime;\n    map.onDragRotateEnd(param);\n\n    if (Math.abs(bearing - this.startBearing) > 20 && (this._rotateMode === 'rotate' || this._rotateMode === 'rotate_pitch') && !param.interupted && t < 400) {\n      var _bearing = map.getBearing();\n\n      map._animateTo({\n        'bearing': _bearing + this._db / 2\n      }, {\n        'easing': 'out',\n        'duration': 800\n      });\n    }\n  };\n\n  _proto._clear = function _clear() {\n    delete this.startPrjCoord;\n    delete this.preX;\n    delete this.preY;\n    delete this.startX;\n    delete this.startY;\n  };\n\n  return MapDragHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'draggable': true,\n  'dragPan': true,\n  'dragRotatePitch': true,\n  'dragRotate': true,\n  'dragPitch': true\n});\nMap$1.addOnLoadHook('addHandler', 'draggable', MapDragHandler);\nvar EVENTS = 'mousedown ' + 'mouseup ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'touchstart ' + 'touchmove ' + 'touchend';\n\nvar MapGeometryEventsHandler = function (_Handler) {\n  _inheritsLoose(MapGeometryEventsHandler, _Handler);\n\n  function MapGeometryEventsHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapGeometryEventsHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    var map = this.target;\n    var dom = map._panels.allLayers || map._containerDOM;\n    on(dom, EVENTS, this._identifyGeometryEvents, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    var map = this.target;\n    var dom = map._panels.allLayers || map._containerDOM;\n    off(dom, EVENTS, this._identifyGeometryEvents, this);\n  };\n\n  _proto._identifyGeometryEvents = function _identifyGeometryEvents(domEvent, type) {\n    var map = this.target;\n\n    if (map.isInteracting() || map._ignoreEvent(domEvent)) {\n      return;\n    }\n\n    var layers = map._getLayers(function (layer) {\n      if (layer.identify && layer.options['geometryEvents']) {\n        return true;\n      }\n\n      return false;\n    });\n\n    if (!layers.length) {\n      return;\n    }\n\n    var oneMoreEvent = null;\n    var eventType = type || domEvent.type;\n\n    if (eventType === 'mousedown' || eventType === 'touchstart' && domEvent.touches.length === 1) {\n      this._mouseDownTime = now();\n    } else if ((eventType === 'click' || eventType === 'touchend') && this._mouseDownTime) {\n      var downTime = this._mouseDownTime;\n      delete this._mouseDownTime;\n      var time = now();\n\n      if (time - downTime > 300) {\n        if (eventType === 'click') {\n          return;\n        }\n      } else if (eventType === 'touchend') {\n        oneMoreEvent = 'click';\n      }\n    }\n\n    var actual = domEvent.touches && domEvent.touches.length > 0 ? domEvent.touches[0] : domEvent.changedTouches && domEvent.changedTouches.length > 0 ? domEvent.changedTouches[0] : domEvent;\n\n    if (!actual) {\n      return;\n    }\n\n    var containerPoint = getEventContainerPoint(actual, map._containerDOM),\n        coordinate = map.containerPointToCoordinate(containerPoint);\n\n    if (eventType === 'touchstart') {\n      preventDefault(domEvent);\n    }\n\n    var geometryCursorStyle = null;\n    var identifyOptions = {\n      'includeInternals': true,\n      'filter': function filter(geometry) {\n        if (!(geometry instanceof Geometry)) {\n          return false;\n        }\n\n        var eventToFire = geometry._getEventTypeToFire(domEvent);\n\n        if (eventType === 'mousemove') {\n          if (!geometryCursorStyle && geometry.options['cursor']) {\n            geometryCursorStyle = geometry.options['cursor'];\n          }\n\n          if (!geometry.listens('mousemove') && !geometry.listens('mouseover') && !geometry.listens('mouseenter')) {\n            return false;\n          }\n        } else if (!geometry.listens(eventToFire) && !geometry.listens(oneMoreEvent)) {\n          return false;\n        }\n\n        return true;\n      },\n      'count': 1,\n      'coordinate': coordinate,\n      'onlyVisible': map.options['onlyVisibleGeometryEvents'],\n      'layers': layers\n    };\n    var callback = fireGeometryEvent.bind(this);\n\n    if (eventType === 'mousemove' || eventType === 'touchmove') {\n      this._queryIdentifyTimeout = map.getRenderer().callInNextFrame(function () {\n        if (map.isInteracting()) {\n          return;\n        }\n\n        map.identify(identifyOptions, callback);\n      });\n    } else {\n      map.identify(identifyOptions, callback);\n    }\n\n    function fireGeometryEvent(geometries) {\n      var propagation = true;\n\n      if (eventType === 'mousemove') {\n        var geoMap = {};\n\n        if (geometries.length > 0) {\n          for (var i = geometries.length - 1; i >= 0; i--) {\n            var geo = geometries[i];\n\n            if (!(geo instanceof Geometry)) {\n              continue;\n            }\n\n            var iid = geo._getInternalId();\n\n            geoMap[iid] = geo;\n\n            geo._onEvent(domEvent);\n\n            if (!this._prevOverGeos || !this._prevOverGeos.geomap[iid]) {\n              geo._onEvent(domEvent, 'mouseenter');\n            }\n\n            propagation = geo._onEvent(domEvent, 'mouseover');\n          }\n        }\n\n        map._setPriorityCursor(geometryCursorStyle);\n\n        var oldTargets = this._prevOverGeos && this._prevOverGeos.geos;\n        this._prevOverGeos = {\n          'geos': geometries,\n          'geomap': geoMap\n        };\n\n        if (oldTargets && oldTargets.length > 0) {\n          for (var _i = oldTargets.length - 1; _i >= 0; _i--) {\n            var oldTarget = oldTargets[_i];\n\n            if (!(oldTarget instanceof Geometry)) {\n              continue;\n            }\n\n            var oldTargetId = oldTargets[_i]._getInternalId();\n\n            if (!geoMap[oldTargetId]) {\n              propagation = oldTarget._onEvent(domEvent, 'mouseout');\n            }\n          }\n        }\n      } else {\n        if (!geometries || !geometries.length) {\n          return;\n        }\n\n        for (var _i2 = geometries.length - 1; _i2 >= 0; _i2--) {\n          if (!(geometries[_i2] instanceof Geometry)) {\n            continue;\n          }\n\n          propagation = geometries[_i2]._onEvent(domEvent);\n\n          if (oneMoreEvent) {\n            geometries[_i2]._onEvent(domEvent, oneMoreEvent);\n          }\n\n          break;\n        }\n      }\n\n      if (propagation === false) {\n        stopPropagation(domEvent);\n      }\n    }\n  };\n\n  return MapGeometryEventsHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'geometryEvents': true,\n  'onlyVisibleGeometryEvents': true\n});\nMap$1.addOnLoadHook('addHandler', 'geometryEvents', MapGeometryEventsHandler);\nvar wheelZoomDelta = 4.000244140625;\nvar defaultZoomRate = 1 / 100;\nvar wheelZoomRate = 1 / 450;\nvar maxScalePerFrame = 2;\n\nvar MapScrollWheelZoomHandler = function (_Handler) {\n  _inheritsLoose(MapScrollWheelZoomHandler, _Handler);\n\n  function MapScrollWheelZoomHandler(target) {\n    var _this;\n\n    _this = _Handler.call(this, target) || this;\n    _this._thisScrollZoom = _this._scrollZoom.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this._wheelZoomRate = wheelZoomRate;\n    _this._defaultZoomRate = defaultZoomRate;\n    _this._delta = 0;\n    return _this;\n  }\n\n  var _proto = MapScrollWheelZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    addDomEvent(this.target._containerDOM, 'wheel', this._onWheelScroll, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    removeDomEvent(this.target._containerDOM, 'wheel', this._onWheelScroll);\n  };\n\n  _proto._onWheelScroll = function _onWheelScroll(evt) {\n    //preventDefault(evt);\n    //stopPropagation(evt);\n    var map = this.target;\n\n    if (map._ignoreEvent(evt) || !map.options['zoomable']) {\n      return false;\n    }\n\n    var container = map._containerDOM;\n\n    var origin = map._checkZoomOrigin(getEventContainerPoint(evt, container));\n\n    if (map.options['seamlessZoom']) {\n      if (!this._zooming) {\n        this._trackPadSuspect = 0;\n        this._ensureTrackpad = false;\n      }\n\n      return this._seamless(evt, origin);\n    } else {\n      return this._interval(evt, origin);\n    }\n  };\n\n  _proto._seamless = function _seamless(evt, origin) {\n    var value = evt.deltaMode === window.WheelEvent.DOM_DELTA_LINE ? evt.deltaY * 60 : evt.deltaY;\n\n    if (value % wheelZoomDelta !== 0) {\n      if (!this._ensureTrackpad) {\n        if (Math.abs(value) < 60) {\n          this._trackPadSuspect++;\n        } else {\n          this._trackPadSuspect = 0;\n        }\n\n        if (this._trackPadSuspect >= 2) {\n          this._ensureTrackpad = true;\n        }\n      }\n\n      if (this._ensureTrackpad) {\n        value *= 14;\n      }\n    }\n\n    if (evt.shiftKey && value) value = value / 4;\n    this._lastWheelEvent = evt;\n    this._delta -= value;\n\n    if (!this._zooming && this._delta) {\n      var map = this.target;\n      this._zoomOrigin = origin;\n      map.onZoomStart(null, origin);\n    }\n\n    this._start();\n  };\n\n  _proto._start = function _start() {\n    if (!this._delta) return;\n    this._zooming = true;\n    var map = this.target;\n\n    if (!this._active) {\n      map.getRenderer().callInNextFrame(this._thisScrollZoom);\n      this._active = true;\n    }\n  };\n\n  _proto._scrollZoom = function _scrollZoom() {\n    var _this2 = this;\n\n    this._active = false;\n\n    if (!this._delta) {\n      return;\n    }\n\n    var zoomRate = Math.abs(this._delta) > wheelZoomDelta ? this._wheelZoomRate : this._defaultZoomRate;\n    var scale = maxScalePerFrame / (1 + Math.exp(-Math.abs(this._delta * zoomRate)));\n\n    if (this._delta < 0 && scale !== 0) {\n      scale = 1 / scale;\n    }\n\n    var map = this.target;\n    var zoom = map.getZoom();\n    var targetZoom = map.getZoomForScale(scale, zoom, true);\n    this._delta = 0;\n    map.onZooming(targetZoom, this._zoomOrigin);\n\n    if (this._timeout) {\n      clearTimeout(this._timeout);\n    }\n\n    this._timeout = setTimeout(function () {\n      _this2._zooming = false;\n      delete _this2._timeout;\n      map.onZoomEnd(map.getZoom(), _this2._zoomOrigin);\n    }, 320);\n  };\n\n  _proto._interval = function _interval(evt, origin) {\n    var _this3 = this;\n\n    var map = this.target;\n\n    if (this._zooming) {\n      this._requesting++;\n      return false;\n    }\n\n    this._requesting = 0;\n    var levelValue = (evt.deltaY ? evt.deltaY * -1 : evt.wheelDelta ? evt.wheelDelta : evt.detail) > 0 ? 1 : -1;\n\n    if (evt.detail) {\n      levelValue *= -1;\n    }\n\n    var zoom = map.getZoom();\n    var nextZoom = zoom + levelValue;\n    nextZoom = map._checkZoom(levelValue > 0 ? Math.ceil(nextZoom) : Math.floor(nextZoom));\n\n    if (nextZoom === zoom) {\n      return false;\n    }\n\n    this._zooming = true;\n\n    if (!this._delta) {\n      map.onZoomStart(null, origin);\n      this._origin = origin;\n      this._delta = levelValue;\n      this._startZoom = map.getZoom();\n    }\n\n    var duration = 90;\n\n    map._animateTo({\n      'zoom': nextZoom - this._delta * 1 / 2,\n      'around': this._origin\n    }, {\n      'continueOnViewChanged': true,\n      'easing': 'linear',\n      'duration': duration,\n      'wheelZoom': true\n    }, function (frame) {\n      if (frame.state.playState !== 'finished') {\n        if (frame.state.playState !== 'running') {\n          delete _this3._zooming;\n          delete _this3._requesting;\n        }\n\n        return;\n      }\n\n      if (_this3._requesting < 1 || Math.abs(nextZoom - _this3._startZoom) > 2 || nextZoom === map.getMaxZoom() || nextZoom === map.getMinZoom()) {\n        map._animateTo({\n          'zoom': nextZoom,\n          'around': _this3._origin\n        }, {\n          'continueOnViewChanged': true,\n          'duration': 100\n        }, function (frame) {\n          if (frame.state.playState !== 'running') {\n            delete _this3._zooming;\n            delete _this3._requesting;\n          }\n        });\n\n        delete _this3._startZoom;\n        delete _this3._origin;\n        delete _this3._delta;\n        _this3._requesting = 0;\n      } else if (!isNil(_this3._requesting)) {\n        delete _this3._zooming;\n\n        _this3._onWheelScroll(evt);\n      }\n    });\n\n    return false;\n  };\n\n  return MapScrollWheelZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'scrollWheelZoom': true,\n  'seamlessZoom': false\n});\nMap$1.addOnLoadHook('addHandler', 'scrollWheelZoom', MapScrollWheelZoomHandler);\n\nvar MapTouchZoomHandler = function (_Handler) {\n  _inheritsLoose(MapTouchZoomHandler, _Handler);\n\n  function MapTouchZoomHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapTouchZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    addDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    removeDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart);\n  };\n\n  _proto._onTouchStart = function _onTouchStart(event) {\n    var map = this.target;\n\n    if (!event.touches || event.touches.length < 2) {\n      return;\n    }\n\n    var container = map.getContainer();\n    var p1 = getEventContainerPoint(event.touches[0], container),\n        p2 = getEventContainerPoint(event.touches[1], container);\n    this.preY = p1.y;\n    this._startP1 = p1;\n    this._startP2 = p2;\n    this._startDist = p1.distanceTo(p2);\n    this._startVector = p1.sub(p2);\n    this._startZoom = map.getZoom();\n    this._startBearing = map.getBearing();\n    off(document, 'touchmove', this._onTouchMove, this);\n    off(document, 'touchend', this._onTouchEnd, this);\n    addDomEvent(document, 'touchmove', this._onTouchMove, this);\n    addDomEvent(document, 'touchend', this._onTouchEnd, this);\n    preventDefault(event);\n\n    map._fireEvent('touchactstart');\n  };\n\n  _proto._onTouchMove = function _onTouchMove(event) {\n    var map = this.target;\n\n    if (!event.touches || event.touches.length < 2) {\n      return;\n    }\n\n    var container = map.getContainer(),\n        p1 = getEventContainerPoint(event.touches[0], container),\n        p2 = getEventContainerPoint(event.touches[1], container),\n        d1 = p1.sub(this._startP1),\n        d2 = p2.sub(this._startP2),\n        vector = p1.sub(p2),\n        scale = p1.distanceTo(p2) / this._startDist,\n        bearing = vector.angleWith(this._startVector) * 180 / Math.PI,\n        preY = this.preY || p1.y,\n        pitch = (preY - p1.y) * 0.4;\n\n    this.preY = p1.y;\n    var param = {\n      'domEvent': event,\n      'mousePos': [p1, p2]\n    };\n\n    if (!this.mode) {\n      if (map.options['touchRotate'] && Math.abs(bearing) > 8) {\n        this.mode = map.options['touchZoomRotate'] ? 'rotate_zoom' : 'rotate';\n      } else if (map.options['touchPitch'] && d1.y * d2.y > 0 && Math.abs(d1.y) > 10 && Math.abs(d2.y) > 10) {\n        this.mode = 'pitch';\n      } else if (map.options['zoomable'] && map.options['touchZoom'] && Math.abs(1 - scale) > 0.15) {\n        this.mode = map.options['touchZoomRotate'] && map.options['touchRotate'] ? 'rotate_zoom' : 'zoom';\n      }\n\n      this._startTouching(param);\n    }\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      this._scale = scale;\n      var res = map._getResolution(this._startZoom) / scale;\n      var zoom = map.getZoomFromRes(res);\n      map.onZooming(zoom, this._Origin);\n    }\n\n    if (this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n      map.setBearing(this._startBearing + bearing);\n      map.onDragRotating(param);\n    } else if (this.mode === 'pitch') {\n      map.setPitch(map.getPitch() + pitch);\n      map.onDragRotating(param);\n    }\n\n    map._fireEvent('touchactinging');\n  };\n\n  _proto._startTouching = function _startTouching(param) {\n    var map = this.target;\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      var size = map.getSize();\n      this._Origin = new Point(size['width'] / 2, size['height'] / 2);\n      map.onZoomStart(null, this._Origin);\n    }\n\n    if (this.mode === 'rotate' || this.mode === 'pitch' || this.mode === 'rotate_zoom') {\n      map.onDragRotateStart(param);\n    }\n  };\n\n  _proto._onTouchEnd = function _onTouchEnd(event) {\n    delete this.preY;\n    var map = this.target;\n    off(document, 'touchmove', this._onTouchMove, this);\n    off(document, 'touchend', this._onTouchEnd, this);\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      var scale = this._scale;\n      var res = map._getResolution(this._startZoom) / scale;\n      var zoom = map.getZoomFromRes(res);\n      map.onZoomEnd(zoom, this._Origin);\n    }\n\n    if (this.mode === 'pitch' || this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n      map.onDragRotateEnd({\n        'domEvent': event\n      });\n    }\n\n    delete this.mode;\n\n    map._fireEvent('touchactend');\n  };\n\n  return MapTouchZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'touchGesture': true,\n  'touchZoom': true,\n  'touchPitch': true,\n  'touchRotate': true,\n  'touchZoomRotate': false\n});\nMap$1.addOnLoadHook('addHandler', 'touchGesture', MapTouchZoomHandler);\nvar KEY = '__anim_player';\nvar Easing = {\n  in: function _in(t) {\n    return Math.pow(t, 2);\n  },\n  out: function out(t) {\n    return 1 - Easing.in(1 - t);\n  },\n  inAndOut: function inAndOut(t) {\n    return 3 * t * t - 2 * t * t * t;\n  },\n  linear: function linear(t) {\n    return t;\n  },\n  upAndDown: function upAndDown(t) {\n    if (t < 0.5) {\n      return Easing.inAndOut(2 * t);\n    } else {\n      return 1 - Easing.inAndOut(2 * (t - 0.5));\n    }\n  }\n};\n\nvar Frame = function Frame(state, styles) {\n  this.state = state;\n  this.styles = styles;\n};\n\nvar Player = function Player(animation, options, onFrame, target) {\n  this._animation = animation;\n  this.options = options;\n  this._onFrame = onFrame;\n  this.playState = 'idle';\n  this.ready = true;\n  this.finished = false;\n  this.target = target;\n};\n\nvar Animation = {\n  speed: {\n    'slow': 2000,\n    'normal': 1000,\n    'fast': 500\n  },\n  _resolveStyles: function _resolveStyles(styles) {\n    if (!styles) {\n      return null;\n    }\n\n    function resolveChild(child) {\n      if (!Array.isArray(child)) {\n        return Animation._resolveStyles(child);\n      }\n\n      var start = [],\n          d = [],\n          dest = [];\n\n      for (var i = 0; i < child.length; i++) {\n        var _styles = Animation._resolveStyles(child[i]);\n\n        if (_styles) {\n          start.push(_styles[0]);\n          d.push(_styles[1]);\n          dest.push(_styles[2]);\n        }\n      }\n\n      if (!start.length) {\n        return null;\n      } else {\n        return [start, d, dest];\n      }\n    }\n\n    function resolveVal(val) {\n      var values = val;\n      var clazz;\n\n      if (!Array.isArray(val)) {\n        if (isNumber(val)) {\n          values = [0, val];\n        } else if (val instanceof Point || val instanceof Coordinate) {\n          clazz = val.constructor;\n          values = [new clazz(0, 0), val];\n        } else {\n          values = [val, val];\n        }\n      }\n\n      var v1 = values[0],\n          v2 = values[1];\n\n      if (isNumber(v1) && isNumber(v2)) {\n        if (v1 === v2) {\n          return null;\n        }\n\n        return [v1, v2 - v1, v2];\n      } else if (Array.isArray(v1) || v1 instanceof Coordinate || v1 instanceof Point) {\n        if (Array.isArray(v1)) {\n          v1 = new Coordinate(v1);\n          v2 = new Coordinate(v2);\n        } else {\n          clazz = v1.constructor;\n          v1 = new clazz(v1);\n          v2 = new clazz(v2);\n        }\n\n        if (v1.equals(v2)) {\n          return null;\n        }\n\n        return [v1, v2.sub(v1), v2];\n      } else {\n        return [v1, 0, v2];\n      }\n    }\n\n    function isChild(val) {\n      if (!Array.isArray(val) && val.constructor === Object) {\n        return true;\n      } else if (Array.isArray(val) && val[0].constructor === Object) {\n        return true;\n      }\n\n      return false;\n    }\n\n    var d = {},\n        start = {},\n        dest = {};\n\n    for (var p in styles) {\n      if (styles.hasOwnProperty(p)) {\n        var values = styles[p];\n\n        if (!values) {\n          continue;\n        } else if (Array.isArray(values)) {\n          if (isNil(values[0]) || isNil(values[1])) {\n            continue;\n          }\n        }\n\n        var childStyles = void 0;\n\n        if (isChild(values)) {\n          childStyles = resolveChild(values);\n        } else {\n          childStyles = resolveVal(values);\n        }\n\n        if (childStyles) {\n          start[p] = childStyles[0];\n          d[p] = childStyles[1];\n          dest[p] = childStyles[2];\n        }\n      }\n    }\n\n    return [start, d, dest];\n  },\n  framing: function framing(styles, options) {\n    if (!options) {\n      options = {};\n    }\n\n    var easing = options['easing'] ? Easing[options['easing']] : Easing.linear;\n\n    if (!easing) {\n      easing = Easing.linear;\n    }\n\n    var dStyles, startStyles, destStyles;\n    styles = Animation._resolveStyles(styles);\n\n    if (styles) {\n      startStyles = styles[0];\n      dStyles = styles[1];\n      destStyles = styles[2];\n    }\n\n    var deltaStyles = function deltaStyles(delta, _startStyles, _dStyles) {\n      if (!_startStyles || !_dStyles) {\n        return null;\n      }\n\n      var result = {};\n\n      for (var p in _dStyles) {\n        if (_dStyles.hasOwnProperty(p)) {\n          if (_startStyles[p] === destStyles[p]) {\n            result[p] = _startStyles[p];\n            continue;\n          }\n\n          var s = _startStyles[p],\n              d = _dStyles[p];\n\n          if (isNumber(d)) {\n            result[p] = s + delta * d;\n          } else if (Array.isArray(d)) {\n            var children = [];\n\n            for (var i = 0; i < d.length; i++) {\n              children.push(deltaStyles(delta, s[i], d[i]));\n            }\n\n            result[p] = children;\n          } else {\n            var clazz = d.constructor;\n\n            if (clazz === Object) {\n              result[p] = deltaStyles(delta, s, d);\n            } else if (s instanceof Point || s instanceof Coordinate) {\n              result[p] = s.add(d.multi(delta));\n            }\n          }\n        }\n      }\n\n      return result;\n    };\n\n    return function (elapsed, duration) {\n      var state, d;\n\n      if (elapsed < 0) {\n        state = {\n          'playState': 'idle',\n          'delta': 0\n        };\n        d = startStyles;\n      } else if (elapsed < duration) {\n        var delta = easing(elapsed / duration);\n        state = {\n          'playState': 'running',\n          'delta': delta\n        };\n        d = deltaStyles(delta, startStyles, dStyles);\n      } else {\n        state = {\n          'playState': 'finished',\n          'delta': 1\n        };\n        d = destStyles;\n      }\n\n      state['startStyles'] = startStyles;\n      state['destStyles'] = destStyles;\n      state['progress'] = elapsed;\n      state['remainingMs'] = duration - elapsed;\n      return new Frame(state, d);\n    };\n  },\n  _requestAnimFrame: function _requestAnimFrame(fn) {\n    if (!this._frameQueue) {\n      this._frameQueue = [];\n    }\n\n    this._frameQueue.push(fn);\n\n    this._a();\n  },\n  _a: function _a() {\n    if (!this._animationFrameId) {\n      this._animationFrameId = requestAnimFrame(Animation._frameFn);\n    }\n  },\n  _run: function _run() {\n    if (this._frameQueue.length) {\n      var running = this._frameQueue;\n      this._frameQueue = [];\n\n      for (var i = 0, len = running.length; i < len; i++) {\n        running[i]();\n      }\n\n      if (this._frameQueue.length) {\n        this._animationFrameId = requestAnimFrame(Animation._frameFn);\n      } else {\n        delete this._animationFrameId;\n      }\n    }\n  },\n  animate: function animate(styles, options, step, target) {\n    if (!options) {\n      options = {};\n    }\n\n    var animation = Animation.framing(styles, options);\n    var player = new Player(animation, options, step, target);\n    return player;\n  }\n};\nAnimation._frameFn = Animation._run.bind(Animation);\nextend(Player.prototype, {\n  _prepare: function _prepare() {\n    var options = this.options;\n    var duration = options['speed'] || options['duration'];\n\n    if (isString(duration)) {\n      duration = Animation.speed[duration];\n\n      if (!duration) {\n        duration = +duration;\n      }\n    }\n\n    if (!duration) {\n      duration = Animation.speed['normal'];\n    }\n\n    this.duration = duration;\n    this._framer = options['framer'] || Animation._requestAnimFrame.bind(Animation);\n  },\n  play: function play() {\n    if (this.playState !== 'idle' && this.playState !== 'paused' || this.target && this.target[KEY]) {\n      return this;\n    }\n\n    if (this.target) {\n      this.target[KEY] = 1;\n    }\n\n    if (this.playState === 'idle') {\n      this.currentTime = 0;\n\n      this._prepare();\n    }\n\n    var t = now();\n\n    if (!this.startTime) {\n      var options = this.options;\n      this.startTime = options['startTime'] ? options['startTime'] : t;\n    }\n\n    this._playStartTime = Math.max(t, this.startTime);\n\n    if (this.playState === 'paused') {\n      this._playStartTime -= this.currentTime;\n    }\n\n    this.playState = 'running';\n\n    this._run();\n\n    return this;\n  },\n  pause: function pause() {\n    if (this.playState === 'paused') {\n      return this;\n    }\n\n    this.playState = 'paused';\n\n    this._run();\n\n    return this;\n  },\n  cancel: function cancel() {\n    if (this.playState === 'idle') {\n      return this;\n    }\n\n    this.playState = 'idle';\n    this.finished = false;\n\n    this._run();\n\n    return this;\n  },\n  finish: function finish() {\n    if (this.playState === 'finished') {\n      return this;\n    }\n\n    this.playState = 'finished';\n    this.finished = true;\n\n    this._run();\n\n    return this;\n  },\n  reverse: function reverse() {},\n  _run: function _run() {\n    var _this = this;\n\n    var onFrame = this._onFrame;\n    var t = now();\n    var elapsed = t - this._playStartTime;\n\n    if (this.options['repeat'] && elapsed >= this.duration) {\n      this._playStartTime = t;\n      elapsed = 0;\n    }\n\n    if (this.playState !== 'running') {\n      if (this.target) {\n        delete this.target[KEY];\n      }\n\n      if (onFrame) {\n        if (this.playState === 'finished') {\n          elapsed = this.duration;\n        } else if (this.playState === 'idle') {\n          elapsed = 0;\n        }\n\n        var _frame = this._animation(elapsed, this.duration);\n\n        _frame.state.playState = this.playState;\n        onFrame(_frame);\n      }\n\n      return;\n    }\n\n    var frame = this._animation(elapsed, this.duration);\n\n    this.playState = frame.state['playState'];\n\n    if (this.playState !== 'running' && this.target) {\n      delete this.target[KEY];\n    }\n\n    if (this.playState === 'idle') {\n      if (this.startTime > t) {\n        setTimeout(this._run.bind(this), this.startTime - t);\n      }\n    } else if (this.playState === 'running') {\n      this._framer(function () {\n        if (_this.playState !== 'running') {\n          return;\n        }\n\n        _this.currentTime = elapsed;\n\n        if (onFrame) {\n          onFrame(frame);\n        }\n\n        _this._run();\n      });\n    } else if (this.playState === 'finished') {\n      this.finished = true;\n\n      if (onFrame) {\n        onFrame(frame);\n      }\n    }\n  }\n});\nvar Animation$1 =\n/*#__PURE__*/\nObject.freeze({\n  Animation: Animation,\n  Easing: Easing,\n  Player: Player,\n  Frame: Frame\n});\nvar simplify = createCommonjsModule(function (module) {\n  (function () {\n    function getSqDist(p1, p2) {\n      var dx = p1.x - p2.x,\n          dy = p1.y - p2.y;\n      return dx * dx + dy * dy;\n    }\n\n    function getSqSegDist(p, p1, p2) {\n      var x = p1.x,\n          y = p1.y,\n          dx = p2.x - x,\n          dy = p2.y - y;\n\n      if (dx !== 0 || dy !== 0) {\n        var t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n          x = p2.x;\n          y = p2.y;\n        } else if (t > 0) {\n          x += dx * t;\n          y += dy * t;\n        }\n      }\n\n      dx = p.x - x;\n      dy = p.y - y;\n      return dx * dx + dy * dy;\n    }\n\n    function simplifyRadialDist(points, sqTolerance) {\n      var prevPoint = points[0],\n          newPoints = [prevPoint],\n          point;\n\n      for (var i = 1, len = points.length; i < len; i++) {\n        point = points[i];\n\n        if (getSqDist(point, prevPoint) > sqTolerance) {\n          newPoints.push(point);\n          prevPoint = point;\n        }\n      }\n\n      if (prevPoint !== point) newPoints.push(point);\n      return newPoints;\n    }\n\n    function simplifyDPStep(points, first, last, sqTolerance, simplified) {\n      var maxSqDist = sqTolerance,\n          index;\n\n      for (var i = first + 1; i < last; i++) {\n        var sqDist = getSqSegDist(points[i], points[first], points[last]);\n\n        if (sqDist > maxSqDist) {\n          index = i;\n          maxSqDist = sqDist;\n        }\n      }\n\n      if (maxSqDist > sqTolerance) {\n        if (index - first > 1) simplifyDPStep(points, first, index, sqTolerance, simplified);\n        simplified.push(points[index]);\n        if (last - index > 1) simplifyDPStep(points, index, last, sqTolerance, simplified);\n      }\n    }\n\n    function simplifyDouglasPeucker(points, sqTolerance) {\n      var last = points.length - 1;\n      var simplified = [points[0]];\n      simplifyDPStep(points, 0, last, sqTolerance, simplified);\n      simplified.push(points[last]);\n      return simplified;\n    }\n\n    function simplify(points, tolerance, highestQuality) {\n      if (points.length <= 2) return points;\n      var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\n      points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\n      points = simplifyDouglasPeucker(points, sqTolerance);\n      return points;\n    }\n\n    {\n      module.exports = simplify;\n      module.exports.default = simplify;\n    }\n  })();\n});\nvar options$3 = {\n  'smoothness': 0,\n  'enableClip': true,\n  'enableSimplify': true,\n  'simplifyTolerance': 2,\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'polygonFill': '#fff',\n    'polygonOpacity': 1,\n    'opacity': 1\n  }\n};\n\nvar Path = function (_Geometry) {\n  _inheritsLoose(Path, _Geometry);\n\n  function Path() {\n    return _Geometry.apply(this, arguments) || this;\n  }\n\n  var _proto = Path.prototype;\n\n  _proto.getOutline = function getOutline() {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    var map = this.getMap();\n    var extent = painter.getContainerExtent().convertTo(function (c) {\n      return map.containerPointToCoord(c);\n    });\n    return new Polygon(extent.toArray(), {\n      symbol: {\n        'lineWidth': 1,\n        'lineColor': '6b707b'\n      }\n    });\n  };\n\n  _proto.animateShow = function animateShow(options, cb) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._showPlayer) {\n      this._showPlayer.finish();\n    }\n\n    if (isFunction(options)) {\n      options = {};\n      cb = options;\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (coordinates.length === 0) {\n      return this;\n    }\n\n    this._animIdx = 0;\n    this._animLenSoFar = 0;\n    this.show();\n    var isPolygon = !!this.getShell;\n    var animCoords = isPolygon ? this.getShell().concat(this.getShell()[0]) : this.getCoordinates();\n\n    var projection = this._getProjection();\n\n    var prjAnimCoords = projection.projectCoords(animCoords);\n    this._prjAniShowCenter = this._getPrjExtent().getCenter();\n    this._aniShowCenter = projection.unproject(this._prjAniShowCenter);\n    var duration = options['duration'] || 1000,\n        easing = options['easing'] || 'out';\n    this.setCoordinates([]);\n    var length = 0;\n\n    for (var i = 1; i < prjAnimCoords.length; i++) {\n      length += prjAnimCoords[i].distanceTo(prjAnimCoords[i - 1]);\n    }\n\n    var player = this._showPlayer = Animation.animate({\n      't': duration\n    }, {\n      'duration': duration,\n      'easing': easing\n    }, function (frame) {\n      if (!_this.getMap()) {\n        if (player.playState !== 'finished') {\n          player.finish();\n\n          if (cb) {\n            var _coordinates = _this.getCoordinates();\n\n            cb(frame, _coordinates[_coordinates.length - 1]);\n          }\n        }\n\n        return;\n      }\n\n      var currentCoord = _this._drawAnimShowFrame(frame.styles.t, duration, length, animCoords, prjAnimCoords);\n\n      if (frame.state.playState === 'finished') {\n        delete _this._showPlayer;\n        delete _this._aniShowCenter;\n        delete _this._prjAniShowCenter;\n        delete _this._animIdx;\n        delete _this._animLenSoFar;\n        delete _this._animTailRatio;\n\n        _this.setCoordinates(coordinates);\n      }\n\n      if (cb) {\n        cb(frame, currentCoord);\n      }\n    }, this);\n    player.play();\n    return player;\n  };\n\n  _proto._drawAnimShowFrame = function _drawAnimShowFrame(t, duration, length, coordinates, prjCoords) {\n    if (t === 0) {\n      return coordinates[0];\n    }\n\n    var projection = this._getProjection();\n\n    var targetLength = t / duration * length;\n    var segLen = 0;\n    var i, l;\n\n    for (i = this._animIdx, l = prjCoords.length; i < l - 1; i++) {\n      segLen = prjCoords[i].distanceTo(prjCoords[i + 1]);\n\n      if (this._animLenSoFar + segLen > targetLength) {\n        break;\n      }\n\n      this._animLenSoFar += segLen;\n    }\n\n    this._animIdx = i;\n\n    if (this._animIdx >= l - 1) {\n      this.setCoordinates(coordinates);\n      return coordinates[coordinates.length - 1];\n    }\n\n    var idx = this._animIdx;\n    var p1 = prjCoords[idx],\n        p2 = prjCoords[idx + 1],\n        span = targetLength - this._animLenSoFar,\n        r = span / segLen;\n    this._animTailRatio = r;\n    var x = p1.x + (p2.x - p1.x) * r,\n        y = p1.y + (p2.y - p1.y) * r,\n        lastCoord = new Coordinate(x, y);\n    var targetCoord = projection.unproject(lastCoord);\n    var isPolygon = !!this.getShell;\n\n    if (!isPolygon && this.options['smoothness'] > 0) {\n      var animCoords = coordinates.slice(0, this._animIdx + 3);\n      this.setCoordinates(animCoords);\n      var prjAnimCoords = prjCoords.slice(0, this._animIdx + 3);\n\n      this._setPrjCoordinates(prjAnimCoords);\n    } else {\n      var _animCoords = coordinates.slice(0, this._animIdx + 1);\n\n      _animCoords.push(targetCoord);\n\n      var _prjAnimCoords = prjCoords.slice(0, this._animIdx + 1);\n\n      _prjAnimCoords.push(lastCoord);\n\n      if (isPolygon) {\n        this.setCoordinates([this._aniShowCenter].concat(_animCoords));\n\n        this._setPrjCoordinates([this._prjAniShowCenter].concat(_prjAnimCoords));\n      } else {\n        this.setCoordinates(_animCoords);\n\n        this._setPrjCoordinates(_prjAnimCoords);\n      }\n    }\n\n    return targetCoord;\n  };\n\n  _proto._getCenterInExtent = function _getCenterInExtent(extent, coordinates, clipFn) {\n    var meExtent = this.getExtent();\n\n    if (!extent.intersects(meExtent)) {\n      return null;\n    }\n\n    var clipped = clipFn(coordinates, extent);\n\n    if (clipped.length === 0) {\n      return null;\n    }\n\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    clipped.forEach(function (part) {\n      if (Array.isArray(part)) {\n        part.forEach(function (c) {\n          if (c.point) {\n            c = c.point;\n          }\n\n          sumx += c.x;\n          sumy += c.y;\n          counter++;\n        });\n      } else {\n        if (part.point) {\n          part = part.point;\n        }\n\n        sumx += part.x;\n        sumy += part.y;\n        counter++;\n      }\n    });\n\n    var c = new Coordinate(sumx, sumy)._multi(1 / counter);\n\n    c.count = counter;\n    return c;\n  };\n\n  _proto._getPath2DPoints = function _getPath2DPoints(prjCoords, disableSimplify, zoom) {\n    if (!isArrayHasData(prjCoords)) {\n      return [];\n    }\n\n    var map = this.getMap(),\n        isSimplify = !disableSimplify && this._shouldSimplify(),\n        tolerance = this.options['simplifyTolerance'] * map._getResolution(),\n        isMulti = Array.isArray(prjCoords[0]);\n\n    delete this._simplified;\n\n    if (isSimplify && !isMulti) {\n      var count = prjCoords.length;\n      prjCoords = simplify(prjCoords, tolerance, false);\n      this._simplified = prjCoords.length < count;\n    }\n\n    if (isNil(zoom)) {\n      zoom = map.getZoom();\n    }\n\n    return forEachCoord(prjCoords, function (c) {\n      return map._prjToPoint(c, zoom);\n    });\n  };\n\n  _proto._shouldSimplify = function _shouldSimplify() {\n    var layer = this.getLayer(),\n        properties = this.getProperties();\n    var hasAltitude = properties && layer.options['enableAltitude'] && !isNil(properties[layer.options['altitudeProperty']]);\n    return layer && layer.options['enableSimplify'] && !hasAltitude && this.options['enableSimplify'] && !this._showPlayer;\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(prjPoints) {\n    this._prjCoords = prjPoints;\n    this.onShapeChanged();\n  };\n\n  _proto._getPrjCoordinates = function _getPrjCoordinates() {\n    this._verifyProjection();\n\n    if (!this._prjCoords && this._getProjection()) {\n      this._prjCoords = this._projectCoords(this._coordinates);\n    }\n\n    return this._prjCoords;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    var projection = this._getProjection();\n\n    if (!projection) {\n      return;\n    }\n\n    if (this._prjCoords) {\n      this._coordinates = this._unprojectCoords(this._getPrjCoordinates());\n    }\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    this._prjCoords = null;\n\n    _Geometry.prototype._clearProjection.call(this);\n  };\n\n  _proto._projectCoords = function _projectCoords(points) {\n    var projection = this._getProjection();\n\n    if (projection) {\n      return projection.projectCoords(points);\n    }\n\n    return [];\n  };\n\n  _proto._unprojectCoords = function _unprojectCoords(prjPoints) {\n    var projection = this._getProjection();\n\n    if (projection) {\n      return projection.unprojectCoords(prjPoints);\n    }\n\n    return [];\n  };\n\n  _proto._computeCenter = function _computeCenter() {\n    var ring = this._coordinates;\n\n    if (!isArrayHasData(ring)) {\n      return null;\n    }\n\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    var size = ring.length;\n\n    for (var i = 0; i < size; i++) {\n      if (ring[i]) {\n        if (isNumber(ring[i].x) && isNumber(ring[i].y)) {\n          sumx += ring[i].x;\n          sumy += ring[i].y;\n          counter++;\n        }\n      }\n    }\n\n    return new Coordinate(sumx / counter, sumy / counter);\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    var shell = this._coordinates;\n\n    if (!isArrayHasData(shell)) {\n      return null;\n    }\n\n    var rings = [shell];\n\n    if (this.hasHoles && this.hasHoles()) {\n      rings.push.apply(rings, this.getHoles());\n    }\n\n    return this._coords2Extent(rings, this._getProjection());\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    var coords = [this._getPrjCoordinates()];\n\n    if (this.hasHoles && this.hasHoles()) {\n      coords.push.apply(coords, this._getPrjHoles());\n    }\n\n    return this._coords2Extent(coords);\n  };\n\n  _proto._get2DLength = function _get2DLength() {\n    var vertexes = this._getPath2DPoints(this._getPrjCoordinates(), true);\n\n    var len = 0;\n\n    for (var i = 1, l = vertexes.length; i < l; i++) {\n      len += vertexes[i].distanceTo(vertexes[i - 1]);\n    }\n\n    return len;\n  };\n\n  _proto._hitTestTolerance = function _hitTestTolerance() {\n    var symbol = this._getInternalSymbol();\n\n    var w;\n\n    if (Array.isArray(symbol)) {\n      w = 0;\n\n      for (var i = 0; i < symbol.length; i++) {\n        if (isNumber(symbol[i]['lineWidth'])) {\n          if (symbol[i]['lineWidth'] > w) {\n            w = symbol[i]['lineWidth'];\n          }\n        }\n      }\n    } else {\n      w = symbol['lineWidth'];\n    }\n\n    return isNumber(w) ? w / 2 : 1.5;\n  };\n\n  _proto._coords2Extent = function _coords2Extent(coords, proj) {\n    var result = new Extent(proj);\n\n    for (var i = 0, l = coords.length; i < l; i++) {\n      for (var j = 0, ll = coords[i].length; j < ll; j++) {\n        result._combine(coords[i][j]);\n      }\n    }\n\n    return result;\n  };\n\n  return Path;\n}(Geometry);\n\nPath.mergeOptions(options$3);\nvar JSON_TYPE = 'Polygon';\n\nvar Polygon = function (_Path) {\n  _inheritsLoose(Polygon, _Path);\n\n  function Polygon(coordinates, opts) {\n    var _this;\n\n    _this = _Path.call(this, opts) || this;\n    _this.type = 'Polygon';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = Polygon.prototype;\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    if (!coordinates) {\n      this._coordinates = null;\n      this._holes = null;\n\n      this._projectRings();\n\n      return this;\n    }\n\n    var rings = Coordinate.toCoordinates(coordinates);\n    var len = rings.length;\n\n    if (!Array.isArray(rings[0])) {\n      this._coordinates = this._trimRing(rings);\n    } else {\n      this._coordinates = this._trimRing(rings[0]);\n\n      if (len > 1) {\n        var holes = [];\n\n        for (var i = 1; i < len; i++) {\n          if (!rings[i]) {\n            continue;\n          }\n\n          holes.push(this._trimRing(rings[i]));\n        }\n\n        this._holes = holes;\n      }\n    }\n\n    this._projectRings();\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    if (!this._coordinates) {\n      return [];\n    }\n\n    var holes = this.getHoles();\n    var rings = [this._copyAndCloseRing(this._coordinates)];\n\n    for (var i = 0, l = holes.length; i < l; i++) {\n      rings.push(this._copyAndCloseRing(holes[i]));\n    }\n\n    return rings;\n  };\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    return this._getCenterInExtent(extent, this.getShell(), clipPolygon);\n  };\n\n  _proto.getShell = function getShell() {\n    return this._coordinates || [];\n  };\n\n  _proto.getHoles = function getHoles() {\n    return this._holes || [];\n  };\n\n  _proto.hasHoles = function hasHoles() {\n    return this.getHoles().length > 0;\n  };\n\n  _proto._projectRings = function _projectRings() {\n    if (!this.getMap()) {\n      this.onShapeChanged();\n      return;\n    }\n\n    this._prjCoords = this._projectCoords(this._coordinates);\n    this._prjHoles = this._projectCoords(this._holes);\n    this.onShapeChanged();\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(prjCoords) {\n    this._prjCoords = prjCoords;\n    this.onShapeChanged();\n  };\n\n  _proto._cleanRing = function _cleanRing(ring) {\n    for (var i = ring.length - 1; i >= 0; i--) {\n      if (!ring[i]) {\n        ring.splice(i, 1);\n      }\n    }\n  };\n\n  _proto._checkRing = function _checkRing(ring) {\n    this._cleanRing(ring);\n\n    if (!ring || !isArrayHasData(ring)) {\n      return false;\n    }\n\n    var lastPoint = ring[ring.length - 1];\n    var isClose = true;\n\n    if (ring[0].x !== lastPoint.x || ring[0].y !== lastPoint.y) {\n      isClose = false;\n    }\n\n    return isClose;\n  };\n\n  _proto._trimRing = function _trimRing(ring) {\n    var isClose = this._checkRing(ring);\n\n    if (isArrayHasData(ring) && isClose) {\n      ring.splice(ring.length - 1, 1);\n    }\n\n    return ring;\n  };\n\n  _proto._copyAndCloseRing = function _copyAndCloseRing(ring) {\n    ring = ring.slice(0);\n\n    var isClose = this._checkRing(ring);\n\n    if (isArrayHasData(ring) && !isClose) {\n      ring.push(ring[0].copy());\n      return ring;\n    } else {\n      return ring;\n    }\n  };\n\n  _proto._getPrjShell = function _getPrjShell() {\n    if (this.getJSONType() === JSON_TYPE) {\n      return this._getPrjCoordinates();\n    }\n\n    this._verifyProjection();\n\n    if (this._getProjection() && !this._prjShell) {\n      this._prjShell = this._projectCoords(this.getShell());\n    }\n\n    return this._prjShell;\n  };\n\n  _proto._getPrjHoles = function _getPrjHoles() {\n    var projection = this._getProjection();\n\n    this._verifyProjection();\n\n    if (projection && !this._prjHoles) {\n      this._prjHoles = this._projectCoords(this.getHoles());\n    }\n\n    return this._prjHoles;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(measurer) {\n    var rings = this.getCoordinates();\n\n    if (!isArrayHasData(rings)) {\n      return 0;\n    }\n\n    var result = 0;\n\n    for (var i = 0, len = rings.length; i < len; i++) {\n      result += measurer.measureLength(rings[i]);\n    }\n\n    return result;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea(measurer) {\n    var rings = this.getCoordinates();\n\n    if (!isArrayHasData(rings)) {\n      return 0;\n    }\n\n    var result = measurer.measureArea(rings[0]);\n\n    for (var i = 1, len = rings.length; i < len; i++) {\n      result -= measurer.measureArea(rings[i]);\n    }\n\n    return result;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    _Path.prototype._updateCache.call(this);\n\n    if (this._prjHoles) {\n      this._holes = this._unprojectCoords(this._getPrjHoles());\n    }\n  };\n\n  _proto._clearCache = function _clearCache() {\n    delete this._prjShell;\n    return _Path.prototype._clearCache.call(this);\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    if (this._prjHoles) {\n      this._prjHoles = null;\n    }\n\n    if (this._prjShell) {\n      this._prjShell = null;\n    }\n\n    _Path.prototype._clearProjection.call(this);\n  };\n\n  return Polygon;\n}(Path);\n\nPolygon.registerJSONType(JSON_TYPE);\n\nfunction CenterMixin(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.getCoordinates = function getCoordinates() {\n      return this._coordinates;\n    };\n\n    _proto.setCoordinates = function setCoordinates(coordinates) {\n      var center = coordinates instanceof Coordinate ? coordinates : new Coordinate(coordinates);\n\n      if (center.equals(this._coordinates)) {\n        return this;\n      }\n\n      this._coordinates = center;\n\n      if (!this.getMap()) {\n        this.onPositionChanged();\n        return this;\n      }\n\n      var projection = this._getProjection();\n\n      this._setPrjCoordinates(projection.project(this._coordinates));\n\n      return this;\n    };\n\n    _proto._getCenter2DPoint = function _getCenter2DPoint(zoom) {\n      var map = this.getMap();\n\n      if (!map) {\n        return null;\n      }\n\n      var z = isNil(zoom) ? map.getZoom() : map.getGLZoom();\n\n      var pcenter = this._getPrjCoordinates();\n\n      if (!pcenter) {\n        return null;\n      }\n\n      return map._prjToPoint(pcenter, z);\n    };\n\n    _proto._getPrjCoordinates = function _getPrjCoordinates() {\n      var projection = this._getProjection();\n\n      this._verifyProjection();\n\n      if (!this._pcenter && projection) {\n        if (this._coordinates) {\n          this._pcenter = projection.project(this._coordinates);\n        }\n      }\n\n      return this._pcenter;\n    };\n\n    _proto._setPrjCoordinates = function _setPrjCoordinates(pcenter) {\n      this._pcenter = pcenter;\n      this.onPositionChanged();\n    };\n\n    _proto._updateCache = function _updateCache() {\n      this._clearCache();\n\n      var projection = this._getProjection();\n\n      if (this._pcenter && projection) {\n        this._coordinates = projection.unproject(this._pcenter);\n      }\n    };\n\n    _proto._clearProjection = function _clearProjection() {\n      this._pcenter = null;\n\n      _Base.prototype._clearProjection.call(this);\n    };\n\n    _proto._computeCenter = function _computeCenter() {\n      return this._coordinates ? this._coordinates.copy() : null;\n    };\n\n    return _class;\n  }(Base);\n}\n\nvar options$4 = {\n  'symbol': {\n    'markerType': 'path',\n    'markerPath': [{\n      'path': 'M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z',\n      'fill': '#DE3333'\n    }],\n    'markerPathWidth': 16,\n    'markerPathHeight': 23,\n    'markerWidth': 24,\n    'markerHeight': 34\n  },\n  'hitTestForEvent': false\n};\n\nvar Marker = function (_CenterMixin) {\n  _inheritsLoose(Marker, _CenterMixin);\n\n  function Marker(coordinates, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, opts) || this;\n    _this.type = 'Point';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = Marker.prototype;\n\n  _proto.getOutline = function getOutline() {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    var coord = this.getCoordinates();\n    var extent = painter.getContainerExtent();\n    var anchor = this.getMap().coordToContainerPoint(coord);\n    return new Marker(coord, {\n      'symbol': {\n        'markerType': 'square',\n        'markerWidth': extent.getWidth(),\n        'markerHeight': extent.getHeight(),\n        'markerLineWidth': 1,\n        'markerLineColor': '6b707b',\n        'markerFill': 'rgba(0, 0, 0, 0)',\n        'markerDx': extent.xmin - (anchor.x - extent.getWidth() / 2),\n        'markerDy': extent.ymin - (anchor.y - extent.getHeight() / 2)\n      }\n    });\n  };\n\n  _proto._isVectorMarker = function _isVectorMarker() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      return false;\n    }\n\n    return VectorMarkerSymbolizer.test(symbol);\n  };\n\n  _proto._canEdit = function _canEdit() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      return false;\n    }\n\n    return VectorMarkerSymbolizer.test(symbol) || VectorPathMarkerSymbolizer.test(symbol) || ImageMarkerSymbolizer.test(symbol);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, t) {\n    var extent = this.getContainerExtent();\n\n    if (t) {\n      extent = extent.expand(t);\n    }\n\n    if (extent.contains(point)) {\n      if (this.options['hitTestForEvent']) {\n        return _CenterMixin.prototype._containsPoint.call(this, point, t);\n      } else {\n        return true;\n      }\n    } else {\n      return false;\n    }\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    return computeExtent.call(this, 'getCenter');\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    return computeExtent.call(this, '_getPrjCoordinates');\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    return 0;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    return 0;\n  };\n\n  _proto._getSprite = function _getSprite(resources, canvasClass) {\n    if (this._getPainter()) {\n      return this._getPainter().getSprite(resources, canvasClass);\n    }\n\n    return new Painter(this).getSprite(resources, canvasClass);\n  };\n\n  return Marker;\n}(CenterMixin(Geometry));\n\nMarker.mergeOptions(options$4);\nMarker.registerJSONType('Marker');\n\nfunction computeExtent(fn) {\n  var coordinates = this[fn]();\n\n  if (!coordinates) {\n    return null;\n  }\n\n  return new Extent(coordinates, coordinates, this._getProjection());\n}\n\nvar options$5 = {\n  'arrowStyle': null,\n  'arrowPlacement': 'vertex-last'\n};\n\nvar LineString = function (_Path) {\n  _inheritsLoose(LineString, _Path);\n\n  function LineString(coordinates, options) {\n    var _this;\n\n    _this = _Path.call(this, options) || this;\n    _this.type = 'LineString';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = LineString.prototype;\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    if (!coordinates) {\n      this._coordinates = null;\n\n      this._setPrjCoordinates(null);\n\n      return this;\n    }\n\n    this._coordinates = Coordinate.toCoordinates(coordinates);\n\n    if (this.getMap()) {\n      this._setPrjCoordinates(this._projectCoords(this._coordinates));\n    } else {\n      this.onShapeChanged();\n    }\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._coordinates || [];\n  };\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    return this._getCenterInExtent(extent, this.getCoordinates(), clipLine);\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(measurer) {\n    return measurer.measureLength(this.getCoordinates());\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    return 0;\n  };\n\n  return LineString;\n}(Path);\n\nLineString.mergeOptions(options$5);\nLineString.registerJSONType('LineString');\n\nvar GeometryCollection = function (_Geometry) {\n  _inheritsLoose(GeometryCollection, _Geometry);\n\n  function GeometryCollection(geometries, opts) {\n    var _this;\n\n    _this = _Geometry.call(this, opts) || this;\n    _this.type = 'GeometryCollection';\n\n    _this.setGeometries(geometries);\n\n    return _this;\n  }\n\n  var _proto = GeometryCollection.prototype;\n\n  _proto.setGeometries = function setGeometries(_geometries) {\n    var geometries = this._checkGeometries(_geometries || []);\n\n    var symbol = this._getSymbol();\n\n    var options = this.config();\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      geometries[i]._initOptions(options);\n\n      geometries[i]._setParent(this);\n\n      geometries[i]._setEventParent(this);\n\n      if (symbol) {\n        geometries[i].setSymbol(symbol);\n      }\n    }\n\n    this._geometries = geometries;\n\n    if (this.getLayer()) {\n      this._bindGeometriesToLayer();\n\n      this.onShapeChanged();\n    }\n\n    return this;\n  };\n\n  _proto.getGeometries = function getGeometries() {\n    return this._geometries || [];\n  };\n\n  _proto.forEach = function forEach(fn, context) {\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      if (!context) {\n        fn(geometries[i], i);\n      } else {\n        fn.call(context, geometries[i], i);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.filter = function filter(fn, context) {\n    if (!fn) {\n      return new GeometryCollection();\n    }\n\n    var selected = [];\n    var isFn = isFunction(fn);\n    var filter = isFn ? fn : createFilter(fn);\n    this.forEach(function (geometry) {\n      var g = isFn ? geometry : getFilterFeature(geometry);\n\n      if (context ? filter.call(context, g) : filter(g)) {\n        selected.push(geometry);\n      }\n    }, this);\n    return new GeometryCollection(selected);\n  };\n\n  _proto.translate = function translate(offset) {\n    if (!offset) {\n      return this;\n    }\n\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    var args = arguments;\n    this.forEach(function (geometry) {\n      if (geometry && geometry.translate) {\n        geometry.translate.apply(geometry, args);\n      }\n    });\n    return this;\n  };\n\n  _proto.isEmpty = function isEmpty$$1() {\n    return !isArrayHasData(this.getGeometries());\n  };\n\n  _proto.remove = function remove() {\n    this.forEach(function (geometry) {\n      geometry._unbind();\n    });\n    return Geometry.prototype.remove.apply(this, arguments);\n  };\n\n  _proto.show = function show() {\n    this.options['visible'] = true;\n    this.forEach(function (geometry) {\n      geometry.show();\n    });\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.options['visible'] = false;\n    this.forEach(function (geometry) {\n      geometry.hide();\n    });\n    return this;\n  };\n\n  _proto.onConfig = function onConfig(config) {\n    this.forEach(function (geometry) {\n      geometry.config(config);\n    });\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var s = _Geometry.prototype.getSymbol.call(this);\n\n    if (!s) {\n      var symbols = [];\n      var is = false;\n      this.forEach(function (g) {\n        var symbol = g.getSymbol();\n\n        if (symbol && !is) {\n          is = true;\n        }\n\n        symbols.push(g.getSymbol());\n      });\n\n      if (is) {\n        s = {\n          'children': symbols\n        };\n      }\n    }\n\n    return s;\n  };\n\n  _proto.setSymbol = function setSymbol(s) {\n    if (s && s['children']) {\n      this._symbol = null;\n      this.forEach(function (g, i) {\n        g.setSymbol(s['children'][i]);\n      });\n    } else {\n      var symbol = this._prepareSymbol(s);\n\n      this._symbol = symbol;\n      this.forEach(function (g) {\n        g.setSymbol(symbol);\n      });\n    }\n\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    symbol = this._prepareSymbol(symbol);\n    this._externSymbol = symbol;\n    this.forEach(function (geometry) {\n      geometry._setExternSymbol(symbol);\n    });\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._bindLayer = function _bindLayer() {\n    _Geometry.prototype._bindLayer.apply(this, arguments);\n\n    this._bindGeometriesToLayer();\n  };\n\n  _proto._bindGeometriesToLayer = function _bindGeometriesToLayer() {\n    var layer = this.getLayer();\n    this.forEach(function (geometry) {\n      geometry._bindLayer(layer);\n    });\n  };\n\n  _proto._checkGeometries = function _checkGeometries(geometries) {\n    var invalidGeoError = 'The geometry added to collection is invalid.';\n\n    if (geometries && !Array.isArray(geometries)) {\n      if (geometries instanceof Geometry) {\n        return [geometries];\n      } else {\n        throw new Error(invalidGeoError);\n      }\n    } else {\n      for (var i = 0, l = geometries.length; i < l; i++) {\n        if (!this._checkGeo(geometries[i])) {\n          throw new Error(invalidGeoError + ' Index: ' + i);\n        }\n      }\n\n      return geometries;\n    }\n  };\n\n  _proto._checkGeo = function _checkGeo(geo) {\n    return geo instanceof Geometry;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    if (this.isEmpty()) {\n      return;\n    }\n\n    this.forEach(function (geometry) {\n      if (geometry && geometry._updateCache) {\n        geometry._updateCache();\n      }\n    });\n  };\n\n  _proto._removePainter = function _removePainter() {\n    if (this._painter) {\n      this._painter.remove();\n    }\n\n    delete this._painter;\n    this.forEach(function (geometry) {\n      geometry._removePainter();\n    });\n  };\n\n  _proto._computeCenter = function _computeCenter(projection) {\n    if (!projection || this.isEmpty()) {\n      return null;\n    }\n\n    var sumX = 0,\n        sumY = 0,\n        counter = 0;\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      var center = geometries[i]._computeCenter(projection);\n\n      if (center) {\n        sumX += center.x;\n        sumY += center.y;\n        counter++;\n      }\n    }\n\n    if (counter === 0) {\n      return null;\n    }\n\n    return new Coordinate(sumX / counter, sumY / counter);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, t) {\n    if (this.isEmpty()) {\n      return false;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (geometries[i]._containsPoint(point, t)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._computeExtent = function _computeExtent(projection) {\n    return computeExtent$1.call(this, projection, '_computeExtent');\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    return computeExtent$1.call(this, projection, '_computePrjExtent');\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(projection) {\n    if (!projection || this.isEmpty()) {\n      return 0;\n    }\n\n    var geometries = this.getGeometries();\n    var result = 0;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      result += geometries[i]._computeGeodesicLength(projection);\n    }\n\n    return result;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea(projection) {\n    if (!projection || this.isEmpty()) {\n      return 0;\n    }\n\n    var geometries = this.getGeometries();\n    var result = 0;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      result += geometries[i]._computeGeodesicArea(projection);\n    }\n\n    return result;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var children = [];\n\n    if (!this.isEmpty()) {\n      var geometries = this.getGeometries();\n\n      for (var i = 0, l = geometries.length; i < l; i++) {\n        if (!geometries[i]) {\n          continue;\n        }\n\n        children.push(geometries[i]._exportGeoJSONGeometry());\n      }\n    }\n\n    return {\n      'type': 'GeometryCollection',\n      'geometries': children\n    };\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    if (this.isEmpty()) {\n      return;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      geometries[i]._clearProjection();\n    }\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var extent = this.getExtent();\n    var anchors = [new Coordinate(extent.xmin, extent.ymax), new Coordinate(extent.xmax, extent.ymin), new Coordinate(extent.xmin, extent.ymin), new Coordinate(extent.xmax, extent.ymax)];\n    return anchors;\n  };\n\n  _proto._getExternalResources = function _getExternalResources() {\n    if (this.isEmpty()) {\n      return [];\n    }\n\n    var geometries = this.getGeometries(),\n        resources = [];\n    var cache = {};\n    var symbol, res, key;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      symbol = geometries[i]._getInternalSymbol();\n      res = getExternalResources(symbol);\n\n      for (var ii = 0, ll = res.length; ii < ll; ii++) {\n        key = res[ii].join();\n\n        if (!cache[key]) {\n          resources.push(res[ii]);\n          cache[key] = 1;\n        }\n      }\n    }\n\n    return resources;\n  };\n\n  _proto.startEdit = function startEdit(opts) {\n    var _this2 = this;\n\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    if (!opts) {\n      opts = {};\n    }\n\n    if (opts['symbol']) {\n      this._originalSymbol = this.getSymbol();\n      this.setSymbol(opts['symbol']);\n    }\n\n    this._draggbleBeforeEdit = this.options['draggable'];\n    this.config('draggable', false);\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      geometries[i].startEdit(opts);\n    }\n\n    this._editing = true;\n    this.hide();\n    setTimeout(function () {\n      _this2.fire('editstart');\n    }, 1);\n    return this;\n  };\n\n  _proto.endEdit = function endEdit() {\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      geometries[i].endEdit();\n    }\n\n    if (this._originalSymbol) {\n      this.setSymbol(this._originalSymbol);\n      delete this._originalSymbol;\n    }\n\n    this._editing = false;\n    this.show();\n    this.config('draggable', this._draggbleBeforeEdit);\n    this.fire('editend');\n    return this;\n  };\n\n  _proto.isEditing = function isEditing() {\n    if (!this._editing) {\n      return false;\n    }\n\n    return true;\n  };\n\n  return GeometryCollection;\n}(Geometry);\n\nGeometryCollection.registerJSONType('GeometryCollection');\n\nfunction computeExtent$1(projection, fn) {\n  if (this.isEmpty()) {\n    return null;\n  }\n\n  var geometries = this.getGeometries();\n  var result = null;\n\n  for (var i = 0, l = geometries.length; i < l; i++) {\n    var geo = geometries[i];\n\n    if (!geo) {\n      continue;\n    }\n\n    var geoExtent = geo[fn](projection);\n\n    if (geoExtent) {\n      result = geoExtent.combine(result);\n    }\n  }\n\n  return result;\n}\n\nvar MultiGeometry = function (_GeometryCollection) {\n  _inheritsLoose(MultiGeometry, _GeometryCollection);\n\n  function MultiGeometry(geoType, type, data, options) {\n    var _this;\n\n    _this = _GeometryCollection.call(this, null, options) || this;\n    _this.GeometryType = geoType;\n    _this.type = type;\n\n    _this._initData(data);\n\n    return _this;\n  }\n\n  var _proto = MultiGeometry.prototype;\n\n  _proto.getCoordinates = function getCoordinates() {\n    var coordinates = [];\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      var child = geometries[i];\n      coordinates.push(child.getShell && child.getJSONType() !== 'Polygon' ? [child.getShell()] : child.getCoordinates());\n    }\n\n    return coordinates;\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    coordinates = coordinates || [];\n    var geometries = [];\n\n    for (var i = 0, l = coordinates.length; i < l; i++) {\n      var g = new this.GeometryType(coordinates[i], this.config());\n      geometries.push(g);\n    }\n\n    this.setGeometries(geometries);\n    return this;\n  };\n\n  _proto._initData = function _initData(data) {\n    data = data || [];\n\n    if (data.length) {\n      if (data[0] instanceof this.GeometryType) {\n        this.setGeometries(data);\n      } else {\n        this.setCoordinates(data);\n      }\n    }\n  };\n\n  _proto._checkGeo = function _checkGeo(geo) {\n    return geo instanceof this.GeometryType;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var points = this.getCoordinates();\n    var coordinates = Coordinate.toNumberArrays(points);\n    return {\n      'type': this.getType(),\n      'coordinates': coordinates\n    };\n  };\n\n  return MultiGeometry;\n}(GeometryCollection);\n\nvar MultiPoint = function (_MultiGeometry) {\n  _inheritsLoose(MultiPoint, _MultiGeometry);\n\n  function MultiPoint(data, opts) {\n    return _MultiGeometry.call(this, Marker, 'MultiPoint', data, opts) || this;\n  }\n\n  var _proto = MultiPoint.prototype;\n\n  _proto.findClosest = function findClosest(coordinate) {\n    if (!coordinate) {\n      return null;\n    }\n\n    var coords = this.getCoordinates();\n    var hit = null;\n    var max = Infinity;\n    coords.forEach(function (c) {\n      var dist = distanceTo(c, coordinate);\n\n      if (dist < max) {\n        hit = c;\n        max = dist;\n      }\n    });\n    return hit;\n  };\n\n  return MultiPoint;\n}(MultiGeometry);\n\nMultiPoint.registerJSONType('MultiPoint');\n\nfunction distanceTo(p0, p1) {\n  var x = p1.x - p0.x,\n      y = p1.y - p0.y;\n  return Math.sqrt(x * x + y * y);\n}\n\nvar MultiPath = function (_MultiGeometry) {\n  _inheritsLoose(MultiPath, _MultiGeometry);\n\n  function MultiPath() {\n    return _MultiGeometry.apply(this, arguments) || this;\n  }\n\n  var _proto = MultiPath.prototype;\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    var children = this.getGeometries();\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    children.forEach(function (l) {\n      var c = l.getCenterInExtent(extent);\n\n      if (c) {\n        sumx += c.x * c.count;\n        sumy += c.y * c.count;\n        counter += c.count;\n      }\n    });\n\n    if (counter === 0) {\n      return null;\n    }\n\n    return new Coordinate(sumx, sumy)._multi(1 / counter);\n  };\n\n  return MultiPath;\n}(MultiGeometry);\n\nvar MultiLineString = function (_MultiPath) {\n  _inheritsLoose(MultiLineString, _MultiPath);\n\n  function MultiLineString(data, options) {\n    return _MultiPath.call(this, LineString, 'MultiLineString', data, options) || this;\n  }\n\n  return MultiLineString;\n}(MultiPath);\n\nMultiLineString.registerJSONType('MultiLineString');\n\nvar MultiPolygon = function (_MultiPath) {\n  _inheritsLoose(MultiPolygon, _MultiPath);\n\n  function MultiPolygon(data, opts) {\n    return _MultiPath.call(this, Polygon, 'MultiPolygon', data, opts) || this;\n  }\n\n  return MultiPolygon;\n}(MultiPath);\n\nMultiPolygon.registerJSONType('MultiPolygon');\nvar types$1 = {\n  'Marker': Marker,\n  'LineString': LineString,\n  'Polygon': Polygon,\n  'MultiPoint': MultiPoint,\n  'MultiLineString': MultiLineString,\n  'MultiPolygon': MultiPolygon\n};\nvar GeoJSON = {\n  toGeometry: function toGeometry(geoJSON, foreachFn) {\n    if (isString(geoJSON)) {\n      geoJSON = parseJSON(geoJSON);\n    }\n\n    if (Array.isArray(geoJSON)) {\n      var resultGeos = [];\n\n      for (var i = 0, len = geoJSON.length; i < len; i++) {\n        var geo = GeoJSON._convert(geoJSON[i], foreachFn);\n\n        if (Array.isArray(geo)) {\n          pushIn(resultGeos, geo);\n        } else {\n          resultGeos.push(geo);\n        }\n      }\n\n      return resultGeos;\n    } else {\n      var resultGeo = GeoJSON._convert(geoJSON, foreachFn);\n\n      return resultGeo;\n    }\n  },\n  _convert: function _convert(json, foreachFn) {\n    if (!json || isNil(json['type'])) {\n      return null;\n    }\n\n    var type = json['type'];\n\n    if (type === 'Feature') {\n      var g = json['geometry'];\n\n      var geometry = GeoJSON._convert(g);\n\n      if (!geometry) {\n        return null;\n      }\n\n      geometry.setId(json['id']);\n      geometry.setProperties(json['properties']);\n\n      if (foreachFn) {\n        foreachFn(geometry);\n      }\n\n      return geometry;\n    } else if (type === 'FeatureCollection') {\n      var features = json['features'];\n\n      if (!features) {\n        return null;\n      }\n\n      return GeoJSON.toGeometry(features, foreachFn);\n    } else if (['Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon'].indexOf(type) >= 0) {\n      var clazz = type === 'Point' ? 'Marker' : type;\n      var result = new types$1[clazz](json['coordinates']);\n\n      if (foreachFn) {\n        foreachFn(result);\n      }\n\n      return result;\n    } else if (type === 'GeometryCollection') {\n      var geometries = json['geometries'];\n\n      if (!isArrayHasData(geometries)) {\n        var _result2 = new GeometryCollection();\n\n        if (foreachFn) {\n          foreachFn(_result2);\n        }\n\n        return _result2;\n      }\n\n      var mGeos = [];\n      var size = geometries.length;\n\n      for (var i = 0; i < size; i++) {\n        mGeos.push(GeoJSON._convert(geometries[i]));\n      }\n\n      var _result = new GeometryCollection(mGeos);\n\n      if (foreachFn) {\n        foreachFn(_result);\n      }\n\n      return _result;\n    }\n\n    return null;\n  }\n};\nvar options$6 = {\n  'numberOfShellPoints': 60\n};\n\nvar Circle = function (_CenterMixin) {\n  _inheritsLoose(Circle, _CenterMixin);\n\n  Circle.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var circle = new Circle(json['coordinates'], json['radius'], json['options']);\n    circle.setProperties(feature['properties']);\n    return circle;\n  };\n\n  function Circle(coordinates, radius, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this._radius = radius;\n    return _this;\n  }\n\n  var _proto = Circle.prototype;\n\n  _proto.getRadius = function getRadius() {\n    return this._radius;\n  };\n\n  _proto.setRadius = function setRadius(radius) {\n    this._radius = radius;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'],\n        radius = this.getRadius();\n\n    var shell = [];\n    var rad, dx, dy;\n\n    for (var i = 0, len = numberOfPoints - 1; i < len; i++) {\n      rad = 360 * i / len * Math.PI / 180;\n      dx = radius * Math.cos(rad);\n      dy = radius * Math.sin(rad);\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    shell.push(shell[0]);\n    return shell;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.getPitch()) {\n      return _CenterMixin.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var center = map._pointToContainerPoint(this._getCenter2DPoint()),\n        size = this.getSize(),\n        t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        se = center.add(size.width / 2, size.height / 2);\n\n    return withInEllipse(point, center, se, t);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    var minmax = this._getMinMax(projection);\n\n    if (!minmax) {\n      return null;\n    }\n\n    var pcenter = this._getPrjCoordinates();\n\n    var pminmax = minmax.map(function (c) {\n      return projection.project(c);\n    });\n    var leftx = pminmax[0].x - pcenter.x;\n    var rightx = pminmax[1].x - pcenter.x;\n    var topy = pminmax[2].y - pcenter.y;\n    var bottomy = pminmax[3].y - pcenter.y;\n    return new Extent(pcenter.add(leftx, topy), pcenter.add(rightx, bottomy));\n  };\n\n  _proto._computeExtent = function _computeExtent(measurer) {\n    var minmax = this._getMinMax(measurer);\n\n    if (!minmax) {\n      return null;\n    }\n\n    return new Extent(minmax[0].x, minmax[2].y, minmax[1].x, minmax[3].y, this._getProjection());\n  };\n\n  _proto._getMinMax = function _getMinMax(measurer) {\n    if (!measurer || !this._coordinates || isNil(this._radius)) {\n      return null;\n    }\n\n    var radius = this._radius;\n    var p1 = measurer.locate(this._coordinates, -radius, 0),\n        p2 = measurer.locate(this._coordinates, radius, 0),\n        p3 = measurer.locate(this._coordinates, 0, radius),\n        p4 = measurer.locate(this._coordinates, 0, -radius);\n    return [p1, p2, p3, p4];\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * 2 * this._radius;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * Math.pow(this._radius, 2);\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var center = this.getCenter();\n    var opts = extend({}, options);\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Circle',\n      'coordinates': [center.x, center.y],\n      'radius': this.getRadius()\n    };\n  };\n\n  return Circle;\n}(CenterMixin(Polygon));\n\nCircle.mergeOptions(options$6);\nCircle.registerJSONType('Circle');\nvar options$7 = {\n  'numberOfShellPoints': 80\n};\n\nvar Ellipse = function (_CenterMixin) {\n  _inheritsLoose(Ellipse, _CenterMixin);\n\n  Ellipse.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var ellipse = new Ellipse(json['coordinates'], json['width'], json['height'], json['options']);\n    ellipse.setProperties(feature['properties']);\n    return ellipse;\n  };\n\n  function Ellipse(coordinates, width, height, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this.width = width;\n    _this.height = height;\n    return _this;\n  }\n\n  var _proto = Ellipse.prototype;\n\n  _proto.getWidth = function getWidth() {\n    return this.width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this.width = width;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this.height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this.height = height;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'],\n        width = this.getWidth(),\n        height = this.getHeight();\n\n    var shell = [];\n    var s = Math.pow(width / 2, 2) * Math.pow(height / 2, 2),\n        sx = Math.pow(width / 2, 2),\n        sy = Math.pow(height / 2, 2);\n    var deg, rad, dx, dy;\n\n    for (var i = 0; i < numberOfPoints; i++) {\n      deg = 360 * i / numberOfPoints;\n      rad = deg * Math.PI / 180;\n      dx = Math.sqrt(s / (sx * Math.pow(Math.tan(rad), 2) + sy));\n      dy = Math.sqrt(s / (sy * Math.pow(1 / Math.tan(rad), 2) + sx));\n\n      if (deg > 90 && deg < 270) {\n        dx *= -1;\n      }\n\n      if (deg > 180 && deg < 360) {\n        dy *= -1;\n      }\n\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    return shell;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _CenterMixin.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var projection = map.getProjection();\n\n    var t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        pps = projection.projectCoords([this._coordinates, map.locate(this._coordinates, this.getWidth() / 2, this.getHeight() / 2)]),\n        p0 = map._prjToContainerPoint(pps[0]),\n        p1 = map._prjToContainerPoint(pps[1]);\n\n    return withInEllipse(point, p0, p1, t);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    return Circle.prototype._computePrjExtent.apply(this, arguments);\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    return Circle.prototype._computeExtent.apply(this, arguments);\n  };\n\n  _proto._getMinMax = function _getMinMax(measurer) {\n    if (!measurer || !this._coordinates || isNil(this.width) || isNil(this.height)) {\n      return null;\n    }\n\n    var width = this.getWidth(),\n        height = this.getHeight();\n    var p1 = measurer.locate(this._coordinates, -width / 2, 0),\n        p2 = measurer.locate(this._coordinates, width / 2, 0),\n        p3 = measurer.locate(this._coordinates, 0, -height / 2),\n        p4 = measurer.locate(this._coordinates, 0, height / 2);\n    return [p1, p2, p3, p4];\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return 0;\n    }\n\n    var longer = this.width > this.height ? this.width : this.height;\n    return 2 * Math.PI * longer / 2 - 4 * Math.abs(this.width - this.height);\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return 0;\n    }\n\n    return Math.PI * this.width * this.height / 4;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var center = this.getCenter();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Ellipse',\n      'coordinates': [center.x, center.y],\n      'width': this.getWidth(),\n      'height': this.getHeight()\n    };\n  };\n\n  return Ellipse;\n}(CenterMixin(Polygon));\n\nEllipse.mergeOptions(options$7);\nEllipse.registerJSONType('Ellipse');\n\nvar Rectangle = function (_Polygon) {\n  _inheritsLoose(Rectangle, _Polygon);\n\n  Rectangle.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var rect = new Rectangle(json['coordinates'], json['width'], json['height'], json['options']);\n    rect.setProperties(feature['properties']);\n    return rect;\n  };\n\n  function Rectangle(coordinates, width, height, opts) {\n    var _this;\n\n    _this = _Polygon.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this._width = width;\n    _this._height = height;\n    return _this;\n  }\n\n  var _proto = Rectangle.prototype;\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._coordinates;\n  };\n\n  _proto.setCoordinates = function setCoordinates(nw) {\n    this._coordinates = nw instanceof Coordinate ? nw : new Coordinate(nw);\n\n    if (!this._coordinates || !this.getMap()) {\n      this.onPositionChanged();\n      return this;\n    }\n\n    var projection = this._getProjection();\n\n    this._setPrjCoordinates(projection.project(this._coordinates));\n\n    return this;\n  };\n\n  _proto.getWidth = function getWidth() {\n    return this._width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this._width = width;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this._height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this._height = height;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer();\n\n    var nw = this._coordinates;\n    var map = this.getMap();\n    var sx = 1,\n        sy = -1;\n\n    if (map) {\n      var fExt = map.getFullExtent();\n\n      if (fExt['left'] > fExt['right']) {\n        sx = -1;\n      }\n\n      if (fExt['bottom'] > fExt['top']) {\n        sy = 1;\n      }\n    }\n\n    var points = [];\n    points.push(nw);\n    points.push(measurer.locate(nw, sx * this._width, 0));\n    points.push(measurer.locate(nw, sx * this._width, sy * this._height));\n    points.push(measurer.locate(nw, 0, sy * this._height));\n    points.push(nw);\n    return points;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._getPrjCoordinates = function _getPrjCoordinates() {\n    var projection = this._getProjection();\n\n    this._verifyProjection();\n\n    if (!this._pnw && projection) {\n      if (this._coordinates) {\n        this._pnw = projection.project(this._coordinates);\n      }\n    }\n\n    return this._pnw;\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(pnw) {\n    this._pnw = pnw;\n    this.onPositionChanged();\n  };\n\n  _proto._getPrjShell = function _getPrjShell() {\n    var shell = _Polygon.prototype._getPrjShell.call(this);\n\n    var projection = this._getProjection();\n\n    if (!projection.isSphere()) {\n      return shell;\n    }\n\n    var sphereExtent = projection.getSphereExtent(),\n        sx = sphereExtent.sx,\n        sy = sphereExtent.sy;\n\n    var circum = this._getProjection().getCircum();\n\n    var nw = shell[0];\n\n    for (var i = 1, l = shell.length; i < l; i++) {\n      var p = shell[i];\n      var dx = 0,\n          dy = 0;\n\n      if (sx * (nw.x - p.x) > 0) {\n        dx = circum.x * sx;\n      }\n\n      if (sy * (nw.y - p.y) < 0) {\n        dy = circum.y * sy;\n      }\n\n      shell[i]._add(dx, dy);\n    }\n\n    return shell;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    var projection = this._getProjection();\n\n    if (this._pnw && projection) {\n      this._coordinates = projection.unproject(this._pnw);\n    }\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    this._pnw = null;\n\n    _Polygon.prototype._clearProjection.call(this);\n  };\n\n  _proto._computeCenter = function _computeCenter(measurer) {\n    return measurer.locate(this._coordinates, this._width / 2, -this._height / 2);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _Polygon.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        r = map._getResolution() * t;\n\n    var extent = this._getPrjExtent().expand(r);\n\n    var p = map._containerPointToPrj(point);\n\n    return extent.contains(p);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    var se = this._getSouthEast(projection);\n\n    if (!se) {\n      return null;\n    }\n\n    var prjs = projection.projectCoords([new Coordinate(this._coordinates.x, se.y), new Coordinate(se.x, this._coordinates.y)]);\n    return new Extent(prjs[0], prjs[1]);\n  };\n\n  _proto._computeExtent = function _computeExtent(measurer) {\n    var se = this._getSouthEast(measurer);\n\n    if (!se) {\n      return null;\n    }\n\n    return new Extent(this._coordinates, se, this._getProjection());\n  };\n\n  _proto._getSouthEast = function _getSouthEast(measurer) {\n    if (!measurer || !this._coordinates || isNil(this._width) || isNil(this._height)) {\n      return null;\n    }\n\n    var width = this.getWidth(),\n        height = this.getHeight();\n    var w = width,\n        h = -height;\n\n    if (measurer.fullExtent) {\n      var fullExtent = measurer.fullExtent,\n          sx = fullExtent.right > fullExtent.left ? 1 : -1,\n          sy = fullExtent.top > fullExtent.bottom ? 1 : -1;\n      w *= sx;\n      h *= sy;\n    }\n\n    var se = measurer.locate(this._coordinates, w, h);\n    return se;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._width) || isNil(this._height)) {\n      return 0;\n    }\n\n    return 2 * (this._width + this._height);\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._width) || isNil(this._height)) {\n      return 0;\n    }\n\n    return this._width * this._height;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var nw = this.getCoordinates();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Rectangle',\n      'coordinates': [nw.x, nw.y],\n      'width': this.getWidth(),\n      'height': this.getHeight()\n    };\n  };\n\n  return Rectangle;\n}(Polygon);\n\nRectangle.registerJSONType('Rectangle');\nvar options$8 = {\n  'numberOfShellPoints': 60\n};\n\nvar Sector = function (_Circle) {\n  _inheritsLoose(Sector, _Circle);\n\n  Sector.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var sector = new Sector(json['coordinates'], json['radius'], json['startAngle'], json['endAngle'], json['options']);\n    sector.setProperties(feature['properties']);\n    return sector;\n  };\n\n  function Sector(coordinates, radius, startAngle, endAngle, opts) {\n    var _this;\n\n    _this = _Circle.call(this, coordinates, radius, opts) || this;\n    _this.startAngle = startAngle;\n    _this.endAngle = endAngle;\n    return _this;\n  }\n\n  var _proto = Sector.prototype;\n\n  _proto.getStartAngle = function getStartAngle() {\n    return this.startAngle;\n  };\n\n  _proto.setStartAngle = function setStartAngle(startAngle) {\n    this.startAngle = startAngle;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getEndAngle = function getEndAngle() {\n    return this.endAngle;\n  };\n\n  _proto.setEndAngle = function setEndAngle(endAngle) {\n    this.endAngle = endAngle;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'] - 2,\n        radius = this.getRadius(),\n        shell = [center.copy()],\n        startAngle = this.getStartAngle(),\n        angle = this.getEndAngle() - startAngle;\n\n    var rad, dx, dy;\n\n    for (var i = 0; i < numberOfPoints; i++) {\n      rad = (angle * i / (numberOfPoints - 1) + startAngle) * Math.PI / 180;\n      dx = radius * Math.cos(rad);\n      dy = radius * Math.sin(rad);\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    shell.push(center.copy());\n    return shell;\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _Circle.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var center = map._pointToContainerPoint(this._getCenter2DPoint()),\n        t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        size = this.getSize(),\n        pc = center,\n        pp = point,\n        x = pp.x - pc.x,\n        y = pc.y - pp.y,\n        atan2 = Math.atan2(y, x),\n        angle = atan2 < 0 ? (atan2 + 2 * Math.PI) * 360 / (2 * Math.PI) : atan2 * 360 / (2 * Math.PI);\n\n    var sAngle = this.startAngle % 360,\n        eAngle = this.endAngle % 360;\n    var between = false;\n\n    if (sAngle > eAngle) {\n      between = !(angle > eAngle && angle < sAngle);\n    } else {\n      between = angle >= sAngle && angle <= eAngle;\n    }\n\n    return pp.distanceTo(pc) <= size.width / 2 + t && between;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * 2 * this._radius * Math.abs(this.startAngle - this.endAngle) / 360 + 2 * this._radius;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * Math.pow(this._radius, 2) * Math.abs(this.startAngle - this.endAngle) / 360;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var center = this.getCenter();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Sector',\n      'coordinates': [center.x, center.y],\n      'radius': this.getRadius(),\n      'startAngle': this.getStartAngle(),\n      'endAngle': this.getEndAngle()\n    };\n  };\n\n  return Sector;\n}(Circle);\n\nSector.mergeOptions(options$8);\nSector.registerJSONType('Sector');\nvar options$9 = {\n  'enableSimplify': false,\n  'enableClip': false\n};\n\nvar Curve = function (_LineString) {\n  _inheritsLoose(Curve, _LineString);\n\n  function Curve() {\n    return _LineString.apply(this, arguments) || this;\n  }\n\n  var _proto = Curve.prototype;\n\n  _proto._arc = function _arc(ctx, points, lineOpacity) {\n    var degree = this.options['arcDegree'] * Math.PI / 180;\n\n    for (var i = 1, l = points.length; i < l; i++) {\n      var c = Canvas._arcBetween(ctx, points[i - 1], points[i], degree);\n\n      var ctrlPoint = [points[i - 1].x + points[i].x - c[0], points[i - 1].y + points[i].y - c[1]];\n      points[i - 1].nextCtrlPoint = ctrlPoint;\n      points[i].prevCtrlPoint = ctrlPoint;\n\n      Canvas._stroke(ctx, lineOpacity);\n    }\n  };\n\n  _proto._quadraticCurve = function _quadraticCurve(ctx, points) {\n    if (points.length <= 2) {\n      Canvas._path(ctx, points);\n\n      return;\n    }\n\n    var i, l;\n\n    for (i = 2, l = points.length; i < l; i += 2) {\n      ctx.quadraticCurveTo(points[i - 1].x, points[i - 1].y, points[i].x, points[i].y);\n    }\n\n    i -= 1;\n\n    if (i < l) {\n      for (; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n    }\n  };\n\n  _proto._bezierCurve = function _bezierCurve(ctx, points) {\n    if (points.length <= 3) {\n      Canvas._path(ctx, points);\n\n      return;\n    }\n\n    var i, l;\n\n    for (i = 1, l = points.length; i + 2 < l; i += 3) {\n      ctx.bezierCurveTo(points[i].x, points[i].y, points[i + 1].x, points[i + 1].y, points[i + 2].x, points[i + 2].y);\n    }\n\n    if (i < l) {\n      for (; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n    }\n  };\n\n  _proto._getCurveArrowPoints = function _getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, step) {\n    var l = segments.length;\n    var i;\n\n    for (i = step; i < l; i += step) {\n      var arrow = this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance);\n\n      if (arrow) {\n        arrows.push(arrow);\n      }\n    }\n\n    i -= step;\n\n    if (i < l - 1) {\n      for (i += 1; i < l; i++) {\n        var _arrow = this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance);\n\n        if (_arrow) {\n          arrows.push(_arrow);\n        }\n      }\n    }\n  };\n\n  return Curve;\n}(LineString);\n\nCurve.mergeOptions(options$9);\nvar options$a = {\n  'arcDegree': 90\n};\n\nvar ArcCurve = function (_Curve) {\n  _inheritsLoose(ArcCurve, _Curve);\n\n  function ArcCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  var _proto = ArcCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'ArcCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n\n    this._arc(ctx, points, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  ArcCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var arc = new ArcCurve(feature['geometry']['coordinates'], json['options']);\n    arc.setProperties(feature['properties']);\n    return arc;\n  };\n\n  return ArcCurve;\n}(Curve);\n\nArcCurve.registerJSONType('ArcCurve');\nArcCurve.mergeOptions(options$a);\n\nvar CubicBezierCurve = function (_Curve) {\n  _inheritsLoose(CubicBezierCurve, _Curve);\n\n  function CubicBezierCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  CubicBezierCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var curve = new CubicBezierCurve(feature['geometry']['coordinates'], json['options']);\n    curve.setProperties(feature['properties']);\n    return curve;\n  };\n\n  var _proto = CubicBezierCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'CubicBezierCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    this._bezierCurve(ctx, points);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  _proto._getArrowPoints = function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 3);\n  };\n\n  return CubicBezierCurve;\n}(Curve);\n\nCubicBezierCurve.registerJSONType('CubicBezierCurve');\n\nvar QuadBezierCurve = function (_Curve) {\n  _inheritsLoose(QuadBezierCurve, _Curve);\n\n  function QuadBezierCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  QuadBezierCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var curve = new QuadBezierCurve(feature['geometry']['coordinates'], json['options']);\n    curve.setProperties(feature['properties']);\n    return curve;\n  };\n\n  var _proto = QuadBezierCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'QuadBezierCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    this._quadraticCurve(ctx, points, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  _proto._getArrowPoints = function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 2);\n  };\n\n  return QuadBezierCurve;\n}(Curve);\n\nQuadBezierCurve.registerJSONType('QuadBezierCurve');\nvar defaultSymbol$1 = {\n  'textFaceName': 'monospace',\n  'textSize': 12,\n  'textLineSpacing': 8,\n  'textWrapCharacter': '\\n',\n  'textHorizontalAlignment': 'middle',\n  'textVerticalAlignment': 'middle'\n};\nvar defaultBoxSymbol = {\n  'markerType': 'square',\n  'markerLineColor': '#000',\n  'markerLineWidth': 2,\n  'markerLineOpacity': 1,\n  'markerFill': '#fff',\n  'markerOpacity': 1\n};\n\nvar TextMarker = function (_Marker) {\n  _inheritsLoose(TextMarker, _Marker);\n\n  function TextMarker() {\n    return _Marker.apply(this, arguments) || this;\n  }\n\n  var _proto = TextMarker.prototype;\n\n  _proto.getContent = function getContent() {\n    return this._content;\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this._content;\n    this._content = escapeSpecialChars(content);\n\n    this._refresh();\n\n    this._fireEvent('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    return this;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this._refresh();\n  };\n\n  _proto.toJSON = function toJSON() {\n    var json = _Marker.prototype.toJSON.call(this);\n\n    delete json['symbol'];\n    return json;\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    if (this._refreshing || !symbol) {\n      return _Marker.prototype.setSymbol.call(this, symbol);\n    }\n\n    var s = this._parseSymbol(symbol);\n\n    if (this.setTextStyle) {\n      var style = this.getTextStyle() || {};\n      style.symbol = s[0];\n      this.setTextStyle(style);\n    } else if (this.setTextSymbol) {\n      this.setTextSymbol(s[0]);\n    }\n\n    if (this.setBoxStyle) {\n      var _style = this.getBoxStyle() || {};\n\n      _style.symbol = s[1];\n      this.setBoxStyle(_style);\n    } else if (this.setBoxSymbol) {\n      this.setBoxSymbol(s[1]);\n    }\n\n    return this;\n  };\n\n  _proto._parseSymbol = function _parseSymbol(symbol) {\n    var t = {};\n    var b = {};\n\n    for (var p in symbol) {\n      if (hasOwn(symbol, p)) {\n        if (p.indexOf('text') === 0) {\n          t[p] = symbol[p];\n        } else {\n          b[p] = symbol[p];\n        }\n      }\n    }\n\n    return [t, b];\n  };\n\n  _proto._getTextSize = function _getTextSize(symbol) {\n    return splitTextToRow(this._content, symbol)['size'];\n  };\n\n  _proto._getInternalSymbol = function _getInternalSymbol() {\n    return this._symbol;\n  };\n\n  _proto._getDefaultTextSymbol = function _getDefaultTextSymbol() {\n    return extend({}, defaultSymbol$1);\n  };\n\n  _proto._getDefaultBoxSymbol = function _getDefaultBoxSymbol() {\n    return extend({}, defaultBoxSymbol);\n  };\n\n  _proto._getDefaultPadding = function _getDefaultPadding() {\n    return [12, 8];\n  };\n\n  return TextMarker;\n}(Marker);\n\nvar options$b = {\n  'textStyle': {\n    'wrap': true,\n    'padding': [12, 8],\n    'verticalAlignment': 'middle',\n    'horizontalAlignment': 'middle'\n  },\n  'boxSymbol': null\n};\n\nvar TextBox = function (_TextMarker) {\n  _inheritsLoose(TextBox, _TextMarker);\n\n  function TextBox(content, coordinates, width, height, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _TextMarker.call(this, coordinates, options) || this;\n    _this._content = escapeSpecialChars(content);\n    _this._width = isNil(width) ? 100 : width;\n    _this._height = isNil(height) ? 40 : height;\n\n    if (options.boxSymbol) {\n      _this.setBoxSymbol(options.boxSymbol);\n    }\n\n    if (options.textStyle) {\n      _this.setTextStyle(options.textStyle);\n    }\n\n    _this._refresh();\n\n    return _this;\n  }\n\n  var _proto = TextBox.prototype;\n\n  _proto.getWidth = function getWidth() {\n    return this._width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this._width = width;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this._height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this._height = height;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getBoxSymbol = function getBoxSymbol() {\n    return extend({}, this.options.boxSymbol);\n  };\n\n  _proto.setBoxSymbol = function setBoxSymbol(symbol) {\n    this.options.boxSymbol = symbol ? extend({}, symbol) : symbol;\n\n    if (this.getSymbol()) {\n      this._refresh();\n    }\n\n    return this;\n  };\n\n  _proto.getTextStyle = function getTextStyle() {\n    if (!this.options.textStyle) {\n      return null;\n    }\n\n    return extend({}, this.options.textStyle);\n  };\n\n  _proto.setTextStyle = function setTextStyle(style) {\n    this.options.textStyle = style ? extend({}, style) : style;\n\n    if (this.getSymbol()) {\n      this._refresh();\n    }\n\n    return this;\n  };\n\n  TextBox.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var textBox = new TextBox(json['content'], feature['geometry']['coordinates'], json['width'], json['height'], json['options']);\n    textBox.setProperties(feature['properties']);\n    textBox.setId(feature['id']);\n\n    if (json['symbol']) {\n      textBox.setSymbol(json['symbol']);\n    }\n\n    return textBox;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'width': this.getWidth(),\n      'height': this.getHeight(),\n      'subType': 'TextBox',\n      'content': this._content\n    };\n  };\n\n  _proto._refresh = function _refresh() {\n    var textStyle = this.getTextStyle() || {},\n        padding = textStyle['padding'] || [12, 8],\n        maxWidth = this._width - 2 * padding[0],\n        maxHeight = this._height - 2 * padding[1];\n    var symbol = extend({}, textStyle.symbol || this._getDefaultTextSymbol(), this.options.boxSymbol || this._getDefaultBoxSymbol(), {\n      'textName': this._content,\n      'markerWidth': this._width,\n      'markerHeight': this._height,\n      'textHorizontalAlignment': 'middle',\n      'textVerticalAlignment': 'middle',\n      'textMaxWidth': maxWidth,\n      'textMaxHeight': maxHeight\n    });\n\n    if (textStyle['wrap'] && !symbol['textWrapWidth']) {\n      symbol['textWrapWidth'] = maxWidth;\n    }\n\n    var hAlign = textStyle['horizontalAlignment'];\n    symbol['textDx'] = symbol['markerDx'] || 0;\n    var offsetX = symbol['markerWidth'] / 2 - padding[0];\n\n    if (hAlign === 'left') {\n      symbol['textHorizontalAlignment'] = 'right';\n      symbol['textDx'] = symbol['textDx'] - offsetX;\n    } else if (hAlign === 'right') {\n      symbol['textHorizontalAlignment'] = 'left';\n      symbol['textDx'] = symbol['textDx'] + offsetX;\n    }\n\n    var vAlign = textStyle['verticalAlignment'];\n    symbol['textDy'] = symbol['markerDy'] || 0;\n    var offsetY = symbol['markerHeight'] / 2 - padding[1];\n\n    if (vAlign === 'top') {\n      symbol['textVerticalAlignment'] = 'bottom';\n      symbol['textDy'] -= offsetY;\n    } else if (vAlign === 'bottom') {\n      symbol['textVerticalAlignment'] = 'top';\n      symbol['textDy'] += offsetY;\n    }\n\n    this._refreshing = true;\n    this.updateSymbol(symbol);\n    delete this._refreshing;\n  };\n\n  return TextBox;\n}(TextMarker);\n\nTextBox.mergeOptions(options$b);\nTextBox.registerJSONType('TextBox');\nvar options$c = {\n  'boxStyle': null,\n  textSymbol: null\n};\n\nvar Label = function (_TextMarker) {\n  _inheritsLoose(Label, _TextMarker);\n\n  function Label(content, coordinates, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _TextMarker.call(this, coordinates, options) || this;\n\n    if (options.textSymbol) {\n      _this.setTextSymbol(options.textSymbol);\n    }\n\n    if (options.boxStyle) {\n      _this.setBoxStyle(options.boxStyle);\n    }\n\n    _this._content = escapeSpecialChars(content);\n\n    _this._refresh();\n\n    return _this;\n  }\n\n  var _proto = Label.prototype;\n\n  _proto.getBoxStyle = function getBoxStyle() {\n    if (!this.options.boxStyle) {\n      return null;\n    }\n\n    return extend({}, this.options.boxStyle);\n  };\n\n  _proto.setBoxStyle = function setBoxStyle(style) {\n    this.options.boxStyle = style ? extend({}, style) : style;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getTextSymbol = function getTextSymbol() {\n    return extend({}, this._getDefaultTextSymbol(), this.options.textSymbol);\n  };\n\n  _proto.setTextSymbol = function setTextSymbol(symbol) {\n    this.options.textSymbol = symbol ? extend({}, symbol) : symbol;\n\n    this._refresh();\n\n    return this;\n  };\n\n  Label.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var label = new Label(json['content'], feature['geometry']['coordinates'], json['options']);\n    label.setProperties(feature['properties']);\n    label.setId(feature['id']);\n\n    if (json['symbol']) {\n      label.setSymbol(json['symbol']);\n    }\n\n    return label;\n  };\n\n  _proto._canEdit = function _canEdit() {\n    return false;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'Label',\n      'content': this._content\n    };\n  };\n\n  _proto._refresh = function _refresh() {\n    var symbol = extend({}, this.getTextSymbol(), {\n      'textName': this._content\n    });\n    var boxStyle = this.getBoxStyle();\n\n    if (boxStyle) {\n      extend(symbol, boxStyle.symbol);\n\n      var sizes = this._getBoxSize(symbol),\n          textSize = sizes[1],\n          padding = boxStyle['padding'] || this._getDefaultPadding();\n\n      var boxSize = sizes[0];\n      symbol['markerWidth'] = boxSize['width'];\n      symbol['markerHeight'] = boxSize['height'];\n\n      var dx = symbol['textDx'] || 0,\n          dy = symbol['textDy'] || 0,\n          textAlignPoint = getAlignPoint(textSize, symbol['textHorizontalAlignment'], symbol['textVerticalAlignment'])._add(dx, dy);\n\n      var hAlign = boxStyle['horizontalAlignment'] || 'middle';\n      symbol['markerDx'] = textAlignPoint.x;\n\n      if (hAlign === 'left') {\n        symbol['markerDx'] += symbol['markerWidth'] / 2 - padding[0];\n      } else if (hAlign === 'right') {\n        symbol['markerDx'] -= symbol['markerWidth'] / 2 - textSize['width'] - padding[0];\n      } else {\n        symbol['markerDx'] += textSize['width'] / 2;\n      }\n\n      var vAlign = boxStyle['verticalAlignment'] || 'middle';\n      symbol['markerDy'] = textAlignPoint.y;\n\n      if (vAlign === 'top') {\n        symbol['markerDy'] += symbol['markerHeight'] / 2 - padding[1];\n      } else if (vAlign === 'bottom') {\n        symbol['markerDy'] -= symbol['markerHeight'] / 2 - textSize['height'] - padding[1] + 1;\n      } else {\n        symbol['markerDy'] += textSize['height'] / 2;\n      }\n    }\n\n    this._refreshing = true;\n    this.updateSymbol(symbol);\n    delete this._refreshing;\n  };\n\n  _proto._getBoxSize = function _getBoxSize(symbol) {\n    if (!symbol['markerType']) {\n      symbol['markerType'] = 'square';\n    }\n\n    var boxStyle = this.getBoxStyle();\n\n    var size = this._getTextSize(symbol);\n\n    var width, height;\n\n    var padding = boxStyle['padding'] || this._getDefaultPadding();\n\n    width = size['width'] + padding[0] * 2;\n    height = size['height'] + padding[1] * 2;\n\n    if (boxStyle['minWidth']) {\n      if (!width || width < boxStyle['minWidth']) {\n        width = boxStyle['minWidth'];\n      }\n    }\n\n    if (boxStyle['minHeight']) {\n      if (!height || height < boxStyle['minHeight']) {\n        height = boxStyle['minHeight'];\n      }\n    }\n\n    return [new Size(width, height), size];\n  };\n\n  return Label;\n}(TextMarker);\n\nLabel.mergeOptions(options$c);\nLabel.registerJSONType('Label');\n\nvar Connectable = function Connectable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class._hasConnectors = function _hasConnectors(geometry) {\n      return !isNil(geometry.__connectors) && geometry.__connectors.length > 0;\n    };\n\n    _class._getConnectors = function _getConnectors(geometry) {\n      return geometry.__connectors;\n    };\n\n    var _proto = _class.prototype;\n\n    _proto.getConnectSource = function getConnectSource() {\n      return this._connSource;\n    };\n\n    _proto.setConnectSource = function setConnectSource(src) {\n      var target = this._connTarget;\n      this.onRemove();\n      this._connSource = src;\n      this._connTarget = target;\n      this.onAdd();\n      return this;\n    };\n\n    _proto.getConnectTarget = function getConnectTarget() {\n      return this._connTarget;\n    };\n\n    _proto.setConnectTarget = function setConnectTarget(target) {\n      var src = this._connSource;\n      this.onRemove();\n      this._connSource = src;\n      this._connTarget = target;\n\n      this._updateCoordinates();\n\n      this._registerEvents();\n\n      return this;\n    };\n\n    _proto._updateCoordinates = function _updateCoordinates() {\n      var map = this.getMap();\n\n      if (!map && this._connSource) {\n        map = this._connSource.getMap();\n      }\n\n      if (!map && this._connTarget) {\n        map = this._connTarget.getMap();\n      }\n\n      if (!map) {\n        return;\n      }\n\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      var srcPoints = this._connSource._getConnectPoints();\n\n      var targetPoints = this._connTarget._getConnectPoints();\n\n      var minDist = 0;\n      var oldCoordinates = this.getCoordinates();\n      var c1, c2;\n\n      for (var i = 0, len = srcPoints.length; i < len; i++) {\n        var p1 = srcPoints[i];\n\n        for (var j = 0, length = targetPoints.length; j < length; j++) {\n          var p2 = targetPoints[j];\n          var dist = map.computeLength(p1, p2);\n\n          if (i === 0 && j === 0) {\n            c1 = p1;\n            c2 = p2;\n            minDist = dist;\n          } else if (dist < minDist) {\n            c1 = p1;\n            c2 = p2;\n          }\n        }\n      }\n\n      if (!isArrayHasData(oldCoordinates) || !oldCoordinates[0].equals(c1) || !oldCoordinates[1].equals(c2)) {\n        this.setCoordinates([c1, c2]);\n      }\n    };\n\n    _proto.onAdd = function onAdd() {\n      this._registerEvents();\n\n      this._updateCoordinates();\n    };\n\n    _proto.onRemove = function onRemove() {\n      if (this._connSource) {\n        if (this._connSource.__connectors) {\n          removeFromArray(this, this._connSource.__connectors);\n        }\n\n        this._connSource.off('dragging positionchange', this._updateCoordinates, this).off('remove', this.onRemove, this);\n\n        this._connSource.off('dragstart mousedown mouseover', this._showConnect, this);\n\n        this._connSource.off('dragend mouseup mouseout', this.hide, this);\n\n        this._connSource.off('show', this._showConnect, this).off('hide', this.hide, this);\n\n        delete this._connSource;\n      }\n\n      if (this._connTarget) {\n        removeFromArray(this, this._connTarget.__connectors);\n\n        this._connTarget.off('dragging positionchange', this._updateCoordinates, this).off('remove', this.onRemove, this);\n\n        this._connTarget.off('show', this._showConnect, this).off('hide', this.hide, this);\n\n        delete this._connTarget;\n      }\n\n      if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n        var map = this.getMap();\n\n        if (map) {\n          map.off('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n        }\n      }\n    };\n\n    _proto._showConnect = function _showConnect() {\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      if (this._connSource.isVisible() && this._connTarget.isVisible()) {\n        this._updateCoordinates();\n\n        this.show();\n      }\n    };\n\n    _proto._registerEvents = function _registerEvents() {\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      if (!this._connSource.__connectors) {\n        this._connSource.__connectors = [];\n      }\n\n      if (!this._connTarget.__connectors) {\n        this._connTarget.__connectors = [];\n      }\n\n      this._connSource.__connectors.push(this);\n\n      this._connTarget.__connectors.push(this);\n\n      this._connSource.on('dragging positionchange', this._updateCoordinates, this).on('remove', this.remove, this);\n\n      this._connTarget.on('dragging positionchange', this._updateCoordinates, this).on('remove', this.remove, this);\n\n      this._connSource.on('show', this._showConnect, this).on('hide', this.hide, this);\n\n      this._connTarget.on('show', this._showConnect, this).on('hide', this.hide, this);\n\n      var trigger = this.options['showOn'];\n      this.hide();\n\n      if (trigger === 'moving') {\n        this._connSource.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n\n        this._connTarget.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n      } else if (trigger === 'click') {\n        this._connSource.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n\n        this._connTarget.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n      } else if (trigger === 'mouseover') {\n        this._connSource.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n\n        this._connTarget.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n      } else {\n        this._showConnect();\n      }\n\n      if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n        var map = this.getMap();\n\n        if (map) {\n          map.on('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n        }\n      }\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar options$d = {\n  showOn: 'always'\n};\n\nvar ConnectorLine = function (_Connectable) {\n  _inheritsLoose(ConnectorLine, _Connectable);\n\n  function ConnectorLine(src, target, options) {\n    var _this;\n\n    _this = _Connectable.call(this, null, options) || this;\n\n    if (arguments.length === 1) {\n      options = src;\n      src = null;\n      target = null;\n    }\n\n    _this._connSource = src;\n    _this._connTarget = target;\n    return _this;\n  }\n\n  return ConnectorLine;\n}(Connectable(LineString));\n\nConnectorLine.mergeOptions(options$d);\nConnectorLine.registerJSONType('ConnectorLine');\n\nvar ArcConnectorLine = function (_Connectable2) {\n  _inheritsLoose(ArcConnectorLine, _Connectable2);\n\n  function ArcConnectorLine(src, target, options) {\n    var _this2;\n\n    _this2 = _Connectable2.call(this, null, options) || this;\n\n    if (arguments.length === 1) {\n      options = src;\n      src = null;\n      target = null;\n    }\n\n    _this2._connSource = src;\n    _this2._connTarget = target;\n    return _this2;\n  }\n\n  return ArcConnectorLine;\n}(Connectable(ArcCurve));\n\nArcConnectorLine.mergeOptions(options$d);\nArcConnectorLine.registerJSONType('ArcConnectorLine');\nvar options$e = {\n  'drawImmediate': false\n};\nvar TEMP_EXTENT$3 = new PointExtent();\n\nvar OverlayLayer = function (_Layer) {\n  _inheritsLoose(OverlayLayer, _Layer);\n\n  function OverlayLayer(id, geometries, options) {\n    var _this;\n\n    if (geometries && !(geometries instanceof Geometry) && !Array.isArray(geometries) && GEOJSON_TYPES.indexOf(geometries.type) < 0) {\n      options = geometries;\n      geometries = null;\n    }\n\n    _this = _Layer.call(this, id, options) || this;\n    _this._maxZIndex = 0;\n    _this._minZIndex = 0;\n\n    _this._initCache();\n\n    if (geometries) {\n      _this.addGeometry(geometries);\n    }\n\n    var style = _this.options['style'];\n    delete _this.options['style'];\n\n    if (style) {\n      _this.setStyle(style);\n    }\n\n    return _this;\n  }\n\n  var _proto = OverlayLayer.prototype;\n\n  _proto.getGeometryById = function getGeometryById(id) {\n    if (isNil(id) || id === '') {\n      return null;\n    }\n\n    if (!this._geoMap[id]) {\n      return null;\n    }\n\n    return this._geoMap[id];\n  };\n\n  _proto.getGeometries = function getGeometries(filter, context) {\n    if (!filter) {\n      return this._geoList.slice(0);\n    }\n\n    var result = [];\n    var geometry, filtered;\n\n    for (var i = 0, l = this._geoList.length; i < l; i++) {\n      geometry = this._geoList[i];\n\n      if (context) {\n        filtered = filter.call(context, geometry);\n      } else {\n        filtered = filter(geometry);\n      }\n\n      if (filtered) {\n        result.push(geometry);\n      }\n    }\n\n    return result;\n  };\n\n  _proto.getFirstGeometry = function getFirstGeometry() {\n    if (!this._geoList.length) {\n      return null;\n    }\n\n    return this._geoList[0];\n  };\n\n  _proto.getLastGeometry = function getLastGeometry() {\n    var len = this._geoList.length;\n\n    if (len === 0) {\n      return null;\n    }\n\n    return this._geoList[len - 1];\n  };\n\n  _proto.getCount = function getCount() {\n    return this._geoList.length;\n  };\n\n  _proto.getExtent = function getExtent() {\n    if (this.getCount() === 0) {\n      return null;\n    }\n\n    var extent = new Extent(this.getProjection());\n    this.forEach(function (g) {\n      extent._combine(g.getExtent());\n    });\n    return extent;\n  };\n\n  _proto.forEach = function forEach(fn, context) {\n    var copyOnWrite = this._geoList.slice(0);\n\n    for (var i = 0, l = copyOnWrite.length; i < l; i++) {\n      if (!context) {\n        fn(copyOnWrite[i], i);\n      } else {\n        fn.call(context, copyOnWrite[i], i);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.filter = function filter(fn, context) {\n    var selected = [];\n    var isFn = isFunction(fn);\n    var filter = isFn ? fn : createFilter(fn);\n    this.forEach(function (geometry) {\n      var g = isFn ? geometry : getFilterFeature(geometry);\n\n      if (context ? filter.call(context, g) : filter(g)) {\n        selected.push(geometry);\n      }\n    }, this);\n    return selected;\n  };\n\n  _proto.isEmpty = function isEmpty$$1() {\n    return !this._geoList.length;\n  };\n\n  _proto.addGeometry = function addGeometry(geometries, fitView) {\n    if (!geometries) {\n      return this;\n    }\n\n    if (geometries.type === 'FeatureCollection') {\n      return this.addGeometry(GeoJSON.toGeometry(geometries), fitView);\n    } else if (!Array.isArray(geometries)) {\n      var count = arguments.length;\n      var last = arguments[count - 1];\n      geometries = Array.prototype.slice.call(arguments, 0, count - 1);\n      fitView = last;\n\n      if (last && isObject(last) && ('type' in last || last instanceof Geometry)) {\n        geometries.push(last);\n        fitView = false;\n      }\n\n      return this.addGeometry(geometries, fitView);\n    } else if (geometries.length === 0) {\n      return this;\n    }\n\n    this._initCache();\n\n    var extent;\n\n    if (fitView) {\n      extent = new Extent();\n    }\n\n    this._toSort = this._maxZIndex > 0;\n    var geos = [];\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      var geo = geometries[i];\n\n      if (!geo) {\n        throw new Error('Invalid geometry to add to layer(' + this.getId() + ') at index:' + i);\n      }\n\n      if (!(geo instanceof Geometry)) {\n        geo = Geometry.fromJSON(geo);\n\n        if (Array.isArray(geo)) {\n          for (var ii = 0, ll = geo.length; ii < ll; ii++) {\n            this._add(geo[ii], extent, i);\n\n            geos.push(geo[ii]);\n          }\n        }\n      }\n\n      if (!Array.isArray(geo)) {\n        this._add(geo, extent, i);\n\n        geos.push(geo);\n      }\n    }\n\n    var map = this.getMap();\n\n    if (map) {\n      this._getRenderer().onGeometryAdd(geos);\n\n      if (extent && !isNil(extent.xmin)) {\n        var center = extent.getCenter();\n        var z = map.getFitZoom(extent);\n\n        if (isObject(fitView)) {\n          var step = isFunction(fitView.step) ? fitView.step : function () {\n            return undefined;\n          };\n          map.animateTo({\n            center: center,\n            zoom: z\n          }, extend({\n            duration: map.options.zoomAnimationDuration,\n            easing: 'out'\n          }, fitView), step);\n        } else if (fitView === true) {\n          map.setCenterAndZoom(center, z);\n        }\n      }\n    }\n\n    this.fire('addgeo', {\n      'geometries': geometries\n    });\n    return this;\n  };\n\n  _proto.getGeoMinZIndex = function getGeoMinZIndex() {\n    return this._minZIndex;\n  };\n\n  _proto.getGeoMaxZIndex = function getGeoMaxZIndex() {\n    return this._maxZIndex;\n  };\n\n  _proto._add = function _add(geo, extent, i) {\n    if (!this._toSort) {\n      this._toSort = geo.getZIndex() !== 0;\n    }\n\n    this._updateZIndex(geo.getZIndex());\n\n    var geoId = geo.getId();\n\n    if (!isNil(geoId)) {\n      if (!isNil(this._geoMap[geoId])) {\n        throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + geoId + ', at index:' + i);\n      }\n\n      this._geoMap[geoId] = geo;\n    }\n\n    var internalId = UID();\n\n    geo._setInternalId(internalId);\n\n    this._geoList.push(geo);\n\n    this.onAddGeometry(geo);\n\n    geo._bindLayer(this);\n\n    if (geo.onAdd) {\n      geo.onAdd();\n    }\n\n    if (extent) {\n      extent._combine(geo.getExtent());\n    }\n\n    geo._fireEvent('add', {\n      'layer': this\n    });\n  };\n\n  _proto.removeGeometry = function removeGeometry(geometries) {\n    if (!Array.isArray(geometries)) {\n      return this.removeGeometry([geometries]);\n    }\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      if (!(geometries[i] instanceof Geometry)) {\n        geometries[i] = this.getGeometryById(geometries[i]);\n      }\n\n      if (!geometries[i] || this !== geometries[i].getLayer()) continue;\n      geometries[i].remove();\n    }\n\n    this.fire('removegeo', {\n      'geometries': geometries\n    });\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this._clearing = true;\n    this.forEach(function (geo) {\n      geo.remove();\n    });\n    this._geoMap = {};\n    var old = this._geoList;\n    this._geoList = [];\n\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryRemove(old);\n    }\n\n    this._clearing = false;\n    this.fire('clear');\n    return this;\n  };\n\n  _proto.onRemoveGeometry = function onRemoveGeometry(geometry) {\n    if (!geometry || this._clearing) {\n      return;\n    }\n\n    if (this !== geometry.getLayer()) {\n      return;\n    }\n\n    var internalId = geometry._getInternalId();\n\n    if (isNil(internalId)) {\n      return;\n    }\n\n    var geoId = geometry.getId();\n\n    if (!isNil(geoId)) {\n      delete this._geoMap[geoId];\n    }\n\n    var idx = this._findInList(geometry);\n\n    if (idx >= 0) {\n      this._geoList.splice(idx, 1);\n    }\n\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryRemove([geometry]);\n    }\n  };\n\n  _proto.getStyle = function getStyle() {\n    if (!this._style) {\n      return null;\n    }\n\n    return this._style;\n  };\n\n  _proto.setStyle = function setStyle(style) {\n    this._style = style;\n    this._cookedStyles = compileStyle(style);\n    this.forEach(function (geometry) {\n      this._styleGeometry(geometry);\n    }, this);\n    this.fire('setstyle', {\n      'style': style\n    });\n    return this;\n  };\n\n  _proto._styleGeometry = function _styleGeometry(geometry) {\n    if (!this._cookedStyles) {\n      return false;\n    }\n\n    var g = getFilterFeature(geometry);\n\n    for (var i = 0, len = this._cookedStyles.length; i < len; i++) {\n      if (this._cookedStyles[i]['filter'](g) === true) {\n        geometry._setExternSymbol(this._cookedStyles[i]['symbol']);\n\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.removeStyle = function removeStyle() {\n    if (!this._style) {\n      return this;\n    }\n\n    delete this._style;\n    delete this._cookedStyles;\n    this.forEach(function (geometry) {\n      geometry._setExternSymbol(null);\n    }, this);\n    this.fire('removestyle');\n    return this;\n  };\n\n  _proto.onAddGeometry = function onAddGeometry(geo) {\n    var style = this.getStyle();\n\n    if (style) {\n      this._styleGeometry(geo);\n    }\n  };\n\n  _proto.hide = function hide() {\n    for (var i = 0, l = this._geoList.length; i < l; i++) {\n      this._geoList[i].onHide();\n    }\n\n    return Layer.prototype.hide.call(this);\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!(coordinate instanceof Coordinate)) {\n      coordinate = new Coordinate(coordinate);\n    }\n\n    return this._hitGeos(this._geoList, coordinate, options);\n  };\n\n  _proto._hitGeos = function _hitGeos(geometries, coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var filter = options['filter'],\n        tolerance = options['tolerance'],\n        hits = [];\n    var map = this.getMap();\n    var point = map.coordToPoint(coordinate);\n\n    var cp = map._pointToContainerPoint(point, undefined, 0, point);\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      var geo = geometries[i];\n\n      if (!geo || !geo.isVisible() || !geo._getPainter() || !geo.options['interactive']) {\n        continue;\n      }\n\n      if (!(geo instanceof LineString) || !geo._getArrowStyle() && !(geo instanceof Curve)) {\n        var extent = geo.getContainerExtent(TEMP_EXTENT$3);\n\n        if (tolerance) {\n          extent = extent._expand(tolerance);\n        }\n\n        if (!extent || !extent.contains(cp)) {\n          continue;\n        }\n      }\n\n      if (geo._containsPoint(cp, tolerance) && (!filter || filter(geo))) {\n        hits.push(geo);\n\n        if (options['count']) {\n          if (hits.length >= options['count']) {\n            break;\n          }\n        }\n      }\n    }\n\n    return hits;\n  };\n\n  _proto._initCache = function _initCache() {\n    if (!this._geoList) {\n      this._geoList = [];\n      this._geoMap = {};\n    }\n  };\n\n  _proto._updateZIndex = function _updateZIndex() {\n    for (var _len = arguments.length, zIndex = new Array(_len), _key = 0; _key < _len; _key++) {\n      zIndex[_key] = arguments[_key];\n    }\n\n    this._maxZIndex = Math.max(this._maxZIndex, Math.max.apply(Math, zIndex));\n    this._minZIndex = Math.min(this._minZIndex, Math.min.apply(Math, zIndex));\n  };\n\n  _proto._sortGeometries = function _sortGeometries() {\n    var _this2 = this;\n\n    if (!this._toSort) {\n      return;\n    }\n\n    this._maxZIndex = 0;\n    this._minZIndex = 0;\n\n    this._geoList.sort(function (a, b) {\n      _this2._updateZIndex(a.getZIndex(), b.getZIndex());\n\n      return _this2._compare(a, b);\n    });\n\n    this._toSort = false;\n  };\n\n  _proto._compare = function _compare(a, b) {\n    if (a.getZIndex() === b.getZIndex()) {\n      return a._getInternalId() - b._getInternalId();\n    }\n\n    return a.getZIndex() - b.getZIndex();\n  };\n\n  _proto._findInList = function _findInList(geo) {\n    var len = this._geoList.length;\n\n    if (len === 0) {\n      return -1;\n    }\n\n    var low = 0,\n        high = len - 1,\n        middle;\n\n    while (low <= high) {\n      middle = Math.floor((low + high) / 2);\n\n      if (this._geoList[middle] === geo) {\n        return middle;\n      } else if (this._compare(this._geoList[middle], geo) > 0) {\n        high = middle - 1;\n      } else {\n        low = middle + 1;\n      }\n    }\n\n    return -1;\n  };\n\n  _proto._onGeometryEvent = function _onGeometryEvent(param) {\n    if (!param || !param['target']) {\n      return;\n    }\n\n    var type = param['type'];\n\n    if (type === 'idchange') {\n      this._onGeometryIdChange(param);\n    } else if (type === 'zindexchange') {\n      this._onGeometryZIndexChange(param);\n    } else if (type === 'positionchange') {\n      this._onGeometryPositionChange(param);\n    } else if (type === 'shapechange') {\n      this._onGeometryShapeChange(param);\n    } else if (type === 'symbolchange') {\n      this._onGeometrySymbolChange(param);\n    } else if (type === 'show') {\n      this._onGeometryShow(param);\n    } else if (type === 'hide') {\n      this._onGeometryHide(param);\n    } else if (type === 'propertieschange') {\n      this._onGeometryPropertiesChange(param);\n    }\n  };\n\n  _proto._onGeometryIdChange = function _onGeometryIdChange(param) {\n    if (param['new'] === param['old']) {\n      if (this._geoMap[param['old']] && this._geoMap[param['old']] === param['target']) {\n        return;\n      }\n    }\n\n    if (!isNil(param['new'])) {\n      if (this._geoMap[param['new']]) {\n        throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + param['new']);\n      }\n\n      this._geoMap[param['new']] = param['target'];\n    }\n\n    if (!isNil(param['old']) && param['new'] !== param['old']) {\n      delete this._geoMap[param['old']];\n    }\n  };\n\n  _proto._onGeometryZIndexChange = function _onGeometryZIndexChange(param) {\n    if (param['old'] !== param['new']) {\n      this._updateZIndex(param['new']);\n\n      this._toSort = true;\n\n      if (this._getRenderer()) {\n        this._getRenderer().onGeometryZIndexChange(param);\n      }\n    }\n  };\n\n  _proto._onGeometryPositionChange = function _onGeometryPositionChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryPositionChange(param);\n    }\n  };\n\n  _proto._onGeometryShapeChange = function _onGeometryShapeChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryShapeChange(param);\n    }\n  };\n\n  _proto._onGeometrySymbolChange = function _onGeometrySymbolChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometrySymbolChange(param);\n    }\n  };\n\n  _proto._onGeometryShow = function _onGeometryShow(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryShow(param);\n    }\n  };\n\n  _proto._onGeometryHide = function _onGeometryHide(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryHide(param);\n    }\n  };\n\n  _proto._onGeometryPropertiesChange = function _onGeometryPropertiesChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryPropertiesChange(param);\n    }\n  };\n\n  return OverlayLayer;\n}(Layer);\n\nOverlayLayer.mergeOptions(options$e);\nvar options$f = {\n  'debug': false,\n  'enableSimplify': true,\n  'geometryEvents': true,\n  'defaultIconSize': [20, 20],\n  'cacheVectorOnCanvas': true,\n  'cacheSvgOnCanvas': Browser$1.gecko,\n  'enableAltitude': false,\n  'altitudeProperty': 'altitude',\n  'drawAltitude': false\n};\n\nvar VectorLayer = function (_OverlayLayer) {\n  _inheritsLoose(VectorLayer, _OverlayLayer);\n\n  function VectorLayer(id, geometries, options) {\n    return _OverlayLayer.call(this, id, geometries, options) || this;\n  }\n\n  var _proto = VectorLayer.prototype;\n\n  _proto.onConfig = function onConfig(conf) {\n    _OverlayLayer.prototype.onConfig.call(this, conf);\n\n    if (conf['enableAltitude'] || conf['drawAltitude'] || conf['altitudeProperty']) {\n      var renderer = this.getRenderer();\n\n      if (renderer && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var renderer = this.getRenderer();\n\n    if (options['onlyVisible'] && renderer && renderer.identify) {\n      return renderer.identify(coordinate, options);\n    }\n\n    return _OverlayLayer.prototype.identify.call(this, coordinate, options);\n  };\n\n  _proto.toJSON = function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'options': this.config()\n    };\n\n    if ((isNil(options['style']) || options['style']) && this.getStyle()) {\n      profile['style'] = this.getStyle();\n    }\n\n    if (isNil(options['geometries']) || options['geometries']) {\n      var clipExtent;\n\n      if (options['clipExtent']) {\n        var map = this.getMap();\n        var projection = map ? map.getProjection() : null;\n        clipExtent = new Extent(options['clipExtent'], projection);\n      }\n\n      var geoJSONs = [];\n      var geometries = this.getGeometries();\n\n      for (var i = 0, len = geometries.length; i < len; i++) {\n        var geo = geometries[i];\n        var geoExt = geo.getExtent();\n\n        if (!geoExt || clipExtent && !clipExtent.intersects(geoExt)) {\n          continue;\n        }\n\n        var json = geo.toJSON(options['geometries']);\n        geoJSONs.push(json);\n      }\n\n      profile['geometries'] = geoJSONs;\n    }\n\n    return profile;\n  };\n\n  VectorLayer.fromJSON = function fromJSON(json) {\n    if (!json || json['type'] !== 'VectorLayer') {\n      return null;\n    }\n\n    var layer = new VectorLayer(json['id'], json['options']);\n    var geoJSONs = json['geometries'];\n    var geometries = [];\n\n    for (var i = 0; i < geoJSONs.length; i++) {\n      var geo = Geometry.fromJSON(geoJSONs[i]);\n\n      if (geo) {\n        geometries.push(geo);\n      }\n    }\n\n    layer.addGeometry(geometries);\n\n    if (json['style']) {\n      layer.setStyle(json['style']);\n    }\n\n    return layer;\n  };\n\n  return VectorLayer;\n}(OverlayLayer);\n\nVectorLayer.mergeOptions(options$f);\nVectorLayer.registerJSONType('VectorLayer');\nvar key = '_map_tool';\n\nvar MapTool = function (_Eventable) {\n  _inheritsLoose(MapTool, _Eventable);\n\n  function MapTool() {\n    return _Eventable.apply(this, arguments) || this;\n  }\n\n  var _proto = MapTool.prototype;\n\n  _proto.addTo = function addTo(map) {\n    if (!map) {\n      return this;\n    }\n\n    this._map = map;\n\n    if (map[key]) {\n      map[key].disable();\n    }\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.enable();\n    map[key] = this;\n\n    this._fireEvent('add');\n\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    return this._map;\n  };\n\n  _proto.enable = function enable() {\n    var map = this._map;\n\n    if (!map || this._enabled) {\n      return this;\n    }\n\n    this._enabled = true;\n\n    this._switchEvents('off');\n\n    this._registerEvents();\n\n    if (this.onEnable) {\n      this.onEnable();\n    }\n\n    this._fireEvent('enable');\n\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this._enabled || !this._map) {\n      return this;\n    }\n\n    this._enabled = false;\n\n    this._switchEvents('off');\n\n    if (this.onDisable) {\n      this.onDisable();\n    }\n\n    this._fireEvent('disable');\n\n    return this;\n  };\n\n  _proto.isEnabled = function isEnabled() {\n    if (!this._enabled) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.remove = function remove() {\n    if (!this._map) {\n      return this;\n    }\n\n    this.disable();\n\n    if (this._map) {\n      delete this._map[key];\n      delete this._map;\n    }\n\n    this._fireEvent('remove');\n\n    return this;\n  };\n\n  _proto._registerEvents = function _registerEvents() {\n    this._switchEvents('on');\n  };\n\n  _proto._switchEvents = function _switchEvents(to) {\n    var events = this.getEvents();\n\n    if (events) {\n      this._map[to](events, this);\n    }\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (!param) {\n      param = {};\n    }\n\n    this.fire(eventName, param);\n  };\n\n  return MapTool;\n}(Eventable(Class));\n\nvar options$g = {\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'polygonFill': '#fff',\n    'polygonOpacity': 0.3\n  },\n  'doubleClickZoom': false,\n  'mode': null,\n  'once': false,\n  'autoPanAtEdge': false,\n  'ignoreMouseleave': true\n};\nvar registeredMode = {};\n\nvar DrawTool = function (_MapTool) {\n  _inheritsLoose(DrawTool, _MapTool);\n\n  DrawTool.registerMode = function registerMode(name, modeAction) {\n    registeredMode[name.toLowerCase()] = modeAction;\n  };\n\n  DrawTool.getRegisterMode = function getRegisterMode(name) {\n    return registeredMode[name.toLowerCase()];\n  };\n\n  function DrawTool(options) {\n    var _this;\n\n    _this = _MapTool.call(this, options) || this;\n\n    _this._checkMode();\n\n    _this._events = {\n      'click': _this._clickHandler,\n      'mousemove': _this._mouseMoveHandler,\n      'dblclick': _this._doubleClickHandler,\n      'mousedown': _this._mouseDownHandler,\n      'mouseup': _this._mouseUpHandler\n    };\n    return _this;\n  }\n\n  var _proto = DrawTool.prototype;\n\n  _proto.getMode = function getMode() {\n    if (this.options['mode']) {\n      return this.options['mode'].toLowerCase();\n    }\n\n    return null;\n  };\n\n  _proto.setMode = function setMode(mode) {\n    if (this._geometry) {\n      this._geometry.remove();\n\n      delete this._geometry;\n    }\n\n    this._clearStage();\n\n    this._switchEvents('off');\n\n    this.options['mode'] = mode;\n\n    this._checkMode();\n\n    if (this.isEnabled()) {\n      this._switchEvents('on');\n\n      this._restoreMapCfg();\n\n      this._saveMapCfg();\n    }\n\n    return this;\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var symbol = this.options['symbol'];\n\n    if (symbol) {\n      return extendSymbol(symbol);\n    } else {\n      return extendSymbol(this.options['symbol']);\n    }\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    if (!symbol) {\n      return this;\n    }\n\n    this.options['symbol'] = symbol;\n\n    if (this._geometry) {\n      this._geometry.setSymbol(symbol);\n    }\n\n    return this;\n  };\n\n  _proto.getCurrentGeometry = function getCurrentGeometry() {\n    return this._geometry;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this._checkMode();\n  };\n\n  _proto.onEnable = function onEnable() {\n    this._saveMapCfg();\n\n    this._drawToolLayer = this._getDrawLayer();\n\n    this._clearStage();\n\n    this._loadResources();\n\n    if (this.options['autoPanAtEdge']) {\n      var map = this.getMap();\n      this._mapAutoPanAtEdge = map.options['autoPanAtEdge'];\n\n      if (!this._mapAutoPanAtEdge) {\n        map.config({\n          autoPanAtEdge: true\n        });\n      }\n    }\n\n    return this;\n  };\n\n  _proto.onDisable = function onDisable() {\n    var map = this.getMap();\n\n    this._restoreMapCfg();\n\n    this.endDraw();\n\n    if (this._map) {\n      map.removeLayer(this._getDrawLayer());\n\n      if (this.options['autoPanAtEdge']) {\n        if (!this._mapAutoPanAtEdge) {\n          map.config({\n            autoPanAtEdge: false\n          });\n        }\n      }\n    }\n\n    return this;\n  };\n\n  _proto.undo = function undo() {\n    var registerMode = this._getRegisterMode();\n\n    var action = registerMode.action;\n\n    if (!this._shouldRecordHistory(action) || !this._historyPointer) {\n      return this;\n    }\n\n    var coords = this._clickCoords.slice(0, --this._historyPointer);\n\n    registerMode.update(this.getMap().getProjection(), coords, this._geometry);\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    var registerMode = this._getRegisterMode();\n\n    var action = registerMode.action;\n\n    if (!this._shouldRecordHistory(action) || isNil(this._historyPointer) || this._historyPointer === this._clickCoords.length) {\n      return this;\n    }\n\n    var coords = this._clickCoords.slice(0, ++this._historyPointer);\n\n    registerMode.update(this.getMap().getProjection(), coords, this._geometry);\n    return this;\n  };\n\n  _proto._shouldRecordHistory = function _shouldRecordHistory(actions) {\n    return Array.isArray(actions) && actions[0] === 'click' && actions[1] === 'mousemove' && actions[2] === 'dblclick';\n  };\n\n  _proto._checkMode = function _checkMode() {\n    this._getRegisterMode();\n  };\n\n  _proto._saveMapCfg = function _saveMapCfg() {\n    var map = this.getMap();\n    this._mapDoubleClickZoom = map.options['doubleClickZoom'];\n    map.config({\n      'doubleClickZoom': this.options['doubleClickZoom']\n    });\n\n    var actions = this._getRegisterMode()['action'];\n\n    if (actions.indexOf('mousedown') > -1) {\n      var _map = this.getMap();\n\n      this._mapDraggable = _map.options['draggable'];\n\n      _map.config({\n        'draggable': false\n      });\n    }\n  };\n\n  _proto._restoreMapCfg = function _restoreMapCfg() {\n    var map = this.getMap();\n    map.config({\n      'doubleClickZoom': this._mapDoubleClickZoom\n    });\n\n    if (!isNil(this._mapDraggable)) {\n      map.config('draggable', this._mapDraggable);\n    }\n\n    delete this._mapDraggable;\n    delete this._mapDoubleClickZoom;\n  };\n\n  _proto._loadResources = function _loadResources() {\n    var symbol = this.getSymbol();\n    var resources = getExternalResources(symbol);\n\n    if (resources.length > 0) {\n      this._drawToolLayer._getRenderer().loadResources(resources);\n    }\n  };\n\n  _proto._getProjection = function _getProjection() {\n    return this._map.getProjection();\n  };\n\n  _proto._getRegisterMode = function _getRegisterMode() {\n    var mode = this.getMode();\n    var registerMode = DrawTool.getRegisterMode(mode);\n\n    if (!registerMode) {\n      throw new Error(mode + ' is not a valid mode of DrawTool.');\n    }\n\n    return registerMode;\n  };\n\n  _proto.getEvents = function getEvents() {\n    var action = this._getRegisterMode()['action'];\n\n    var _events = {};\n\n    if (Array.isArray(action)) {\n      for (var i = 0; i < action.length; i++) {\n        _events[action[i]] = this._events[action[i]];\n      }\n\n      return _events;\n    }\n\n    return null;\n  };\n\n  _proto._mouseDownHandler = function _mouseDownHandler(event) {\n    this._createGeometry(event);\n  };\n\n  _proto._mouseUpHandler = function _mouseUpHandler(event) {\n    this.endDraw(event);\n  };\n\n  _proto._clickHandler = function _clickHandler(event) {\n    var registerMode = this._getRegisterMode();\n\n    if (!this._geometry) {\n      this._createGeometry(event);\n    } else {\n      var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n      if (!isNil(this._historyPointer)) {\n        this._clickCoords = this._clickCoords.slice(0, this._historyPointer);\n      }\n\n      this._clickCoords.push(prjCoord);\n\n      this._historyPointer = this._clickCoords.length;\n      event.drawTool = this;\n      registerMode['update'](this.getMap().getProjection(), this._clickCoords, this._geometry, event);\n\n      this._fireEvent('drawvertex', event);\n\n      if (registerMode['clickLimit'] && registerMode['clickLimit'] === this._historyPointer) {\n        this.endDraw(event);\n      }\n    }\n  };\n\n  _proto._createGeometry = function _createGeometry(event) {\n    var mode = this.getMode();\n\n    var registerMode = this._getRegisterMode();\n\n    var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n    var symbol = this.getSymbol();\n\n    if (!this._geometry) {\n      this._clickCoords = [prjCoord];\n      event.drawTool = this;\n      this._geometry = registerMode['create'](this.getMap().getProjection(), this._clickCoords, event);\n\n      if (symbol && mode !== 'point') {\n        this._geometry.setSymbol(symbol);\n      } else if (this.options.hasOwnProperty('symbol')) {\n        this._geometry.setSymbol(this.options['symbol']);\n      }\n\n      this._addGeometryToStage(this._geometry);\n\n      this._fireEvent('drawstart', event);\n    }\n\n    if (mode === 'point') {\n      this.endDraw(event);\n    }\n  };\n\n  _proto._mouseMoveHandler = function _mouseMoveHandler(event) {\n    var map = this.getMap();\n\n    if (!this._geometry || !map || map.isInteracting()) {\n      return;\n    }\n\n    var containerPoint = this._getMouseContainerPoint(event);\n\n    if (!this._isValidContainerPoint(containerPoint)) {\n      return;\n    }\n\n    var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n    var projection = map.getProjection();\n    event.drawTool = this;\n\n    var registerMode = this._getRegisterMode();\n\n    if (this._shouldRecordHistory(registerMode.action)) {\n      var path = this._clickCoords.slice(0, this._historyPointer);\n\n      if (path && path.length > 0 && prjCoord.equals(path[path.length - 1])) {\n        return;\n      }\n\n      registerMode['update'](projection, path.concat([prjCoord]), this._geometry, event);\n    } else {\n      registerMode['update'](projection, prjCoord, this._geometry, event);\n    }\n\n    this._fireEvent('mousemove', event);\n  };\n\n  _proto._doubleClickHandler = function _doubleClickHandler(event) {\n    if (!this._geometry) {\n      return;\n    }\n\n    var containerPoint = this._getMouseContainerPoint(event);\n\n    if (!this._isValidContainerPoint(containerPoint)) {\n      return;\n    }\n\n    var registerMode = this._getRegisterMode();\n\n    var clickCoords = this._clickCoords;\n\n    if (clickCoords.length < 2) {\n      return;\n    }\n\n    var projection = this.getMap().getProjection();\n    var path = [clickCoords[0]];\n\n    for (var i = 1, len = clickCoords.length; i < len; i++) {\n      if (clickCoords[i].x !== clickCoords[i - 1].x || clickCoords[i].y !== clickCoords[i - 1].y) {\n        path.push(clickCoords[i]);\n      }\n    }\n\n    if (path.length < 2 || this._geometry && this._geometry instanceof Polygon && path.length < 3) {\n      return;\n    }\n\n    event.drawTool = this;\n    registerMode['update'](projection, path, this._geometry, event);\n    this.endDraw(event);\n  };\n\n  _proto._addGeometryToStage = function _addGeometryToStage(geometry) {\n    var drawLayer = this._getDrawLayer();\n\n    drawLayer.addGeometry(geometry);\n  };\n\n  _proto.endDraw = function endDraw(param) {\n    if (!this._geometry || this._ending) {\n      return this;\n    }\n\n    this._ending = true;\n    var geometry = this._geometry;\n\n    this._clearStage();\n\n    param = param || {};\n    this._geometry = geometry;\n\n    this._fireEvent('drawend', param);\n\n    delete this._geometry;\n\n    if (this.options['once']) {\n      this.disable();\n    }\n\n    delete this._ending;\n    return this;\n  };\n\n  _proto._clearStage = function _clearStage() {\n    this._getDrawLayer().clear();\n\n    delete this._geometry;\n    delete this._clickCoords;\n  };\n\n  _proto._getMouseContainerPoint = function _getMouseContainerPoint(event) {\n    var action = this._getRegisterMode()['action'];\n\n    if (action === 'mousedown') {\n      stopPropagation(event['domEvent']);\n    }\n\n    return event['containerPoint'];\n  };\n\n  _proto._isValidContainerPoint = function _isValidContainerPoint(containerPoint) {\n    var mapSize = this._map.getSize();\n\n    var w = mapSize['width'],\n        h = mapSize['height'];\n\n    if (containerPoint.x < 0 || containerPoint.y < 0) {\n      return false;\n    } else if (containerPoint.x > w || containerPoint.y > h) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto._getDrawLayer = function _getDrawLayer() {\n    var drawLayerId = INTERNAL_LAYER_PREFIX + 'drawtool';\n\n    var drawToolLayer = this._map.getLayer(drawLayerId);\n\n    if (!drawToolLayer) {\n      drawToolLayer = new VectorLayer(drawLayerId, {\n        'enableSimplify': false\n      });\n\n      this._map.addLayer(drawToolLayer);\n    }\n\n    return drawToolLayer;\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (!param) {\n      param = {};\n    }\n\n    if (this._geometry) {\n      param['geometry'] = this._getRegisterMode()['generate'](this._geometry, {\n        drawTool: this\n      });\n    }\n\n    MapTool.prototype._fireEvent.call(this, eventName, param);\n  };\n\n  return DrawTool;\n}(MapTool);\n\nDrawTool.mergeOptions(options$g);\n\nvar MapBoxZoomHander = function (_Handler) {\n  _inheritsLoose(MapBoxZoomHander, _Handler);\n\n  function MapBoxZoomHander(target) {\n    var _this;\n\n    _this = _Handler.call(this, target) || this;\n    _this.drawTool = new DrawTool({\n      'mode': 'boxZoom',\n      'ignoreMouseleave': false\n    });\n    return _this;\n  }\n\n  var _proto = MapBoxZoomHander.prototype;\n\n  _proto.addHooks = function addHooks() {\n    this.target.on('_mousedown', this._onMouseDown, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this.target.off('_mousedown', this._onMouseDown, this);\n\n    if (this.drawTool.isEnabled()) {\n      this.drawTool.remove();\n    }\n  };\n\n  _proto._onMouseDown = function _onMouseDown(param) {\n    if (!this.target.options['boxZoom']) {\n      return;\n    }\n\n    if (param.domEvent.shiftKey) {\n      this.drawTool.setSymbol(this.target.options['boxZoomSymbol']).on('drawend', this._boxZoom, this).addTo(this.target);\n    }\n  };\n\n  _proto._boxZoom = function _boxZoom(param) {\n    var map = this.target;\n    this.drawTool.remove();\n    var geometry = param.geometry,\n        center = geometry.getCenter(),\n        symbol = geometry.getSymbol(),\n        w = symbol.markerWidth,\n        h = symbol.markerHeight;\n    var extent = new Extent(center, map.locateByPoint(center, w, h), map.getProjection());\n    var zoom = map.getFitZoom(extent);\n\n    map._animateTo({\n      center: extent.getCenter(),\n      zoom: zoom\n    });\n  };\n\n  return MapBoxZoomHander;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'boxZoom': true,\n  'boxZoomSymbol': {\n    'markerType': 'rectangle',\n    'markerLineWidth': 3,\n    'markerLineColor': '#1bbc9b',\n    'markerLineDasharray': [10, 5],\n    'markerFillOpacity': 0.1,\n    'markerFill': '#1bbc9b',\n    'markerWidth': 1,\n    'markerHeight': 1\n  }\n});\nMap$1.addOnLoadHook('addHandler', 'boxZoom', MapBoxZoomHander);\nvar PANOFFSET = 30;\n\nvar MapAutoPanAtEdgeHandler = function (_Handler) {\n  _inheritsLoose(MapAutoPanAtEdgeHandler, _Handler);\n\n  function MapAutoPanAtEdgeHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapAutoPanAtEdgeHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.on('_mousemove', this._onMouseMove, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.off('_mousemove', this._onMouseMove, this);\n  };\n\n  _proto._onMouseMove = function _onMouseMove(event) {\n    var map = this.target;\n\n    if (map.options['autoPanAtEdge']) {\n      var containerPoint = event.containerPoint;\n      var containerExtent = map.getContainerExtent();\n\n      if (containerExtent) {\n        var x = containerPoint.x,\n            y = containerPoint.y;\n        var xmax = containerExtent.xmax,\n            ymax = containerExtent.ymax;\n        var p;\n\n        if (x < PANOFFSET) {\n          p = [Math.abs(x - PANOFFSET), 0];\n        }\n\n        if (y < PANOFFSET) {\n          p = [0, Math.abs(y - PANOFFSET)];\n        }\n\n        if (x + PANOFFSET > xmax) {\n          p = [-Math.abs(x + PANOFFSET - xmax), 0];\n        }\n\n        if (y + PANOFFSET > ymax) {\n          p = [0, -Math.abs(y + PANOFFSET - ymax)];\n        }\n\n        if (p) {\n          map.panBy(p, {\n            duration: 1\n          });\n        }\n      }\n    }\n  };\n\n  return MapAutoPanAtEdgeHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'autoPanAtEdge': false\n});\nMap$1.addOnLoadHook('addHandler', 'autoPanAtEdge', MapAutoPanAtEdgeHandler);\nMap$1.include({\n  animateTo: function animateTo(view, options, step) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    var projection = this.getProjection(),\n        currView = this.getView(),\n        props = {};\n    var empty = true;\n\n    for (var p in view) {\n      if (hasOwn(view, p) && !isNil(view[p]) && (p === 'prjCenter' || !isNil(currView[p]))) {\n        empty = false;\n\n        if (p === 'center') {\n          var from = new Coordinate(currView[p]).toFixed(7),\n              to = new Coordinate(view[p]).toFixed(7);\n\n          if (!from.equals(to)) {\n            props['center'] = [from, to];\n          }\n        } else if (p === 'prjCenter') {\n          var _from = new Coordinate(this._getPrjCenter());\n\n          var _to = new Coordinate(view[p]);\n\n          if (!_from.equals(_to)) {\n            props['prjCenter'] = [_from, _to];\n          }\n        } else if (currView[p] !== view[p] && p !== 'around') {\n          props[p] = [currView[p], view[p]];\n        }\n      }\n    }\n\n    if (empty) {\n      return null;\n    }\n\n    if (this._animPlayer) {\n      if (this._isInternalAnimation) {\n        if (this._animPlayer.playState === 'running') {\n          this._animPlayer.pause();\n\n          this._prevAnimPlayer = this._animPlayer;\n        }\n      } else {\n        delete this._prevAnimPlayer;\n\n        this._stopAnim(this._animPlayer);\n      }\n    }\n\n    var zoomOrigin = view['around'] || new Point(this.width / 2, this.height / 2);\n\n    var renderer = this._getRenderer(),\n        framer = function framer(fn) {\n      renderer.callInNextFrame(fn);\n    };\n\n    var player = this._animPlayer = Animation.animate(props, {\n      'easing': options['easing'] || 'out',\n      'duration': options['duration'] || this.options['zoomAnimationDuration'],\n      'framer': framer\n    }, function (frame) {\n      if (_this.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      if (player.playState === 'running') {\n        if (frame.styles['center']) {\n          var center = frame.styles['center'];\n\n          _this._setPrjCenter(projection.project(center));\n\n          _this.onMoving(_this._parseEventFromCoord(_this.getCenter()));\n        } else if (frame.styles['prjCenter']) {\n          var _center = frame.styles['prjCenter'];\n\n          _this._setPrjCenter(_center);\n\n          _this.onMoving(_this._parseEventFromCoord(_this.getCenter()));\n        }\n\n        if (!isNil(frame.styles['zoom'])) {\n          _this.onZooming(frame.styles['zoom'], zoomOrigin);\n        }\n\n        if (!isNil(frame.styles['pitch'])) {\n          _this.setPitch(frame.styles['pitch']);\n        }\n\n        if (!isNil(frame.styles['bearing'])) {\n          _this.setBearing(frame.styles['bearing']);\n        }\n\n        _this._fireEvent('animating');\n      } else if (player.playState !== 'paused' || player === _this._mapAnimPlayer) {\n        if (!player._interupted) {\n          if (props['center']) {\n            _this._setPrjCenter(projection.project(props['center'][1]));\n          } else if (props['prjCenter']) {\n            _this._setPrjCenter(props['prjCenter'][1]);\n          }\n\n          if (!isNil(props['pitch'])) {\n            _this.setPitch(props['pitch'][1]);\n          }\n\n          if (!isNil(props['bearing'])) {\n            _this.setBearing(props['bearing'][1]);\n          }\n        }\n\n        _this._endAnim(player, props, zoomOrigin, options);\n      }\n\n      if (step) {\n        step(frame);\n      }\n    }, this);\n\n    this._startAnim(props, zoomOrigin);\n\n    return player;\n  },\n  _animateTo: function _animateTo(view, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    this._isInternalAnimation = true;\n    this._mapAnimPlayer = this.animateTo(view, options, step);\n    delete this._isInternalAnimation;\n    return this._mapAnimPlayer;\n  },\n  isAnimating: function isAnimating() {\n    return !!this._animPlayer;\n  },\n  isRotating: function isRotating() {\n    return this.isDragRotating() || !!this._animRotating;\n  },\n  _endAnim: function _endAnim(player, props, zoomOrigin, options) {\n    delete this._animRotating;\n    var evtType = player._interupted ? 'animateinterrupted' : 'animateend';\n\n    if (player === this._animPlayer) {\n      delete this._animPlayer;\n    }\n\n    if (player === this._mapAnimPlayer) {\n      delete this._mapAnimPlayer;\n    }\n\n    if (props['center']) {\n      var endCoord;\n\n      if (player._interupted) {\n        endCoord = this.getCenter();\n      } else {\n        endCoord = props['center'][1];\n      }\n\n      this.onMoveEnd(this._parseEventFromCoord(endCoord));\n    } else if (props['prjCenter']) {\n      var _endCoord;\n\n      if (player._interupted) {\n        _endCoord = this._getPrjCenter();\n      } else {\n        _endCoord = props['prjCenter'][1];\n      }\n\n      var event = this._parseEventFromCoord(this.getProjection().unproject(_endCoord));\n\n      event['point2d'] = this._prjToPoint(_endCoord);\n      this.onMoveEnd(event);\n    }\n\n    if (!isNil(props['zoom'])) {\n      if (player._interupted) {\n        this.onZoomEnd(this.getZoom(), zoomOrigin);\n      } else if (!options['wheelZoom']) {\n        this.onZoomEnd(props['zoom'][1], zoomOrigin);\n      } else {\n        this.onZooming(props['zoom'][1], zoomOrigin);\n      }\n    }\n\n    if (evtType) {\n      this._fireEvent(evtType);\n    }\n\n    if (!isNil(props['pitch']) && !this.getPitch()) {\n      this.getRenderer().setToRedraw();\n    }\n\n    this._resumePrev(player);\n  },\n  _startAnim: function _startAnim(props, zoomOrigin) {\n    if (!this._animPlayer) {\n      return;\n    }\n\n    if (props['center']) {\n      this.onMoveStart();\n    }\n\n    if (props['zoom'] && !this.isZooming()) {\n      this.onZoomStart(props['zoom'][1], zoomOrigin);\n    }\n\n    if (props['pitch'] || props['bearing']) {\n      this._animRotating = true;\n    }\n\n    this._fireEvent('animatestart');\n\n    this._animPlayer.play();\n  },\n  _stopAnim: function _stopAnim(player) {\n    if (!player) {\n      return;\n    }\n\n    delete this._animRotating;\n\n    if (player.playState !== 'finished') {\n      player._interupted = true;\n      player.cancel();\n    }\n\n    if (player === this._animPlayer) {\n      delete this._animPlayer;\n    }\n\n    if (player === this._mapAnimPlayer) {\n      delete this._mapAnimPlayer;\n    }\n  },\n  _resumePrev: function _resumePrev(player) {\n    if (!this._prevAnimPlayer) {\n      return;\n    }\n\n    var prevPlayer = this._prevAnimPlayer;\n\n    if (prevPlayer.playState !== 'paused') {\n      delete this._prevAnimPlayer;\n    }\n\n    if (player !== prevPlayer) {\n      this._animPlayer = prevPlayer;\n      prevPlayer.play();\n    }\n  }\n});\nvar events = 'mousedown ' + 'mouseup ' + 'mouseover ' + 'mouseout ' + 'mouseenter ' + 'mouseleave ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'keypress ' + 'touchstart ' + 'touchmove ' + 'touchend ';\nMap$1.include({\n  _registerDomEvents: function _registerDomEvents() {\n    var dom = this._panels.mapWrapper || this._containerDOM;\n    addDomEvent(dom, events, this._handleDOMEvent, this);\n  },\n  _removeDomEvents: function _removeDomEvents() {\n    var dom = this._panels.mapWrapper || this._containerDOM;\n    removeDomEvent(dom, events, this._handleDOMEvent, this);\n  },\n  _handleDOMEvent: function _handleDOMEvent(e) {\n    var type = e.type;\n\n    if (type === 'contextmenu') {\n      preventDefault(e);\n    }\n\n    if (this._ignoreEvent(e)) {\n      return;\n    }\n\n    var mimicClick = false;\n\n    if (type === 'mousedown' || type === 'touchstart' && e.touches.length === 1) {\n      this._mouseDownTime = now();\n    } else if (type === 'click' || type === 'touchend' || type === 'contextmenu') {\n      if (!this._mouseDownTime) {\n        return;\n      } else {\n        var downTime = this._mouseDownTime;\n        delete this._mouseDownTime;\n        var time = now();\n\n        if (time - downTime > 300) {\n          if (type === 'click' || type === 'contextmenu') {\n            return;\n          }\n        } else if (type === 'touchend') {\n          mimicClick = true;\n        }\n      }\n    }\n\n    this._fireDOMEvent(this, e, type);\n\n    if (mimicClick) {\n      if (this._clickTime && now() - this._clickTime <= 300) {\n        delete this._clickTime;\n\n        this._fireDOMEvent(this, e, 'dblclick');\n      } else {\n        this._clickTime = now();\n\n        this._fireDOMEvent(this, e, 'click');\n      }\n    }\n  },\n  _ignoreEvent: function _ignoreEvent(domEvent) {\n    if (!domEvent || !this._panels.control) {\n      return false;\n    }\n\n    if (this._isEventOutMap(domEvent)) {\n      return true;\n    }\n\n    var target = domEvent.srcElement || domEvent.target;\n    var preTarget;\n\n    if (target) {\n      while (target && target !== this._containerDOM) {\n        if (target.className && target.className.indexOf && (target.className.indexOf('maptalks-control') >= 0 || target.className.indexOf('maptalks-ui') >= 0 && !preTarget['eventsPropagation'])) {\n          return true;\n        }\n\n        preTarget = target;\n        target = target.parentNode;\n      }\n    }\n\n    return false;\n  },\n  _isEventOutMap: function _isEventOutMap(domEvent) {\n    if (this.getPitch() > this.options['maxVisualPitch']) {\n      var actualEvent = this._getActualEvent(domEvent);\n\n      var eventPos = getEventContainerPoint(actualEvent, this._containerDOM);\n\n      if (!this.getContainerExtent().contains(eventPos)) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n  _parseEvent: function _parseEvent(e, type) {\n    if (!e) {\n      return null;\n    }\n\n    var eventParam = {\n      'domEvent': e\n    };\n\n    if (type !== 'keypress') {\n      var actual = this._getActualEvent(e);\n\n      if (actual) {\n        var containerPoint = getEventContainerPoint(actual, this._containerDOM);\n        eventParam = extend(eventParam, {\n          'coordinate': this.containerPointToCoord(containerPoint),\n          'containerPoint': containerPoint,\n          'viewPoint': this.containerPointToViewPoint(containerPoint),\n          'point2d': this._containerPointToPoint(containerPoint)\n        });\n      }\n    }\n\n    return eventParam;\n  },\n  _parseEventFromCoord: function _parseEventFromCoord(coord) {\n    var containerPoint = this.coordToContainerPoint(coord),\n        viewPoint = this.containerPointToViewPoint(containerPoint);\n    var e = {\n      'coordinate': coord,\n      'containerPoint': containerPoint,\n      'viewPoint': viewPoint,\n      'point2d': this.coordToPoint(coord)\n    };\n    return e;\n  },\n  _getActualEvent: function _getActualEvent(e) {\n    return e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n  },\n  _fireDOMEvent: function _fireDOMEvent(target, e, type) {\n    if (this.isRemoved()) {\n      return;\n    }\n\n    var eventParam = this._parseEvent(e, type);\n\n    this._fireEvent(type, eventParam);\n  }\n});\nMap$1.addOnLoadHook('_registerDomEvents');\nMap$1.include({\n  isFullScreen: function isFullScreen() {\n    return !!(document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement || document.fullscreenElement);\n  },\n  requestFullScreen: function requestFullScreen(dom) {\n    this._fireEvent('fullscreenstart');\n\n    this._requestFullScreen(dom || this._containerDOM);\n\n    this._fireEvent('fullscreenend');\n\n    return this;\n  },\n  cancelFullScreen: function cancelFullScreen() {\n    this._cancelFullScreen();\n\n    this._fireEvent('cancelfullscreen');\n\n    return this;\n  },\n  _requestFullScreen: function _requestFullScreen(dom) {\n    if (dom.requestFullScreen) {\n      dom.requestFullScreen();\n    } else if (dom.mozRequestFullScreen) {\n      dom.mozRequestFullScreen();\n    } else if (dom.webkitRequestFullScreen) {\n      dom.webkitRequestFullScreen();\n    } else if (dom.msRequestFullScreen) {\n      dom.msRequestFullScreen();\n    } else {\n      var features = 'fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,' + 'titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,' + 'width=' + (screen.availWidth - 8) + ',height=' + (screen.availHeight - 45);\n      var newWin = window.open(location.href, '_blank', features);\n\n      if (newWin !== null) {\n        window.opener = null;\n        window.close();\n      }\n    }\n  },\n  _cancelFullScreen: function _cancelFullScreen() {\n    if (document.cancelFullScreen) {\n      document.cancelFullScreen();\n    } else if (document.mozCancelFullScreen) {\n      document.mozCancelFullScreen();\n    } else if (document.webkitCancelFullScreen) {\n      document.webkitCancelFullScreen();\n    } else {\n      var features = 'fullscreen=no,status=yes,resizable=yes,scrollbars=no,' + 'titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes';\n      var newWin = window.open(location.href, '_blank', features);\n\n      if (newWin !== null) {\n        window.opener = null;\n        window.close();\n      }\n    }\n  }\n});\nMap$1.include({\n  panTo: function panTo(coordinate, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!coordinate) {\n      return this;\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    coordinate = new Coordinate(coordinate);\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      var prjCoord = this.getProjection().project(coordinate);\n      return this._panAnimation(prjCoord, options['duration'], step);\n    } else {\n      this.setCenter(coordinate);\n    }\n\n    return this;\n  },\n  _panTo: function _panTo(prjCoord, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      return this._panAnimation(prjCoord, options['duration']);\n    } else {\n      this.onMoveStart();\n\n      this._setPrjCenter(prjCoord);\n\n      this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n      return this;\n    }\n  },\n  panBy: function panBy(offset, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!offset) {\n      return this;\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    offset = new Point(offset);\n    var containerExtent = this.getContainerExtent();\n    var ymin = containerExtent.ymin;\n\n    if (ymin > 0 && offset.y > 30) {\n      var y = offset.y;\n      offset.y = 30;\n      offset.x = offset.x * 30 / y;\n      console.warn('offset is limited to panBy when pitch is above maxPitch');\n    }\n\n    this.onMoveStart();\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      offset = offset.multi(-1);\n\n      var target = this._containerPointToPrj(new Point(this.width / 2 + offset.x, this.height / 2 + offset.y));\n\n      this._panAnimation(target, options['duration'], step);\n    } else {\n      this._offsetCenterByPixel(offset);\n\n      this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n    }\n\n    return this;\n  },\n  _panAnimation: function _panAnimation(target, t, cb) {\n    return this._animateTo({\n      'prjCenter': target\n    }, {\n      'duration': t || this.options['panAnimationDuration']\n    }, cb);\n  }\n});\n\nGeometry.fromJSON = function (json) {\n  if (Array.isArray(json)) {\n    var result = [];\n\n    for (var i = 0, len = json.length; i < len; i++) {\n      var c = Geometry.fromJSON(json[i]);\n\n      if (Array.isArray(json)) {\n        result = result.concat(c);\n      } else {\n        result.push(c);\n      }\n    }\n\n    return result;\n  }\n\n  if (json && !json['feature']) {\n    return GeoJSON.toGeometry(json);\n  }\n\n  var geometry;\n\n  if (json['subType']) {\n    geometry = Geometry.getJSONClass(json['subType']).fromJSON(json);\n\n    if (!isNil(json['feature']['id'])) {\n      geometry.setId(json['feature']['id']);\n    }\n  } else {\n    geometry = GeoJSON.toGeometry(json['feature']);\n\n    if (json['options']) {\n      geometry.config(json['options']);\n    }\n  }\n\n  if (json['symbol']) {\n    geometry.setSymbol(json['symbol']);\n  }\n\n  if (json['infoWindow']) {\n    geometry.setInfoWindow(json['infoWindow']);\n  }\n\n  return geometry;\n};\n\nLayer.fromJSON = function (layerJSON) {\n  if (!layerJSON) {\n    return null;\n  }\n\n  var layerType = layerJSON['type'];\n  var clazz = Layer.getJSONClass(layerType);\n\n  if (!clazz || !clazz.fromJSON) {\n    throw new Error('unsupported layer type:' + layerType);\n  }\n\n  return clazz.fromJSON(layerJSON);\n};\n\nMap$1.include({\n  'JSON_VERSION': '1.0',\n  toJSON: function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var json = {\n      'jsonVersion': this['JSON_VERSION'],\n      'version': this.VERSION,\n      'extent': this.getExtent().toJSON()\n    };\n    json['options'] = this.config();\n    json['options']['center'] = this.getCenter();\n    json['options']['zoom'] = this.getZoom();\n    json['options']['bearing'] = this.getBearing();\n    json['options']['pitch'] = this.getPitch();\n    var baseLayer = this.getBaseLayer();\n\n    if ((isNil(options['baseLayer']) || options['baseLayer']) && baseLayer) {\n      json['baseLayer'] = baseLayer.toJSON(options['baseLayer']);\n    }\n\n    var extraLayerOptions = {};\n\n    if (options['clipExtent']) {\n      if (options['clipExtent'] === true) {\n        extraLayerOptions['clipExtent'] = this.getExtent();\n      } else {\n        extraLayerOptions['clipExtent'] = options['clipExtent'];\n      }\n    }\n\n    var layersJSON = [];\n\n    if (isNil(options['layers']) || options['layers'] && !Array.isArray(options['layers'])) {\n      var layers = this.getLayers();\n\n      for (var i = 0, len = layers.length; i < len; i++) {\n        if (!layers[i].toJSON) {\n          continue;\n        }\n\n        var opts = extend({}, isObject(options['layers']) ? options['layers'] : {}, extraLayerOptions);\n        layersJSON.push(layers[i].toJSON(opts));\n      }\n\n      json['layers'] = layersJSON;\n    } else if (isArrayHasData(options['layers'])) {\n      var _layers = options['layers'];\n\n      for (var _i = 0; _i < _layers.length; _i++) {\n        var exportOption = _layers[_i];\n        var layer = this.getLayer(exportOption['id']);\n\n        if (!layer.toJSON) {\n          continue;\n        }\n\n        var _opts = extend({}, exportOption['options'], extraLayerOptions);\n\n        layersJSON.push(layer.toJSON(_opts));\n      }\n\n      json['layers'] = layersJSON;\n    } else {\n      json['layers'] = [];\n    }\n\n    return json;\n  }\n});\n\nMap$1.fromJSON = function (container, profile, options) {\n  if (!container || !profile) {\n    return null;\n  }\n\n  if (!options) {\n    options = {};\n  }\n\n  var map = new Map$1(container, profile['options']);\n\n  if (isNil(options['baseLayer']) || options['baseLayer']) {\n    var baseLayer = Layer.fromJSON(profile['baseLayer']);\n\n    if (baseLayer) {\n      map.setBaseLayer(baseLayer);\n    }\n  }\n\n  if (isNil(options['layers']) || options['layers']) {\n    var layers = [];\n    var layerJSONs = profile['layers'];\n\n    for (var i = 0; i < layerJSONs.length; i++) {\n      var layer = Layer.fromJSON(layerJSONs[i]);\n      layers.push(layer);\n    }\n\n    map.addLayer(layers);\n  }\n\n  return map;\n};\n\nMap$1.include({\n  computeLength: function computeLength(coord1, coord2) {\n    if (!this.getProjection()) {\n      return null;\n    }\n\n    var p1 = new Coordinate(coord1),\n        p2 = new Coordinate(coord2);\n\n    if (p1.equals(p2)) {\n      return 0;\n    }\n\n    return this.getProjection().measureLength(p1, p2);\n  },\n  computeGeometryLength: function computeGeometryLength(geometry) {\n    return geometry._computeGeodesicLength(this.getProjection());\n  },\n  computeGeometryArea: function computeGeometryArea(geometry) {\n    return geometry._computeGeodesicArea(this.getProjection());\n  },\n  identify: function identify(opts, callback) {\n    if (!opts) {\n      return this;\n    }\n\n    var reqLayers = opts['layers'];\n\n    if (!isArrayHasData(reqLayers)) {\n      return this;\n    }\n\n    var layers = [];\n\n    for (var i = 0, len = reqLayers.length; i < len; i++) {\n      if (isString(reqLayers[i])) {\n        layers.push(this.getLayer(reqLayers[i]));\n      } else {\n        layers.push(reqLayers[i]);\n      }\n    }\n\n    var coordinate = new Coordinate(opts['coordinate']);\n    var options = extend({}, opts);\n    var hits = [];\n\n    for (var _i = layers.length - 1; _i >= 0; _i--) {\n      if (opts['count'] && hits.length >= opts['count']) {\n        break;\n      }\n\n      var layer = layers[_i];\n\n      if (!layer || !layer.getMap() || !opts['includeInvisible'] && !layer.isVisible() || !opts['includeInternals'] && layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n        continue;\n      }\n\n      var layerHits = layer.identify(coordinate, options);\n\n      if (layerHits) {\n        if (Array.isArray(layerHits)) {\n          pushIn(hits, layerHits);\n        } else {\n          hits.push(layerHits);\n        }\n      }\n    }\n\n    callback.call(this, hits);\n    return this;\n  }\n});\nMap$1.include({\n  _zoom: function _zoom(nextZoom, origin) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    origin = this._checkZoomOrigin(origin);\n    nextZoom = this._checkZoom(nextZoom);\n    this.onZoomStart(nextZoom, origin);\n    this._frameZoom = this.getZoom();\n    this.onZoomEnd(nextZoom, origin);\n  },\n  _zoomAnimation: function _zoomAnimation(nextZoom, origin, startScale) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    nextZoom = this._checkZoom(nextZoom);\n\n    if (this.getZoom() === nextZoom) {\n      return;\n    }\n\n    origin = this._checkZoomOrigin(origin);\n\n    this._startZoomAnim(nextZoom, origin, startScale);\n  },\n  _checkZoomOrigin: function _checkZoomOrigin(origin) {\n    if (!origin || this.options['zoomInCenter']) {\n      origin = new Point(this.width / 2, this.height / 2);\n    }\n\n    if (this.options['zoomOrigin']) {\n      origin = new Point(this.options['zoomOrigin']);\n    }\n\n    return origin;\n  },\n  _startZoomAnim: function _startZoomAnim(nextZoom, origin, startScale) {\n    if (isNil(startScale)) {\n      startScale = 1;\n    }\n\n    var endScale = this._getResolution(this._startZoomVal) / this._getResolution(nextZoom);\n\n    var duration = this.options['zoomAnimationDuration'] * Math.abs(endScale - startScale) / Math.abs(endScale - 1);\n    this._frameZoom = this._startZoomVal;\n\n    this._animateTo({\n      'zoom': nextZoom,\n      'around': origin\n    }, {\n      'continueOnViewChanged': true,\n      'duration': duration\n    });\n  },\n  onZoomStart: function onZoomStart(nextZoom, origin) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    this._zooming = true;\n    this._startZoomVal = this.getZoom();\n    this._startZoomCoord = this._containerPointToPrj(origin);\n\n    this._fireEvent('zoomstart', {\n      'from': this._startZoomVal,\n      'to': nextZoom\n    });\n  },\n  onZooming: function onZooming(nextZoom, origin, startScale) {\n    if (!this.options['zoomable']) {\n      return;\n    }\n\n    var frameZoom = this._frameZoom;\n\n    if (frameZoom === nextZoom) {\n      return;\n    }\n\n    if (isNil(startScale)) {\n      startScale = 1;\n    }\n\n    this._zoomTo(nextZoom, origin);\n\n    var res = this.getResolution(nextZoom),\n        fromRes = this.getResolution(this._startZoomVal),\n        scale = fromRes / res / startScale,\n        startPoint = this._prjToContainerPoint(this._startZoomCoord, this._startZoomVal);\n\n    var offset = this.getViewPoint();\n\n    if (!this.isRotating() && !startPoint.equals(origin) && scale !== 1) {\n      var pitch = this.getPitch();\n\n      var originOffset = startPoint._sub(origin)._multi(1 / (1 - scale));\n\n      if (pitch) {\n        originOffset.y /= Math.cos(pitch * Math.PI / 180);\n      }\n\n      origin = origin.add(originOffset);\n    }\n\n    var matrix = {\n      'view': [scale, 0, 0, scale, (origin.x - offset.x) * (1 - scale), (origin.y - offset.y) * (1 - scale)]\n    };\n    var dpr = this.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      origin = origin.multi(dpr);\n    }\n\n    matrix['container'] = [scale, 0, 0, scale, origin.x * (1 - scale), origin.y * (1 - scale)];\n\n    this._fireEvent('zooming', {\n      'from': this._startZoomVal,\n      'to': nextZoom,\n      'origin': origin,\n      'matrix': matrix\n    });\n\n    this._frameZoom = nextZoom;\n  },\n  onZoomEnd: function onZoomEnd(nextZoom, origin) {\n    if (!this.options['zoomable']) {\n      return;\n    }\n\n    var startZoomVal = this._startZoomVal;\n\n    this._zoomTo(nextZoom, origin);\n\n    this._zooming = false;\n\n    this._getRenderer().onZoomEnd();\n\n    this._fireEvent('zoomend', {\n      'from': startZoomVal,\n      'to': nextZoom\n    });\n\n    if (!this._verifyExtent(this._getPrjCenter())) {\n      this._panTo(this._prjMaxExtent.getCenter());\n    }\n  },\n  _zoomTo: function _zoomTo(nextZoom, origin) {\n    this._zoomLevel = nextZoom;\n\n    this._calcMatrices();\n\n    if (origin) {\n      this._setPrjCoordAtContainerPoint(this._startZoomCoord, origin);\n    }\n  },\n  _checkZoom: function _checkZoom(nextZoom) {\n    var maxZoom = this.getMaxZoom(),\n        minZoom = this.getMinZoom();\n\n    if (nextZoom < minZoom) {\n      nextZoom = minZoom;\n    }\n\n    if (nextZoom > maxZoom) {\n      nextZoom = maxZoom;\n    }\n\n    return nextZoom;\n  }\n});\n\nfunction perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf = 1 / (near - far);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 2 * far * near * nf;\n  out[15] = 0;\n  return out;\n}\n\nfunction translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2],\n      a00,\n      a01,\n      a02,\n      a03,\n      a10,\n      a11,\n      a12,\n      a13,\n      a20,\n      a21,\n      a22,\n      a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n\nfunction scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\nfunction rotateX(out, a, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad),\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n\n  if (a !== out) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n\nfunction rotateZ(out, a, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad),\n      a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n\n  if (a !== out) {\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n\nfunction multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11],\n      a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n\nfunction invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11],\n      a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15],\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n\nfunction identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\nfunction copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\nfunction set$2(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\nfunction add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n\nfunction subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n\nfunction length(a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\nfunction normalize(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    out[0] = a[0] * len;\n    out[1] = a[1] * len;\n    out[2] = a[2] * len;\n  }\n\n  return out;\n}\n\nfunction dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\nfunction scale$1(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n\nfunction cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n\nfunction distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot ? Math.hypot(x, y, z) : hypot(x, y, z);\n}\n\nfunction transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n\nfunction hypot() {\n  var y = 0;\n  var i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n}\n\nfunction applyMatrix(out, v, e) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var w = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]);\n  out[0] = (e[0] * x + e[4] * y + e[8] * z + e[12]) * w;\n  out[1] = (e[1] * x + e[5] * y + e[9] * z + e[13]) * w;\n  out[2] = (e[2] * x + e[6] * y + e[10] * z + e[14]) * w;\n  return out;\n}\n\nfunction matrixToQuaternion(out, te) {\n  var m11 = te[0],\n      m12 = te[4],\n      m13 = te[8],\n      m21 = te[1],\n      m22 = te[5],\n      m23 = te[9],\n      m31 = te[2],\n      m32 = te[6],\n      m33 = te[10],\n      trace = m11 + m22 + m33;\n  var s;\n\n  if (trace > 0) {\n    s = 0.5 / Math.sqrt(trace + 1.0);\n    out.w = 0.25 / s;\n    out.x = (m32 - m23) * s;\n    out.y = (m13 - m31) * s;\n    out.z = (m21 - m12) * s;\n  } else if (m11 > m22 && m11 > m33) {\n    s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\n    out.w = (m32 - m23) / s;\n    out.x = 0.25 * s;\n    out.y = (m12 + m21) / s;\n    out.z = (m13 + m31) / s;\n  } else if (m22 > m33) {\n    s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\n    out.w = (m13 - m31) / s;\n    out.x = (m12 + m21) / s;\n    out.y = 0.25 * s;\n    out.z = (m23 + m32) / s;\n  } else {\n    s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\n    out.w = (m21 - m12) / s;\n    out.x = (m13 + m31) / s;\n    out.y = (m23 + m32) / s;\n    out.z = 0.25 * s;\n  }\n\n  return this;\n}\n\nfunction quaternionToMatrix(out, q) {\n  var te = out;\n  var x = q.x,\n      y = q.y,\n      z = q.z,\n      w = q.w;\n  var x2 = x + x,\n      y2 = y + y,\n      z2 = z + z;\n  var xx = x * x2,\n      xy = x * y2,\n      xz = x * z2;\n  var yy = y * y2,\n      yz = y * z2,\n      zz = z * z2;\n  var wx = w * x2,\n      wy = w * y2,\n      wz = w * z2;\n  te[0] = 1 - (yy + zz);\n  te[4] = xy - wz;\n  te[8] = xz + wy;\n  te[1] = xy + wz;\n  te[5] = 1 - (xx + zz);\n  te[9] = yz - wx;\n  te[2] = xz - wy;\n  te[6] = yz + wx;\n  te[10] = 1 - (xx + yy);\n  te[3] = 0;\n  te[7] = 0;\n  te[11] = 0;\n  te[12] = 0;\n  te[13] = 0;\n  te[14] = 0;\n  te[15] = 1;\n  return te;\n}\n\nfunction setPosition(out, v) {\n  var te = out;\n  te[12] = v[0];\n  te[13] = v[1];\n  te[14] = v[2];\n  return out;\n}\n\nfunction lookAt(te, eye, target, up) {\n  var x = [0, 0, 0];\n  var y = [0, 0, 0];\n  var z = [0, 0, 0];\n  subtract(z, eye, target);\n\n  if (length(z) === 0) {\n    z[2] = 1;\n  }\n\n  normalize(z, z);\n  cross(x, up, z);\n\n  if (length(z) === 0) {\n    if (Math.abs(up[2]) === 1) {\n      z[0] += 0.0001;\n    } else {\n      z[2] += 0.0001;\n    }\n\n    normalize(z, z);\n    cross(x, up, z);\n  }\n\n  normalize(x, x);\n  cross(y, z, x);\n  te[0] = x[0];\n  te[4] = y[0];\n  te[8] = z[0];\n  te[1] = x[1];\n  te[5] = y[1];\n  te[9] = z[1];\n  te[2] = x[2];\n  te[6] = y[2];\n  te[10] = z[2];\n  return te;\n}\n\nvar RADIAN$1 = Math.PI / 180;\nvar DEFAULT_FOV = 0.6435011087932844;\nvar TEMP_COORD = new Coordinate(0, 0);\nMap$1.include({\n  getFov: function getFov() {\n    if (!this._fov) {\n      this._fov = DEFAULT_FOV;\n    }\n\n    return this._fov / RADIAN$1;\n  },\n  setFov: function setFov(fov) {\n    if (this.isZooming()) {\n      return this;\n    }\n\n    fov = Math.max(0.01, Math.min(60, fov));\n    if (this._fov === fov) return this;\n    var from = this.getFov();\n    this._fov = fov * RADIAN$1;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('fovchange', {\n      'from': from,\n      'to': this.getFov()\n    });\n\n    return this;\n  },\n  getBearing: function getBearing() {\n    if (!this._angle) {\n      return 0;\n    }\n\n    return -this._angle / RADIAN$1;\n  },\n  setBearing: function setBearing(bearing) {\n    if (Browser$1.ie9) {\n      throw new Error('map can\\'t rotate in IE9.');\n    }\n\n    var b = -wrap(bearing, -180, 180) * RADIAN$1;\n    if (this._angle === b) return this;\n    var from = this.getBearing();\n\n    this._fireEvent('rotatestart', {\n      'from': from,\n      'to': b\n    });\n\n    this._angle = b;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('rotate', {\n      'from': from,\n      'to': b\n    });\n\n    this._fireEvent('rotateend', {\n      'from': from,\n      'to': b\n    });\n\n    return this;\n  },\n  getPitch: function getPitch() {\n    if (!this._pitch) {\n      return 0;\n    }\n\n    return this._pitch / Math.PI * 180;\n  },\n  setPitch: function setPitch(pitch) {\n    if (Browser$1.ie9) {\n      throw new Error('map can\\'t tilt in IE9.');\n    }\n\n    var p = clamp(pitch, 0, this.options['maxPitch']) * RADIAN$1;\n    if (this._pitch === p) return this;\n    var from = this.getPitch();\n\n    this._fireEvent('pitchstart', {\n      'from': from,\n      'to': p\n    });\n\n    this._pitch = p;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('pitch', {\n      'from': from,\n      'to': p\n    });\n\n    this._fireEvent('pitchend', {\n      'from': from,\n      'to': p\n    });\n\n    return this;\n  },\n  isTransforming: function isTransforming() {\n    return !!(this._pitch || this._angle);\n  },\n  getFrustumAltitude: function getFrustumAltitude() {\n    return this._frustumAltitude;\n  },\n  _calcFrustumAltitude: function _calcFrustumAltitude() {\n    var pitch = 90 - this.getPitch();\n    var fov = this.getFov() / 2;\n    var cameraAlt = this.cameraPosition ? this.cameraPosition[2] : 0;\n\n    if (fov <= pitch) {\n      return cameraAlt;\n    }\n\n    fov = Math.PI * fov / 180;\n    var d1 = new Point(this.cameraPosition).distanceTo(new Point(this.cameraLookAt)),\n        d2 = cameraAlt * Math.tan(fov * 2);\n    var d = Math.tan(fov) * (d1 + d2);\n    return cameraAlt + d;\n  },\n  _pointToContainerPoint: function () {\n    var a = [0, 0, 0];\n    return function (point, zoom, altitude, out) {\n      if (altitude === void 0) {\n        altitude = 0;\n      }\n\n      point = this._pointToPoint(point, zoom, out);\n\n      if (this.isTransforming() || altitude) {\n        altitude *= this._getResolution(zoom) / this._getResolution();\n        var _scale = this._glScale;\n        set$2(a, point.x * _scale, point.y * _scale, altitude * _scale);\n\n        var t = this._projIfBehindCamera(a, this.cameraPosition, this.cameraForward);\n\n        applyMatrix(t, t, this.projViewMatrix);\n        var w2 = this.width / 2,\n            h2 = this.height / 2;\n        t[0] = t[0] * w2 + w2;\n        t[1] = -(t[1] * h2) + h2;\n\n        if (out) {\n          out.x = t[0];\n          out.y = t[1];\n          return out;\n        }\n\n        return new Point(t[0], t[1]);\n      } else {\n        var centerPoint = this._prjToPoint(this._getPrjCenter(), undefined, TEMP_COORD);\n\n        if (out) {\n          out.x = point.x;\n          out.y = point.y;\n        } else {\n          out = point;\n        }\n\n        out._sub(centerPoint.x, centerPoint.y);\n\n        out.set(out.x, -out.y);\n        return out._add(this.width / 2, this.height / 2);\n      }\n    };\n  }(),\n  _projIfBehindCamera: function () {\n    var vectorFromCam = new Array(3);\n    var proj = new Array(3);\n    var sub = new Array(3);\n    return function (position, cameraPos, camForward) {\n      subtract(vectorFromCam, position, cameraPos);\n      var camNormDot = dot(camForward, vectorFromCam);\n\n      if (camNormDot <= 0) {\n        scale$1(proj, camForward, camNormDot * 1.01);\n        add(position, cameraPos, subtract(sub, vectorFromCam, proj));\n      }\n\n      return position;\n    };\n  }(),\n  _containerPointToPoint: function () {\n    var cp = [0, 0, 0],\n        coord0 = [0, 0, 0, 1],\n        coord1 = [0, 0, 0, 1];\n    return function (p, zoom, out) {\n      if (this.isTransforming()) {\n        var w2 = this.width / 2 || 1,\n            h2 = this.height / 2 || 1;\n        set$2(cp, (p.x - w2) / w2, (h2 - p.y) / h2, 0);\n        set$2(coord0, cp[0], cp[1], 0);\n        set$2(coord1, cp[0], cp[1], 1);\n        coord0[3] = coord1[3] = 1;\n        applyMatrix(coord0, coord0, this.projViewMatrixInverse);\n        applyMatrix(coord1, coord1, this.projViewMatrixInverse);\n        var x0 = coord0[0];\n        var x1 = coord1[0];\n        var y0 = coord0[1];\n        var y1 = coord1[1];\n        var z0 = coord0[2];\n        var z1 = coord1[2];\n        var t = z0 === z1 ? 0 : (0 - z0) / (z1 - z0);\n\n        var _x = interpolate(x0, x1, t);\n\n        var _y = interpolate(y0, y1, t);\n\n        if (out) {\n          out.x = _x;\n          out.y = _y;\n        } else {\n          out = new Point(_x, _y);\n        }\n\n        out._multi(1 / this._glScale);\n\n        return zoom === undefined || this.getZoom() === zoom ? out : this._pointToPointAtZoom(out, zoom, out);\n      }\n\n      var centerPoint = this._prjToPoint(this._getPrjCenter(), zoom, out),\n          scale$$1 = zoom !== undefined ? this._getResolution() / this._getResolution(zoom) : 1;\n\n      var x = scale$$1 * (p.x - this.width / 2),\n          y = scale$$1 * (p.y - this.height / 2);\n      return centerPoint._add(x, -y);\n    };\n  }(),\n  _calcMatrices: function () {\n    var m0 = createMat4(),\n        m1 = createMat4();\n    return function () {\n      delete this._mapRes;\n      delete this._mapGlRes;\n      delete this._mapExtent2D;\n      delete this._mapGlExtent2D;\n      var size = this.getSize();\n      var w = size.width || 1,\n          h = size.height || 1;\n      this._glScale = this.getGLScale();\n      var pitch = this.getPitch() * Math.PI / 180;\n\n      var worldMatrix = this._getCameraWorldMatrix();\n\n      var fov = this.getFov() * Math.PI / 180;\n\n      var farZ = this._getCameraFar(fov, this.getPitch());\n\n      this.cameraFar = farZ;\n      this.cameraNear = Math.max(this._glScale * this.getResolution(this.getGLZoom()) * Math.cos(pitch), 0.1);\n      var projMatrix = this.projMatrix || createMat4();\n      perspective(projMatrix, fov, w / h, this.cameraNear, farZ);\n      this.projMatrix = projMatrix;\n      this.viewMatrix = invert(m0, worldMatrix);\n      this.projViewMatrix = multiply(this.projViewMatrix || createMat4(), projMatrix, this.viewMatrix);\n\n      this._calcCascadeMatrixes();\n\n      this.projViewMatrixInverse = multiply(this.projViewMatrixInverse || createMat4(), worldMatrix, invert(m1, projMatrix));\n      this.domCssMatrix = this._calcDomMatrix();\n      this._frustumAltitude = this._calcFrustumAltitude();\n      this._mapRes = this._getResolution();\n      this._mapGlRes = this._getResolution(this.getGLZoom());\n      this._mapExtent2D = this._get2DExtent();\n      this._mapGlExtent2D = this._get2DExtent(this.getGLZoom());\n    };\n  }(),\n  _getCameraFar: function _getCameraFar(fov, pitch) {\n    var cameraCenterDistance = this.cameraCenterDistance = distance(this.cameraPosition, this.cameraLookAt);\n    var farZ = cameraCenterDistance;\n\n    if (pitch > 0) {\n      pitch = pitch * Math.PI / 180;\n      var y;\n\n      if (2 / Math.PI - pitch <= fov / 2) {\n        y = 4 * cameraCenterDistance;\n      } else {\n        var tanFov = Math.tan(fov / 2);\n        var tanP = Math.tan(pitch);\n        y = cameraCenterDistance * tanFov / (1 / tanP - tanFov);\n      }\n\n      farZ += y;\n    }\n\n    return farZ + 1.0;\n  },\n  _calcCascadeMatrixes: function () {\n    var projMatrix = createMat4();\n\n    function cal(curPitch, pitch, out) {\n      var w = this.width;\n      var h = this.height;\n      var fov = this.getFov() * Math.PI / 180;\n\n      var farZ = this._getCameraFar(fov, pitch);\n\n      var cameraCenterDistance = this.cameraCenterDistance;\n      farZ = cameraCenterDistance + (farZ - cameraCenterDistance) / Math.cos((90 - pitch) * Math.PI / 180) * Math.cos((90 - curPitch) * Math.PI / 180);\n      perspective(projMatrix, fov, w / h, 0.1, farZ);\n      var viewMatrix = this.viewMatrix;\n      return multiply(out, projMatrix, viewMatrix);\n    }\n\n    return function () {\n      var pitch = this.getPitch();\n      var cascadePitch0 = this.options['cascadePitches'][0];\n      var cascadePitch1 = this.options['cascadePitches'][1];\n      var projViewMatrix0 = this.cascadeFrustumMatrix0 = this.cascadeFrustumMatrix0 || createMat4();\n      var projViewMatrix1 = this.cascadeFrustumMatrix1 = this.cascadeFrustumMatrix1 || createMat4();\n\n      if (pitch > cascadePitch0) {\n        cal.call(this, pitch, cascadePitch0, projViewMatrix0);\n      } else {\n        copy(this.cascadeFrustumMatrix0, this.projViewMatrix);\n      }\n\n      if (pitch > cascadePitch1) {\n        cal.call(this, pitch, cascadePitch1, projViewMatrix1);\n      } else {\n        copy(this.cascadeFrustumMatrix1, this.cascadeFrustumMatrix0);\n      }\n    };\n  }(),\n  _calcDomMatrix: function () {\n    var m = createMat4(),\n        m1 = createMat4(),\n        minusY = [1, -1, 1],\n        arr = [0, 0, 0];\n    return function () {\n      var width = this.width || 1;\n      var height = this.height || 1;\n      var cameraToCenterDistance = 0.5 / Math.tan(this._fov / 2) * height;\n      scale(m, this.projMatrix, minusY);\n      translate(m, m, set$2(arr, 0, 0, -cameraToCenterDistance));\n\n      if (this._pitch) {\n        rotateX(m, m, this._pitch);\n      }\n\n      if (this._angle) {\n        rotateZ(m, m, this._angle);\n      }\n\n      identity(m1);\n      scale(m1, m1, set$2(arr, width / 2, -height / 2, 1));\n      return multiply(this.domCssMatrix || createMat4(), m1, m);\n    };\n  }(),\n  _getCameraWorldMatrix: function () {\n    var q = {};\n    return function () {\n      var targetZ = this.getGLZoom();\n      var size = this.getSize(),\n          scale$$1 = this.getGLScale();\n\n      var center2D = this._prjToPoint(this._prjCenter, targetZ);\n\n      this.cameraLookAt = set$2(this.cameraLookAt || [0, 0, 0], center2D.x, center2D.y, 0);\n      var pitch = this.getPitch() * RADIAN$1;\n      var bearing = this.getBearing() * RADIAN$1;\n\n      var ratio = this._getFovRatio();\n\n      var z = scale$$1 * (size.height || 1) / 2 / ratio;\n      var cz = z * Math.cos(pitch);\n      var dist = Math.sin(pitch) * z;\n      var cx = center2D.x - dist * Math.sin(bearing);\n      var cy = center2D.y - dist * Math.cos(bearing);\n      this.cameraPosition = set$2(this.cameraPosition || [0, 0, 0], cx, cy, cz);\n      var d = dist || 1;\n      var up = this.cameraUp = set$2(this.cameraUp || [0, 0, 0], Math.sin(bearing) * d, Math.cos(bearing) * d, 0);\n      var m = this.cameraWorldMatrix = this.cameraWorldMatrix || createMat4();\n      lookAt(m, this.cameraPosition, this.cameraLookAt, up);\n      var cameraForward = this.cameraForward || [0, 0, 0];\n      subtract(cameraForward, this.cameraLookAt, this.cameraPosition);\n      this.cameraForward = normalize(cameraForward, cameraForward);\n      matrixToQuaternion(q, m);\n      quaternionToMatrix(m, q);\n      setPosition(m, this.cameraPosition);\n      return m;\n    };\n  }(),\n  _getFovRatio: function _getFovRatio() {\n    var fov = this.getFov();\n    return Math.tan(fov / 2 * RADIAN$1);\n  },\n  _renderLayers: function _renderLayers() {\n    if (this.isInteracting()) {\n      return;\n    }\n\n    var layers = this._getLayers();\n\n    layers.forEach(function (layer) {\n      if (!layer) {\n        return;\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (renderer && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    });\n  }\n});\n\nfunction createMat4() {\n  return identity(new Array(16));\n}\n\nMap$1.include({\n  _onViewChange: function _onViewChange(view) {\n    if (!this._viewHistory) {\n      this._viewHistory = [];\n      this._viewHistoryPointer = 0;\n    }\n\n    var old = this._getCurrentView();\n\n    for (var i = this._viewHistory.length - 1; i >= 0; i--) {\n      if (equalMapView(view, this._viewHistory[i])) {\n        this._viewHistoryPointer = i;\n\n        this._fireViewChange(old, view);\n\n        return;\n      }\n    }\n\n    if (this._viewHistoryPointer < this._viewHistory.length - 1) {\n      this._viewHistory.splice(this._viewHistoryPointer + 1);\n    }\n\n    this._viewHistory.push(view);\n\n    var count = this.options['viewHistoryCount'];\n\n    if (count > 0 && this._viewHistory.length > count) {\n      this._viewHistory.splice(0, this._viewHistory.length - count);\n    }\n\n    this._viewHistoryPointer = this._viewHistory.length - 1;\n\n    this._fireViewChange(old, view);\n  },\n  zoomToPreviousView: function zoomToPreviousView(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!this.hasPreviousView()) {\n      return null;\n    }\n\n    var view = this._viewHistory[--this._viewHistoryPointer];\n\n    this._zoomToView(view, options);\n\n    return view;\n  },\n  hasPreviousView: function hasPreviousView() {\n    if (!this._viewHistory || this._viewHistoryPointer === 0) {\n      return false;\n    }\n\n    return true;\n  },\n  zoomToNextView: function zoomToNextView(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!this.hasNextView()) {\n      return null;\n    }\n\n    var view = this._viewHistory[++this._viewHistoryPointer];\n\n    this._zoomToView(view, options);\n\n    return view;\n  },\n  hasNextView: function hasNextView() {\n    if (!this._viewHistory || this._viewHistoryPointer === this._viewHistory.length - 1) {\n      return false;\n    }\n\n    return true;\n  },\n  _zoomToView: function _zoomToView(view, options) {\n    var _this = this;\n\n    var old = this.getView();\n\n    if (options['animation']) {\n      this._animateTo(view, {\n        'duration': options['duration']\n      }, function (frame) {\n        if (frame.state.playState === 'finished') {\n          _this._fireViewChange(old, view);\n        }\n      });\n    } else {\n      this.setView(view);\n\n      this._fireViewChange(old, view);\n    }\n  },\n  getViewHistory: function getViewHistory() {\n    return this._viewHistory;\n  },\n  _fireViewChange: function _fireViewChange(old, view) {\n    this._fireEvent('viewchange', {\n      'old': old,\n      'new': view\n    });\n  },\n  _getCurrentView: function _getCurrentView() {\n    if (!this._viewHistory) {\n      return null;\n    }\n\n    return this._viewHistory[this._viewHistoryPointer];\n  }\n});\nMap$1.mergeOptions({\n  'viewHistory': true,\n  'viewHistoryCount': 10\n});\nvar options$h = {\n  'mode': 'LineString',\n  'language': 'zh-CN',\n  'metric': true,\n  'imperial': false,\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 3,\n    'lineOpacity': 1\n  },\n  'vertexSymbol': {\n    'markerType': 'ellipse',\n    'markerFill': '#fff',\n    'markerLineColor': '#000',\n    'markerLineWidth': 3,\n    'markerWidth': 11,\n    'markerHeight': 11\n  },\n  'labelOptions': {\n    'textSymbol': {\n      'textFaceName': 'monospace',\n      'textLineSpacing': 1,\n      'textHorizontalAlignment': 'right',\n      'textDx': 15\n    },\n    'boxStyle': {\n      'padding': [6, 2],\n      'symbol': {\n        'markerType': 'square',\n        'markerFill': '#fff',\n        'markerFillOpacity': 0.9,\n        'markerLineColor': '#b4b3b3'\n      }\n    }\n  },\n  'clearButtonSymbol': [{\n    'markerType': 'square',\n    'markerFill': '#fff',\n    'markerLineColor': '#b4b3b3',\n    'markerLineWidth': 2,\n    'markerWidth': 15,\n    'markerHeight': 15,\n    'markerDx': 20\n  }, {\n    'markerType': 'x',\n    'markerWidth': 10,\n    'markerHeight': 10,\n    'markerDx': 20\n  }]\n};\n\nvar DistanceTool = function (_DrawTool) {\n  _inheritsLoose(DistanceTool, _DrawTool);\n\n  function DistanceTool(options) {\n    var _this;\n\n    _this = _DrawTool.call(this, options) || this;\n\n    _this.on('enable', _this._afterEnable, _assertThisInitialized(_assertThisInitialized(_this))).on('disable', _this._afterDisable, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._measureLayers = [];\n    return _this;\n  }\n\n  var _proto = DistanceTool.prototype;\n\n  _proto.clear = function clear() {\n    if (isArrayHasData(this._measureLayers)) {\n      for (var i = 0; i < this._measureLayers.length; i++) {\n        this._measureLayers[i].remove();\n      }\n    }\n\n    delete this._lastMeasure;\n    delete this._lastVertex;\n    this._measureLayers = [];\n    return this;\n  };\n\n  _proto.getMeasureLayers = function getMeasureLayers() {\n    return this._measureLayers;\n  };\n\n  _proto.getLastMeasure = function getLastMeasure() {\n    if (!this._lastMeasure) {\n      return 0;\n    }\n\n    return this._lastMeasure;\n  };\n\n  _proto.undo = function undo() {\n    _DrawTool.prototype.undo.call(this);\n\n    var pointer = this._historyPointer;\n\n    if (pointer !== this._vertexes.length) {\n      for (var i = pointer; i < this._vertexes.length; i++) {\n        if (this._vertexes[i].label) {\n          this._vertexes[i].label.remove();\n        }\n\n        this._vertexes[i].marker.remove();\n      }\n    }\n\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    _DrawTool.prototype.redo.call(this);\n\n    var i = this._historyPointer - 1;\n\n    if (this._vertexes[i]) {\n      if (!this._vertexes[i].marker.getLayer()) {\n        if (this._vertexes[i].label) {\n          this._vertexes[i].label.addTo(this._measureMarkerLayer);\n        }\n\n        this._vertexes[i].marker.addTo(this._measureMarkerLayer);\n      }\n    }\n\n    return this;\n  };\n\n  _proto._measure = function _measure(toMeasure) {\n    var map = this.getMap();\n    var length;\n\n    if (toMeasure instanceof Geometry) {\n      length = map.computeGeometryLength(toMeasure);\n    } else if (Array.isArray(toMeasure)) {\n      length = map.getProjection().measureLength(toMeasure);\n    }\n\n    this._lastMeasure = length;\n    var units;\n\n    if (this.options['language'] === 'zh-CN') {\n      units = [' 米', ' 公里', ' 英尺', ' 英里'];\n    } else {\n      units = [' m', ' km', ' feet', ' mile'];\n    }\n\n    var content = '';\n\n    if (this.options['metric']) {\n      content += length < 1000 ? length.toFixed(0) + units[0] : (length / 1000).toFixed(2) + units[1];\n    }\n\n    if (this.options['imperial']) {\n      length *= 3.2808399;\n\n      if (content.length > 0) {\n        content += '\\n';\n      }\n\n      content += length < 5280 ? length.toFixed(0) + units[2] : (length / 5280).toFixed(2) + units[3];\n    }\n\n    return content;\n  };\n\n  _proto._registerMeasureEvents = function _registerMeasureEvents() {\n    this.on('drawstart', this._msOnDrawStart, this).on('drawvertex', this._msOnDrawVertex, this).on('mousemove', this._msOnMouseMove, this).on('drawend', this._msOnDrawEnd, this);\n  };\n\n  _proto._afterEnable = function _afterEnable() {\n    this._registerMeasureEvents();\n  };\n\n  _proto._afterDisable = function _afterDisable() {\n    this.off('drawstart', this._msOnDrawStart, this).off('drawvertex', this._msOnDrawVertex, this).off('mousemove', this._msOnMouseMove, this).off('drawend', this._msOnDrawEnd, this);\n  };\n\n  _proto._msOnDrawStart = function _msOnDrawStart(param) {\n    var map = this.getMap();\n\n    var prjCoord = map._pointToPrj(param['point2d']);\n\n    var uid = UID();\n    var layerId = 'distancetool_' + uid;\n    var markerLayerId = 'distancetool_markers_' + uid;\n\n    if (!map.getLayer(layerId)) {\n      this._measureLineLayer = new VectorLayer(layerId).addTo(map);\n      this._measureMarkerLayer = new VectorLayer(markerLayerId).addTo(map);\n    } else {\n      this._measureLineLayer = map.getLayer(layerId);\n      this._measureMarkerLayer = map.getLayer(markerLayerId);\n    }\n\n    this._measureLayers.push(this._measureLineLayer);\n\n    this._measureLayers.push(this._measureMarkerLayer);\n\n    var marker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    marker._setPrjCoordinates(prjCoord);\n\n    var content = this.options['language'] === 'zh-CN' ? '起点' : 'start';\n    var startLabel = new Label(content, param['coordinate'], this.options['labelOptions']);\n\n    startLabel._setPrjCoordinates(prjCoord);\n\n    this._lastVertex = startLabel;\n\n    this._addVertexMarker(marker, startLabel);\n  };\n\n  _proto._msOnMouseMove = function _msOnMouseMove(param) {\n    var ms = this._measure(this._msGetCoordsToMeasure(param));\n\n    if (!this._tailMarker) {\n      var symbol = extendSymbol(this.options['vertexSymbol']);\n      symbol['markerWidth'] /= 2;\n      symbol['markerHeight'] /= 2;\n      this._tailMarker = new Marker(param['coordinate'], {\n        'symbol': symbol\n      }).addTo(this._measureMarkerLayer);\n      this._tailLabel = new Label(ms, param['coordinate'], this.options['labelOptions']).addTo(this._measureMarkerLayer);\n    }\n\n    var prjCoords = this._geometry._getPrjCoordinates();\n\n    var lastCoord = prjCoords[prjCoords.length - 1];\n\n    this._tailMarker.setCoordinates(param['coordinate']);\n\n    this._tailMarker._setPrjCoordinates(lastCoord);\n\n    this._tailLabel.setContent(ms);\n\n    this._tailLabel.setCoordinates(param['coordinate']);\n\n    this._tailLabel._setPrjCoordinates(lastCoord);\n  };\n\n  _proto._msGetCoordsToMeasure = function _msGetCoordsToMeasure(param) {\n    return param['geometry'].getCoordinates().concat([param['coordinate']]);\n  };\n\n  _proto._msOnDrawVertex = function _msOnDrawVertex(param) {\n    var prjCoords = this._geometry._getPrjCoordinates();\n\n    var lastCoord = prjCoords[prjCoords.length - 1];\n    var geometry = param['geometry'];\n    var marker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    var length = this._measure(geometry);\n\n    var vertexLabel = new Label(length, param['coordinate'], this.options['labelOptions']);\n\n    this._addVertexMarker(marker, vertexLabel);\n\n    vertexLabel._setPrjCoordinates(lastCoord);\n\n    marker._setPrjCoordinates(lastCoord);\n\n    this._lastVertex = vertexLabel;\n  };\n\n  _proto._addVertexMarker = function _addVertexMarker(marker, vertexLabel) {\n    if (!this._vertexes) {\n      this._vertexes = [];\n    }\n\n    this._vertexes.push({\n      label: vertexLabel,\n      marker: marker\n    });\n\n    if (this._historyPointer !== undefined) {\n      this._vertexes.length = this._historyPointer;\n    }\n\n    this._measureMarkerLayer.addGeometry(marker);\n\n    if (vertexLabel) {\n      this._measureMarkerLayer.addGeometry(vertexLabel);\n    }\n  };\n\n  _proto._msOnDrawEnd = function _msOnDrawEnd(param) {\n    this._clearTailMarker();\n\n    var size = this._lastVertex.getSize();\n\n    if (!size) {\n      size = new Size(10, 10);\n    }\n\n    this._addClearMarker(this._lastVertex.getCoordinates(), this._lastVertex._getPrjCoordinates(), size['width']);\n\n    var geo = param['geometry'].copy();\n\n    geo._setPrjCoordinates(param['geometry']._getPrjCoordinates());\n\n    geo.addTo(this._measureLineLayer);\n    this._lastMeasure = geo.getLength();\n  };\n\n  _proto._addClearMarker = function _addClearMarker(coordinates, prjCoord, dx) {\n    var symbol = this.options['clearButtonSymbol'];\n    var dxSymbol = {\n      'markerDx': (symbol['markerDx'] || 0) + dx,\n      'textDx': (symbol['textDx'] || 0) + dx\n    };\n\n    if (Array.isArray(symbol)) {\n      dxSymbol = symbol.map(function (s) {\n        if (s) {\n          return {\n            'markerDx': (s['markerDx'] || 0) + dx,\n            'textDx': (s['textDx'] || 0) + dx\n          };\n        }\n\n        return null;\n      });\n    }\n\n    symbol = extendSymbol(symbol, dxSymbol);\n    var endMarker = new Marker(coordinates, {\n      'symbol': symbol\n    });\n    var measureLineLayer = this._measureLineLayer,\n        measureMarkerLayer = this._measureMarkerLayer;\n    endMarker.on('click', function () {\n      measureLineLayer.remove();\n      measureMarkerLayer.remove();\n      return false;\n    }, this);\n    endMarker.addTo(this._measureMarkerLayer);\n\n    endMarker._setPrjCoordinates(prjCoord);\n  };\n\n  _proto._clearTailMarker = function _clearTailMarker() {\n    if (this._tailMarker) {\n      this._tailMarker.remove();\n\n      delete this._tailMarker;\n    }\n\n    if (this._tailLabel) {\n      this._tailLabel.remove();\n\n      delete this._tailLabel;\n    }\n  };\n\n  return DistanceTool;\n}(DrawTool);\n\nDistanceTool.mergeOptions(options$h);\nvar options$i = {\n  'mode': 'Polygon',\n  'symbol': {\n    'lineColor': '#000000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'lineDasharray': '',\n    'polygonFill': '#ffffff',\n    'polygonOpacity': 0.5\n  }\n};\n\nvar AreaTool = function (_DistanceTool) {\n  _inheritsLoose(AreaTool, _DistanceTool);\n\n  function AreaTool(options) {\n    var _this;\n\n    _this = _DistanceTool.call(this, options) || this;\n\n    _this.on('enable', _this._afterEnable, _assertThisInitialized(_assertThisInitialized(_this))).on('disable', _this._afterDisable, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._measureLayers = [];\n    return _this;\n  }\n\n  var _proto = AreaTool.prototype;\n\n  _proto._measure = function _measure(toMeasure) {\n    var map = this.getMap();\n    var area;\n\n    if (toMeasure instanceof Geometry) {\n      area = map.computeGeometryArea(toMeasure);\n    } else if (Array.isArray(toMeasure)) {\n      area = map.getProjection().measureArea(toMeasure);\n    }\n\n    this._lastMeasure = area;\n    var units;\n\n    if (this.options['language'] === 'zh-CN') {\n      units = [' 平方米', ' 平方公里', ' 平方英尺', ' 平方英里'];\n    } else {\n      units = [' sq.m', ' sq.km', ' sq.ft', ' sq.mi'];\n    }\n\n    var content = '';\n\n    if (this.options['metric']) {\n      content += area < 1E6 ? area.toFixed(0) + units[0] : (area / 1E6).toFixed(2) + units[1];\n    }\n\n    if (this.options['imperial']) {\n      area *= 3.2808399;\n\n      if (content.length > 0) {\n        content += '\\n';\n      }\n\n      var sqmi = 5280 * 5280;\n      content += area < sqmi ? area.toFixed(0) + units[2] : (area / sqmi).toFixed(2) + units[3];\n    }\n\n    return content;\n  };\n\n  _proto._msGetCoordsToMeasure = function _msGetCoordsToMeasure(param) {\n    return param['geometry'].getShell().concat([param['coordinate']]);\n  };\n\n  _proto._msOnDrawVertex = function _msOnDrawVertex(param) {\n    var prjCoord = this.getMap()._pointToPrj(param['point2d']);\n\n    var vertexMarker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    vertexMarker._setPrjCoordinates(prjCoord);\n\n    this._measure(param['geometry']);\n\n    this._lastVertex = vertexMarker;\n\n    this._addVertexMarker(vertexMarker);\n  };\n\n  _proto._msOnDrawEnd = function _msOnDrawEnd(param) {\n    this._clearTailMarker();\n\n    var prjCoord = this.getMap()._pointToPrj(param['point2d']);\n\n    var ms = this._measure(param['geometry']);\n\n    var endLabel = new Label(ms, param['coordinate'], this.options['labelOptions']).addTo(this._measureMarkerLayer);\n\n    endLabel._setPrjCoordinates(prjCoord);\n\n    var size = endLabel.getSize();\n\n    if (!size) {\n      size = new Size(10, 10);\n    }\n\n    this._addClearMarker(param['coordinate'], prjCoord, size['width']);\n\n    var geo = param['geometry'].copy();\n\n    geo._setPrjCoordinates(param['geometry']._getPrjCoordinates());\n\n    geo.addTo(this._measureLineLayer);\n    this._lastMeasure = geo.getArea();\n  };\n\n  return AreaTool;\n}(DistanceTool);\n\nAreaTool.mergeOptions(options$i);\nvar circleHooks = {\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var circle = new Circle(center, 0);\n\n    circle._setPrjCoordinates(prjCoord[0]);\n\n    return circle;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var map = geometry.getMap();\n    var prjCoord = Array.isArray(prjPath) ? prjPath[prjPath.length - 1] : prjPath;\n    var nextCoord = projection.unproject(prjCoord);\n    var radius = map.computeLength(geometry.getCenter(), nextCoord);\n    geometry.setRadius(radius);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('circle', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, circleHooks));\nDrawTool.registerMode('freeHandCircle', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, circleHooks));\nvar ellipseHooks = {\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var ellipse = new Ellipse(center, 0, 0);\n\n    ellipse._setPrjCoordinates(prjCoord[0]);\n\n    return ellipse;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var map = geometry.getMap();\n    var center = geometry.getCenter();\n    var prjCoord = Array.isArray(prjPath) ? prjPath[prjPath.length - 1] : prjPath;\n    var nextCoord = projection.unproject(prjCoord);\n    var rx = map.computeLength(center, new Coordinate({\n      x: nextCoord.x,\n      y: center.y\n    }));\n    var ry = map.computeLength(center, new Coordinate({\n      x: center.x,\n      y: nextCoord.y\n    }));\n    geometry.setWidth(rx * 2);\n    geometry.setHeight(ry * 2);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('ellipse', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, ellipseHooks));\nDrawTool.registerMode('freeHandEllipse', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, ellipseHooks));\nvar rectangleHooks = {\n  'create': function create(projection, prjCoords) {\n    var rect = new Polygon([]);\n    rect._firstClick = prjCoords[0];\n    return rect;\n  },\n  'update': function update(projection, prjCoords, geometry, param) {\n    var map = geometry.getMap();\n    var containerPoint = param['containerPoint'];\n\n    var firstClick = map._prjToContainerPoint(geometry._firstClick);\n\n    var ring = [[firstClick.x, firstClick.y], [containerPoint.x, firstClick.y], [containerPoint.x, containerPoint.y], [firstClick.x, containerPoint.y]];\n    geometry.setCoordinates(ring.map(function (c) {\n      return map.containerPointToCoord(new Point(c));\n    }));\n\n    geometry._setPrjCoordinates(ring.map(function (c) {\n      return map._containerPointToPrj(new Point(c));\n    }));\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('rectangle', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, rectangleHooks));\nDrawTool.registerMode('freeHandRectangle', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, rectangleHooks));\nDrawTool.registerMode('point', {\n  'clickLimit': 1,\n  'action': ['click'],\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var marker = new Marker(center);\n\n    marker._setPrjCoordinates(prjCoord[0]);\n\n    return marker;\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nvar polygonHooks = {\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var line = new LineString(path);\n\n    line._setPrjCoordinates(prjPath);\n\n    return line;\n  },\n  'update': function update(projection, path, geometry) {\n    var symbol = geometry.getSymbol();\n    var prjCoords;\n\n    if (Array.isArray(path)) {\n      prjCoords = path;\n    } else {\n      prjCoords = geometry._getPrjCoordinates();\n      prjCoords.push(path);\n    }\n\n    var coordinates = prjCoords.map(function (c) {\n      return projection.unproject(c);\n    });\n    geometry.setCoordinates(coordinates);\n\n    geometry._setPrjCoordinates(prjCoords);\n\n    var layer = geometry.getLayer();\n\n    if (layer) {\n      var polygon = layer.getGeometryById('polygon');\n\n      if (!polygon && prjCoords.length >= 3) {\n        polygon = new Polygon([coordinates], {\n          'id': 'polygon'\n        });\n\n        if (symbol) {\n          var pSymbol = extendSymbol(symbol, {\n            'lineOpacity': 0\n          });\n          polygon.setSymbol(pSymbol);\n        }\n\n        polygon.addTo(layer);\n      }\n\n      if (polygon) {\n        polygon._setPrjCoordinates(prjCoords);\n      }\n    }\n  },\n  'generate': function generate(geometry) {\n    var polygon = new Polygon(geometry.getCoordinates(), {\n      'symbol': geometry.getSymbol()\n    });\n\n    polygon._setPrjCoordinates(geometry._getPrjCoordinates());\n\n    polygon._projCode = geometry._projCode;\n    return polygon;\n  }\n};\nDrawTool.registerMode('polygon', extend({\n  'action': ['click', 'mousemove', 'dblclick']\n}, polygonHooks));\nDrawTool.registerMode('freeHandPolygon', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, polygonHooks));\nvar lineStringHooks = {\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var line = new LineString(path);\n\n    line._setPrjCoordinates(prjPath);\n\n    return line;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var prjCoords;\n\n    if (Array.isArray(prjPath)) {\n      prjCoords = prjPath;\n    } else {\n      prjCoords = geometry._getPrjCoordinates();\n      prjCoords.push(prjPath);\n    }\n\n    var path = prjCoords.map(function (c) {\n      return projection.unproject(c);\n    });\n    geometry.setCoordinates(path);\n\n    geometry._setPrjCoordinates(prjCoords);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('linestring', extend({\n  'action': ['click', 'mousemove', 'dblclick']\n}, lineStringHooks));\nDrawTool.registerMode('freeHandLinestring', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, lineStringHooks));\nDrawTool.registerMode('arccurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var arc = new ArcCurve(path);\n\n    arc._setPrjCoordinates(prjPath);\n\n    return arc;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('quadbeziercurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var curve = new QuadBezierCurve(path);\n\n    curve._setPrjCoordinates(prjPath);\n\n    return curve;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('cubicbeziercurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var curve = new CubicBezierCurve(path);\n\n    curve._setPrjCoordinates(prjPath);\n\n    return curve;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('boxZoom', {\n  'action': ['mousedown', 'mousemove', 'mouseup'],\n  'create': function create(projection, prjCoord) {\n    prjCoord = prjCoord[0];\n    var center = projection.unproject(prjCoord);\n    var marker = new Marker(center);\n    marker._firstClick = prjCoord;\n    return marker;\n  },\n  'update': function update(projection, prjCoord, geometry, param) {\n    var map = geometry.getMap();\n\n    var p1 = map._prjToContainerPoint(geometry._firstClick),\n        p2 = param['containerPoint'];\n\n    prjCoord = map._containerPointToPrj(new Coordinate(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)));\n    var center = projection.unproject(prjCoord);\n\n    geometry.setCoordinates(center)._setPrjCoordinates(prjCoord);\n\n    geometry.updateSymbol({\n      markerWidth: Math.abs(p1.x - p2.x),\n      markerHeight: Math.abs(p1.y - p2.y)\n    });\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\n\nfunction parse(arcConf) {\n  var tileInfo = arcConf['tileInfo'],\n      tileSize = [tileInfo['cols'], tileInfo['rows']],\n      resolutions = [],\n      lods = tileInfo['lods'];\n\n  for (var i = 0, len = lods.length; i < len; i++) {\n    resolutions.push(lods[i]['resolution']);\n  }\n\n  var fullExtent = arcConf['fullExtent'],\n      origin = tileInfo['origin'],\n      tileSystem = [1, -1, origin['x'], origin['y']];\n  delete fullExtent['spatialReference'];\n  return {\n    'spatialReference': {\n      'resolutions': resolutions,\n      'fullExtent': fullExtent\n    },\n    'tileSystem': tileSystem,\n    'tileSize': tileSize\n  };\n}\n\nSpatialReference.loadArcgis = function (url, cb, options) {\n  if (options === void 0) {\n    options = {\n      'jsonp': true\n    };\n  }\n\n  if (isString(url) && url.substring(0, 1) !== '{') {\n    Ajax.getJSON(url, function (err, json) {\n      if (err) {\n        cb(err);\n        return;\n      }\n\n      var spatialRef = parse(json);\n      cb(null, spatialRef);\n    }, options);\n  } else {\n    if (isString(url)) {\n      url = parseJSON(url);\n    }\n\n    var spatialRef = parse(url);\n    cb(null, spatialRef);\n  }\n\n  return this;\n};\n\nvar options$j = {\n  'eventsPropagation': false,\n  'eventsToStop': null,\n  'dx': 0,\n  'dy': 0,\n  'autoPan': false,\n  'autoPanDuration': 600,\n  'single': true,\n  'animation': 'scale',\n  'animationOnHide': true,\n  'animationDuration': 500,\n  'pitchWithMap': false,\n  'rotateWithMap': false\n};\n\nvar UIComponent = function (_Eventable) {\n  _inheritsLoose(UIComponent, _Eventable);\n\n  function UIComponent(options) {\n    return _Eventable.call(this, options) || this;\n  }\n\n  var _proto = UIComponent.prototype;\n\n  _proto.addTo = function addTo(owner) {\n    this._owner = owner;\n\n    this._switchEvents('on');\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.fire('add');\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    if (!this._owner) {\n      return null;\n    }\n\n    if (this._owner.getBaseLayer) {\n      return this._owner;\n    }\n\n    return this._owner.getMap();\n  };\n\n  _proto.show = function show(coordinate) {\n    var map = this.getMap();\n\n    if (!map) {\n      return this;\n    }\n\n    if (!this._mapEventsOn) {\n      this._switchMapEvents('on');\n    }\n\n    coordinate = coordinate || this._coordinate || this._owner.getCenter();\n    var visible = this.isVisible();\n    this.fire('showstart');\n\n    var container = this._getUIContainer();\n\n    this._coordinate = coordinate;\n\n    this._removePrevDOM();\n\n    var dom = this.__uiDOM = this.buildOn(map);\n    dom['eventsPropagation'] = this.options['eventsPropagation'];\n\n    if (!dom) {\n      this.fire('showend');\n      return this;\n    }\n\n    this._measureSize(dom);\n\n    if (this._singleton()) {\n      map[this._uiDomKey()] = dom;\n    }\n\n    this._setPosition();\n\n    dom.style[TRANSITION] = null;\n    container.appendChild(dom);\n\n    var anim = this._getAnimation();\n\n    if (visible) {\n      anim.ok = false;\n    }\n\n    if (anim.ok) {\n      if (anim.fade) {\n        dom.style.opacity = 0;\n      }\n\n      if (anim.scale) {\n        if (this.getTransformOrigin) {\n          var origin = this.getTransformOrigin();\n          dom.style[TRANSFORMORIGIN] = origin;\n        }\n\n        dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n      }\n    }\n\n    dom.style.display = '';\n\n    if (this.options['eventsToStop']) {\n      on(dom, this.options['eventsToStop'], stopPropagation);\n    }\n\n    if (this.options['autoPan']) {\n      this._autoPan();\n    }\n\n    var transition = anim.transition;\n\n    if (anim.ok && transition) {\n      dom.offsetHeight;\n\n      if (transition) {\n        dom.style[TRANSITION] = transition;\n      }\n\n      if (anim.fade) {\n        dom.style.opacity = 1;\n      }\n\n      if (anim.scale) {\n        dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(1)';\n      }\n    }\n\n    this.fire('showend');\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    var _this = this;\n\n    if (!this.getDOM() || !this.getMap()) {\n      return this;\n    }\n\n    var anim = this._getAnimation(),\n        dom = this.getDOM();\n\n    if (!this.options['animationOnHide']) {\n      anim.ok = false;\n    }\n\n    if (!anim.ok) {\n      dom.style.display = 'none';\n      this.fire('hide');\n    } else {\n      dom.offsetHeight;\n      dom.style[TRANSITION] = anim.transition;\n      setTimeout(function () {\n        dom.style.display = 'none';\n\n        _this.fire('hide');\n      }, this.options['animationDuration']);\n    }\n\n    if (anim.fade) {\n      dom.style.opacity = 0;\n    }\n\n    if (anim.scale) {\n      dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    var dom = this.getDOM();\n    return this.getMap() && dom && dom.parentNode && dom.style.display !== 'none';\n  };\n\n  _proto.remove = function remove() {\n    delete this._mapEventsOn;\n\n    if (!this._owner) {\n      return this;\n    }\n\n    this.hide();\n\n    this._switchEvents('off');\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    if (!this._singleton() && this.__uiDOM) {\n      this._removePrevDOM();\n    }\n\n    delete this._owner;\n    this.fire('remove');\n    return this;\n  };\n\n  _proto.getSize = function getSize() {\n    if (this._size) {\n      return this._size.copy();\n    } else {\n      return null;\n    }\n  };\n\n  _proto.getOwner = function getOwner() {\n    return this._owner;\n  };\n\n  _proto.getDOM = function getDOM() {\n    return this.__uiDOM;\n  };\n\n  _proto.getPosition = function getPosition() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var p = this._getViewPoint()._round();\n\n    if (this.getOffset) {\n      var o = this.getOffset()._round();\n\n      if (o) {\n        p._add(o);\n      }\n    }\n\n    return p;\n  };\n\n  _proto._getAnimation = function _getAnimation() {\n    var anim = {\n      'fade': false,\n      'scale': false\n    };\n    var animations = this.options['animation'] ? this.options['animation'].split(',') : [];\n\n    for (var i = 0; i < animations.length; i++) {\n      var trimed = trim(animations[i]);\n\n      if (trimed === 'fade') {\n        anim.fade = true;\n      } else if (trimed === 'scale') {\n        anim.scale = true;\n      }\n    }\n\n    var transition = null;\n\n    if (anim.fade) {\n      transition = 'opacity ' + this.options['animationDuration'] + 'ms';\n    }\n\n    if (anim.scale) {\n      transition = transition ? transition + ',' : '';\n      transition += TRANSFORM + ' ' + this.options['animationDuration'] + 'ms';\n    }\n\n    anim.transition = transition;\n    anim.ok = transition !== null;\n    return anim;\n  };\n\n  _proto._getViewPoint = function _getViewPoint() {\n    var alt = 0;\n\n    if (this._owner && this._owner.getAltitude) {\n      var altitude = this._owner.getAltitude();\n\n      if (altitude > 0) {\n        alt = this._meterToPoint(this._coordinate, altitude);\n      }\n    }\n\n    return this.getMap().coordToViewPoint(this._coordinate, undefined, alt)._add(this.options['dx'], this.options['dy']);\n  };\n\n  _proto._meterToPoint = function _meterToPoint(center, altitude) {\n    var map = this.getMap();\n    return map.distanceToPoint(altitude, 0, undefined, center).x * sign(altitude);\n  };\n\n  _proto._autoPan = function _autoPan() {\n    var map = this.getMap(),\n        dom = this.getDOM();\n\n    if (map.isMoving()) {\n      return;\n    }\n\n    var point = this._pos;\n    var mapSize = map.getSize(),\n        mapWidth = mapSize['width'],\n        mapHeight = mapSize['height'];\n    var containerPoint = map.viewPointToContainerPoint(point);\n    var clientWidth = parseInt(dom.clientWidth),\n        clientHeight = parseInt(dom.clientHeight);\n    var left = 0,\n        top = 0;\n\n    if (containerPoint.x < 0) {\n      left = -(containerPoint.x - clientWidth / 2);\n    } else if (containerPoint.x + clientWidth - 35 > mapWidth) {\n      left = mapWidth - (containerPoint.x + clientWidth * 3 / 2);\n    }\n\n    if (containerPoint.y - clientHeight < 0) {\n      top = -(containerPoint.y - clientHeight) + 50;\n    } else if (containerPoint.y > mapHeight) {\n      top = mapHeight - containerPoint.y - clientHeight - 30;\n    }\n\n    if (top !== 0 || left !== 0) {\n      map.panBy(new Point(left, top), {\n        'duration': this.options['autoPanDuration']\n      });\n    }\n  };\n\n  _proto._measureSize = function _measureSize(dom) {\n    var container = this._getUIContainer();\n\n    dom.style.position = 'absolute';\n    dom.style.left = -99999 + 'px';\n    var anchor = dom.style.bottom ? 'bottom' : 'top';\n    dom.style[anchor] = -99999 + 'px';\n    dom.style.display = '';\n    container.appendChild(dom);\n    this._size = new Size(dom.clientWidth, dom.clientHeight);\n    dom.style.display = 'none';\n    dom.style.left = '0px';\n    dom.style[anchor] = '0px';\n    return this._size;\n  };\n\n  _proto._removePrevDOM = function _removePrevDOM() {\n    if (this.onDomRemove) {\n      this.onDomRemove();\n    }\n\n    var eventsToStop = this.options['eventsToStop'];\n\n    if (this._singleton()) {\n      var map = this.getMap(),\n          key = this._uiDomKey();\n\n      if (map[key]) {\n        if (eventsToStop) {\n          off(map[key], eventsToStop, stopPropagation);\n        }\n\n        removeDomNode(map[key]);\n        delete map[key];\n      }\n\n      delete this.__uiDOM;\n    } else if (this.__uiDOM) {\n      if (eventsToStop) {\n        off(this.__uiDOM, eventsToStop, stopPropagation);\n      }\n\n      removeDomNode(this.__uiDOM);\n      delete this.__uiDOM;\n    }\n  };\n\n  _proto._uiDomKey = function _uiDomKey() {\n    return '__ui_' + this._getClassName();\n  };\n\n  _proto._singleton = function _singleton() {\n    return this.options['single'];\n  };\n\n  _proto._getUIContainer = function _getUIContainer() {\n    return this.getMap()._panels['ui'];\n  };\n\n  _proto._getClassName = function _getClassName() {\n    return 'UIComponent';\n  };\n\n  _proto._switchMapEvents = function _switchMapEvents(to) {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    this._mapEventsOn = to === 'on';\n\n    var events = this._getDefaultEvents();\n\n    if (this.getEvents) {\n      extend(events, this.getEvents());\n    }\n\n    if (events) {\n      for (var p in events) {\n        if (events.hasOwnProperty(p)) {\n          map[to](p, events[p], this);\n        }\n      }\n    }\n  };\n\n  _proto._switchEvents = function _switchEvents(to) {\n    this._switchMapEvents(to);\n\n    var ownerEvents = this._getOwnerEvents();\n\n    if (this._owner) {\n      for (var p in ownerEvents) {\n        if (ownerEvents.hasOwnProperty(p)) {\n          this._owner[to](p, ownerEvents[p], this);\n        }\n      }\n    }\n  };\n\n  _proto._getDefaultEvents = function _getDefaultEvents() {\n    return {\n      'zooming rotate pitch': this.onEvent,\n      'zoomend': this.onZoomEnd,\n      'moving': this.onMoving\n    };\n  };\n\n  _proto._getOwnerEvents = function _getOwnerEvents() {\n    var events = {};\n\n    if (this._owner && this._owner instanceof Geometry) {\n      events.positionchange = this.onGeometryPositionChange;\n    }\n\n    if (this.getOwnerEvents) {\n      extend(events, this.getOwnerEvents());\n    }\n\n    return events;\n  };\n\n  _proto.onGeometryPositionChange = function onGeometryPositionChange(param) {\n    if (this._owner && this.isVisible()) {\n      this.show(param['target'].getCenter());\n    }\n  };\n\n  _proto.onMoving = function onMoving() {\n    if (this.isVisible() && this.getMap().isTransforming()) {\n      this._updatePosition();\n    }\n  };\n\n  _proto.onEvent = function onEvent() {\n    if (this.isVisible()) {\n      this._updatePosition();\n    }\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    if (this.isVisible()) {\n      this._setPosition();\n    }\n  };\n\n  _proto._updatePosition = function _updatePosition() {\n    var renderer = this.getMap()._getRenderer();\n\n    renderer.callInNextFrame(this._setPosition.bind(this));\n  };\n\n  _proto._setPosition = function _setPosition() {\n    var dom = this.getDOM();\n    if (!dom) return;\n    dom.style[TRANSITION] = null;\n    var p = this.getPosition();\n    this._pos = p;\n    dom.style[TRANSFORM] = this._toCSSTranslate(p) + ' scale(1)';\n  };\n\n  _proto._toCSSTranslate = function _toCSSTranslate(p) {\n    if (!p) {\n      return '';\n    }\n\n    if (Browser$1.any3d) {\n      var map = this.getMap(),\n          bearing = map ? map.getBearing() : 0,\n          pitch = map ? map.getPitch() : 0;\n      var r = '';\n\n      if (this.options['pitchWithMap'] && pitch) {\n        r += \" rotateX(\" + Math.round(pitch) + \"deg)\";\n      }\n\n      if (this.options['rotateWithMap'] && bearing) {\n        r += \" rotateZ(\" + Math.round(-bearing) + \"deg)\";\n      }\n\n      return 'translate3d(' + p.x + 'px,' + p.y + 'px, 0px)' + r;\n    } else {\n      return 'translate(' + p.x + 'px,' + p.y + 'px)';\n    }\n  };\n\n  UIComponent.isSupport = function isSupport(owner) {\n    if (owner && isFunction(owner.on) && isFunction(owner.off) && isFunction(owner.getCenter)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return UIComponent;\n}(Eventable(Class));\n\nUIComponent.mergeOptions(options$j);\nvar options$k = {\n  'containerClass': null,\n  'eventsPropagation': true,\n  'draggable': false,\n  'single': false,\n  'content': null\n};\nvar domEvents = 'mousedown ' + 'mouseup ' + 'mouseenter ' + 'mouseover ' + 'mouseout ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'keypress ' + 'touchstart ' + 'touchmove ' + 'touchend';\n\nvar UIMarker = function (_Handlerable) {\n  _inheritsLoose(UIMarker, _Handlerable);\n\n  function UIMarker(coordinate, options) {\n    var _this;\n\n    _this = _Handlerable.call(this, options) || this;\n    _this._markerCoord = new Coordinate(coordinate);\n    return _this;\n  }\n\n  var _proto = UIMarker.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'UIMarker';\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    this._markerCoord = coordinates;\n    this.fire('positionchange');\n\n    if (this.isVisible()) {\n      this._coordinate = this._markerCoord;\n\n      this._setPosition();\n    }\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._markerCoord;\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.show();\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto.onAdd = function onAdd() {\n    this.show();\n  };\n\n  _proto.show = function show() {\n    return _Handlerable.prototype.show.call(this, this._markerCoord);\n  };\n\n  _proto.flash = function flash$$1(interval, count, cb, context) {\n    return flash.call(this, interval, count, cb, context);\n  };\n\n  _proto.buildOn = function buildOn() {\n    var dom;\n\n    if (isString(this.options['content'])) {\n      dom = createEl('div');\n      dom.innerHTML = this.options['content'];\n    } else {\n      dom = this.options['content'];\n    }\n\n    if (this.options['containerClass']) {\n      dom.className = this.options['containerClass'];\n    }\n\n    this._registerDOMEvents(dom);\n\n    return dom;\n  };\n\n  _proto.getOffset = function getOffset() {\n    var size = this.getSize();\n    return new Point(-size.width / 2, -size.height / 2);\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    return 'center center';\n  };\n\n  _proto.onDomRemove = function onDomRemove() {\n    var dom = this.getDOM();\n\n    this._removeDOMEvents(dom);\n  };\n\n  _proto.isDragging = function isDragging() {\n    if (this['draggable']) {\n      return this['draggable'].isDragging();\n    }\n\n    return false;\n  };\n\n  _proto._registerDOMEvents = function _registerDOMEvents(dom) {\n    on(dom, domEvents, this._onDomEvents, this);\n  };\n\n  _proto._onDomEvents = function _onDomEvents(e) {\n    var event = this.getMap()._parseEvent(e, e.type);\n\n    this.fire(e.type, event);\n  };\n\n  _proto._removeDOMEvents = function _removeDOMEvents(dom) {\n    off(dom, domEvents, this._onDomEvents, this);\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var map = this.getMap();\n    var containerPoint = map.coordToContainerPoint(this.getCoordinates());\n    var size = this.getSize(),\n        width = size.width,\n        height = size.height;\n    var anchors = [map.containerPointToCoordinate(containerPoint.add(-width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(0, height / 2)), map.containerPointToCoordinate(containerPoint.add(0, -height / 2))];\n    return anchors;\n  };\n\n  return UIMarker;\n}(Handlerable(UIComponent));\n\nUIMarker.mergeOptions(options$k);\nvar EVENTS$1 = Browser$1.touch ? 'touchstart mousedown' : 'mousedown';\n\nvar UIMarkerDragHandler = function (_Handler) {\n  _inheritsLoose(UIMarkerDragHandler, _Handler);\n\n  function UIMarkerDragHandler(target) {\n    return _Handler.call(this, target) || this;\n  }\n\n  var _proto2 = UIMarkerDragHandler.prototype;\n\n  _proto2.addHooks = function addHooks() {\n    this.target.on(EVENTS$1, this._startDrag, this);\n  };\n\n  _proto2.removeHooks = function removeHooks() {\n    this.target.off(EVENTS$1, this._startDrag, this);\n  };\n\n  _proto2._startDrag = function _startDrag(param) {\n    var domEvent = param['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n      return;\n    }\n\n    if (this.isDragging()) {\n      return;\n    }\n\n    this.target.on('click', this._endDrag, this);\n    this._lastCoord = param['coordinate'];\n    this._lastPoint = param['containerPoint'];\n\n    this._prepareDragHandler();\n\n    this._dragHandler.onMouseDown(param['domEvent']);\n\n    this.target.fire('dragstart', param);\n  };\n\n  _proto2._prepareDragHandler = function _prepareDragHandler() {\n    this._dragHandler = new DragHandler(this.target.getDOM(), {\n      'cancelOn': this._cancelOn.bind(this),\n      'ignoreMouseleave': true\n    });\n\n    this._dragHandler.on('mousedown', this._onMouseDown, this);\n\n    this._dragHandler.on('dragging', this._dragging, this);\n\n    this._dragHandler.on('mouseup', this._endDrag, this);\n\n    this._dragHandler.enable();\n  };\n\n  _proto2._cancelOn = function _cancelOn(domEvent) {\n    var target = domEvent.srcElement || domEvent.target,\n        tagName = target.tagName.toLowerCase();\n\n    if (tagName === 'button' || tagName === 'input' || tagName === 'select' || tagName === 'option' || tagName === 'textarea') {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto2._onMouseDown = function _onMouseDown(param) {\n    stopPropagation(param['domEvent']);\n  };\n\n  _proto2._dragging = function _dragging(param) {\n    var target = this.target,\n        map = target.getMap(),\n        eventParam = map._parseEvent(param['domEvent']),\n        domEvent = eventParam['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1) {\n      return;\n    }\n\n    if (!this._isDragging) {\n      this._isDragging = true;\n      return;\n    }\n\n    var coord = eventParam['coordinate'],\n        point = eventParam['containerPoint'];\n\n    if (!this._lastCoord) {\n      this._lastCoord = coord;\n    }\n\n    if (!this._lastPoint) {\n      this._lastPoint = point;\n    }\n\n    var coordOffset = coord.sub(this._lastCoord),\n        pointOffset = point.sub(this._lastPoint);\n    this._lastCoord = coord;\n    this._lastPoint = point;\n    this.target.setCoordinates(this.target.getCoordinates().add(coordOffset));\n    eventParam['coordOffset'] = coordOffset;\n    eventParam['pointOffset'] = pointOffset;\n    target.fire('dragging', eventParam);\n  };\n\n  _proto2._endDrag = function _endDrag(param) {\n    var target = this.target,\n        map = target.getMap();\n\n    if (this._dragHandler) {\n      target.off('click', this._endDrag, this);\n\n      this._dragHandler.disable();\n\n      delete this._dragHandler;\n    }\n\n    delete this._lastCoord;\n    delete this._lastPoint;\n    this._isDragging = false;\n\n    if (!map) {\n      return;\n    }\n\n    var eventParam = map._parseEvent(param['domEvent']);\n\n    target.fire('dragend', eventParam);\n  };\n\n  _proto2.isDragging = function isDragging() {\n    if (!this._isDragging) {\n      return false;\n    }\n\n    return true;\n  };\n\n  return UIMarkerDragHandler;\n}(Handler$1);\n\nUIMarker.addInitHook('addHandler', 'draggable', UIMarkerDragHandler);\nvar options$l = {\n  'containerClass': 'maptalks-msgBox',\n  'autoPan': true,\n  'autoCloseOn': null,\n  'autoOpenOn': 'click',\n  'width': 300,\n  'minHeight': 120,\n  'custom': false,\n  'title': null,\n  'content': null\n};\n\nvar InfoWindow = function (_UIComponent) {\n  _inheritsLoose(InfoWindow, _UIComponent);\n\n  function InfoWindow() {\n    return _UIComponent.apply(this, arguments) || this;\n  }\n\n  var _proto = InfoWindow.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'InfoWindow';\n  };\n\n  _proto.addTo = function addTo(owner) {\n    if (owner instanceof Geometry) {\n      if (owner.getInfoWindow() && owner.getInfoWindow() !== this) {\n        owner.removeInfoWindow();\n      }\n\n      owner._infoWindow = this;\n    }\n\n    return _UIComponent.prototype.addTo.call(this, owner);\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.show(this._coordinate);\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto.setTitle = function setTitle(title) {\n    var old = title;\n    this.options['title'] = title;\n    this.fire('contentchange', {\n      'old': old,\n      'new': title\n    });\n\n    if (this.isVisible()) {\n      this.show(this._coordinate);\n    }\n\n    return this;\n  };\n\n  _proto.getTitle = function getTitle() {\n    return this.options['title'];\n  };\n\n  _proto.buildOn = function buildOn() {\n    if (this.options['custom']) {\n      if (isString(this.options['content'])) {\n        var _dom = createEl('div');\n\n        _dom.innerHTML = this.options['content'];\n        return _dom;\n      } else {\n        return this.options['content'];\n      }\n    }\n\n    var dom = createEl('div');\n\n    if (this.options['containerClass']) {\n      dom.className = this.options['containerClass'];\n    }\n\n    dom.style.width = this._getWindowWidth() + 'px';\n    dom.style.bottom = '0px';\n    var content = '<em class=\"maptalks-ico\"></em>';\n\n    if (this.options['title']) {\n      content += '<h2>' + this.options['title'] + '</h2>';\n    }\n\n    content += '<a href=\"javascript:void(0);\" class=\"maptalks-close\"></a><div class=\"maptalks-msgContent\"></div>';\n    dom.innerHTML = content;\n    var msgContent = dom.querySelector('.maptalks-msgContent');\n\n    if (isString(this.options['content'])) {\n      msgContent.innerHTML = this.options['content'];\n    } else {\n      msgContent.appendChild(this.options['content']);\n    }\n\n    this._onCloseBtnClick = this.hide.bind(this);\n    var closeBtn = dom.querySelector('.maptalks-close');\n    addDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n    return dom;\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    var size = this.getSize();\n    return size.width / 2 + 'px bottom';\n  };\n\n  _proto.getOffset = function getOffset() {\n    var size = this.getSize();\n    var o = new Point(-size['width'] / 2, 0);\n\n    if (!this.options['custom']) {\n      o._sub(4, 12);\n    } else {\n      o._sub(0, size['height']);\n    }\n\n    var owner = this.getOwner();\n\n    if (owner instanceof Marker || owner instanceof MultiPoint) {\n      var painter, markerSize;\n\n      if (owner instanceof Marker) {\n        painter = owner._getPainter();\n        markerSize = owner.getSize();\n      } else {\n        var children = owner.getGeometries();\n\n        if (!children || !children.length) {\n          return o;\n        }\n\n        painter = children[0]._getPainter();\n        markerSize = children[0].getSize();\n      }\n\n      if (painter) {\n        var fixExtent = painter.getFixedExtent();\n\n        o._add(fixExtent.xmax - markerSize.width / 2, fixExtent.ymin);\n      }\n    }\n\n    return o;\n  };\n\n  _proto.show = function show(coordinate) {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (!this.getMap().options['enableInfoWindow']) {\n      return this;\n    }\n\n    return _UIComponent.prototype.show.call(this, coordinate);\n  };\n\n  _proto.getEvents = function getEvents() {\n    if (!this.options['autoCloseOn']) {\n      return null;\n    }\n\n    var events = {};\n    events[this.options['autoCloseOn']] = this.hide;\n    return events;\n  };\n\n  _proto.getOwnerEvents = function getOwnerEvents() {\n    var owner = this.getOwner();\n\n    if (!this.options['autoOpenOn'] || !owner) {\n      return null;\n    }\n\n    var events = {};\n    events[this.options['autoOpenOn']] = this._onAutoOpen;\n    return events;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.onDomRemove();\n  };\n\n  _proto.onDomRemove = function onDomRemove() {\n    if (this._onCloseBtnClick) {\n      var dom = this.getDOM();\n      var closeBtn = dom.childNodes[2];\n      removeDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n      delete this._onCloseBtnClick;\n    }\n  };\n\n  _proto._onAutoOpen = function _onAutoOpen(e) {\n    var _this = this;\n\n    var owner = this.getOwner();\n    setTimeout(function () {\n      if (owner instanceof Marker || owner instanceof UIComponent) {\n        _this.show(owner.getCoordinates());\n      } else if (owner instanceof MultiPoint) {\n        _this.show(owner.findClosest(e.coordinate));\n      } else {\n        _this.show(e.coordinate);\n      }\n    }, 1);\n  };\n\n  _proto._getWindowWidth = function _getWindowWidth() {\n    var defaultWidth = 300;\n    var width = this.options['width'];\n\n    if (!width) {\n      width = defaultWidth;\n    }\n\n    return width;\n  };\n\n  return InfoWindow;\n}(UIComponent);\n\nInfoWindow.mergeOptions(options$l);\nvar options$m = {\n  'width': 0,\n  'height': 0,\n  'animation': 'fade',\n  'containerClass': 'maptalks-tooltip',\n  'showTimeout': 400\n};\n\nvar ToolTip = function (_UIComponent) {\n  _inheritsLoose(ToolTip, _UIComponent);\n\n  var _proto = ToolTip.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'ToolTip';\n  };\n\n  function ToolTip(content, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _UIComponent.call(this, options) || this;\n    _this._content = content;\n    return _this;\n  }\n\n  _proto.addTo = function addTo(owner) {\n    if (ToolTip.isSupport(owner)) {\n      owner.on('mousemove', this.onMouseMove, this);\n      owner.on('mouseout', this.onMouseOut, this);\n      return _UIComponent.prototype.addTo.call(this, owner);\n    } else {\n      throw new Error('Invalid geometry or UIMarker the tooltip is added to.');\n    }\n  };\n\n  _proto.setStyle = function setStyle$$1(cssName) {\n    this.options.containerClass = cssName;\n    return this;\n  };\n\n  _proto.getStyle = function getStyle() {\n    return this.options.containerClass;\n  };\n\n  _proto.getContent = function getContent() {\n    return this._content;\n  };\n\n  _proto.buildOn = function buildOn() {\n    var dom = createEl('div');\n    var options = this.options || {};\n\n    if (options.height) {\n      dom.style.height = options.height + 'px';\n    }\n\n    if (options.width) {\n      dom.style.width = options.width + 'px';\n    }\n\n    var cssName = options.containerClass || options.cssName;\n\n    if (!cssName && options.height) {\n      dom.style.lineHeight = options.height + 'px';\n    }\n\n    dom.innerHTML = \"<div class=\\\"\" + cssName + \"\\\">\" + this._content + \"</div>\";\n    return dom;\n  };\n\n  _proto.onMouseOut = function onMouseOut() {\n    clearTimeout(this._timeout);\n\n    if (this.isVisible()) {\n      this._removePrevDOM();\n    }\n  };\n\n  _proto.onMouseMove = function onMouseMove(e) {\n    var _this2 = this;\n\n    clearTimeout(this._timeout);\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var coord = map.locateByPoint(e.coordinate, -5, 25);\n\n    if (this.options['showTimeout'] === 0) {\n      this.show(coord);\n    } else {\n      this._timeout = setTimeout(function () {\n        if (map) {\n          _this2.show(coord);\n        }\n      }, this.options['showTimeout']);\n    }\n  };\n\n  _proto.onRemove = function onRemove() {\n    clearTimeout(this._timeout);\n\n    if (this._owner) {\n      this._owner.off('mouseover', this.onMouseOver, this);\n\n      this._owner.off('mouseout', this.onMouseOut, this);\n    }\n  };\n\n  return ToolTip;\n}(UIComponent);\n\nToolTip.mergeOptions(options$m);\nvar defaultOptions = {\n  'containerClass': 'maptalks-menu',\n  'animation': null,\n  'animationDelay': 10,\n  'animationOnHide': false,\n  'autoPan': false,\n  'width': 160,\n  'maxHeight': 0,\n  'custom': false,\n  'items': []\n};\n\nvar Menu = function (_UIComponent) {\n  _inheritsLoose(Menu, _UIComponent);\n\n  function Menu(options) {\n    return _UIComponent.call(this, options) || this;\n  }\n\n  var _proto = Menu.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'Menu';\n  };\n\n  _proto.addTo = function addTo(owner) {\n    if (owner._menu && owner._menu !== this) {\n      owner.removeMenu();\n    }\n\n    owner._menu = this;\n    return UIComponent.prototype.addTo.apply(this, arguments);\n  };\n\n  _proto.setItems = function setItems(items) {\n    this.options['items'] = items;\n    return this;\n  };\n\n  _proto.getItems = function getItems() {\n    return this.options['items'] || [];\n  };\n\n  _proto.buildOn = function buildOn() {\n    if (this.options['custom']) {\n      if (isString(this.options['items'])) {\n        var container = createEl('div');\n        container.innerHTML = this.options['items'];\n        return container;\n      } else {\n        return this.options['items'];\n      }\n    } else {\n      var dom = createEl('div');\n\n      if (this.options['containerClass']) {\n        addClass(dom, this.options['containerClass']);\n      }\n\n      dom.style.width = this._getMenuWidth() + 'px';\n\n      var menuItems = this._createMenuItemDom();\n\n      dom.appendChild(menuItems);\n      on(dom, 'contextmenu', preventDefault);\n      return dom;\n    }\n  };\n\n  _proto.getOffset = function getOffset() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var mapSize = this.getMap().getSize(),\n        p = this.getMap().viewPointToContainerPoint(this._getViewPoint()),\n        size = this.getSize();\n    var dx = 0,\n        dy = 0;\n\n    if (p.x + size['width'] > mapSize['width']) {\n      dx = -size['width'];\n    }\n\n    if (p.y + size['height'] > mapSize['height']) {\n      dy = -size['height'];\n    }\n\n    return new Point(dx, dy);\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    var p = this.getOffset()._multi(-1);\n\n    return p.x + 'px ' + p.y + 'px';\n  };\n\n  _proto.getEvents = function getEvents() {\n    return {\n      '_zoomstart _zoomend _movestart _dblclick _click': this._removePrevDOM\n    };\n  };\n\n  _proto._createMenuItemDom = function _createMenuItemDom() {\n    var me = this;\n    var map = this.getMap();\n    var ul = createEl('ul');\n    addClass(ul, 'maptalks-menu-items');\n    var items = this.getItems();\n\n    function onMenuClick(index) {\n      return function (e) {\n        var param = map._parseEvent(e, 'click');\n\n        param['target'] = me;\n        param['owner'] = me._owner;\n        param['index'] = index;\n\n        var result = this._callback(param);\n\n        if (result === false) {\n          return;\n        }\n\n        me.hide();\n      };\n    }\n\n    var item, itemDOM;\n\n    for (var i = 0, len = items.length; i < len; i++) {\n      item = items[i];\n\n      if (item === '-' || item === '_') {\n        itemDOM = createEl('li');\n        addClass(itemDOM, 'maptalks-menu-splitter');\n      } else {\n        itemDOM = createEl('li');\n        var itemTitle = item['item'];\n\n        if (isFunction(itemTitle)) {\n          itemTitle = itemTitle({\n            'owner': this._owner,\n            'index': i\n          });\n        }\n\n        itemDOM.innerHTML = itemTitle;\n        itemDOM._callback = item['click'];\n        on(itemDOM, 'click', onMenuClick(i));\n      }\n\n      ul.appendChild(itemDOM);\n    }\n\n    var maxHeight = this.options['maxHeight'] || 0;\n\n    if (maxHeight > 0) {\n      setStyle(ul, 'max-height: ' + maxHeight + 'px; overflow-y: auto;');\n    }\n\n    return ul;\n  };\n\n  _proto._getMenuWidth = function _getMenuWidth() {\n    var defaultWidth = 160;\n    var width = this.options['width'] || defaultWidth;\n    return width;\n  };\n\n  return Menu;\n}(UIComponent);\n\nMenu.mergeOptions(defaultOptions);\nvar Menuable = {\n  setMenu: function setMenu(options) {\n    this._menuOptions = options;\n\n    if (this._menu) {\n      this._menu.setOptions(options);\n    } else {\n      this.on('contextmenu', this._defaultOpenMenu, this);\n    }\n\n    return this;\n  },\n  openMenu: function openMenu(coordinate) {\n    var map = this instanceof Map$1 ? this : this.getMap();\n\n    if (!coordinate) {\n      coordinate = this.getCenter();\n    }\n\n    if (!this._menu) {\n      if (this._menuOptions && map) {\n        this._bindMenu(this._menuOptions);\n\n        this._menu.show(coordinate);\n      }\n    } else {\n      this._menu.show(coordinate);\n    }\n\n    return this;\n  },\n  setMenuItems: function setMenuItems(items) {\n    if (!this._menuOptions) {\n      this._menuOptions = {};\n    }\n\n    if (Array.isArray(items)) {\n      this._menuOptions['custom'] = false;\n    }\n\n    this._menuOptions['items'] = items;\n    this.setMenu(this._menuOptions);\n    return this;\n  },\n  getMenuItems: function getMenuItems() {\n    if (this._menu) {\n      return this._menu.getItems();\n    } else if (this._menuOptions) {\n      return this._menuOptions['items'] || [];\n    }\n\n    return [];\n  },\n  closeMenu: function closeMenu() {\n    if (this._menu) {\n      this._menu.hide();\n    }\n\n    return this;\n  },\n  removeMenu: function removeMenu() {\n    this.off('contextmenu', this._defaultOpenMenu, this);\n\n    this._unbindMenu();\n\n    delete this._menuOptions;\n    return this;\n  },\n  _bindMenu: function _bindMenu(options) {\n    this._menu = new Menu(options);\n\n    this._menu.addTo(this);\n\n    return this;\n  },\n  _unbindMenu: function _unbindMenu() {\n    if (this._menu) {\n      this.closeMenu();\n\n      this._menu.remove();\n\n      delete this._menu;\n    }\n\n    return this;\n  },\n  _defaultOpenMenu: function _defaultOpenMenu(param) {\n    if (this.listens('contextmenu') > 1) {\n      return true;\n    } else {\n      this.openMenu(param['coordinate']);\n      return false;\n    }\n  }\n};\nMap$1.include(Menuable);\nGeometry.include(Menuable);\nvar index$4 =\n/*#__PURE__*/\nObject.freeze({\n  UIComponent: UIComponent,\n  UIMarker: UIMarker,\n  InfoWindow: InfoWindow,\n  ToolTip: ToolTip,\n  Menuable: Menuable,\n  Menu: Menu\n});\n\nvar Control = function (_Eventable) {\n  _inheritsLoose(Control, _Eventable);\n\n  function Control(options) {\n    if (options && options['position'] && !isString(options['position'])) {\n      options['position'] = extend({}, options['position']);\n    }\n\n    return _Eventable.call(this, options) || this;\n  }\n\n  var _proto = Control.prototype;\n\n  _proto.addTo = function addTo(map) {\n    this.remove();\n\n    if (!map.options['control']) {\n      return this;\n    }\n\n    this._map = map;\n    var controlContainer = map._panels.control;\n    this.__ctrlContainer = createEl('div');\n    setStyle(this.__ctrlContainer, 'position:absolute;overflow:visible;');\n    this.update();\n    controlContainer.appendChild(this.__ctrlContainer);\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.fire('add', {\n      'dom': controlContainer\n    });\n    return this;\n  };\n\n  _proto.update = function update() {\n    this.__ctrlContainer.innerHTML = '';\n    this._controlDom = this.buildOn(this.getMap());\n\n    if (this._controlDom) {\n      this._updatePosition();\n\n      this.__ctrlContainer.appendChild(this._controlDom);\n    }\n\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    return this._map;\n  };\n\n  _proto.getPosition = function getPosition() {\n    return extend({}, this._parse(this.options['position']));\n  };\n\n  _proto.setPosition = function setPosition(position) {\n    if (isString(position)) {\n      this.options['position'] = position;\n    } else {\n      this.options['position'] = extend({}, position);\n    }\n\n    this._updatePosition();\n\n    return this;\n  };\n\n  _proto.getContainerPoint = function getContainerPoint() {\n    var position = this.getPosition();\n    var size = this.getMap().getSize();\n    var x, y;\n\n    if (!isNil(position['left'])) {\n      x = parseInt(position['left']);\n    } else if (!isNil(position['right'])) {\n      x = size['width'] - parseInt(position['right']);\n    }\n\n    if (!isNil(position['top'])) {\n      y = parseInt(position['top']);\n    } else if (!isNil(position['bottom'])) {\n      y = size['height'] - parseInt(position['bottom']);\n    }\n\n    return new Point(x, y);\n  };\n\n  _proto.getContainer = function getContainer() {\n    return this.__ctrlContainer;\n  };\n\n  _proto.getDOM = function getDOM() {\n    return this._controlDom;\n  };\n\n  _proto.show = function show() {\n    this.__ctrlContainer.style.display = '';\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.__ctrlContainer.style.display = 'none';\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    return this.__ctrlContainer && this.__ctrlContainer.style.display === '';\n  };\n\n  _proto.remove = function remove() {\n    if (!this._map) {\n      return this;\n    }\n\n    removeDomNode(this.__ctrlContainer);\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    delete this._map;\n    delete this.__ctrlContainer;\n    delete this._controlDom;\n    this.fire('remove');\n    return this;\n  };\n\n  _proto._parse = function _parse(position) {\n    var p = position;\n\n    if (isString(position)) {\n      p = Control['positions'][p];\n    }\n\n    return p;\n  };\n\n  _proto._updatePosition = function _updatePosition() {\n    var position = this.getPosition();\n\n    if (!position) {\n      position = {\n        'top': 20,\n        'left': 20\n      };\n    }\n\n    for (var p in position) {\n      if (position.hasOwnProperty(p)) {\n        position[p] = parseInt(position[p]);\n        this.__ctrlContainer.style[p] = position[p] + 'px';\n      }\n    }\n\n    this.fire('positionchange', {\n      'position': extend({}, position)\n    });\n  };\n\n  return Control;\n}(Eventable(Class));\n\nControl.positions = {\n  'top-left': {\n    'top': 20,\n    'left': 20\n  },\n  'top-right': {\n    'top': 20,\n    'right': 20\n  },\n  'bottom-left': {\n    'bottom': 20,\n    'left': 20\n  },\n  'bottom-right': {\n    'bottom': 20,\n    'right': 20\n  }\n};\nMap$1.mergeOptions({\n  'control': true\n});\nMap$1.include({\n  addControl: function addControl(control) {\n    if (this._containerDOM.getContext) {\n      return this;\n    }\n\n    control.addTo(this);\n    return this;\n  },\n  removeControl: function removeControl(control) {\n    if (!control || control.getMap() !== this) {\n      return this;\n    }\n\n    control.remove();\n    return this;\n  }\n});\nvar options$n = {\n  'position': {\n    'bottom': 0,\n    'left': 0\n  },\n  'content': '<a href=\"http://maptalks.org\" target=\"_blank\">maptalks</a>'\n};\nvar layerEvents = 'addlayer removelayer setbaselayer baselayerremove';\n\nvar Attribution = function (_Control) {\n  _inheritsLoose(Attribution, _Control);\n\n  function Attribution() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Attribution.prototype;\n\n  _proto.buildOn = function buildOn() {\n    this._attributionContainer = createEl('div');\n    this._attributionContainer.className = 'maptalks-attribution';\n\n    this._update();\n\n    return this._attributionContainer;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this.getMap().on(layerEvents, this._update, this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off(layerEvents, this._update, this);\n  };\n\n  _proto._update = function _update() {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var attributions = map._getLayers(function (layer) {\n      return layer.options['attribution'];\n    }).reverse().map(function (layer) {\n      return layer.options['attribution'];\n    });\n\n    var content = this.options['content'] + (attributions.length > 0 ? ' - ' + attributions.join(', ') : '');\n    this._attributionContainer.innerHTML = '<span style=\"padding:0px 4px\">' + content + '</span>';\n  };\n\n  return Attribution;\n}(Control);\n\nAttribution.mergeOptions(options$n);\nMap$1.mergeOptions({\n  'attribution': true\n});\nMap$1.addOnLoadHook(function () {\n  var a = this.options['attribution'] || this.options['attributionControl'];\n\n  if (a) {\n    this.attributionControl = new Attribution(a);\n    this.addControl(this.attributionControl);\n  }\n});\nvar options$o = {\n  'position': 'top-right',\n  'baseTitle': 'Base Layers',\n  'overlayTitle': 'Layers',\n  'excludeLayers': [],\n  'containerClass': 'maptalks-layer-switcher'\n};\n\nvar LayerSwitcher = function (_Control) {\n  _inheritsLoose(LayerSwitcher, _Control);\n\n  function LayerSwitcher() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = LayerSwitcher.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var container = this.container = createEl('div', this.options['containerClass']),\n        panel = this.panel = createEl('div', 'panel'),\n        button = this.button = createEl('button');\n    container.appendChild(button);\n    container.appendChild(panel);\n    return container;\n  };\n\n  _proto.onAdd = function onAdd() {\n    on(this.button, 'mouseover', this._show, this);\n    on(this.panel, 'mouseleave', this._hide, this);\n    on(this.getMap(), 'click', this._hide, this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    if (this.panel) {\n      off(this.button, 'mouseover', this._show, this);\n      off(this.panel, 'mouseleave', this._hide, this);\n      off(this.getMap(), 'click', this._hide, this);\n      removeDomNode(this.panel);\n      removeDomNode(this.button);\n      delete this.panel;\n      delete this.button;\n      delete this.container;\n    }\n  };\n\n  _proto._show = function _show() {\n    if (!hasClass(this.container, 'shown')) {\n      addClass(this.container, 'shown');\n\n      this._createPanel();\n    }\n  };\n\n  _proto._hide = function _hide(e) {\n    if (!this.panel.contains(e.toElement || e.relatedTarget)) {\n      setClass(this.container, this.options['containerClass']);\n    }\n  };\n\n  _proto._createPanel = function _createPanel() {\n    this.panel.innerHTML = '';\n    var ul = createEl('ul');\n    this.panel.appendChild(ul);\n\n    this._renderLayers(this.getMap(), ul);\n  };\n\n  _proto._renderLayers = function _renderLayers(map, elm) {\n    var base = map.getBaseLayer(),\n        layers = map.getLayers(),\n        len = layers.length;\n\n    if (base) {\n      var baseLayers = base.layers || [base],\n          li = createEl('li', 'group'),\n          ul = createEl('ul'),\n          label = createEl('label');\n      label.innerHTML = this.options['baseTitle'];\n      li.appendChild(label);\n\n      for (var i = 0, _len = baseLayers.length; i < _len; i++) {\n        var layer = baseLayers[i];\n\n        if (this._isExcluded(layer)) {\n          ul.appendChild(this._renderLayer(baseLayers[i], true));\n          li.appendChild(ul);\n          elm.appendChild(li);\n        }\n      }\n    }\n\n    if (len) {\n      var _li = createEl('li', 'group'),\n          _ul = createEl('ul'),\n          _label = createEl('label');\n\n      _label.innerHTML = this.options['overlayTitle'];\n\n      _li.appendChild(_label);\n\n      for (var _i = 0; _i < len; _i++) {\n        var _layer = layers[_i];\n\n        if (this._isExcluded(_layer)) {\n          _ul.appendChild(this._renderLayer(_layer));\n        }\n      }\n\n      _li.appendChild(_ul);\n\n      elm.appendChild(_li);\n    }\n  };\n\n  _proto._isExcluded = function _isExcluded(layer) {\n    var id = layer.getId(),\n        excludeLayers = this.options['excludeLayers'];\n    return !(excludeLayers.length && excludeLayers.indexOf(id) >= 0);\n  };\n\n  _proto._renderLayer = function _renderLayer(layer, isBase) {\n    var _this = this;\n\n    var li = createEl('li', 'layer'),\n        label = createEl('label'),\n        input = createEl('input'),\n        map = this.getMap();\n    var visible = layer.options['visible'];\n    layer.options['visible'] = true;\n    var enabled = layer.isVisible();\n    layer.options['visible'] = visible;\n    li.className = 'layer';\n\n    if (isBase) {\n      input.type = 'radio';\n      input.name = 'base';\n    } else {\n      input.type = 'checkbox';\n    }\n\n    input.checked = visible && enabled;\n\n    if (!enabled) {\n      input.setAttribute('disabled', 'disabled');\n    }\n\n    input.onchange = function (e) {\n      if (e.target.type === 'radio') {\n        var baseLayer = map.getBaseLayer(),\n            baseLayers = baseLayer.layers;\n\n        if (baseLayers) {\n          for (var i = 0, len = baseLayers.length; i < len; i++) {\n            var _baseLayer = baseLayers[i];\n\n            _baseLayer[_baseLayer === layer ? 'show' : 'hide']();\n          }\n        } else if (!baseLayer.isVisible()) {\n          baseLayer.show();\n        }\n\n        map._fireEvent('setbaselayer');\n      } else {\n        layer[e.target.checked ? 'show' : 'hide']();\n      }\n\n      _this.fire('layerchange', {\n        target: layer\n      });\n    };\n\n    li.appendChild(input);\n    label.innerHTML = layer.getId();\n    li.appendChild(label);\n    return li;\n  };\n\n  return LayerSwitcher;\n}(Control);\n\nLayerSwitcher.mergeOptions(options$o);\nMap$1.mergeOptions({\n  'layerSwitcherControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['layerSwitcherControl']) {\n    this.layerSwitcherControl = new LayerSwitcher(this.options['layerSwitcherControl']);\n    this.addControl(this.layerSwitcherControl);\n  }\n});\nvar options$p = {\n  'level': 4,\n  'position': {\n    'right': 1,\n    'bottom': 1\n  },\n  'size': [300, 200],\n  'maximize': true,\n  'symbol': {\n    'lineWidth': 3,\n    'lineColor': '#1bbc9b',\n    'polygonFill': '#1bbc9b',\n    'polygonOpacity': 0.4\n  },\n  'containerClass': 'maptalks-overview',\n  'buttonClass': 'maptalks-overview-button'\n};\n\nvar Overview = function (_Control) {\n  _inheritsLoose(Overview, _Control);\n\n  function Overview() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Overview.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var size = this.options['size'];\n\n    if (!this.options['maximize']) {\n      size = [0, 0];\n    }\n\n    var container = createEl('div');\n    var mapContainer = this.mapContainer = createEl('div');\n    mapContainer.style.width = size[0] + 'px';\n    mapContainer.style.height = size[1] + 'px';\n    mapContainer.className = this.options['containerClass'];\n    var button = this.button = createEl('div');\n    button.className = this.options['buttonClass'];\n    container.appendChild(mapContainer);\n    container.appendChild(button);\n    return container;\n  };\n\n  _proto.onAdd = function onAdd() {\n    if (this.options['maximize']) {\n      this._createOverview();\n    }\n\n    this.getMap().on('resize moving zooming rotate dragrotating viewchange', this._update, this).on('setbaselayer', this._updateBaseLayer, this).on('spatialreferencechange', this._updateSpatialReference, this);\n    on(this.button, 'click', this._onButtonClick, this);\n\n    this._updateButtonText();\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('resize moving zooming rotate dragrotating viewchange', this._update, this).off('setbaselayer', this._updateBaseLayer, this).off('spatialreferencechange', this._updateSpatialReference, this);\n\n    if (this._overview) {\n      this._overview.remove();\n\n      delete this._overview;\n      delete this._perspective;\n    }\n\n    off(this.button, 'click', this._onButtonClick, this);\n  };\n\n  _proto.maxmize = function maxmize() {\n    var size = this.options['size'];\n    var dom = this.mapContainer;\n    dom.style.width = size[0] + 'px';\n    dom.style.height = size[1] + 'px';\n\n    this._createOverview();\n\n    return this;\n  };\n\n  _proto.minimize = function minimize() {\n    if (this._overview) {\n      this._overview.remove();\n    }\n\n    delete this._overview;\n    delete this._perspective;\n    var dom = this.mapContainer;\n    dom.style.width = 0 + 'px';\n    dom.style.height = 0 + 'px';\n    return this;\n  };\n\n  _proto.getOverviewMap = function getOverviewMap() {\n    return this._overview;\n  };\n\n  _proto._onButtonClick = function _onButtonClick() {\n    if (!this._overview) {\n      this.maxmize();\n    } else {\n      this.minimize();\n    }\n\n    this._updateButtonText();\n  };\n\n  _proto._updateButtonText = function _updateButtonText() {\n    if (this._overview) {\n      this.button.innerHTML = '-';\n    } else {\n      this.button.innerHTML = '+';\n    }\n  };\n\n  _proto._createOverview = function _createOverview() {\n    var map = this.getMap(),\n        dom = this.mapContainer;\n    var options = map.config();\n    extend(options, {\n      'center': map.getCenter(),\n      'zoom': this._getOverviewZoom(),\n      'zoomAnimationDuration': 150,\n      'pitch': 0,\n      'bearing': 0,\n      'scrollWheelZoom': false,\n      'checkSize': false,\n      'doubleClickZoom': false,\n      'touchZoom': false,\n      'control': false,\n      'draggable': false,\n      'maxExtent': null\n    });\n    this._overview = new Map$1(dom, options);\n\n    this._updateBaseLayer();\n\n    this._perspective = new Polygon(this._getPerspectiveCoords(), {\n      'draggable': true,\n      'cursor': 'move',\n      'symbol': this.options['symbol']\n    }).on('dragend', this._onDragEnd, this);\n    new VectorLayer('perspective_layer', this._perspective).addTo(this._overview);\n    this.fire('load');\n  };\n\n  _proto._getOverviewZoom = function _getOverviewZoom() {\n    var map = this.getMap(),\n        zoom = map.getZoom(),\n        minZoom = map.getMinZoom(),\n        level = this.options['level'];\n\n    if (level > 0) {\n      for (var i = level; i > 0; i--) {\n        if (zoom - i >= minZoom) {\n          return zoom - i;\n        }\n      }\n    } else {\n      for (var _i = level; _i < 0; _i++) {\n        if (zoom - _i >= minZoom) {\n          return zoom - _i;\n        }\n      }\n    }\n\n    return zoom;\n  };\n\n  _proto._onDragEnd = function _onDragEnd() {\n    var center = this._perspective.getCenter();\n\n    this._overview.setCenter(center);\n\n    this.getMap().panTo(center);\n  };\n\n  _proto._getPerspectiveCoords = function _getPerspectiveCoords() {\n    var map = this.getMap();\n    return map.getContainerExtent().toArray().map(function (c) {\n      return map.containerPointToCoordinate(c);\n    });\n  };\n\n  _proto._update = function _update() {\n    if (!this._overview) {\n      return;\n    }\n\n    computeDomPosition(this._overview._containerDOM);\n\n    var coords = this._getPerspectiveCoords();\n\n    this._perspective.setCoordinates(coords);\n\n    this._overview.setCenterAndZoom(this.getMap().getCenter(), this._getOverviewZoom());\n  };\n\n  _proto._updateSpatialReference = function _updateSpatialReference() {\n    if (!this._overview) {\n      return;\n    }\n\n    var map = this.getMap();\n    var spatialRef = map.options['spatialReference'];\n\n    this._overview.setSpatialReference(spatialRef);\n  };\n\n  _proto._updateBaseLayer = function _updateBaseLayer() {\n    if (!this._overview) {\n      return;\n    }\n\n    var map = this.getMap(),\n        baseLayer = map.getBaseLayer();\n\n    if (!baseLayer) {\n      this._overview.setBaseLayer(null);\n\n      return;\n    }\n\n    var layers = baseLayer.layers;\n    var showIndex = 0;\n\n    if (layers) {\n      for (var i = 0, l = layers.length; i < l; i++) {\n        var _layer = layers[i];\n\n        if (_layer.isVisible()) {\n          showIndex = i;\n          break;\n        }\n      }\n    }\n\n    var json = baseLayer.toJSON();\n    var options = null;\n\n    if (layers) {\n      options = json.layers[showIndex].options;\n      options.visible = true;\n    } else {\n      options = json.options;\n    }\n\n    this._overview.setMinZoom(options.minZoom || null).setMaxZoom(options.maxZoom || null);\n\n    delete options.minZoom;\n    delete options.maxZoom;\n    delete json.options.canvas;\n    json.options.visible = true;\n    json.options.renderer = 'canvas';\n    var layer = Layer.fromJSON(json);\n\n    for (var p in baseLayer) {\n      if (isFunction(baseLayer[p]) && baseLayer.hasOwnProperty(p) && baseLayer[p] !== baseLayer.constructor.prototype[p]) {\n        layer[p] = baseLayer[p];\n      }\n    }\n\n    this._overview.setBaseLayer(layer);\n  };\n\n  return Overview;\n}(Control);\n\nOverview.mergeOptions(options$p);\nMap$1.mergeOptions({\n  'overviewControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['overviewControl']) {\n    this.overviewControl = new Overview(this.options['overviewControl']);\n    this.addControl(this.overviewControl);\n  }\n});\nvar options$q = {\n  'position': 'top-right',\n  'draggable': true,\n  'custom': false,\n  'content': '',\n  'closeButton': true\n};\n\nvar Panel = function (_Control) {\n  _inheritsLoose(Panel, _Control);\n\n  function Panel() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Panel.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var dom;\n\n    if (this.options['custom']) {\n      if (isString(this.options['content'])) {\n        dom = createEl('div');\n        dom.innerHTML = this.options['content'];\n      } else {\n        dom = this.options['content'];\n      }\n    } else {\n      dom = createEl('div', 'maptalks-panel');\n\n      if (this.options['closeButton']) {\n        var closeButton = createEl('a', 'maptalks-close');\n        closeButton.href = 'javascript:;';\n\n        closeButton.onclick = function () {\n          dom.style.display = 'none';\n        };\n\n        dom.appendChild(closeButton);\n      }\n\n      var panelContent = createEl('div', 'maptalks-panel-content');\n      panelContent.innerHTML = this.options['content'];\n      dom.appendChild(panelContent);\n    }\n\n    this.draggable = new DragHandler(dom, {\n      'cancelOn': this._cancelOn.bind(this),\n      'ignoreMouseleave': true\n    });\n    this.draggable.on('dragstart', this._onDragStart, this).on('dragging', this._onDragging, this).on('dragend', this._onDragEnd, this);\n\n    if (this.options['draggable']) {\n      this.draggable.enable();\n    }\n\n    return dom;\n  };\n\n  _proto.update = function update() {\n    if (this.draggable) {\n      this.draggable.disable();\n      delete this.draggable;\n    }\n\n    return Control.prototype.update.call(this);\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.update();\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto._cancelOn = function _cancelOn(domEvent) {\n    var target = domEvent.srcElement || domEvent.target,\n        tagName = target.tagName.toLowerCase();\n\n    if (tagName === 'button' || tagName === 'input' || tagName === 'select' || tagName === 'option' || tagName === 'textarea') {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto._onDragStart = function _onDragStart(param) {\n    this._startPos = param['mousePos'];\n    this._startPosition = extend({}, this.getPosition());\n    this.fire('dragstart', param);\n  };\n\n  _proto._onDragging = function _onDragging(param) {\n    var pos = param['mousePos'];\n    var offset = pos.sub(this._startPos);\n    var startPosition = this._startPosition;\n    var position = this.getPosition();\n\n    if (!isNil(position['top'])) {\n      position['top'] = parseInt(startPosition['top']) + offset.y;\n    }\n\n    if (!isNil(position['bottom'])) {\n      position['bottom'] = parseInt(startPosition['bottom']) - offset.y;\n    }\n\n    if (!isNil(position['left'])) {\n      position['left'] = parseInt(startPosition['left']) + offset.x;\n    }\n\n    if (!isNil(position['right'])) {\n      position['right'] = parseInt(startPosition['right']) - offset.x;\n    }\n\n    this.setPosition(position);\n    this.fire('dragging', param);\n  };\n\n  _proto._onDragEnd = function _onDragEnd(param) {\n    delete this._startPos;\n    delete this._startPosition;\n    this.fire('dragend', param);\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var map = this.getMap();\n    var containerPoint = this.getContainerPoint();\n    var dom = this.getDOM(),\n        width = parseInt(dom.clientWidth),\n        height = parseInt(dom.clientHeight);\n    var anchors = [map.containerPointToCoordinate(containerPoint.add(width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(width, height / 2)), map.containerPointToCoordinate(containerPoint.add(width / 2, height)), map.containerPointToCoordinate(containerPoint.add(0, height / 2))];\n    return anchors;\n  };\n\n  return Panel;\n}(Control);\n\nPanel.mergeOptions(options$q);\nvar options$r = {\n  'position': 'bottom-left',\n  'maxWidth': 100,\n  'metric': true,\n  'imperial': false,\n  'containerClass': null\n};\n\nvar Scale = function (_Control) {\n  _inheritsLoose(Scale, _Control);\n\n  function Scale() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Scale.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    this._map = map;\n    this._scaleContainer = createEl('div', this.options['containerClass']);\n\n    this._addScales();\n\n    map.on('zoomend', this._update, this);\n\n    if (this._map._loaded) {\n      this._update();\n    }\n\n    return this._scaleContainer;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('zoomend', this._update, this);\n  };\n\n  _proto._addScales = function _addScales() {\n    var css = 'border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 0px;' + 'color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden' + ';-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);';\n\n    if (this.options['metric']) {\n      this._mScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n    }\n\n    if (this.options['imperial']) {\n      this._iScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n    }\n  };\n\n  _proto._update = function _update() {\n    var map = this._map;\n    var maxMeters = map.pixelToDistance(this.options['maxWidth'], 0);\n\n    this._updateScales(maxMeters);\n  };\n\n  _proto._updateScales = function _updateScales(maxMeters) {\n    if (this.options['metric'] && maxMeters) {\n      this._updateMetric(maxMeters);\n    }\n\n    if (this.options['imperial'] && maxMeters) {\n      this._updateImperial(maxMeters);\n    }\n  };\n\n  _proto._updateMetric = function _updateMetric(maxMeters) {\n    var meters = this._getRoundNum(maxMeters),\n        label = meters < 1000 ? meters + ' m' : meters / 1000 + ' km';\n\n    this._updateScale(this._mScale, label, meters / maxMeters);\n  };\n\n  _proto._updateImperial = function _updateImperial(maxMeters) {\n    var maxFeet = maxMeters * 3.2808399;\n    var maxMiles, miles, feet;\n\n    if (maxFeet > 5280) {\n      maxMiles = maxFeet / 5280;\n      miles = this._getRoundNum(maxMiles);\n\n      this._updateScale(this._iScale, miles + ' mile', miles / maxMiles);\n    } else {\n      feet = this._getRoundNum(maxFeet);\n\n      this._updateScale(this._iScale, feet + ' feet', feet / maxFeet);\n    }\n  };\n\n  _proto._updateScale = function _updateScale(scale, text, ratio) {\n    scale['style']['width'] = Math.round(this.options['maxWidth'] * ratio) + 'px';\n    scale['innerHTML'] = text;\n  };\n\n  _proto._getRoundNum = function _getRoundNum(num) {\n    var pow10 = Math.pow(10, (Math.floor(num) + '').length - 1);\n    var d = num / pow10;\n    d = d >= 10 ? 10 : d >= 5 ? 5 : d >= 3 ? 3 : d >= 2 ? 2 : 1;\n    return pow10 * d;\n  };\n\n  return Scale;\n}(Control);\n\nScale.mergeOptions(options$r);\nMap$1.mergeOptions({\n  'scaleControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['scaleControl']) {\n    this.scaleControl = new Scale(this.options['scaleControl']);\n    this.addControl(this.scaleControl);\n  }\n});\nvar options$s = {\n  'height': 28,\n  'vertical': false,\n  'position': 'top-right',\n  'reverseMenu': false,\n  'items': {}\n};\n\nvar Toolbar = function (_Control) {\n  _inheritsLoose(Toolbar, _Control);\n\n  function Toolbar() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Toolbar.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    this._map = map;\n    var dom = createEl('div');\n    var ul = createEl('ul', 'maptalks-toolbar-hx');\n    dom.appendChild(ul);\n\n    if (this.options['vertical']) {\n      addClass(dom, 'maptalks-toolbar-vertical');\n    } else {\n      addClass(dom, 'maptalks-toolbar-horizonal');\n    }\n\n    var me = this;\n\n    function onButtonClick(fn, index, childIndex, targetDom) {\n      var item = me._getItems()[index];\n\n      return function (e) {\n        stopPropagation(e);\n        return fn({\n          'target': item,\n          'index': index,\n          'childIndex': childIndex,\n          'dom': targetDom\n        });\n      };\n    }\n\n    var items = this.options['items'];\n\n    if (isArrayHasData(items)) {\n      for (var i = 0, len = items.length; i < len; i++) {\n        var item = items[i];\n        var li = createEl('li');\n\n        if (this.options['height'] !== 28) {\n          li.style.lineHeight = this.options['height'] + 'px';\n        }\n\n        li.style.height = this.options['height'] + 'px';\n        li.style.cursor = 'pointer';\n\n        if (isHTML(item['item'])) {\n          li.style.textAlign = 'center';\n          var itemSize = measureDom('div', item['item']);\n          li.innerHTML = '<div style=\"margin-top:' + (this.options['height'] - itemSize['height']) / 2 + 'px;\">' + item['item'] + '</div>';\n        } else {\n          li.innerHTML = item['item'];\n        }\n\n        if (item['click']) {\n          on(li, 'click', onButtonClick(item['click'], i, null, li));\n        }\n\n        if (isArrayHasData(item['children'])) {\n          var dropMenu = this._createDropMenu(i);\n\n          li.appendChild(dropMenu);\n          li._menu = dropMenu;\n          on(li, 'mouseover', function () {\n            this._menu.style.display = '';\n          });\n          on(li, 'mouseout', function () {\n            this._menu.style.display = 'none';\n          });\n        }\n\n        ul.appendChild(li);\n      }\n    }\n\n    return dom;\n  };\n\n  _proto._createDropMenu = function _createDropMenu(index) {\n    var me = this;\n\n    function onButtonClick(fn, index, childIndex) {\n      var item = me._getItems()[index]['children'][childIndex];\n\n      return function (e) {\n        stopPropagation(e);\n        return fn({\n          'target': item,\n          'index': index,\n          'childIndex': childIndex\n        });\n      };\n    }\n\n    var menuDom = createEl('div', 'maptalks-dropMenu'),\n        items = this._getItems(),\n        len = items.length,\n        menuUL = createEl('ul'),\n        children = items[index]['children'];\n\n    if (index === len - 1 && children) {\n      menuDom.style.cssText = 'right: 0px;';\n      menuUL.style.cssText = 'right: 0px;position: absolute;';\n\n      if (this.options['reverseMenu']) {\n        menuUL.style.bottom = 0;\n      }\n    }\n\n    menuDom.appendChild(createEl('em', 'maptalks-ico'));\n    var liWidth = 0;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      var size = stringLength(children[i]['item'], '12px');\n\n      if (size.width > liWidth) {\n        liWidth = size.width;\n      }\n    }\n\n    for (var _i = 0, _l = children.length; _i < _l; _i++) {\n      var child = children[_i];\n      var li = createEl('li');\n      li.innerHTML = '<a href=\"javascript:;\">' + child['item'] + '</a>';\n      li.style.cursor = 'pointer';\n      li.style.width = liWidth + 24 + 'px';\n      on(li.childNodes[0], 'click', onButtonClick(child['click'], index, _i));\n      menuUL.appendChild(li);\n    }\n\n    if (this.options['vertical']) {\n      var width = liWidth < 95 ? 95 : liWidth;\n\n      if (this.options['reverseMenu']) {\n        menuDom.style.right = -(width + 10 * 2) + 'px';\n      } else {\n        menuDom.style.left = -(width + 10 * 2) + 'px';\n      }\n    } else if (this.options['reverseMenu']) {\n      menuDom.style.bottom = '28px';\n    } else {\n      menuDom.style.top = '28px';\n    }\n\n    menuDom.appendChild(menuUL);\n    menuDom.style.display = 'none';\n    return menuDom;\n  };\n\n  _proto._getItems = function _getItems() {\n    return this.options['items'] || [];\n  };\n\n  return Toolbar;\n}(Control);\n\nToolbar.mergeOptions(options$s);\nvar options$t = {\n  'position': 'top-left',\n  'slider': true,\n  'zoomLevel': true,\n  'seamless': false\n};\nvar UNIT = 10;\n\nvar Zoom = function (_Control) {\n  _inheritsLoose(Zoom, _Control);\n\n  function Zoom() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Zoom.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    var options = this.options;\n    var dom = createEl('div', 'maptalks-zoom');\n\n    if (options['zoomLevel']) {\n      var levelDOM = createEl('span', 'maptalks-zoom-zoomlevel');\n      dom.appendChild(levelDOM);\n      this._levelDOM = levelDOM;\n    }\n\n    var zoomDOM = createEl('div', 'maptalks-zoom-slider');\n    var zoomInButton = createEl('i', 'maptalks-zoom-zoomin el-icon-plus'); //    zoomInButton.href = 'javascript:;';\n    //    zoomInButton.innerHTML = '+';\n\n    zoomDOM.appendChild(zoomInButton);\n    this._zoomInButton = zoomInButton;\n\n    if (options['slider']) {\n      var box = createEl('div', 'maptalks-zoom-slider-box');\n      var ruler = createEl('div', 'maptalks-zoom-slider-ruler');\n      var reading = createEl('span', 'maptalks-zoom-slider-reading');\n      var dot = createEl('span', 'maptalks-zoom-slider-dot');\n      ruler.appendChild(reading);\n      box.appendChild(ruler);\n      box.appendChild(dot);\n      zoomDOM.appendChild(box);\n      this._sliderBox = box;\n      this._sliderRuler = ruler;\n      this._sliderReading = reading;\n      this._sliderDot = dot;\n    }\n\n    var zoomOutButton = createEl('i', 'maptalks-zoom-zoomout el-icon-minus'); //    zoomOutButton.href = 'javascript:;';\n    //    zoomOutButton.innerHTML = '-';\n\n    zoomDOM.appendChild(zoomOutButton);\n    this._zoomOutButton = zoomOutButton;\n    dom.appendChild(zoomDOM);\n    map.on('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n    this._update();\n\n    this._registerDomEvents();\n\n    return dom;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n    if (this._zoomInButton) {\n      off(this._zoomInButton, 'click', this._onZoomInClick, this);\n    }\n\n    if (this._zoomOutButton) {\n      off(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n    }\n\n    if (this._sliderRuler) {\n      off(this._sliderRuler, 'click', this._onClickRuler, this);\n      this.dotDragger.disable();\n      delete this.dotDragger;\n    }\n  };\n\n  _proto._update = function _update() {\n    var map = this.getMap();\n\n    if (this._sliderBox) {\n      var totalRange = (map.getMaxZoom() - map.getMinZoom()) * UNIT;\n      this._sliderBox.style.height = totalRange + 16 + 'px';\n      this._sliderRuler.style.height = totalRange + 8 + 'px';\n      this._sliderRuler.style.cursor = 'pointer';\n      var zoomRange = (map.getMaxZoom() - map.getZoom()) * UNIT;\n      this._sliderReading.style.height = (map.getZoom() - map.getMinZoom() + 1) * UNIT + 'px';\n      this._sliderDot.style.top = zoomRange + 'px';\n    }\n\n    this._updateText();\n  };\n\n  _proto._updateText = function _updateText() {\n    if (this._levelDOM) {\n      var map = this.getMap();\n      var zoom = map.getZoom();\n\n      if (!isInteger(zoom)) {\n        zoom = Math.floor(zoom * 10) / 10;\n      }\n\n      this._levelDOM.innerHTML = zoom;\n    }\n  };\n\n  _proto._registerDomEvents = function _registerDomEvents() {\n    if (this._zoomInButton) {\n      on(this._zoomInButton, 'click', this._onZoomInClick, this);\n    }\n\n    if (this._zoomOutButton) {\n      on(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n    }\n\n    if (this._sliderRuler) {\n      on(this._sliderRuler, 'click', this._onClickRuler, this);\n      this.dotDragger = new DragHandler(this._sliderDot, {\n        'ignoreMouseleave': true\n      });\n      this.dotDragger.on('dragstart', this._onDotDragstart, this).on('dragging dragend', this._onDotDrag, this).enable();\n    }\n  };\n\n  _proto._onZoomInClick = function _onZoomInClick(e) {\n    preventDefault(e);\n    this.getMap().zoomIn();\n  };\n\n  _proto._onZoomOutClick = function _onZoomOutClick(e) {\n    preventDefault(e);\n    this.getMap().zoomOut();\n  };\n\n  _proto._onClickRuler = function _onClickRuler(e) {\n    preventDefault(e);\n    var map = this.getMap(),\n        point = getEventContainerPoint(e, this._sliderRuler),\n        h = point.y;\n    var maxZoom = map.getMaxZoom(),\n        zoom = Math.floor(maxZoom - h / UNIT);\n    map.setZoom(zoom);\n  };\n\n  _proto._onDotDragstart = function _onDotDragstart(e) {\n    preventDefault(e.domEvent);\n\n    var map = this.getMap(),\n        origin = map.getSize().toPoint()._multi(1 / 2);\n\n    map.onZoomStart(map.getZoom(), origin);\n  };\n\n  _proto._onDotDrag = function _onDotDrag(e) {\n    preventDefault(e.domEvent);\n\n    var map = this.getMap(),\n        origin = map.getSize().toPoint()._multi(1 / 2),\n        point = getEventContainerPoint(e.domEvent, this._sliderRuler),\n        maxZoom = map.getMaxZoom(),\n        minZoom = map.getMinZoom();\n\n    var top = point.y,\n        z = maxZoom - top / UNIT;\n\n    if (maxZoom < z) {\n      z = maxZoom;\n      top = 0;\n    } else if (minZoom > z) {\n      z = minZoom;\n      top = (maxZoom - minZoom) * UNIT;\n    }\n\n    if (e.type === 'dragging') {\n      map.onZooming(z, origin, 1);\n    } else if (e.type === 'dragend') {\n      if (this.options['seamless']) {\n        map.onZoomEnd(z, origin);\n      } else {\n        map.onZoomEnd(Math.round(z), origin);\n      }\n    }\n\n    this._sliderDot.style.top = top + 'px';\n    this._sliderReading.style.height = (map.getZoom() - minZoom + 1) * UNIT + 'px';\n\n    this._updateText();\n  };\n\n  return Zoom;\n}(Control);\n\nZoom.mergeOptions(options$t);\nMap$1.mergeOptions({\n  'zoomControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['zoomControl']) {\n    this.zoomControl = new Zoom(this.options['zoomControl']);\n    this.addControl(this.zoomControl);\n  }\n});\nvar index$5 =\n/*#__PURE__*/\nObject.freeze({\n  Control: Control,\n  Attribution: Attribution,\n  LayerSwitcher: LayerSwitcher,\n  Overview: Overview,\n  Panel: Panel,\n  Scale: Scale,\n  Toolbar: Toolbar,\n  Zoom: Zoom\n});\n\nvar TileSystem = function () {\n  function TileSystem(sx, sy, ox, oy) {\n    if (Array.isArray(sx)) {\n      this.scale = {\n        x: sx[0],\n        y: sx[1]\n      };\n      this.origin = {\n        x: sx[2],\n        y: sx[3]\n      };\n    } else {\n      this.scale = {\n        x: sx,\n        y: sy\n      };\n      this.origin = {\n        x: ox,\n        y: oy\n      };\n    }\n  }\n\n  TileSystem.getDefault = function getDefault(projection) {\n    if (projection['code'].toLowerCase() === 'baidu') {\n      return 'baidu';\n    } else if (projection['code'].toLowerCase() === 'EPSG:4326'.toLowerCase()) {\n      return 'tms-global-geodetic';\n    } else if (projection['code'].toLowerCase() === 'identity') {\n      return [1, -1, 0, 0];\n    } else {\n      return 'web-mercator';\n    }\n  };\n\n  return TileSystem;\n}();\n\nvar semiCircum = 6378137 * Math.PI;\nextend(TileSystem, {\n  'web-mercator': new TileSystem([1, -1, -semiCircum, semiCircum]),\n  'tms-global-mercator': new TileSystem([1, 1, -semiCircum, -semiCircum]),\n  'tms-global-geodetic': new TileSystem([1, 1, -180, -90]),\n  'baidu': new TileSystem([1, 1, 0, 0])\n});\n\nvar TileConfig = function () {\n  function TileConfig(map, tileSystem, fullExtent, tileSize) {\n    this.map = map;\n    this.tileSize = tileSize;\n    this.fullExtent = fullExtent;\n    this.prepareTileInfo(tileSystem, fullExtent);\n    this._xScale = fullExtent['right'] >= fullExtent['left'] ? 1 : -1;\n    this._yScale = fullExtent['top'] >= fullExtent['bottom'] ? 1 : -1;\n    this._pointOrigin = map._prjToPoint(new Point(this.tileSystem['origin']), map.getGLZoom());\n    this._glRes = map.getResolution(map.getGLZoom());\n  }\n\n  var _proto = TileConfig.prototype;\n\n  _proto.prepareTileInfo = function prepareTileInfo(tileSystem, fullExtent) {\n    if (isString(tileSystem)) {\n      tileSystem = TileSystem[tileSystem.toLowerCase()];\n    } else if (Array.isArray(tileSystem)) {\n      tileSystem = new TileSystem(tileSystem);\n    }\n\n    if (!tileSystem) {\n      throw new Error('Invalid TileSystem');\n    }\n\n    this.tileSystem = tileSystem;\n    var a = fullExtent['right'] > fullExtent['left'] ? 1 : -1,\n        b = fullExtent['top'] > fullExtent['bottom'] ? -1 : 1,\n        c = tileSystem['origin']['x'],\n        d = tileSystem['origin']['y'];\n    this.transformation = new Transformation([a, b, c, d]);\n  };\n\n  _proto._getTileNum = function _getTileNum(point, res) {\n    var tileSystem = this.tileSystem,\n        tileSize = this['tileSize'],\n        delta = 1E-7;\n    var tileX = Math.floor(delta * tileSystem['scale']['x'] + point.x / (tileSize['width'] * res));\n    var tileY = Math.ceil(delta * tileSystem['scale']['y'] + point.y / (tileSize['height'] * res));\n    return {\n      'x': tileSystem['scale']['x'] * tileX,\n      'y': tileSystem['scale']['y'] * tileY\n    };\n  };\n\n  _proto.getTileIndex = function getTileIndex(pCoord, res, repeatWorld) {\n    var tileSystem = this.tileSystem;\n    var point = this.transformation.transform(pCoord, 1);\n\n    var tileIndex = this._getTileNum(point, res);\n\n    if (tileSystem['scale']['x'] < 0) {\n      tileIndex['x'] -= 1;\n    }\n\n    if (tileSystem['scale']['y'] > 0) {\n      tileIndex['y'] -= 1;\n    }\n\n    return this.getNeighorTileIndex(tileIndex['x'], tileIndex['y'], 0, 0, res, repeatWorld);\n  };\n\n  _proto.getNeighorTileIndex = function getNeighorTileIndex(tileX, tileY, offsetX, offsetY, res, repeatWorld) {\n    var tileSystem = this.tileSystem;\n    var x = tileX + tileSystem['scale']['x'] * offsetX;\n    var y = tileY - tileSystem['scale']['y'] * offsetY;\n    var out = false;\n    var idx = x;\n    var idy = y;\n\n    var ext = this._getTileFullIndex(res);\n\n    if (repeatWorld) {\n      if (repeatWorld === true || repeatWorld === 'x') {\n        if (ext['xmax'] === ext['xmin']) {\n          x = ext['xmin'];\n        } else if (x < ext['xmin']) {\n          x = ext['xmax'] - (ext['xmin'] - x) % (ext['xmax'] - ext['xmin']);\n\n          if (x === ext['xmax']) {\n            x = ext['xmin'];\n          }\n        } else if (x >= ext['xmax']) {\n          x = ext['xmin'] + (x - ext['xmin']) % (ext['xmax'] - ext['xmin']);\n        }\n      }\n\n      if (repeatWorld === true || repeatWorld === 'y') {\n        if (ext['ymax'] === ext['ymin']) {\n          y = ext['ymin'];\n        } else if (y >= ext['ymax']) {\n          y = ext['ymin'] + (y - ext['ymin']) % (ext['ymax'] - ext['ymin']);\n        } else if (y < ext['ymin']) {\n          y = ext['ymax'] - (ext['ymin'] - y) % (ext['ymax'] - ext['ymin']);\n\n          if (y === ext['ymax']) {\n            y = ext['ymin'];\n          }\n        }\n      }\n    }\n\n    if (x < ext['xmin'] || x > ext['xmax'] || y > ext['ymax'] || y < ext['ymin']) {\n      out = true;\n    }\n\n    return {\n      'x': x,\n      'y': y,\n      'idx': idx,\n      'idy': idy,\n      out: out\n    };\n  };\n\n  _proto._getTileFullIndex = function _getTileFullIndex(res) {\n    if (!this._tileFullIndex) {\n      this._tileFullIndex = {};\n    }\n\n    if (this._tileFullIndex[res]) {\n      return this._tileFullIndex[res];\n    }\n\n    var ext = this.fullExtent;\n    var transformation = this.transformation;\n\n    var nwIndex = this._getTileNum(transformation.transform(new Coordinate(ext['left'], ext['top']), 1), res);\n\n    var seIndex = this._getTileNum(transformation.transform(new Coordinate(ext['right'], ext['bottom']), 1), res);\n\n    var tileSystem = this.tileSystem;\n\n    if (tileSystem['scale']['x'] < 0) {\n      nwIndex.x -= 1;\n      seIndex.x -= 1;\n    }\n\n    if (tileSystem['scale']['y'] > 0) {\n      nwIndex.y -= 1;\n      seIndex.y -= 1;\n    }\n\n    this._tileFullIndex[res] = new Extent(nwIndex, seIndex);\n    return this._tileFullIndex[res];\n  };\n\n  _proto.getTilePrjNW = function getTilePrjNW(tileX, tileY, res) {\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * res * tileSize['height'];\n    var x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * res * tileSize['width'];\n    return new Coordinate(x, y);\n  };\n\n  _proto.getTilePointNW = function getTilePointNW(tileX, tileY, res) {\n    var scale = this._glRes / res;\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = this._pointOrigin.y * scale + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * tileSize['height'];\n    var x = this._pointOrigin.x * scale + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * tileSize['width'];\n    return new Point(x, y);\n  };\n\n  _proto.getTilePrjSE = function getTilePrjSE(tileX, tileY, res) {\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * res * tileSize['height'];\n    var x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * res * tileSize['width'];\n    return new Coordinate(x, y);\n  };\n\n  _proto.getTilePointSE = function getTilePointSE(tileX, tileY, res) {\n    var scale = this._glRes / res;\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = this._pointOrigin.y * scale + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * tileSize['height'];\n    var x = this._pointOrigin.x * scale + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * tileSize['width'];\n    return new Point(x, y);\n  };\n\n  _proto.getTilePrjExtent = function getTilePrjExtent(tileX, tileY, res) {\n    var nw = this.getTilePrjNW(tileX, tileY, res),\n        se = this.getTilePrjSE(tileX, tileY, res);\n    return new Extent(nw, se);\n  };\n\n  return TileConfig;\n}();\n\nvar planes = [];\n\nfor (var i = 0; i < 6; i++) {\n  planes[i] = [];\n}\n\nvar p = [];\n\nfunction intersectsBox(matrix, box, mask) {\n  setPlanes(matrix);\n\n  for (var i = 0; i < 6; i++) {\n    if (mask && mask.charAt(i) === '0') {\n      continue;\n    }\n\n    var plane = planes[i];\n    p[0] = plane[0] > 0 ? box[1][0] : box[0][0];\n    p[1] = plane[1] > 0 ? box[1][1] : box[0][1];\n    p[2] = plane[2] > 0 ? box[1][2] : box[0][2];\n\n    if (distanceToPoint(plane, p) < 0) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction setPlanes(m) {\n  var me = m;\n  var me0 = me[0],\n      me1 = me[1],\n      me2 = me[2],\n      me3 = me[3];\n  var me4 = me[4],\n      me5 = me[5],\n      me6 = me[6],\n      me7 = me[7];\n  var me8 = me[8],\n      me9 = me[9],\n      me10 = me[10],\n      me11 = me[11];\n  var me12 = me[12],\n      me13 = me[13],\n      me14 = me[14],\n      me15 = me[15];\n  setComponents(planes[0], me3 - me0, me7 - me4, me11 - me8, me15 - me12);\n  setComponents(planes[1], me3 + me0, me7 + me4, me11 + me8, me15 + me12);\n  setComponents(planes[2], me3 + me1, me7 + me5, me11 + me9, me15 + me13);\n  setComponents(planes[3], me3 - me1, me7 - me5, me11 - me9, me15 - me13);\n  setComponents(planes[4], me3 - me2, me7 - me6, me11 - me10, me15 - me14);\n  setComponents(planes[5], me3 + me2, me7 + me6, me11 + me10, me15 + me14);\n}\n\nfunction setComponents(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  var length = distance$1(out);\n  out[0] /= length;\n  out[1] /= length;\n  out[2] /= length;\n  out[3] /= length;\n  return out;\n}\n\nfunction distanceToPoint(plane, p) {\n  return plane[0] * p[0] + plane[1] * p[1] + plane[2] * p[2] + plane[3];\n}\n\nfunction distance$1(v3) {\n  return Math.sqrt(v3[0] * v3[0] + v3[1] * v3[1] + v3[2] * v3[2]);\n}\n\nvar isSetAvailable = typeof Set !== 'undefined';\n\nvar TileHashset = function () {\n  function TileHashset() {\n    this._table = isSetAvailable ? new Set() : {};\n  }\n\n  var _proto = TileHashset.prototype;\n\n  _proto.add = function add$$1(key) {\n    if (isSetAvailable) {\n      this._table.add(key);\n    } else {\n      this._table[key] = true;\n    }\n  };\n\n  _proto.has = function has(key) {\n    if (isSetAvailable) {\n      return this._table.has(key);\n    } else {\n      return this._table[key];\n    }\n  };\n\n  _proto.reset = function reset() {\n    if (isSetAvailable) {\n      this._table.clear();\n    } else {\n      this._table = {};\n    }\n  };\n\n  return TileHashset;\n}();\n\nvar options$u = {\n  'urlTemplate': null,\n  'subdomains': null,\n  'repeatWorld': true,\n  'background': true,\n  'backgroundZoomDiff': 6,\n  'loadingLimitOnInteracting': 3,\n  'tileRetryCount': 0,\n  'placeholder': false,\n  'crossOrigin': null,\n  'tileSize': [256, 256],\n  'offset': [0, 0],\n  'tileSystem': null,\n  'fadeAnimation': !IS_NODE,\n  'debug': false,\n  'spatialReference': null,\n  'maxCacheSize': 256,\n  'renderer': function () {\n    return Browser$1.webgl ? 'gl' : 'canvas';\n  }(),\n  'clipByPitch': true,\n  'maxAvailableZoom': null,\n  'cascadeTiles': true,\n  'zoomOffset': 0\n};\nvar URL_PATTERN = /\\{ *([\\w_]+) *\\}/g;\nvar TEMP_POINT = new Point(0, 0);\nvar TEMP_POINT0$3 = new Point(0, 0);\nvar TEMP_POINT1$1 = new Point(0, 0);\nvar TEMP_POINT2 = new Point(0, 0);\nvar TEMP_POINT3 = new Point(0, 0);\nvar TEMP_POINT4 = new Point(0, 0);\nvar TEMP_POINT5 = new Point(0, 0);\nvar TEMP_POINT6 = new Point(0, 0);\nvar TILE_BOX = [[0, 0, 0], [0, 0, 0]];\nvar ARR3 = [];\n\nvar TileLayer = function (_Layer) {\n  _inheritsLoose(TileLayer, _Layer);\n\n  function TileLayer() {\n    return _Layer.apply(this, arguments) || this;\n  }\n\n  TileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'TileLayer') {\n      return null;\n    }\n\n    return new TileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  var _proto2 = TileLayer.prototype;\n\n  _proto2.getTileSize = function getTileSize() {\n    var size = this.options['tileSize'];\n\n    if (isNumber(size)) {\n      size = [size, size];\n    }\n\n    return new Size(size);\n  };\n\n  _proto2.getTiles = function getTiles(z, parentLayer) {\n    var map = this.getMap();\n    var pitch = map.getPitch();\n    var parentRenderer = parentLayer && parentLayer.getRenderer();\n    var mapExtent = map.getContainerExtent();\n    var tileGrids = [];\n    var count = 0;\n    var minZoom = this.getMinZoom();\n    var cascadePitch0 = map.options['cascadePitches'][0];\n    var cascadePitch1 = map.options['cascadePitches'][1];\n    var visualHeight1 = Math.floor(map._getVisualHeight(cascadePitch1));\n    var tileZoom = isNil(z) ? this._getTileZoom(map.getZoom()) : z;\n    this._visitedTiles = new TileHashset();\n    this._coordCache = {};\n\n    if (!isNil(z) || !this.options['cascadeTiles'] || pitch <= cascadePitch0 || !isNil(minZoom) && tileZoom <= minZoom) {\n      var containerExtent = pitch <= cascadePitch1 ? mapExtent : new PointExtent(0, map.height - visualHeight1, map.width, map.height);\n\n      var _currentTiles = this._getTiles(tileZoom, containerExtent, 2, parentRenderer);\n\n      if (_currentTiles) {\n        count += _currentTiles.tiles.length;\n        tileGrids.push(_currentTiles);\n      }\n\n      return {\n        tileGrids: tileGrids,\n        count: count\n      };\n    }\n\n    var visualHeight0 = Math.floor(map._getVisualHeight(cascadePitch0));\n    var extent0 = new PointExtent(0, map.height - visualHeight0, map.width, map.height);\n\n    var currentTiles = this._getTiles(tileZoom, extent0, 0, parentRenderer);\n\n    count += currentTiles ? currentTiles.tiles.length : 0;\n    tileGrids.push(currentTiles);\n    var cascadeHeight = extent0.ymin;\n    var d = map.getSpatialReference().getZoomDirection();\n    var cascadeLevels = d;\n    var cascadeTiles1;\n\n    if (pitch > cascadePitch1) {\n      if (tileZoom - cascadeLevels <= minZoom) {\n        cascadeLevels = 0;\n      }\n\n      var extent1 = new PointExtent(0, map.height - visualHeight1, map.width, cascadeHeight);\n      cascadeTiles1 = this._getTiles(tileZoom - cascadeLevels, extent1, 1, parentRenderer);\n      count += cascadeTiles1 ? cascadeTiles1.tiles.length : 0;\n      cascadeHeight = extent1.ymin;\n      cascadeLevels += 4 * d;\n    }\n\n    var cascadeTiles2;\n\n    if (tileZoom - cascadeLevels >= minZoom) {\n      var extent2 = new PointExtent(0, mapExtent.ymin, map.width, cascadeHeight);\n      cascadeTiles2 = this._getTiles(tileZoom - cascadeLevels, extent2, 2, parentRenderer);\n      count += cascadeTiles2 ? cascadeTiles2.tiles.length : 0;\n      tileGrids.push(cascadeTiles2);\n    }\n\n    if (cascadeTiles1 && cascadeTiles2) {\n      tileGrids[1] = cascadeTiles2;\n      tileGrids[2] = cascadeTiles1;\n    }\n\n    return {\n      tileGrids: tileGrids,\n      count: count\n    };\n  };\n\n  _proto2.getTileUrl = function getTileUrl(x, y, z) {\n    var urlTemplate = this.options['urlTemplate'];\n    var domain = '';\n\n    if (this.options['subdomains']) {\n      var subdomains = this.options['subdomains'];\n\n      if (isArrayHasData(subdomains)) {\n        var length$$1 = subdomains.length;\n        var s = (x + y) % length$$1;\n\n        if (s < 0) {\n          s = 0;\n        }\n\n        domain = subdomains[s];\n      }\n    }\n\n    if (isFunction(urlTemplate)) {\n      return urlTemplate(x, y, z, domain);\n    }\n\n    var data = {\n      'x': x,\n      'y': y,\n      'z': z,\n      's': domain\n    };\n    return urlTemplate.replace(URL_PATTERN, function (str, key) {\n      var value = data[key];\n\n      if (value === undefined) {\n        throw new Error('No value provided for variable ' + str);\n      } else if (typeof value === 'function') {\n        value = value(data);\n      }\n\n      return value;\n    });\n  };\n\n  _proto2.clear = function clear() {\n    if (this._renderer) {\n      this._renderer.clear();\n    }\n\n    this.fire('clear');\n    return this;\n  };\n\n  _proto2.toJSON = function toJSON() {\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'options': this.config()\n    };\n    return profile;\n  };\n\n  _proto2.getSpatialReference = function getSpatialReference() {\n    var map = this.getMap();\n\n    if (map && (!this.options['spatialReference'] || SpatialReference.equals(this.options['spatialReference'], map.options['spatialReference']))) {\n      return map.getSpatialReference();\n    }\n\n    this._sr = this._sr || new SpatialReference(this.options['spatialReference']);\n\n    if (this._srMinZoom === undefined) {\n      this._srMinZoom = this._sr.getMinZoom();\n      this._srMaxZoom = this._sr.getMaxZoom();\n    }\n\n    return this._sr;\n  };\n\n  _proto2.getMinZoom = function getMinZoom() {\n    var sr = this.getSpatialReference();\n\n    if (sr !== this.getMap().getSpatialReference()) {\n      return Math.max(_Layer.prototype.getMinZoom.call(this), this._srMinZoom);\n    }\n\n    return _Layer.prototype.getMinZoom.call(this);\n  };\n\n  _proto2.getMaxZoom = function getMaxZoom() {\n    var sr = this.getSpatialReference();\n\n    if (sr !== this.getMap().getSpatialReference()) {\n      return Math.min(_Layer.prototype.getMaxZoom.call(this), this._srMaxZoom);\n    }\n\n    return _Layer.prototype.getMaxZoom.call(this);\n  };\n\n  _proto2._getTileZoom = function _getTileZoom(zoom) {\n    if (!isInteger(zoom)) {\n      zoom = Math.round(zoom);\n    }\n\n    var maxZoom = this.options['maxAvailableZoom'];\n\n    if (!isNil(maxZoom) && zoom > maxZoom) {\n      zoom = maxZoom;\n    }\n\n    return zoom;\n  };\n\n  _proto2._getTiles = function _getTiles(tileZoom, containerExtent, cascadeLevel, parentRenderer) {\n    var _this = this;\n\n    var map = this.getMap();\n    var z = tileZoom;\n    var frustumMatrix = map.projViewMatrix;\n\n    if (cascadeLevel < 2) {\n      if (cascadeLevel === 0) {\n        z -= 1;\n      }\n\n      frustumMatrix = cascadeLevel === 0 ? map.cascadeFrustumMatrix0 : cascadeLevel === 1 ? map.cascadeFrustumMatrix1 : map.projViewMatrix;\n    }\n\n    var zoom = z + this.options['zoomOffset'];\n\n    var offset = this._getTileOffset(zoom),\n        hasOffset = offset[0] || offset[1];\n\n    var emptyGrid = {\n      'zoom': z,\n      'extent': null,\n      'offset': offset,\n      'tiles': []\n    };\n\n    if (zoom < 0) {\n      return emptyGrid;\n    }\n\n    var minZoom = this.getMinZoom(),\n        maxZoom = this.getMaxZoom();\n\n    if (!map || !this.isVisible() || !map.width || !map.height) {\n      return emptyGrid;\n    }\n\n    if (!isNil(minZoom) && z < minZoom || !isNil(maxZoom) && z > maxZoom) {\n      return emptyGrid;\n    }\n\n    var tileConfig = this._getTileConfig();\n\n    if (!tileConfig) {\n      return emptyGrid;\n    }\n\n    var sr = this.getSpatialReference();\n    var mapSR = map.getSpatialReference();\n    var res = sr.getResolution(zoom);\n    var glScale = map.getGLScale(z);\n    var repeatWorld = sr === mapSR && this.options['repeatWorld'];\n    var extent2d = containerExtent.convertTo(function (c) {\n      var result;\n\n      if (c.y > 0 && c.y < map.height) {\n        var key = (c.x === 0 ? 0 : 1) + c.y;\n\n        if (!_this._coordCache[key]) {\n          _this._coordCache[key] = map._containerPointToPoint(c);\n        }\n\n        result = _this._coordCache[key];\n      }\n\n      result = map._containerPointToPoint(c, undefined, TEMP_POINT);\n      return result;\n    });\n\n    extent2d._add(offset);\n\n    var maskExtent = this._getMask2DExtent();\n\n    if (maskExtent) {\n      var intersection = maskExtent.intersection(extent2d);\n\n      if (!intersection) {\n        return emptyGrid;\n      }\n\n      containerExtent = intersection.convertTo(function (c) {\n        return map._pointToContainerPoint(c, undefined, 0, TEMP_POINT);\n      });\n    }\n\n    var prjCenter = map._containerPointToPrj(containerExtent.getCenter(), TEMP_POINT0$3);\n\n    var centerPoint = map._prjToPoint(prjCenter, undefined, TEMP_POINT1$1);\n\n    var c;\n\n    if (hasOffset) {\n      c = this._project(map._pointToPrj(centerPoint._add(offset), undefined, TEMP_POINT1$1), TEMP_POINT1$1);\n    } else {\n      c = this._project(prjCenter, TEMP_POINT1$1);\n    }\n\n    TEMP_POINT2.x = extent2d.xmin;\n    TEMP_POINT2.y = extent2d.ymax;\n    TEMP_POINT3.x = extent2d.xmax;\n    TEMP_POINT3.y = extent2d.ymin;\n\n    var pmin = this._project(map._pointToPrj(TEMP_POINT2, undefined, TEMP_POINT2), TEMP_POINT2);\n\n    var pmax = this._project(map._pointToPrj(TEMP_POINT3, undefined, TEMP_POINT3), TEMP_POINT3);\n\n    var centerTile = tileConfig.getTileIndex(c, res, repeatWorld);\n    var ltTile = tileConfig.getTileIndex(pmin, res, repeatWorld);\n    var rbTile = tileConfig.getTileIndex(pmax, res, repeatWorld);\n    var top = Math.ceil(Math.abs(centerTile.idy - ltTile.idy)),\n        left = Math.ceil(Math.abs(centerTile.idx - ltTile.idx)),\n        bottom = Math.ceil(Math.abs(centerTile.idy - rbTile.idy)),\n        right = Math.ceil(Math.abs(centerTile.idx - rbTile.idx));\n    var allCount = (top + bottom + 1) * (left + right + 1);\n    var tileSize = this.getTileSize();\n\n    var renderer = this.getRenderer() || parentRenderer,\n        scale = this._getTileConfig().tileSystem.scale;\n\n    var tiles = [],\n        extent = new PointExtent();\n\n    for (var i = -top; i <= bottom; i++) {\n      var j = -left;\n      var leftVisitEnd = -Infinity;\n      var rightVisitEnd = false;\n\n      while (j >= leftVisitEnd && j <= right) {\n        var idx = tileConfig.getNeighorTileIndex(centerTile.idx, centerTile.idy, j, i, res, repeatWorld);\n\n        if (leftVisitEnd === -Infinity) {\n          j++;\n        } else {\n          j--;\n        }\n\n        var tileId = this._getTileId(idx.idx, idx.idy, z);\n\n        if (idx.out || this._visitedTiles && this._visitedTiles.has(tileId)) {\n          continue;\n        }\n\n        var tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n\n        if (tileInfo) {\n          tileInfo = tileInfo.info;\n        }\n\n        var p = void 0;\n\n        if (tileInfo) {\n          var _tileInfo = tileInfo,\n              point0 = _tileInfo.point0;\n          p = tileInfo.point.set(point0.x, point0.y);\n        } else if (!this._hasOwnSR) {\n          p = tileConfig.getTilePointNW(idx.x, idx.y, res);\n        } else {\n          var pnw = tileConfig.getTilePrjNW(idx.x, idx.y, res);\n          p = map._prjToPoint(this._unproject(pnw, TEMP_POINT3), z);\n        }\n\n        var width = void 0,\n            height = void 0;\n\n        if (sr === mapSR) {\n          width = tileSize.width;\n          height = tileSize.height;\n        } else {\n          var pp = void 0;\n\n          if (!this._hasOwnSR) {\n            pp = tileConfig.getTilePointSE(idx.x, idx.y, res);\n          } else {\n            var pse = tileConfig.getTilePrjSE(idx.x, idx.y, res);\n            pp = map._prjToPoint(this._unproject(pse, TEMP_POINT3), z, TEMP_POINT3);\n          }\n\n          width = Math.ceil(Math.abs(pp.x - p.x));\n          height = Math.ceil(Math.abs(pp.y - p.y));\n        }\n\n        var dx = scale.x * (idx.idx - idx.x) * width,\n            dy = scale.y * (idx.idy - idx.y) * height;\n\n        if (dx || dy) {\n          p._add(dx, dy);\n        }\n\n        if (hasOffset) {\n          p._sub(offset);\n        }\n\n        var tileExtent = tileInfo && tileInfo.extent2d || new PointExtent(p.x, p.y, p.x + width, p.y - height);\n\n        if (allCount <= 4 || rightVisitEnd || this._isTileInExtent(frustumMatrix, tileExtent, glScale)) {\n          if (this._visitedTiles && cascadeLevel === 0) {\n            this._visitedTiles.add(tileId);\n          }\n\n          if (cascadeLevel === 0) {\n            this._splitTiles(frustumMatrix, tiles, renderer, idx, z + 1, tileExtent, offset, dx, dy);\n\n            extent._combine(tileExtent);\n          } else {\n            if (!tileInfo) {\n              tileInfo = {\n                'point0': p.add(offset)._sub(dx, dy),\n                'point': p,\n                'z': z,\n                'x': idx.x,\n                'y': idx.y,\n                'extent2d': tileExtent,\n                'mask': cascadeLevel,\n                'size': [width, height],\n                'id': tileId,\n                'dupKey': tileId,\n                'layer': this.getId(),\n                'url': this.getTileUrl(idx.x, idx.y, zoom)\n              };\n            }\n\n            if (hasOffset) {\n              tileExtent.set(p.x, p.y, p.x + width, p.y - height);\n              tileInfo.point = p._add(offset);\n\n              tileExtent._add(offset);\n            }\n\n            tiles.push(tileInfo);\n\n            extent._combine(tileExtent);\n          }\n\n          if (leftVisitEnd === -Infinity) {\n            leftVisitEnd = j;\n            j = right;\n          } else if (!rightVisitEnd) {\n            rightVisitEnd = true;\n          }\n        }\n      }\n    }\n\n    if (tiles.length) {\n      var center = map._containerPointToPoint(containerExtent.getCenter(), z, TEMP_POINT)._add(offset);\n\n      tiles.sort(function (a, b) {\n        return a.point.distanceTo(center) - b.point.distanceTo(center);\n      });\n    }\n\n    return {\n      'offset': offset,\n      'zoom': tileZoom,\n      'extent': extent,\n      'tiles': tiles\n    };\n  };\n\n  _proto2._splitTiles = function _splitTiles(frustumMatrix, tiles, renderer, tileIdx, z, tileExtent, offset, dx, dy) {\n    var yOrder = this._getTileConfig().tileSystem.scale.y;\n\n    var glScale = this.getMap().getGLScale(z);\n    var corner = TEMP_POINT4.set(tileExtent.xmin * 2, yOrder < 0 ? tileExtent.ymax * 2 : tileExtent.ymin * 2);\n\n    var corner0 = TEMP_POINT5.set(tileExtent.xmin, yOrder < 0 ? tileExtent.ymax : tileExtent.ymin)._add(offset)._sub(dx, dy)._multi(2);\n\n    var w = tileExtent.getWidth();\n    var h = tileExtent.getHeight();\n    var idx = tileIdx.idx * 2;\n    var idy = tileIdx.idy * 2;\n    var x = tileIdx.x * 2;\n    var y = tileIdx.y * 2;\n\n    var tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 0, 0, w, h, corner, corner0, offset, glScale);\n\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 0, 1, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 1, 0, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 1, 1, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n  };\n\n  _proto2._checkAndAddTile = function _checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, i, j, w, h, corner, corner0, offset, glScale) {\n    var tileId = this._getTileId(idx + i, idy + j, z);\n\n    if (this._visitedTiles && this._visitedTiles.has(tileId)) {\n      return null;\n    }\n\n    var yOrder = this._getTileConfig().tileSystem.scale.y;\n\n    var childExtent = new PointExtent(corner.x + i * w, corner.y + yOrder * j * h, corner.x + (i + 1) * w, corner.y + yOrder * (j + 1) * h);\n\n    if (!this._isSplittedTileInExtent(frustumMatrix, childExtent, glScale)) {\n      return null;\n    }\n\n    var hasOffset = offset[0] || offset[1];\n    var tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n\n    if (!tileInfo) {\n      tileInfo = {\n        'point0': corner0.add(i * w, Math.max(yOrder * j * h, yOrder * (j + 1) * h)),\n        'point': new Point(childExtent.xmin, childExtent.ymax),\n        'z': z,\n        'x': x + i,\n        'y': y + j,\n        'extent2d': childExtent,\n        'size': [w, h],\n        'id': tileId,\n        'dupKey': tileId,\n        'layer': this.getId(),\n        'url': this.getTileUrl(x + i, y + j, z + this.options['zoomOffset'])\n      };\n    } else {\n      tileInfo = tileInfo.info;\n    }\n\n    if (hasOffset) {\n      tileInfo.extent2d = childExtent;\n\n      tileInfo.extent2d._add(offset);\n\n      tileInfo.point.set(childExtent.xmin, childExtent.ymax)._add(offset);\n    }\n\n    return tileInfo;\n  };\n\n  _proto2._getTileOffset = function _getTileOffset(z) {\n    var map = this.getMap();\n\n    var scale = map._getResolution() / map._getResolution(z);\n\n    var offset = this.options['offset'];\n\n    if (isFunction(offset)) {\n      offset = offset(this);\n    }\n\n    offset[0] *= scale;\n    offset[1] *= scale;\n    return offset;\n  };\n\n  _proto2._getTileId = function _getTileId(x, y, zoom, id) {\n    return (id || this.getId()) + \"_\" + y + \"_\" + x + \"_\" + zoom;\n  };\n\n  _proto2._project = function _project(pcoord, out) {\n    if (this._hasOwnSR) {\n      var map = this.getMap();\n      var mapProjection = map.getProjection();\n      var projection = this.getSpatialReference().getProjection();\n      return projection.project(mapProjection.unproject(pcoord, out), out);\n    } else {\n      return pcoord;\n    }\n  };\n\n  _proto2._unproject = function _unproject(pcoord, out) {\n    if (this._hasOwnSR) {\n      var map = this.getMap();\n      var sr = this.getSpatialReference();\n      var mapProjection = map.getProjection();\n      var projection = sr.getProjection();\n      return mapProjection.project(projection.unproject(pcoord, out), out);\n    } else {\n      return pcoord;\n    }\n  };\n\n  _proto2._initTileConfig = function _initTileConfig() {\n    var map = this.getMap(),\n        tileSize = this.getTileSize();\n    var sr = this.getSpatialReference();\n    var projection = sr.getProjection(),\n        fullExtent = sr.getFullExtent();\n    this._defaultTileConfig = new TileConfig(map, TileSystem.getDefault(projection), fullExtent, tileSize);\n\n    if (this.options['tileSystem']) {\n      this._tileConfig = new TileConfig(map, this.options['tileSystem'], fullExtent, tileSize);\n    }\n\n    if (map && !this._tileConfig && map.getSpatialReference() === sr && map.getBaseLayer() && map.getBaseLayer() !== this && map.getBaseLayer()._getTileConfig) {\n      var base = map.getBaseLayer()._getTileConfig();\n\n      this._tileConfig = new TileConfig(map, base.tileSystem, base.fullExtent, tileSize);\n    }\n\n    this._hasOwnSR = sr !== map.getSpatialReference();\n  };\n\n  _proto2._getTileConfig = function _getTileConfig() {\n    if (!this._defaultTileConfig) {\n      this._initTileConfig();\n    }\n\n    return this._tileConfig || this._defaultTileConfig;\n  };\n\n  _proto2._bindMap = function _bindMap(map) {\n    var baseLayer = map.getBaseLayer();\n\n    if (baseLayer === this) {\n      if (!baseLayer.options.hasOwnProperty('forceRenderOnMoving')) {\n        this.config({\n          'forceRenderOnMoving': true\n        });\n      }\n    }\n\n    return _Layer.prototype._bindMap.apply(this, arguments);\n  };\n\n  _proto2._isTileInExtent = function _isTileInExtent(frustumMatrix, tileExtent, glScale) {\n    var map = this.getMap();\n    var matrix;\n\n    if (frustumMatrix !== map.projViewMatrix) {\n      var tileCenter = tileExtent.getCenter(TEMP_POINT6)._multi(glScale);\n\n      set$2(ARR3, tileCenter.x, tileCenter.y, 0);\n      var ndc = transformMat4(ARR3, ARR3, map.projViewMatrix);\n      matrix = ndc[1] < 0 ? map.projViewMatrix : frustumMatrix;\n    } else {\n      matrix = map.projViewMatrix;\n    }\n\n    TILE_BOX[0][0] = tileExtent.xmin * glScale;\n    TILE_BOX[0][1] = tileExtent.ymin * glScale;\n    TILE_BOX[1][0] = tileExtent.xmax * glScale;\n    TILE_BOX[1][1] = tileExtent.ymax * glScale;\n    return intersectsBox(matrix, TILE_BOX);\n  };\n\n  _proto2._isSplittedTileInExtent = function _isSplittedTileInExtent(frustumMatrix, tileExtent, glScale) {\n    var map = this.getMap();\n    TILE_BOX[0][0] = tileExtent.xmin * glScale;\n    TILE_BOX[0][1] = tileExtent.ymin * glScale;\n    TILE_BOX[1][0] = tileExtent.xmax * glScale;\n    TILE_BOX[1][1] = tileExtent.ymax * glScale;\n    return intersectsBox(map.projViewMatrix, TILE_BOX);\n  };\n\n  _proto2.getEvents = function getEvents() {\n    return {\n      'spatialreferencechange': this._onSpatialReferenceChange\n    };\n  };\n\n  _proto2._onSpatialReferenceChange = function _onSpatialReferenceChange() {\n    delete this._tileConfig;\n    delete this._defaultTileConfig;\n    delete this._sr;\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.clear();\n    }\n  };\n\n  return TileLayer;\n}(Layer);\n\nTileLayer.registerJSONType('TileLayer');\nTileLayer.mergeOptions(options$u);\n\nvar GroupTileLayer = function (_TileLayer) {\n  _inheritsLoose(GroupTileLayer, _TileLayer);\n\n  GroupTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'GroupTileLayer') {\n      return null;\n    }\n\n    var layers = layerJSON['layers'].map(function (json) {\n      return Layer.fromJSON(json);\n    });\n    return new GroupTileLayer(layerJSON['id'], layers, layerJSON['options']);\n  };\n\n  function GroupTileLayer(id, layers, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id, options) || this;\n    _this.layers = layers || [];\n\n    _this._checkChildren();\n\n    _this.layerMap = {};\n    _this._groupChildren = [];\n    return _this;\n  }\n\n  var _proto = GroupTileLayer.prototype;\n\n  _proto.getLayers = function getLayers() {\n    return this.layers;\n  };\n\n  _proto.toJSON = function toJSON() {\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'layers': this.layers.map(function (layer) {\n        return layer.toJSON();\n      }),\n      'options': this.config()\n    };\n    return profile;\n  };\n\n  _proto.getTiles = function getTiles(z) {\n    var layers = this.layers;\n    var tiles = [];\n    var count = 0;\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var layer = layers[i];\n\n      if (!layer.options['visible']) {\n        continue;\n      }\n\n      var childGrid = layer.getTiles(z, this);\n\n      if (!childGrid || childGrid.count === 0) {\n        continue;\n      }\n\n      count += childGrid.count;\n      pushIn(tiles, childGrid.tileGrids);\n    }\n\n    return {\n      count: count,\n      tileGrids: tiles\n    };\n  };\n\n  _proto.onAdd = function onAdd() {\n    var _this2 = this;\n\n    var map = this.getMap();\n    this.layers.forEach(function (layer) {\n      _this2.layerMap[layer.getId()] = layer;\n\n      if (layer.getChildLayer) {\n        _this2._groupChildren.push(layer);\n      }\n\n      layer._bindMap(map);\n\n      layer.on('show hide', _this2._onLayerShowHide, _this2);\n    });\n\n    _TileLayer.prototype.onAdd.call(this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    var _this3 = this;\n\n    this.layers.forEach(function (layer) {\n      layer._doRemove();\n\n      layer.off('show hide', _this3._onLayerShowHide, _this3);\n    });\n    this.layerMap = {};\n    this._groupChildren = [];\n\n    _TileLayer.prototype.onRemove.call(this);\n  };\n\n  _proto.getChildLayer = function getChildLayer(id) {\n    var layer = this.layerMap[id];\n\n    if (layer) {\n      return layer;\n    }\n\n    for (var i = 0; i < this._groupChildren.length; i++) {\n      var child = this._groupChildren[i].getChildLayer(id);\n\n      if (child) {\n        return child;\n      }\n    }\n\n    return null;\n  };\n\n  _proto._onLayerShowHide = function _onLayerShowHide() {\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.setToRedraw();\n    }\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!_TileLayer.prototype.isVisible.call(this)) {\n      return false;\n    }\n\n    var children = this.layers;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      if (children[i].isVisible()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._checkChildren = function _checkChildren() {\n    var _this4 = this;\n\n    var ids = {};\n    this.layers.forEach(function (layer) {\n      var layerId = layer.getId();\n\n      if (ids[layerId]) {\n        throw new Error(\"Duplicate child layer id (\" + layerId + \") in the GroupTileLayer (\" + _this4.getId() + \")\");\n      } else {\n        ids[layerId] = 1;\n      }\n    });\n  };\n\n  return GroupTileLayer;\n}(TileLayer);\n\nGroupTileLayer.registerJSONType('GroupTileLayer');\nvar options$v = {\n  crs: null,\n  uppercase: false,\n  detectRetina: false\n};\nvar defaultWmsParams = {\n  service: 'WMS',\n  request: 'GetMap',\n  layers: '',\n  styles: '',\n  format: 'image/jpeg',\n  transparent: false,\n  version: '1.1.1'\n};\n\nvar WMSTileLayer = function (_TileLayer) {\n  _inheritsLoose(WMSTileLayer, _TileLayer);\n\n  function WMSTileLayer(id, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id) || this;\n    var wmsParams = extend({}, defaultWmsParams);\n\n    for (var p in options) {\n      if (!(p in _this.options)) {\n        wmsParams[p] = options[p];\n      }\n    }\n\n    _this.setOptions(options);\n\n    _this.setZIndex(options.zIndex);\n\n    var tileSize = _this.getTileSize();\n\n    wmsParams.width = tileSize.width;\n    wmsParams.height = tileSize.height;\n    _this.wmsParams = wmsParams;\n    _this._wmsVersion = parseFloat(wmsParams.version);\n    return _this;\n  }\n\n  var _proto = WMSTileLayer.prototype;\n\n  _proto.onAdd = function onAdd() {\n    var dpr = this.getMap().getDevicePixelRatio();\n    var r = options$v.detectRetina ? dpr : 1;\n    this.wmsParams.width *= r;\n    this.wmsParams.height *= r;\n    var crs = this.options.crs || this.getMap().getProjection().code;\n    var projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';\n    this.wmsParams[projectionKey] = crs;\n\n    _TileLayer.prototype.onAdd.call(this);\n  };\n\n  _proto.getTileUrl = function getTileUrl(x, y, z) {\n    var res = this.getSpatialReference().getResolution(z),\n        tileConfig = this._getTileConfig(),\n        tileExtent = tileConfig.getTilePrjExtent(x, y, res);\n\n    var max = tileExtent.getMax(),\n        min = tileExtent.getMin();\n    var bbox = (this._wmsVersion >= 1.3 && this.wmsParams.crs === 'EPSG:4326' ? [min.y, min.x, max.y, max.x] : [min.x, min.y, max.x, max.y]).join(',');\n\n    var url = _TileLayer.prototype.getTileUrl.call(this, x, y, z);\n\n    return url + getParamString(this.wmsParams, url, this.options.uppercase) + (this.options.uppercase ? '&BBOX=' : '&bbox=') + bbox;\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'type': 'WMSTileLayer',\n      'id': this.getId(),\n      'options': this.config()\n    };\n  };\n\n  WMSTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'WMSTileLayer') {\n      return null;\n    }\n\n    return new WMSTileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  return WMSTileLayer;\n}(TileLayer);\n\nWMSTileLayer.registerJSONType('WMSTileLayer');\nWMSTileLayer.mergeOptions(options$v);\n\nfunction getParamString(obj, existingUrl, uppercase) {\n  var params = [];\n\n  for (var i in obj) {\n    params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n  }\n\n  return (!existingUrl || existingUrl.indexOf('?') === -1 ? '?' : '&') + params.join('&');\n}\n\nvar CanvasTileLayer = function (_TileLayer) {\n  _inheritsLoose(CanvasTileLayer, _TileLayer);\n\n  function CanvasTileLayer(id, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id, options) || this;\n\n    if (!_this.options.hasOwnProperty('forceRenderOnMoving')) {\n      _this.options['forceRenderOnMoving'] = false;\n    }\n\n    return _this;\n  }\n\n  var _proto = CanvasTileLayer.prototype;\n\n  _proto.drawTile = function drawTile() {};\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'type': 'CanvasTileLayer',\n      'id': this.getId(),\n      'options': this.config()\n    };\n  };\n\n  CanvasTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'CanvasTileLayer') {\n      return null;\n    }\n\n    return new CanvasTileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  return CanvasTileLayer;\n}(TileLayer);\n\nCanvasTileLayer.registerJSONType('CanvasTileLayer');\n\nfunction createGLContext(canvas, options) {\n  var attributes = {\n    'alpha': true,\n    'stencil': true,\n    'preserveDrawingBuffer': true,\n    'antialias': false\n  };\n  var names = ['webgl', 'experimental-webgl'];\n  var context = null;\n\n  for (var i = 0; i < names.length; ++i) {\n    try {\n      context = canvas.getContext(names[i], options || attributes);\n    } catch (e) {}\n\n    if (context) {\n      break;\n    }\n  }\n\n  return context;\n}\n\nfunction compileShader(gl, type, source) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n\n  if (!compiled) {\n    var error = gl.getShaderInfoLog(shader);\n    gl.deleteShader(shader);\n    throw new Error('Failed to compile shader: ' + error);\n  }\n\n  return shader;\n}\n\nfunction createProgram(gl, vert, frag) {\n  var vertexShader = compileShader(gl, gl.VERTEX_SHADER, vert);\n  var fragmentShader = compileShader(gl, gl.FRAGMENT_SHADER, frag);\n\n  if (!vertexShader || !fragmentShader) {\n    return null;\n  }\n\n  var program = gl.createProgram();\n\n  if (!program) {\n    return null;\n  }\n\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  return {\n    program: program,\n    vertexShader: vertexShader,\n    fragmentShader: fragmentShader\n  };\n}\n\nfunction enableVertexAttrib(gl, program, attributes) {\n  if (Array.isArray(attributes[0])) {\n    var FSIZE = Float32Array.BYTES_PER_ELEMENT;\n    var STRIDE = 0;\n\n    for (var i = 0; i < attributes.length; i++) {\n      STRIDE += attributes[i][1] || 0;\n    }\n\n    var offset = 0;\n\n    for (var _i = 0; _i < attributes.length; _i++) {\n      var attr = gl.getAttribLocation(program, attributes[_i][0]);\n\n      if (attr < 0) {\n        throw new Error('Failed to get the storage location of ' + attributes[_i][0]);\n      }\n\n      gl.vertexAttribPointer(attr, attributes[_i][1], gl[attributes[_i][2] || 'FLOAT'], false, FSIZE * STRIDE, FSIZE * offset);\n      offset += attributes[_i][1] || 0;\n      gl.enableVertexAttribArray(attr);\n    }\n  } else {\n    var _attr = gl.getAttribLocation(program, attributes[0]);\n\n    gl.vertexAttribPointer(_attr, attributes[1], gl[attributes[2] || 'FLOAT'], false, 0, 0);\n    gl.enableVertexAttribArray(_attr);\n  }\n}\n\nvar shaders = {\n  'vertexShader': \"\\n        attribute vec2 a_position;\\n\\n        attribute vec2 a_texCoord;\\n\\n        uniform mat4 u_matrix;\\n\\n        varying vec2 v_texCoord;\\n\\n        void main() {\\n            gl_Position = u_matrix * vec4(a_position, 0., 1.);\\n\\n            v_texCoord = a_texCoord;\\n        }\\n    \",\n  'fragmentShader': \"\\n        precision mediump float;\\n\\n        uniform sampler2D u_image;\\n\\n        uniform float u_opacity;\\n        uniform float u_debug_line;\\n\\n        varying vec2 v_texCoord;\\n\\n        void main() {\\n            if (u_debug_line == 1.) {\\n                gl_FragColor = vec4(0., 1., 0., 1.);\\n            } else {\\n                gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\\n            }\\n        }\\n    \"\n};\nvar v2 = [0, 0],\n    v3 = [0, 0, 0],\n    arr16 = new Array(16);\nvar DEBUG_POINT = new Point(20, 20);\n\nvar ImageGLRenderable = function ImageGLRenderable(Base) {\n  var renderable = function (_Base) {\n    _inheritsLoose(renderable, _Base);\n\n    function renderable() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = renderable.prototype;\n\n    _proto.drawGLImage = function drawGLImage(image, x, y, w, h, scale$$1, opacity, debug) {\n      if (this.gl.program !== this.program) {\n        this.useProgram(this.program);\n      }\n\n      var gl = this.gl;\n      this.loadTexture(image);\n      v3[0] = x || 0;\n      v3[1] = y || 0;\n      var uMatrix = identity(arr16);\n      translate(uMatrix, uMatrix, v3);\n      scale(uMatrix, uMatrix, [scale$$1, scale$$1, 1]);\n      multiply(uMatrix, this.getMap().projViewMatrix, uMatrix);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n      gl.uniform1f(this.program['u_opacity'], opacity);\n      gl.uniform1f(this.program['u_debug_line'], 0);\n      var glBuffer = image.glBuffer;\n\n      if (glBuffer && (glBuffer.width !== w || glBuffer.height !== h)) {\n        this.saveImageBuffer(glBuffer);\n        delete image.glBuffer;\n      }\n\n      if (!image.glBuffer) {\n        image.glBuffer = this.bufferTileData(0, 0, w, h);\n      } else {\n        gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);\n      }\n\n      v2[0] = 'a_position';\n      v2[1] = 2;\n      v2[2] = image.glBuffer.type;\n      this.enableVertexAttrib(v2);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n      if (debug) {\n        this.drawDebug(uMatrix, v2, 0, 0, w, h, debug);\n      }\n    };\n\n    _proto.drawDebug = function drawDebug(uMatrix, attrib, x, y, w, h, debugInfo) {\n      var gl = this.gl;\n      gl.bindBuffer(gl.ARRAY_BUFFER, this._debugBuffer);\n      this.enableVertexAttrib(['a_position', 2, 'FLOAT']);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([x, y, x + w, y, x + w, y - h, x, y - h, x, y]), gl.DYNAMIC_DRAW);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n      gl.uniform1f(this.program['u_debug_line'], 1);\n      gl.drawArrays(gl.LINE_STRIP, 0, 5);\n      var canvas = this._debugInfoCanvas;\n\n      if (!canvas) {\n        var dpr = this.getMap().getDevicePixelRatio() > 1 ? 2 : 1;\n        canvas = this._debugInfoCanvas = document.createElement('canvas');\n        canvas.width = 256 * dpr;\n        canvas.height = 32 * dpr;\n\n        var _ctx = canvas.getContext('2d');\n\n        _ctx.font = '20px monospace';\n\n        _ctx.scale(dpr, dpr);\n      }\n\n      var ctx = canvas.getContext('2d');\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      var color = this.layer.options['debugOutline'];\n      Canvas.fillText(ctx, debugInfo, DEBUG_POINT, color);\n      this.loadTexture(canvas);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\n      w = 256;\n      h = 32;\n      var x1 = x;\n      var x2 = x + w;\n      var y1 = y;\n      var y2 = y - h;\n      gl.bufferData(gl.ARRAY_BUFFER, this.set8(x1, y1, x1, y2, x2, y1, x2, y2), gl.DYNAMIC_DRAW);\n      gl.uniform1f(this.program['u_debug_line'], 0);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n\n    _proto.bufferTileData = function bufferTileData(x, y, w, h, buffer) {\n      var x1 = x;\n      var x2 = x + w;\n      var y1 = y;\n      var y2 = y - h;\n      var data;\n\n      if (isInteger(x1) && isInteger(x2) && isInteger(y1) && isInteger(y2)) {\n        data = this.set8Int(x1, y1, x1, y2, x2, y1, x2, y2);\n      } else {\n        data = this.set8(x1, y1, x1, y2, x2, y1, x2, y2);\n      }\n\n      var glBuffer = this.loadImageBuffer(data, buffer);\n      glBuffer.width = w;\n      glBuffer.height = h;\n      glBuffer.type = data instanceof Int16Array ? 'SHORT' : 'FLOAT';\n      return glBuffer;\n    };\n\n    _proto.drawTinImage = function drawTinImage(image, vertices, texCoords, indices, opacity) {\n      var gl = this.gl;\n      this.loadTexture(image);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, this.getMap().projViewMatrix);\n      gl.uniform1f(this.program['u_opacity'], opacity);\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.posBuffer);\n      this.enableVertexAttrib(['a_position', 3]);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.DYNAMIC_DRAW);\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n      this.enableVertexAttrib(['a_texCoord', 2]);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(texCoords), gl.DYNAMIC_DRAW);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.DYNAMIC_DRAW);\n      gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);\n    };\n\n    _proto.createCanvas2 = function createCanvas2() {\n      this.canvas2 = Canvas.createCanvas(this.canvas.width, this.canvas.height);\n    };\n\n    _proto.createGLContext = function createGLContext$$1() {\n      if (this.canvas.gl && this.canvas.gl.wrap) {\n        this.gl = this.canvas.gl.wrap();\n      } else {\n        this.gl = createGLContext(this.canvas2 || this.canvas, this.layer.options['glOptions']);\n      }\n\n      var gl = this.gl;\n      gl.clearColor(0.0, 0.0, 0.0, 0.0);\n      gl.disable(gl.DEPTH_TEST);\n      gl.enable(gl.STENCIL_TEST);\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n      this.program = this.createProgram(shaders['vertexShader'], this.layer.options['fragmentShader'] || shaders['fragmentShader'], ['u_matrix', 'u_image', 'u_opacity', 'u_debug_line']);\n      this._debugBuffer = this.createBuffer();\n      this.useProgram(this.program);\n      this.texBuffer = this.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n      this.enableVertexAttrib(['a_texCoord', 2, 'UNSIGNED_BYTE']);\n      gl.bufferData(gl.ARRAY_BUFFER, new Uint8Array([0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]), gl.STATIC_DRAW);\n      this.enableSampler('u_image');\n      gl.activeTexture(gl['TEXTURE0']);\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n    };\n\n    _proto.resizeGLCanvas = function resizeGLCanvas() {\n      if (this.gl) {\n        this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\n      }\n\n      if (!this.canvas2) {\n        return;\n      }\n\n      if (this.canvas2.width !== this.canvas.width || this.canvas2.height !== this.canvas.height) {\n        this.canvas2.width = this.canvas.width;\n        this.canvas2.height = this.canvas.height;\n      }\n    };\n\n    _proto.clearGLCanvas = function clearGLCanvas() {\n      if (this.gl) {\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.STENCIL_BUFFER_BIT);\n      }\n    };\n\n    _proto.disposeImage = function disposeImage(image) {\n      if (!image) {\n        return;\n      }\n\n      if (image.texture) {\n        this.saveTexture(image.texture);\n      }\n\n      if (image.glBuffer) {\n        this.saveImageBuffer(image.glBuffer);\n      }\n\n      delete image.texture;\n      delete image.glBuffer;\n    };\n\n    _proto._createTexture = function _createTexture(image) {\n      var gl = this.gl;\n      var texture = this.getTexture() || gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n      if (isInteger(log2(image.width)) && isInteger(log2(image.width))) {\n        gl.generateMipmap(gl.TEXTURE_2D);\n      }\n\n      return texture;\n    };\n\n    _proto.getTexture = function getTexture() {\n      if (!this._textures) {\n        this._textures = [];\n      }\n\n      var textures = this._textures;\n      return textures && textures.length > 0 ? textures.pop() : null;\n    };\n\n    _proto.saveTexture = function saveTexture(texture) {\n      this._textures.push(texture);\n    };\n\n    _proto.loadTexture = function loadTexture(image) {\n      var gl = this.gl;\n      var texture = image.texture;\n\n      if (!texture) {\n        texture = this._createTexture(image);\n        image.texture = texture;\n      }\n\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      return texture;\n    };\n\n    _proto.getImageBuffer = function getImageBuffer() {\n      if (!this._imageBuffers) {\n        this._imageBuffers = [];\n      }\n\n      var imageBuffers = this._imageBuffers;\n      return imageBuffers && imageBuffers.length > 0 ? imageBuffers.pop() : null;\n    };\n\n    _proto.saveImageBuffer = function saveImageBuffer(buffer) {\n      this._imageBuffers.push(buffer);\n    };\n\n    _proto.loadImageBuffer = function loadImageBuffer(data, glBuffer) {\n      var gl = this.gl;\n      var buffer = glBuffer || this.createImageBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n      gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n      return buffer;\n    };\n\n    _proto.createImageBuffer = function createImageBuffer() {\n      return this.getImageBuffer() || this.createBuffer();\n    };\n\n    _proto.removeGLCanvas = function removeGLCanvas() {\n      var gl = this.gl;\n\n      if (!gl) {\n        return;\n      }\n\n      if (this._debugBuffer) {\n        gl.deleteBuffer(this._debugBuffer);\n        delete this._debugBuffer;\n      }\n\n      if (this._buffers) {\n        this._buffers.forEach(function (b) {\n          gl.deleteBuffer(b);\n        });\n\n        delete this._buffers;\n      }\n\n      if (this._textures) {\n        this._textures.forEach(function (t) {\n          return gl.deleteTexture(t);\n        });\n\n        delete this._textures;\n      }\n\n      if (this._debugInfoCanvas) {\n        var texture = this._debugInfoCanvas.texture;\n\n        if (texture) {\n          gl.deleteTexture(texture);\n        }\n\n        delete this._debugInfoCanvas.texture;\n        delete this._debugInfoCanvas;\n      }\n\n      var program = gl.program;\n      gl.deleteShader(program.fragmentShader);\n      gl.deleteShader(program.vertexShader);\n      gl.deleteProgram(program);\n      delete this.gl;\n      delete this.canvas2;\n    };\n\n    _proto.createBuffer = function createBuffer() {\n      var gl = this.gl;\n      var buffer = gl.createBuffer();\n\n      if (!buffer) {\n        throw new Error('Failed to create the buffer object');\n      }\n\n      if (!this._buffers) {\n        this._buffers = [];\n      }\n\n      this._buffers.push(buffer);\n\n      return buffer;\n    };\n\n    _proto.enableVertexAttrib = function enableVertexAttrib$$1(attributes) {\n      enableVertexAttrib(this.gl, this.gl.program, attributes);\n    };\n\n    _proto.createProgram = function createProgram$$1(vert, frag, uniforms) {\n      var gl = this.gl;\n\n      var _createProgram2 = createProgram(gl, vert, frag),\n          program = _createProgram2.program,\n          vertexShader = _createProgram2.vertexShader,\n          fragmentShader = _createProgram2.fragmentShader;\n\n      program.vertexShader = vertexShader;\n      program.fragmentShader = fragmentShader;\n\n      this._initUniforms(program, uniforms);\n\n      return program;\n    };\n\n    _proto.useProgram = function useProgram(program) {\n      var gl = this.gl;\n      gl.useProgram(program);\n      gl.program = program;\n      return this;\n    };\n\n    _proto.enableSampler = function enableSampler(sampler, texIdx) {\n      var gl = this.gl;\n\n      var uSampler = this._getUniform(gl.program, sampler);\n\n      if (!texIdx) {\n        texIdx = 0;\n      }\n\n      gl.uniform1i(uSampler, texIdx);\n      return uSampler;\n    };\n\n    _proto._initUniforms = function _initUniforms(program, uniforms) {\n      for (var i = 0; i < uniforms.length; i++) {\n        var name = uniforms[i];\n        var uniform = uniforms[i];\n        var b = name.indexOf('[');\n\n        if (b >= 0) {\n          name = name.substring(0, b);\n\n          if (!IS_NODE) {\n            uniform = uniform.substring(0, b);\n          }\n        }\n\n        program[name] = this._getUniform(program, uniform);\n      }\n    };\n\n    _proto._getUniform = function _getUniform(program, uniformName) {\n      var gl = this.gl;\n      var uniform = gl.getUniformLocation(program, uniformName);\n\n      if (!uniform) {\n        throw new Error('Failed to get the storage location of ' + uniformName);\n      }\n\n      return uniform;\n    };\n\n    return renderable;\n  }(Base);\n\n  extend(renderable.prototype, {\n    set8: function () {\n      var out = Browser$1.ie9 ? null : new Float32Array(8);\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a4;\n        out[5] = a5;\n        out[6] = a6;\n        out[7] = a7;\n        return out;\n      };\n    }(),\n    set8Int: function () {\n      var out = Browser$1.ie9 ? null : new Int16Array(8);\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a4;\n        out[5] = a5;\n        out[6] = a6;\n        out[7] = a7;\n        return out;\n      };\n    }()\n  });\n  return renderable;\n};\n\nvar options$w = {\n  renderer: Browser$1.webgl ? 'gl' : 'canvas',\n  crossOrigin: null\n};\nvar TEMP_POINT$1 = new Point(0, 0);\n\nvar ImageLayer = function (_Layer) {\n  _inheritsLoose(ImageLayer, _Layer);\n\n  function ImageLayer(id, images, options) {\n    var _this;\n\n    if (images && !Array.isArray(images) && !images.url) {\n      options = images;\n      images = null;\n    }\n\n    _this = _Layer.call(this, id, options) || this;\n    _this._images = images;\n    return _this;\n  }\n\n  var _proto = ImageLayer.prototype;\n\n  _proto.onAdd = function onAdd() {\n    this._prepareImages(this._images);\n  };\n\n  _proto.setImages = function setImages(images) {\n    this._images = images;\n\n    this._prepareImages(images);\n\n    return this;\n  };\n\n  _proto.getImages = function getImages() {\n    return this._images;\n  };\n\n  _proto._prepareImages = function _prepareImages(images) {\n    images = images || [];\n\n    if (!Array.isArray(images)) {\n      images = [images];\n    }\n\n    var map = this.getMap();\n    this._imageData = images.map(function (img) {\n      var extent = new Extent(img.extent);\n      return extend({}, img, {\n        extent: extent,\n        extent2d: extent.convertTo(function (c) {\n          return map.coordToPoint(c, map.getGLZoom());\n        })\n      });\n    });\n    this._images = images;\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.refreshImages();\n    }\n  };\n\n  return ImageLayer;\n}(Layer);\n\nImageLayer.mergeOptions(options$w);\nvar EMPTY_ARRAY = [];\n\nvar ImageLayerCanvasRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(ImageLayerCanvasRenderer, _CanvasRenderer);\n\n  function ImageLayerCanvasRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = ImageLayerCanvasRenderer.prototype;\n\n  _proto2.isDrawable = function isDrawable() {\n    if (this.getMap().getPitch()) {\n      if (console) {\n        console.warn('ImageLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n      }\n\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto2.checkResources = function checkResources() {\n    var _this2 = this;\n\n    if (this._imageLoaded) {\n      return EMPTY_ARRAY;\n    }\n\n    var layer = this.layer;\n\n    var urls = layer._imageData.map(function (img) {\n      return [img.url, null, null];\n    });\n\n    if (this.resources) {\n      var unloaded = [];\n      var resources = new ResourceCache();\n      urls.forEach(function (url) {\n        if (_this2.resources.isResourceLoaded(url)) {\n          var img = _this2.resources.getImage(url);\n\n          resources.addResource(url, img);\n        } else {\n          unloaded.push(url);\n        }\n      });\n      this.resources.forEach(function (url, res) {\n        if (!resources.isResourceLoaded(url)) {\n          _this2.retireImage(res.image);\n        }\n      });\n      this.resources = resources;\n      urls = unloaded;\n    }\n\n    this._imageLoaded = true;\n    return urls;\n  };\n\n  _proto2.retireImage = function retireImage() {};\n\n  _proto2.refreshImages = function refreshImages() {\n    this._imageLoaded = false;\n    this.setToRedraw();\n  };\n\n  _proto2.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isZooming() && !map.getPitch()) {\n      return false;\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto2.draw = function draw() {\n    if (!this.isDrawable()) {\n      return;\n    }\n\n    this.prepareCanvas();\n    this._painted = false;\n\n    this._drawImages();\n\n    this.completeRender();\n  };\n\n  _proto2._drawImages = function _drawImages() {\n    var imgData = this.layer._imageData;\n    var map = this.getMap();\n\n    var mapExtent = map._get2DExtent(map.getGLZoom());\n\n    if (imgData && imgData.length) {\n      for (var i = 0; i < imgData.length; i++) {\n        var extent = imgData[i].extent2d;\n        var image = this.resources && this.resources.getImage(imgData[i].url);\n\n        if (image && mapExtent.intersects(extent)) {\n          this._painted = true;\n\n          this._drawImage(image, extent, imgData[i].opacity || 1);\n        }\n      }\n    }\n  };\n\n  _proto2._drawImage = function _drawImage(image, extent, opacity) {\n    var globalAlpha = 0;\n    var ctx = this.context;\n\n    if (opacity < 1) {\n      globalAlpha = ctx.globalAlpha;\n      ctx.globalAlpha = opacity;\n    }\n\n    var map = this.getMap();\n    var nw = TEMP_POINT$1.set(extent.xmin, extent.ymax);\n\n    var point = map._pointToContainerPoint(nw, map.getGLZoom());\n\n    var x = point.x,\n        y = point.y;\n    var bearing = map.getBearing();\n\n    if (bearing) {\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (bearing) {\n        ctx.rotate(-bearing * Math.PI / 180);\n      }\n\n      x = y = 0;\n    }\n\n    var scale = map.getGLScale();\n    ctx.drawImage(image, x, y, extent.getWidth() / scale, extent.getHeight() / scale);\n\n    if (bearing) {\n      ctx.restore();\n    }\n\n    if (globalAlpha) {\n      ctx.globalAlpha = globalAlpha;\n    }\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n  };\n\n  return ImageLayerCanvasRenderer;\n}(CanvasRenderer);\n\nvar ImageLayerGLRenderer = function (_ImageGLRenderable) {\n  _inheritsLoose(ImageLayerGLRenderer, _ImageGLRenderable);\n\n  function ImageLayerGLRenderer() {\n    return _ImageGLRenderable.apply(this, arguments) || this;\n  }\n\n  var _proto3 = ImageLayerGLRenderer.prototype;\n\n  _proto3.isDrawable = function isDrawable() {\n    return true;\n  };\n\n  _proto3._drawImage = function _drawImage(image, extent, opacity) {\n    this.drawGLImage(image, extent.xmin, extent.ymax, extent.getWidth(), extent.getHeight(), 1, opacity);\n  };\n\n  _proto3.createContext = function createContext() {\n    this.createGLContext();\n  };\n\n  _proto3.resizeCanvas = function resizeCanvas(canvasSize) {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.resizeCanvas.call(this, canvasSize);\n\n    this.resizeGLCanvas();\n  };\n\n  _proto3.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.clearCanvas.call(this);\n\n    this.clearGLCanvas();\n  };\n\n  _proto3.retireImage = function retireImage(image) {\n    this.disposeImage(image);\n  };\n\n  _proto3.onRemove = function onRemove() {\n    this.removeGLCanvas();\n\n    _ImageGLRenderable.prototype.onRemove.call(this);\n  };\n\n  return ImageLayerGLRenderer;\n}(ImageGLRenderable(ImageLayerCanvasRenderer));\n\nImageLayer.registerRenderer('canvas', ImageLayerCanvasRenderer);\nImageLayer.registerRenderer('gl', ImageLayerGLRenderer);\n\nvar CanvasLayerRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(CanvasLayerRenderer, _CanvasRenderer);\n\n  function CanvasLayerRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasLayerRenderer.prototype;\n\n  _proto.getPrepareParams = function getPrepareParams() {\n    return [];\n  };\n\n  _proto.getDrawParams = function getDrawParams() {\n    return [];\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    if (this.canvas && this.layer.options['doubleBuffer']) {\n      this.buffer = Canvas.createCanvas(this.canvas.width, this.canvas.height, this.getMap().CanvasClass);\n    }\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    if (this.layer.options['animation']) {\n      return true;\n    }\n\n    var map = this.getMap();\n\n    if (map.isInteracting() && !this.layer.drawOnInteracting) {\n      return false;\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto.draw = function draw() {\n    this.prepareCanvas();\n    this.prepareDrawContext();\n\n    this._drawLayer();\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    this._drawLayerOnInteracting();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    var canvasImg = _CanvasRenderer.prototype.getCanvasImage.call(this);\n\n    if (canvasImg && canvasImg.image && this.layer.options['doubleBuffer']) {\n      var canvas = canvasImg.image;\n\n      if (this.buffer.width !== canvas.width || this.buffer.height !== canvas.height) {\n        this.buffer.width = canvas.width;\n        this.buffer.height = canvas.height;\n      }\n\n      var bufferContext = this.buffer.getContext('2d');\n      var prevent = this.layer.doubleBuffer(bufferContext, this.context);\n\n      if (prevent === undefined || prevent) {\n        Canvas.image(bufferContext, canvas, 0, 0);\n        canvasImg.image = this.buffer;\n      }\n    }\n\n    return canvasImg;\n  };\n\n  _proto.remove = function remove() {\n    delete this._drawContext;\n    return _CanvasRenderer.prototype.remove.call(this);\n  };\n\n  _proto.onZoomStart = function onZoomStart(param) {\n    this.layer.onZoomStart(param);\n\n    _CanvasRenderer.prototype.onZoomStart.call(this, param);\n  };\n\n  _proto.onZooming = function onZooming(param) {\n    this.layer.onZooming(param);\n\n    _CanvasRenderer.prototype.onZooming.call(this, param);\n  };\n\n  _proto.onZoomEnd = function onZoomEnd(param) {\n    this.layer.onZoomEnd(param);\n\n    _CanvasRenderer.prototype.onZoomEnd.call(this, param);\n  };\n\n  _proto.onMoveStart = function onMoveStart(param) {\n    this.layer.onMoveStart(param);\n\n    _CanvasRenderer.prototype.onMoveStart.call(this, param);\n  };\n\n  _proto.onMoving = function onMoving(param) {\n    this.layer.onMoving(param);\n\n    _CanvasRenderer.prototype.onMoving.call(this, param);\n  };\n\n  _proto.onMoveEnd = function onMoveEnd(param) {\n    this.layer.onMoveEnd(param);\n\n    _CanvasRenderer.prototype.onMoveEnd.call(this, param);\n  };\n\n  _proto.onResize = function onResize(param) {\n    this.layer.onResize(param);\n\n    _CanvasRenderer.prototype.onResize.call(this, param);\n  };\n\n  _proto.prepareDrawContext = function prepareDrawContext() {\n    if (!this._predrawed) {\n      var params = ensureParams(this.getPrepareParams());\n      this._drawContext = this.layer.prepareToDraw.apply(this.layer, [this.context].concat(params));\n\n      if (!this._drawContext) {\n        this._drawContext = [];\n      }\n\n      if (!Array.isArray(this._drawContext)) {\n        this._drawContext = [this._drawContext];\n      }\n\n      this._predrawed = true;\n    }\n  };\n\n  _proto._prepareDrawParams = function _prepareDrawParams() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var view = this.getViewExtent();\n\n    if (view['maskExtent'] && !view['extent'].intersects(view['maskExtent'])) {\n      this.completeRender();\n      return null;\n    }\n\n    var args = [this.context, view];\n    var params = ensureParams(this.getDrawParams());\n    args.push.apply(args, params);\n    args.push.apply(args, this._drawContext);\n    return args;\n  };\n\n  _proto._drawLayer = function _drawLayer() {\n    var args = this._prepareDrawParams();\n\n    if (!args) {\n      return;\n    }\n\n    this.layer.draw.apply(this.layer, args);\n    this.completeRender();\n  };\n\n  _proto._drawLayerOnInteracting = function _drawLayerOnInteracting() {\n    if (!this.layer.drawOnInteracting) {\n      return;\n    }\n\n    var args = this._prepareDrawParams();\n\n    if (!args) {\n      return;\n    }\n\n    this.layer.drawOnInteracting.apply(this.layer, args);\n    this.completeRender();\n  };\n\n  return CanvasLayerRenderer;\n}(CanvasRenderer);\n\nfunction ensureParams(params) {\n  if (!params) {\n    params = [];\n  }\n\n  if (!Array.isArray(params)) {\n    params = [params];\n  }\n\n  return params;\n}\n\nvar options$x = {\n  'doubleBuffer': false,\n  'animation': false\n};\n\nvar CanvasLayer = function (_Layer) {\n  _inheritsLoose(CanvasLayer, _Layer);\n\n  function CanvasLayer() {\n    return _Layer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasLayer.prototype;\n\n  _proto.isCanvasRender = function isCanvasRender() {\n    return true;\n  };\n\n  _proto.prepareToDraw = function prepareToDraw() {};\n\n  _proto.draw = function draw() {};\n\n  _proto.redraw = function redraw() {\n    if (this._getRenderer()) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.play = function play() {\n    this.config('animation', true);\n    return this;\n  };\n\n  _proto.pause = function pause() {\n    this.config('animation', false);\n    return this;\n  };\n\n  _proto.isPlaying = function isPlaying() {\n    return this.options['animation'];\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (this._getRenderer()) {\n      this._getRenderer().clearCanvas();\n    }\n\n    return this;\n  };\n\n  _proto.requestMapToRender = function requestMapToRender() {\n    if (this._getRenderer()) {\n      this._getRenderer().requestMapToRender();\n    }\n\n    return this;\n  };\n\n  _proto.completeRender = function completeRender() {\n    if (this._getRenderer()) {\n      this._getRenderer().completeRender();\n    }\n\n    return this;\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    return this;\n  };\n\n  _proto.onZoomStart = function onZoomStart() {};\n\n  _proto.onZooming = function onZooming() {};\n\n  _proto.onZoomEnd = function onZoomEnd() {};\n\n  _proto.onMoveStart = function onMoveStart() {};\n\n  _proto.onMoving = function onMoving() {};\n\n  _proto.onMoveEnd = function onMoveEnd() {};\n\n  _proto.onResize = function onResize() {};\n\n  _proto.doubleBuffer = function doubleBuffer(bufferContext) {\n    bufferContext.clearRect(0, 0, bufferContext.canvas.width, bufferContext.canvas.height);\n    return this;\n  };\n\n  return CanvasLayer;\n}(Layer);\n\nCanvasLayer.mergeOptions(options$x);\nCanvasLayer.registerRenderer('canvas', CanvasLayerRenderer);\nvar TEMP_POINT$2 = new Point(0, 0);\nvar options$y = {\n  'animation': true\n};\n\nvar ParticleLayer = function (_CanvasLayer) {\n  _inheritsLoose(ParticleLayer, _CanvasLayer);\n\n  function ParticleLayer() {\n    return _CanvasLayer.apply(this, arguments) || this;\n  }\n\n  var _proto = ParticleLayer.prototype;\n\n  _proto.getParticles = function getParticles() {};\n\n  _proto.draw = function draw(context, view) {\n    var points = this.getParticles(now());\n\n    if (!points || points.length === 0) {\n      var renderer = this._getRenderer();\n\n      if (renderer) {\n        this._getRenderer()._shouldClear = true;\n      }\n\n      return;\n    }\n\n    var map = this.getMap();\n    var extent = view.extent;\n\n    if (view.maskExtent) {\n      extent = view.extent.intersection(view.maskExtent);\n    }\n\n    extent = extent.convertTo(function (c) {\n      return map._pointToContainerPoint(c, undefined, 0, TEMP_POINT$2);\n    });\n    var e = 2 * Math.PI;\n\n    for (var i = 0, l = points.length; i < l; i++) {\n      var pos = points[i].point;\n\n      if (extent.contains(pos)) {\n        var color = points[i].color || this.options['lineColor'] || '#fff',\n            r = points[i].r;\n\n        if (context.fillStyle !== color) {\n          context.fillStyle = color;\n        }\n\n        if (r <= 2) {\n          context.fillRect(pos.x - r / 2, pos.y - r / 2, r, r);\n        } else {\n          context.beginPath();\n          context.arc(pos.x, pos.y, r / 2, 0, e);\n          context.fill();\n        }\n      }\n    }\n\n    this._fillCanvas(context);\n  };\n\n  _proto._fillCanvas = function _fillCanvas(context) {\n    var g = context.globalCompositeOperation;\n    context.globalCompositeOperation = 'destination-out';\n    var trail = this.options['trail'] || 30;\n    context.fillStyle = 'rgba(0, 0, 0, ' + 1 / trail + ')';\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height);\n    context.globalCompositeOperation = g;\n  };\n\n  return ParticleLayer;\n}(CanvasLayer);\n\nParticleLayer.mergeOptions(options$y);\nParticleLayer.registerRenderer('canvas', function (_CanvasLayerRenderer) {\n  _inheritsLoose(_class, _CanvasLayerRenderer);\n\n  function _class() {\n    return _CanvasLayerRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = _class.prototype;\n\n  _proto2.draw = function draw() {\n    if (!this.canvas || !this.layer.options['animation'] || this._shouldClear) {\n      this.prepareCanvas();\n      this._shouldClear = false;\n    }\n\n    this.prepareDrawContext();\n\n    this._drawLayer();\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n    this._shouldClear = false;\n  };\n\n  _proto2.onSkipDrawOnInteracting = function onSkipDrawOnInteracting() {\n    this._shouldClear = true;\n  };\n\n  return _class;\n}(CanvasLayerRenderer));\nvar EDIT_STAGE_LAYER_PREFIX = INTERNAL_LAYER_PREFIX + '_edit_stage_';\n\nfunction createHandleSymbol(markerType, opacity) {\n  return {\n    'markerType': markerType,\n    'markerFill': '#fff',\n    'markerLineColor': '#000',\n    'markerLineWidth': 2,\n    'markerWidth': 10,\n    'markerHeight': 10,\n    'opacity': opacity\n  };\n}\n\nvar options$z = {\n  'fixAspectRatio': false,\n  'symbol': null,\n  'removeVertexOn': 'contextmenu',\n  'centerHandleSymbol': createHandleSymbol('ellipse', 1),\n  'vertexHandleSymbol': createHandleSymbol('square', 1),\n  'newVertexHandleSymbol': createHandleSymbol('square', 0.4)\n};\n\nvar GeometryEditor = function (_Eventable) {\n  _inheritsLoose(GeometryEditor, _Eventable);\n\n  function GeometryEditor(geometry, opts) {\n    var _this;\n\n    _this = _Eventable.call(this, opts) || this;\n    _this._geometry = geometry;\n\n    if (!_this._geometry) {\n      return _assertThisInitialized(_this);\n    }\n\n    return _this;\n  }\n\n  var _proto = GeometryEditor.prototype;\n\n  _proto.getMap = function getMap() {\n    return this._geometry.getMap();\n  };\n\n  _proto.prepare = function prepare() {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    if (this.options['symbol']) {\n      this._originalSymbol = this._geometry.getSymbol();\n\n      this._geometry.setSymbol(this.options['symbol']);\n    }\n\n    this._prepareEditStageLayer();\n  };\n\n  _proto._prepareEditStageLayer = function _prepareEditStageLayer() {\n    var map = this.getMap();\n    var uid = UID();\n    var stageId = EDIT_STAGE_LAYER_PREFIX + uid,\n        shadowId = EDIT_STAGE_LAYER_PREFIX + uid + '_shadow';\n    this._editStageLayer = map.getLayer(stageId);\n    this._shadowLayer = map.getLayer(shadowId);\n\n    if (!this._editStageLayer) {\n      this._editStageLayer = new VectorLayer(stageId);\n      map.addLayer(this._editStageLayer);\n    }\n\n    if (!this._shadowLayer) {\n      this._shadowLayer = new VectorLayer(shadowId);\n      map.addLayer(this._shadowLayer);\n    }\n  };\n\n  _proto.start = function start() {\n    var _this2 = this;\n\n    if (!this._geometry || !this._geometry.getMap() || this._geometry.editing) {\n      return;\n    }\n\n    var map = this.getMap();\n    this.editing = true;\n    var geometry = this._geometry;\n    this._geometryDraggble = geometry.options['draggable'];\n    geometry.config('draggable', false);\n    this.prepare();\n    var shadow = geometry.copy();\n    shadow.setSymbol(geometry._getInternalSymbol());\n    shadow.copyEventListeners(geometry);\n\n    if (geometry._getParent()) {\n      shadow.copyEventListeners(geometry._getParent());\n    }\n\n    shadow._setEventTarget(geometry);\n\n    shadow.setId(null).config({\n      'draggable': false\n    });\n    this._shadow = shadow;\n\n    this._switchGeometryEvents('on');\n\n    geometry.hide();\n\n    if (geometry instanceof Marker || geometry instanceof Circle || geometry instanceof Rectangle || geometry instanceof Ellipse) {\n      this._createOrRefreshOutline();\n    }\n\n    this._shadowLayer.bringToFront().addGeometry(shadow);\n\n    this._editStageLayer.bringToFront();\n\n    this._addListener([map, 'zoomstart', function () {\n      _this2._editStageLayer.hide();\n    }]);\n\n    this._addListener([map, 'zoomend', function () {\n      _this2._editStageLayer.show();\n    }]);\n\n    if (!(geometry instanceof Marker)) {\n      this._createCenterHandle();\n    } else {\n      shadow.config('draggable', true);\n      shadow.on('dragend', this._onMarkerDragEnd, this);\n    }\n\n    if (geometry instanceof Marker) {\n      this.createMarkerEditor();\n    } else if (geometry instanceof Circle) {\n      this.createCircleEditor();\n    } else if (geometry instanceof Rectangle) {\n      this.createEllipseOrRectEditor();\n    } else if (geometry instanceof Ellipse) {\n      this.createEllipseOrRectEditor();\n    } else if (geometry instanceof Sector) ;else if (geometry instanceof Polygon || geometry instanceof LineString) {\n      this.createPolygonEditor();\n    }\n  };\n\n  _proto.stop = function stop() {\n    delete this._history;\n    delete this._historyPointer;\n    delete this._editOutline;\n\n    this._switchGeometryEvents('off');\n\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    delete this._shadow;\n\n    this._geometry.config('draggable', this._geometryDraggble);\n\n    delete this._geometryDraggble;\n\n    this._geometry.show();\n\n    this._editStageLayer.remove();\n\n    this._shadowLayer.remove();\n\n    this._clearAllListeners();\n\n    this._refreshHooks = [];\n\n    if (this.options['symbol']) {\n      this._geometry.setSymbol(this._originalSymbol);\n\n      delete this._originalSymbol;\n    }\n\n    this.editing = false;\n  };\n\n  _proto.isEditing = function isEditing() {\n    if (isNil(this.editing)) {\n      return false;\n    }\n\n    return this.editing;\n  };\n\n  _proto._getGeometryEvents = function _getGeometryEvents() {\n    return {\n      'symbolchange': this._onGeoSymbolChange,\n      'positionchange shapechange': this._exeAndReset\n    };\n  };\n\n  _proto._switchGeometryEvents = function _switchGeometryEvents(oper) {\n    if (this._geometry) {\n      var events = this._getGeometryEvents();\n\n      for (var p in events) {\n        this._geometry[oper](p, events[p], this);\n      }\n    }\n  };\n\n  _proto._onGeoSymbolChange = function _onGeoSymbolChange(param) {\n    if (this._shadow) {\n      this._shadow.setSymbol(param.target._getInternalSymbol());\n    }\n  };\n\n  _proto._onMarkerDragEnd = function _onMarkerDragEnd() {\n    this._update('setCoordinates', this._shadow.getCoordinates().toArray());\n\n    this._refresh();\n  };\n\n  _proto._createOrRefreshOutline = function _createOrRefreshOutline() {\n    var geometry = this._geometry;\n    var outline = this._editOutline;\n\n    if (!outline) {\n      outline = geometry.getOutline();\n\n      this._editStageLayer.addGeometry(outline);\n\n      this._editOutline = outline;\n\n      this._addRefreshHook(this._createOrRefreshOutline);\n    } else {\n      outline.remove();\n      this._editOutline = outline = geometry.getOutline();\n\n      this._editStageLayer.addGeometry(outline);\n    }\n\n    return outline;\n  };\n\n  _proto._createCenterHandle = function _createCenterHandle() {\n    var _this3 = this;\n\n    var center = this._shadow.getCenter();\n\n    var symbol = this.options['centerHandleSymbol'];\n    var shadow;\n    var handle = this.createHandle(center, {\n      'symbol': symbol,\n      'cursor': 'move',\n      onDown: function onDown() {\n        shadow = _this3._shadow.copy();\n        var symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n        shadow.setSymbol(symbol).addTo(_this3._editStageLayer);\n      },\n      onMove: function onMove(v, param) {\n        var offset = param['coordOffset'];\n        shadow.translate(offset);\n      },\n      onUp: function onUp() {\n        _this3._update('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n\n        shadow.remove();\n\n        _this3._refresh();\n      }\n    });\n\n    this._addRefreshHook(function () {\n      var center = _this3._shadow.getCenter();\n\n      handle.setCoordinates(center);\n    });\n  };\n\n  _proto._createHandleInstance = function _createHandleInstance(coordinate, opts) {\n    var symbol = opts['symbol'];\n    var handle = new Marker(coordinate, {\n      'draggable': true,\n      'dragShadow': false,\n      'dragOnAxis': opts['axis'],\n      'cursor': opts['cursor'],\n      'symbol': symbol\n    });\n    return handle;\n  };\n\n  _proto.createHandle = function createHandle(coordinate, opts) {\n    if (!opts) {\n      opts = {};\n    }\n\n    var map = this.getMap();\n\n    var handle = this._createHandleInstance(coordinate, opts);\n\n    var me = this;\n\n    function onHandleDragstart(param) {\n      if (opts.onDown) {\n        this._geometry.fire('handledragstart');\n\n        opts.onDown.call(me, param['viewPoint'], param);\n      }\n\n      return false;\n    }\n\n    function onHandleDragging(param) {\n      me._hideContext();\n\n      var viewPoint = map._prjToViewPoint(handle._getPrjCoordinates());\n\n      if (opts.onMove) {\n        this._geometry.fire('handledragging');\n\n        opts.onMove.call(me, viewPoint, param);\n      }\n\n      return false;\n    }\n\n    function onHandleDragEnd(ev) {\n      if (opts.onUp) {\n        this._geometry.fire('handledragend');\n\n        opts.onUp.call(me, ev);\n      }\n\n      return false;\n    }\n\n    function onHandleRemove() {\n      handle.config('draggable', false);\n      handle.off('dragstart', onHandleDragstart, me);\n      handle.off('dragging', onHandleDragging, me);\n      handle.off('dragend', onHandleDragEnd, me);\n      handle.off('removestart', onHandleRemove, me);\n      delete handle['maptalks--editor-refresh-fn'];\n    }\n\n    handle.on('dragstart', onHandleDragstart, this);\n    handle.on('dragging', onHandleDragging, this);\n    handle.on('dragend', onHandleDragEnd, this);\n    handle.on('removestart', onHandleRemove, this);\n\n    if (opts.onRefresh) {\n      handle['maptalks--editor-refresh-fn'] = opts.onRefresh;\n    }\n\n    this._editStageLayer.addGeometry(handle);\n\n    return handle;\n  };\n\n  _proto._createResizeHandles = function _createResizeHandles(blackList, onHandleMove, onHandleUp) {\n    var _this4 = this;\n\n    var cursors = ['nw-resize', 'n-resize', 'ne-resize', 'w-resize', 'e-resize', 'sw-resize', 's-resize', 'se-resize'];\n    var axis = [null, 'y', null, 'x', 'x', null, 'y', null];\n    var geometry = this._geometry;\n\n    function getResizeAnchors(ext) {\n      return [new Point(ext['xmin'], ext['ymax']), new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymax']), new Point(ext['xmax'], ext['ymax']), new Point(ext['xmin'], (ext['ymax'] + ext['ymin']) / 2), new Point(ext['xmax'], (ext['ymax'] + ext['ymin']) / 2), new Point(ext['xmin'], ext['ymin']), new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymin']), new Point(ext['xmax'], ext['ymin'])];\n    }\n\n    if (!blackList) {\n      blackList = [];\n    }\n\n    var me = this;\n    var resizeHandles = [],\n        anchorIndexes = {},\n        map = this.getMap(),\n        handleSymbol = this.options['vertexHandleSymbol'];\n\n    var fnLocateHandles = function fnLocateHandles() {\n      var pExt = geometry._getPainter().get2DExtent(),\n          anchors = getResizeAnchors(pExt);\n\n      var _loop = function _loop(i) {\n        if (Array.isArray(blackList)) {\n          var isBlack = blackList.some(function (ele) {\n            return ele === i;\n          });\n\n          if (isBlack) {\n            return \"continue\";\n          }\n        }\n\n        var anchor = anchors[i],\n            coordinate = map.pointToCoordinate(anchor);\n\n        if (resizeHandles.length < anchors.length - blackList.length) {\n          var handle = _this4.createHandle(coordinate, {\n            'symbol': handleSymbol,\n            'cursor': cursors[i],\n            'axis': axis[i],\n            onMove: function (_index) {\n              return function (handleViewPoint) {\n                me._updating = true;\n                onHandleMove(handleViewPoint, _index);\n                geometry.fire('resizing');\n              };\n            }(i),\n            onUp: function onUp() {\n              me._updating = false;\n              onHandleUp();\n\n              _this4._refresh();\n            }\n          });\n\n          handle.setId(i);\n          anchorIndexes[i] = resizeHandles.length;\n          resizeHandles.push(handle);\n        } else {\n          resizeHandles[anchorIndexes[i]].setCoordinates(coordinate);\n        }\n      };\n\n      for (var i = 0; i < anchors.length; i++) {\n        var _ret = _loop(i);\n\n        if (_ret === \"continue\") continue;\n      }\n    };\n\n    fnLocateHandles();\n\n    this._addRefreshHook(fnLocateHandles);\n\n    return resizeHandles;\n  };\n\n  _proto.createMarkerEditor = function createMarkerEditor() {\n    var _this5 = this;\n\n    var geometryToEdit = this._geometry,\n        shadow = this._shadow,\n        map = this.getMap();\n\n    if (!shadow._canEdit()) {\n      if (console) {\n        console.warn('A marker can\\'t be resized with symbol:', shadow.getSymbol());\n      }\n\n      return;\n    }\n\n    if (!this._history) {\n      this._recordHistory(getUpdates());\n    }\n\n    var symbol = shadow._getInternalSymbol();\n\n    var dxdy = new Point(0, 0);\n\n    if (isNumber(symbol['markerDx'])) {\n      dxdy.x = symbol['markerDx'];\n    }\n\n    if (isNumber(symbol['markerDy'])) {\n      dxdy.y = symbol['markerDy'];\n    }\n\n    var blackList = null;\n\n    if (VectorMarkerSymbolizer.test(symbol)) {\n      if (symbol['markerType'] === 'pin' || symbol['markerType'] === 'pie' || symbol['markerType'] === 'bar') {\n        blackList = [5, 6, 7];\n      }\n    } else if (ImageMarkerSymbolizer.test(symbol) || VectorPathMarkerSymbolizer.test(symbol)) {\n      blackList = [5, 6, 7];\n    }\n\n    var resizeAbilities = [2, 1, 2, 0, 0, 2, 1, 2];\n    var aspectRatio;\n\n    if (this.options['fixAspectRatio']) {\n      var size = shadow.getSize();\n      aspectRatio = size.width / size.height;\n    }\n\n    var resizeHandles = this._createResizeHandles(null, function (handleViewPoint, i) {\n      if (blackList && blackList.indexOf(i) >= 0) {\n        var newCoordinates = map.viewPointToCoordinate(handleViewPoint.sub(dxdy));\n        var coordinates = shadow.getCoordinates();\n        newCoordinates.x = coordinates.x;\n        shadow.setCoordinates(newCoordinates);\n\n        _this5._updateCoordFromShadow(true);\n\n        var mirrorHandle = resizeHandles[resizeHandles.length - 1 - i];\n        var mirrorViewPoint = map.coordToViewPoint(mirrorHandle.getCoordinates());\n        handleViewPoint = mirrorViewPoint;\n      }\n\n      var viewCenter = map._pointToViewPoint(shadow._getCenter2DPoint()).add(dxdy),\n          symbol = shadow._getInternalSymbol();\n\n      var wh = handleViewPoint.sub(viewCenter);\n\n      if (blackList && handleViewPoint.y > viewCenter.y) {\n        wh.y = 0;\n      }\n\n      var r = blackList ? 1 : 2;\n      var width = Math.abs(wh.x) * 2,\n          height = Math.abs(wh.y) * r;\n\n      if (aspectRatio) {\n        width = Math.max(width, height * aspectRatio);\n        height = width / aspectRatio;\n      }\n\n      var ability = resizeAbilities[i];\n\n      if (!(shadow instanceof TextBox)) {\n        if (aspectRatio || ability === 0 || ability === 2) {\n          symbol['markerWidth'] = width;\n        }\n\n        if (aspectRatio || ability === 1 || ability === 2) {\n          symbol['markerHeight'] = height;\n        }\n\n        shadow.setSymbol(symbol);\n        geometryToEdit.setSymbol(symbol);\n      } else {\n        if (aspectRatio || ability === 0 || ability === 2) {\n          shadow.setWidth(width);\n          geometryToEdit.setWidth(width);\n        }\n\n        if (aspectRatio || ability === 1 || ability === 2) {\n          shadow.setHeight(height);\n          geometryToEdit.setHeight(height);\n        }\n      }\n    }, function () {\n      _this5._update(getUpdates());\n    });\n\n    function getUpdates() {\n      var updates = [['setCoordinates', shadow.getCoordinates().toArray()]];\n\n      if (shadow instanceof TextBox) {\n        updates.push(['setWidth', shadow.getWidth()]);\n        updates.push(['setHeight', shadow.getHeight()]);\n      } else {\n        updates.push(['setSymbol', shadow.getSymbol()]);\n      }\n\n      return updates;\n    }\n\n    function onZoomEnd() {\n      this._refresh();\n    }\n\n    this._addListener([map, 'zoomend', onZoomEnd]);\n  };\n\n  _proto.createCircleEditor = function createCircleEditor() {\n    var _this6 = this;\n\n    var circle = this._geometry,\n        shadow = this._shadow;\n    var map = this.getMap();\n\n    if (!this._history) {\n      this._recordHistory([['setCoordinates', shadow.getCoordinates().toArray()], ['setRadius', shadow.getRadius()]]);\n    }\n\n    this._createResizeHandles(null, function (handleViewPoint) {\n      var viewCenter = map._pointToViewPoint(shadow._getCenter2DPoint());\n\n      var wh = handleViewPoint.sub(viewCenter);\n      var w = Math.abs(wh.x),\n          h = Math.abs(wh.y);\n      var r;\n\n      if (w > h) {\n        r = map.pixelToDistance(w, 0);\n      } else {\n        r = map.pixelToDistance(0, h);\n      }\n\n      shadow.setRadius(r);\n      circle.setRadius(r);\n    }, function () {\n      _this6._update('setRadius', shadow.getRadius());\n    });\n  };\n\n  _proto.createEllipseOrRectEditor = function createEllipseOrRectEditor() {\n    var _this7 = this;\n\n    var resizeAbilities = [2, 1, 2, 0, 0, 2, 1, 2];\n    var geometryToEdit = this._geometry,\n        shadow = this._shadow;\n\n    if (!this._history) {\n      this._recordHistory(getUpdates());\n    }\n\n    var map = this.getMap();\n    var isRect = this._geometry instanceof Rectangle;\n    var aspectRatio;\n\n    if (this.options['fixAspectRatio']) {\n      aspectRatio = geometryToEdit.getWidth() / geometryToEdit.getHeight();\n    }\n\n    var resizeHandles = this._createResizeHandles(null, function (mouseViewPoint, i) {\n      var r = isRect ? 1 : 2;\n      var pointSub, w, h;\n      var targetPoint = mouseViewPoint;\n      var ability = resizeAbilities[i];\n\n      if (isRect) {\n        var mirror = resizeHandles[7 - i];\n        var mirrorViewPoint = map.coordToViewPoint(mirror.getCoordinates());\n        pointSub = targetPoint.sub(mirrorViewPoint);\n        var absSub = pointSub.abs();\n        w = map.pixelToDistance(absSub.x, 0);\n        h = map.pixelToDistance(0, absSub.y);\n        var size = geometryToEdit.getSize();\n\n        if (ability === 0) {\n          if (aspectRatio) {\n            absSub.y = absSub.x / aspectRatio;\n            size.height = Math.abs(absSub.y);\n            h = w / aspectRatio;\n          }\n\n          targetPoint.y = mirrorViewPoint.y - size.height / 2;\n        } else if (ability === 1) {\n          if (aspectRatio) {\n            absSub.x = absSub.y * aspectRatio;\n            size.width = Math.abs(absSub.x);\n            w = h * aspectRatio;\n          }\n\n          targetPoint.x = mirrorViewPoint.x - size.width / 2;\n        } else if (aspectRatio) {\n          if (w > h * aspectRatio) {\n            h = w / aspectRatio;\n            targetPoint.y = mirrorViewPoint.y + absSub.x * sign(pointSub.y) / aspectRatio;\n          } else {\n            w = h * aspectRatio;\n            targetPoint.x = mirrorViewPoint.x + absSub.y * sign(pointSub.x) * aspectRatio;\n          }\n        }\n\n        var newCoordinates = map.viewPointToCoordinate(new Point(Math.min(targetPoint.x, mirrorViewPoint.x), Math.min(targetPoint.y, mirrorViewPoint.y)));\n        shadow.setCoordinates(newCoordinates);\n\n        _this7._updateCoordFromShadow(true);\n      } else {\n        var viewCenter = map.coordToViewPoint(geometryToEdit.getCenter());\n        pointSub = viewCenter.sub(targetPoint)._abs();\n        w = map.pixelToDistance(pointSub.x, 0);\n        h = map.pixelToDistance(0, pointSub.y);\n\n        if (aspectRatio) {\n          w = Math.max(w, h * aspectRatio);\n          h = w / aspectRatio;\n        }\n      }\n\n      if (aspectRatio || ability === 0 || ability === 2) {\n        shadow.setWidth(w * r);\n        geometryToEdit.setWidth(w * r);\n      }\n\n      if (aspectRatio || ability === 1 || ability === 2) {\n        shadow.setHeight(h * r);\n        geometryToEdit.setHeight(h * r);\n      }\n    }, function () {\n      _this7._update(getUpdates());\n    });\n\n    function getUpdates() {\n      return [['setCoordinates', shadow.getCoordinates().toArray()], ['setWidth', shadow.getWidth()], ['setHeight', shadow.getHeight()]];\n    }\n  };\n\n  _proto.createPolygonEditor = function createPolygonEditor() {\n    var map = this.getMap(),\n        shadow = this._shadow,\n        me = this,\n        projection = map.getProjection();\n\n    if (!this._history) {\n      this._recordHistory('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n    }\n\n    var verticeLimit = shadow instanceof Polygon ? 3 : 2;\n    var propertyOfVertexRefreshFn = 'maptalks--editor-refresh-fn',\n        propertyOfVertexIndex = 'maptalks--editor-vertex-index';\n    var vertexHandles = [],\n        newVertexHandles = [];\n\n    function getVertexCoordinates() {\n      if (shadow instanceof Polygon) {\n        var coordinates = shadow.getCoordinates()[0];\n        return coordinates.slice(0, coordinates.length - 1);\n      } else {\n        return shadow.getCoordinates();\n      }\n    }\n\n    function getVertexPrjCoordinates() {\n      return shadow._getPrjCoordinates();\n    }\n\n    function onVertexAddOrRemove() {\n      for (var i = vertexHandles.length - 1; i >= 0; i--) {\n        vertexHandles[i][propertyOfVertexIndex] = i;\n      }\n\n      for (var _i = newVertexHandles.length - 1; _i >= 0; _i--) {\n        newVertexHandles[_i][propertyOfVertexIndex] = _i;\n      }\n\n      me._updateCoordFromShadow();\n    }\n\n    function removeVertex(param) {\n      var handle = param['target'],\n          index = handle[propertyOfVertexIndex];\n      var prjCoordinates = getVertexPrjCoordinates();\n\n      if (prjCoordinates.length <= verticeLimit) {\n        return;\n      }\n\n      prjCoordinates.splice(index, 1);\n\n      shadow._setPrjCoordinates(prjCoordinates);\n\n      shadow._updateCache();\n\n      vertexHandles.splice(index, 1)[0].remove();\n\n      if (index < newVertexHandles.length) {\n        newVertexHandles.splice(index, 1)[0].remove();\n      }\n\n      var nextIndex;\n\n      if (index === 0) {\n        nextIndex = newVertexHandles.length - 1;\n      } else {\n        nextIndex = index - 1;\n      }\n\n      newVertexHandles.splice(nextIndex, 1)[0].remove();\n      newVertexHandles.splice(nextIndex, 0, createNewVertexHandle.call(me, nextIndex));\n      onVertexAddOrRemove();\n\n      me._refresh();\n    }\n\n    function moveVertexHandle(handleViewPoint, index) {\n      var vertice = getVertexPrjCoordinates();\n\n      var nVertex = map._viewPointToPrj(handleViewPoint);\n\n      var pVertex = vertice[index];\n      pVertex.x = nVertex.x;\n      pVertex.y = nVertex.y;\n\n      shadow._updateCache();\n\n      shadow.onShapeChanged();\n\n      me._updateCoordFromShadow(true);\n\n      var nextIndex;\n\n      if (index === 0) {\n        nextIndex = newVertexHandles.length - 1;\n      } else {\n        nextIndex = index - 1;\n      }\n\n      if (newVertexHandles[index]) {\n        newVertexHandles[index][propertyOfVertexRefreshFn]();\n      }\n\n      if (newVertexHandles[nextIndex]) {\n        newVertexHandles[nextIndex][propertyOfVertexRefreshFn]();\n      }\n    }\n\n    function createVertexHandle(index) {\n      var vertex = getVertexCoordinates()[index];\n      var handle = me.createHandle(vertex, {\n        'symbol': me.options['vertexHandleSymbol'],\n        'cursor': 'pointer',\n        'axis': null,\n        onMove: function onMove(handleViewPoint) {\n          moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex]);\n        },\n        onRefresh: function onRefresh() {\n          vertex = getVertexCoordinates()[handle[propertyOfVertexIndex]];\n          handle.setCoordinates(vertex);\n        },\n        onUp: function onUp() {\n          me._refresh();\n\n          me._updateCoordFromShadow();\n        },\n        onDown: function onDown(param, e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n        }\n      });\n      handle[propertyOfVertexIndex] = index;\n      handle.on(me.options['removeVertexOn'], removeVertex);\n      return handle;\n    }\n\n    function createNewVertexHandle(index) {\n      var vertexCoordinates = getVertexCoordinates();\n      var nextVertex;\n\n      if (index + 1 >= vertexCoordinates.length) {\n        nextVertex = vertexCoordinates[0];\n      } else {\n        nextVertex = vertexCoordinates[index + 1];\n      }\n\n      var vertex = vertexCoordinates[index].add(nextVertex).multi(1 / 2);\n      var handle = me.createHandle(vertex, {\n        'symbol': me.options['newVertexHandleSymbol'],\n        'cursor': 'pointer',\n        'axis': null,\n        onDown: function onDown(param, e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n\n          var prjCoordinates = getVertexPrjCoordinates();\n          var vertexIndex = handle[propertyOfVertexIndex];\n          var pVertex = projection.project(handle.getCoordinates());\n          prjCoordinates.splice(vertexIndex + 1, 0, pVertex);\n\n          shadow._setPrjCoordinates(prjCoordinates);\n\n          shadow._updateCache();\n\n          var symbol = handle.getSymbol();\n          delete symbol['opacity'];\n          handle.setSymbol(symbol);\n          newVertexHandles.splice(vertexIndex, 0, createNewVertexHandle.call(me, vertexIndex), createNewVertexHandle.call(me, vertexIndex + 1));\n        },\n        onMove: function onMove(handleViewPoint) {\n          moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex] + 1);\n        },\n        onUp: function onUp(e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n\n          var vertexIndex = handle[propertyOfVertexIndex];\n          removeFromArray(handle, newVertexHandles);\n          handle.remove();\n          vertexHandles.splice(vertexIndex + 1, 0, createVertexHandle.call(me, vertexIndex + 1));\n          onVertexAddOrRemove();\n\n          me._updateCoordFromShadow();\n\n          me._refresh();\n        },\n        onRefresh: function onRefresh() {\n          vertexCoordinates = getVertexCoordinates();\n          var vertexIndex = handle[propertyOfVertexIndex];\n          var nextIndex;\n\n          if (vertexIndex === vertexCoordinates.length - 1) {\n            nextIndex = 0;\n          } else {\n            nextIndex = vertexIndex + 1;\n          }\n\n          var refreshVertex = vertexCoordinates[vertexIndex].add(vertexCoordinates[nextIndex]).multi(1 / 2);\n          handle.setCoordinates(refreshVertex);\n        }\n      });\n      handle[propertyOfVertexIndex] = index;\n      return handle;\n    }\n\n    var vertexCoordinates = getVertexCoordinates();\n\n    for (var i = 0, len = vertexCoordinates.length; i < len; i++) {\n      vertexHandles.push(createVertexHandle.call(this, i));\n\n      if (i < len - 1) {\n        newVertexHandles.push(createNewVertexHandle.call(this, i));\n      }\n    }\n\n    if (shadow instanceof Polygon) {\n      newVertexHandles.push(createNewVertexHandle.call(this, vertexCoordinates.length - 1));\n    }\n\n    this._addRefreshHook(function () {\n      for (var _i2 = newVertexHandles.length - 1; _i2 >= 0; _i2--) {\n        newVertexHandles[_i2][propertyOfVertexRefreshFn]();\n      }\n\n      for (var _i3 = vertexHandles.length - 1; _i3 >= 0; _i3--) {\n        vertexHandles[_i3][propertyOfVertexRefreshFn]();\n      }\n    });\n  };\n\n  _proto._refresh = function _refresh() {\n    if (this._refreshHooks) {\n      for (var i = this._refreshHooks.length - 1; i >= 0; i--) {\n        this._refreshHooks[i].call(this);\n      }\n    }\n  };\n\n  _proto._hideContext = function _hideContext() {\n    if (this._geometry) {\n      this._geometry.closeMenu();\n\n      this._geometry.closeInfoWindow();\n    }\n  };\n\n  _proto._addListener = function _addListener(listener) {\n    if (!this._eventListeners) {\n      this._eventListeners = [];\n    }\n\n    this._eventListeners.push(listener);\n\n    listener[0].on(listener[1], listener[2], this);\n  };\n\n  _proto._clearAllListeners = function _clearAllListeners() {\n    if (this._eventListeners && this._eventListeners.length > 0) {\n      for (var i = this._eventListeners.length - 1; i >= 0; i--) {\n        var listener = this._eventListeners[i];\n        listener[0].off(listener[1], listener[2], this);\n      }\n\n      this._eventListeners = [];\n    }\n  };\n\n  _proto._addRefreshHook = function _addRefreshHook(fn) {\n    if (!fn) {\n      return;\n    }\n\n    if (!this._refreshHooks) {\n      this._refreshHooks = [];\n    }\n\n    this._refreshHooks.push(fn);\n  };\n\n  _proto._update = function _update(method) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    this._exeHistory([method, args]);\n\n    this._recordHistory.apply(this, [method].concat(args));\n  };\n\n  _proto._updateCoordFromShadow = function _updateCoordFromShadow(ignoreRecord) {\n    if (!this._shadow) {\n      return;\n    }\n\n    var coords = this._shadow.getCoordinates();\n\n    var geo = this._geometry;\n    var updating = this._updating;\n    this._updating = true;\n    geo.setCoordinates(coords);\n\n    if (!ignoreRecord) {\n      this._recordHistory('setCoordinates', Coordinate.toNumberArrays(geo.getCoordinates()));\n    }\n\n    this._updating = updating;\n  };\n\n  _proto._recordHistory = function _recordHistory(method) {\n    if (!this._history) {\n      this._history = [];\n      this._historyPointer = 0;\n    }\n\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    if (this._history.length) {\n      var lastOperation = this._history[this._history.length - 1];\n\n      if (lastOperation[0] === method && JSON.stringify(lastOperation[1]) === JSON.stringify(args)) {\n        return;\n      }\n    }\n\n    if (this._historyPointer < this._history.length - 1) {\n      this._history.splice(this._historyPointer + 1);\n    }\n\n    this._history.push([method, args]);\n\n    this._historyPointer = this._history.length - 1;\n\n    this._geometry.fire('editrecord');\n  };\n\n  _proto.cancel = function cancel() {\n    if (!this._history || this._historyPointer === 0) {\n      return this;\n    }\n\n    this._historyPointer = 0;\n    var record = this._history[0];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto.undo = function undo() {\n    if (!this._history || this._historyPointer === 0) {\n      return this;\n    }\n\n    var record = this._history[--this._historyPointer];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    if (!this._history || this._historyPointer === this._history.length - 1) {\n      return this;\n    }\n\n    var record = this._history[++this._historyPointer];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto._exeAndReset = function _exeAndReset(record) {\n    if (this._updating) {\n      return;\n    }\n\n    this._exeHistory(record);\n\n    var history = this._history,\n        pointer = this._historyPointer;\n    this.stop();\n    this._history = history;\n    this._historyPointer = pointer;\n    this.start();\n  };\n\n  _proto._exeHistory = function _exeHistory(record) {\n    var _this8 = this;\n\n    if (!Array.isArray(record)) {\n      return;\n    }\n\n    var updating = this._updating;\n    this._updating = true;\n    var geo = this._geometry;\n\n    if (Array.isArray(record[0])) {\n      record[0].forEach(function (o) {\n        var m = o[0],\n            args = o.slice(1);\n\n        _this8._shadow[m].apply(_this8._shadow, args);\n\n        geo[m].apply(geo, args);\n      });\n    } else {\n      this._shadow[record[0]].apply(this._shadow, record[1]);\n\n      geo[record[0]].apply(geo, record[1]);\n    }\n\n    this._updating = updating;\n  };\n\n  return GeometryEditor;\n}(Eventable(Class));\n\nGeometryEditor.mergeOptions(options$z);\nvar TextEditable = {\n  startEditText: function startEditText() {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    this.hide();\n    this.endEditText();\n\n    this._prepareEditor();\n\n    this._fireEvent('edittextstart');\n\n    return this;\n  },\n  endEditText: function endEditText() {\n    if (this._textEditor) {\n      var html = this._textEditor.innerHTML;\n      html = html.replace(/<p>/ig, '').replace(/<\\/p>/ig, '<br/>');\n      this._textEditor.innerHTML = html;\n\n      var content = this._textEditor.innerText.replace(/[\\r\\n]+$/gi, '');\n\n      this.setContent(content);\n      off(this._textEditor, 'mousedown dblclick', stopPropagation);\n      this.getMap().off('mousedown', this.endEditText, this);\n\n      this._editUIMarker.remove();\n\n      delete this._editUIMarker;\n      this._textEditor.onkeyup = null;\n      delete this._textEditor;\n      this.show();\n\n      this._fireEvent('edittextend');\n    }\n\n    return this;\n  },\n  isEditingText: function isEditingText() {\n    if (this._textEditor) {\n      return true;\n    }\n\n    return false;\n  },\n  getTextEditor: function getTextEditor() {\n    return this._editUIMarker;\n  },\n  _prepareEditor: function _prepareEditor() {\n    var map = this.getMap();\n\n    var editContainer = this._createEditor();\n\n    this._textEditor = editContainer;\n    map.on('mousedown', this.endEditText, this);\n\n    var offset = this._getEditorOffset();\n\n    this._editUIMarker = new UIMarker(this.getCoordinates(), {\n      'animation': null,\n      'content': editContainer,\n      'dx': offset.dx,\n      'dy': offset.dy\n    }).addTo(map);\n\n    this._setCursorToLast(this._textEditor);\n  },\n  _getEditorOffset: function _getEditorOffset() {\n    var symbol = this._getInternalSymbol() || {};\n    var dx = 0,\n        dy = 0;\n    var textAlign = symbol['textHorizontalAlignment'];\n\n    if (textAlign === 'middle' || isNil(textAlign)) {\n      dx = (symbol['textDx'] || 0) - 2;\n      dy = (symbol['textDy'] || 0) - 2;\n    } else {\n      dx = (symbol['markerDx'] || 0) - 2;\n      dy = (symbol['markerDy'] || 0) - 2;\n    }\n\n    return {\n      'dx': dx,\n      'dy': dy\n    };\n  },\n  _createEditor: function _createEditor() {\n    var content = this.getContent();\n    var labelSize = this.getSize(),\n        symbol = this._getInternalSymbol() || {},\n        width = labelSize.width,\n        textColor = symbol['textFill'] || '#000000',\n        textSize = symbol['textSize'] || 12,\n        height = labelSize.height,\n        lineColor = symbol['markerLineColor'] || '#000',\n        fill = symbol['markerFill'] || '#3398CC',\n        spacing = symbol['textLineSpacing'] || 0;\n    var editor = createEl('div');\n    editor.contentEditable = true;\n    editor.style.cssText = \"background:\" + fill + \"; border:1px solid \" + lineColor + \";\\n            color:\" + textColor + \";font-size:\" + textSize + \"px;width:\" + (width - 2) + \"px;height:\" + (height - 2) + \"px;margin: auto;\\n            line-height:\" + (textSize + spacing) + \"px;outline: 0; padding:0; margin:0;word-wrap: break-word;\\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;\";\n    editor.innerText = content;\n    on(editor, 'mousedown dblclick', stopPropagation);\n\n    editor.onkeyup = function (event) {\n      var h = editor.style.height || 0;\n\n      if (event.keyCode === 13) {\n        editor.style.height = parseInt(h) + textSize / 2 + 'px';\n      }\n    };\n\n    return editor;\n  },\n  _setCursorToLast: function _setCursorToLast(obj) {\n    var range;\n\n    if (window.getSelection) {\n      obj.focus();\n      range = window.getSelection();\n      range.selectAllChildren(obj);\n      range.collapseToEnd();\n    } else if (document.selection) {\n      range = document.selection.createRange();\n      range.moveToElementText(obj);\n      range.collapse(false);\n      range.select();\n    }\n  }\n};\nTextMarker.include(TextEditable);\nGeometry.include({\n  animate: function animate(styles, options, step) {\n    var _this = this;\n\n    if (this._animPlayer) {\n      this._animPlayer.finish();\n    }\n\n    if (isFunction(options)) {\n      step = options;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    var map = this.getMap(),\n        projection = this._getProjection(),\n        symbol = this.getSymbol() || {},\n        stylesToAnimate = this._prepareAnimationStyles(styles);\n\n    var preTranslate;\n    var isFocusing = options['focus'];\n    delete this._animationStarted;\n\n    if (map) {\n      var renderer = map._getRenderer();\n\n      var framer = function framer(fn) {\n        renderer.callInNextFrame(fn);\n      };\n\n      options['framer'] = framer;\n    }\n\n    var player = Animation.animate(stylesToAnimate, options, function (frame) {\n      if (map && map.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      if (map && !_this._animationStarted && isFocusing) {\n        map.onMoveStart();\n      }\n\n      var styles = frame.styles;\n\n      for (var p in styles) {\n        if (p !== 'symbol' && p !== 'translate' && styles.hasOwnProperty(p)) {\n          var fnName = 'set' + p[0].toUpperCase() + p.slice(1);\n\n          _this[fnName](styles[p]);\n        }\n      }\n\n      var translate = styles['translate'];\n\n      if (translate) {\n        var toTranslate = translate;\n\n        if (preTranslate) {\n          toTranslate = translate.sub(preTranslate);\n        }\n\n        preTranslate = translate;\n\n        _this.translate(toTranslate);\n      }\n\n      var dSymbol = styles['symbol'];\n\n      if (dSymbol) {\n        _this.setSymbol(extendSymbol(symbol, dSymbol));\n      }\n\n      if (map && isFocusing) {\n        var pcenter = projection.project(_this.getCenter());\n\n        map._setPrjCenter(pcenter);\n\n        var e = map._parseEventFromCoord(projection.unproject(pcenter));\n\n        if (player.playState !== 'running') {\n          map.onMoveEnd(e);\n        } else {\n          map.onMoving(e);\n        }\n      }\n\n      _this._fireAnimateEvent(player.playState);\n\n      if (step) {\n        step(frame);\n      }\n    }, this);\n    this._animPlayer = player;\n    return this._animPlayer.play();\n  },\n  _prepareAnimationStyles: function _prepareAnimationStyles(styles) {\n    var symbol = this._getInternalSymbol();\n\n    var stylesToAnimate = {};\n\n    for (var p in styles) {\n      if (styles.hasOwnProperty(p)) {\n        var v = styles[p];\n\n        if (p !== 'translate' && p !== 'symbol') {\n          var fnName = 'get' + p[0].toUpperCase() + p.substring(1);\n          var current = this[fnName]();\n          stylesToAnimate[p] = [current, v];\n        } else if (p === 'symbol') {\n          var symbolToAnimate = void 0;\n\n          if (Array.isArray(styles['symbol'])) {\n            if (!Array.isArray(symbol)) {\n              throw new Error('geometry\\'symbol isn\\'t a composite symbol, while the symbol in styles is.');\n            }\n\n            symbolToAnimate = [];\n            var symbolInStyles = styles['symbol'];\n\n            for (var i = 0; i < symbolInStyles.length; i++) {\n              if (!symbolInStyles[i]) {\n                symbolToAnimate.push(null);\n                continue;\n              }\n\n              var a = {};\n\n              for (var sp in symbolInStyles[i]) {\n                if (symbolInStyles[i].hasOwnProperty(sp)) {\n                  a[sp] = [symbol[i][sp], symbolInStyles[i][sp]];\n                }\n              }\n\n              symbolToAnimate.push(a);\n            }\n          } else {\n            if (Array.isArray(symbol)) {\n              throw new Error('geometry\\'symbol is a composite symbol, while the symbol in styles isn\\'t.');\n            }\n\n            symbolToAnimate = {};\n\n            for (var _sp in v) {\n              if (v.hasOwnProperty(_sp)) {\n                symbolToAnimate[_sp] = [symbol[_sp], v[_sp]];\n              }\n            }\n          }\n\n          stylesToAnimate['symbol'] = symbolToAnimate;\n        } else if (p === 'translate') {\n          stylesToAnimate['translate'] = new Coordinate(v);\n        }\n      }\n    }\n\n    return stylesToAnimate;\n  },\n  _fireAnimateEvent: function _fireAnimateEvent(playState) {\n    if (playState === 'finished') {\n      delete this._animationStarted;\n\n      this._fireEvent('animateend');\n    } else if (playState === 'running') {\n      if (this._animationStarted) {\n        this._fireEvent('animating');\n      } else {\n        this._fireEvent('animatestart');\n\n        this._animationStarted = true;\n      }\n    }\n  }\n});\nvar DRAG_STAGE_LAYER_ID = INTERNAL_LAYER_PREFIX + '_drag_stage';\nvar EVENTS$2 = Browser$1.touch ? 'touchstart mousedown' : 'mousedown';\n\nvar GeometryDragHandler = function (_Handler) {\n  _inheritsLoose(GeometryDragHandler, _Handler);\n\n  function GeometryDragHandler(target) {\n    return _Handler.call(this, target) || this;\n  }\n\n  var _proto = GeometryDragHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    this.target.on(EVENTS$2, this._startDrag, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this._endDrag();\n\n    this.target.off(EVENTS$2, this._startDrag, this);\n    delete this.container;\n  };\n\n  _proto._prepareDragHandler = function _prepareDragHandler() {\n    this._dragHandler = new DragHandler(this.container);\n\n    this._dragHandler.on('dragging', this._dragging, this).on('mouseup', this._endDrag, this).enable();\n  };\n\n  _proto._prepareShadow = function _prepareShadow() {\n    var _this = this;\n\n    var target = this.target;\n\n    this._prepareDragStageLayer();\n\n    if (this._shadow) {\n      this._shadow.remove();\n    }\n\n    var shadow = this._shadow = target.copy();\n\n    if (shadow.getGeometries) {\n      var shadows = shadow.getGeometries();\n      var geos = target.getGeometries();\n      shadows.forEach(function (g, i) {\n        _this._updateShadowSymbol(g, geos[i]);\n      });\n    } else {\n      this._updateShadowSymbol(shadow, target);\n    }\n\n    shadow.setId(null);\n\n    this._prepareShadowConnectors();\n  };\n\n  _proto._updateShadowSymbol = function _updateShadowSymbol(shadow, target) {\n    shadow.setSymbol(target._getInternalSymbol());\n\n    if (target.options['dragShadow']) {\n      var symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n      shadow.setSymbol(symbol);\n    }\n  };\n\n  _proto._prepareShadowConnectors = function _prepareShadowConnectors() {\n    var target = this.target;\n    var shadow = this._shadow;\n\n    var resources = this._dragStageLayer._getRenderer().resources;\n\n    var shadowConnectors = [];\n\n    if (ConnectorLine._hasConnectors(target)) {\n      var connectors = ConnectorLine._getConnectors(target);\n\n      for (var i = 0, l = connectors.length; i < l; i++) {\n        var targetConn = connectors[i];\n\n        var connOptions = targetConn.config(),\n            connSymbol = targetConn._getInternalSymbol();\n\n        connOptions['symbol'] = lowerSymbolOpacity(connSymbol, 0.5);\n        var conn = void 0;\n\n        if (targetConn.getConnectSource() === target) {\n          conn = new targetConn.constructor(shadow, targetConn.getConnectTarget(), connOptions);\n        } else {\n          conn = new targetConn.constructor(targetConn.getConnectSource(), shadow, connOptions);\n        }\n\n        shadowConnectors.push(conn);\n\n        if (targetConn.getLayer() && targetConn.getLayer()._getRenderer()) {\n          resources.merge(targetConn.getLayer()._getRenderer().resources);\n        }\n      }\n    }\n\n    this._shadowConnectors = shadowConnectors;\n    shadowConnectors.push(shadow);\n\n    this._dragStageLayer.bringToFront().addGeometry(shadowConnectors);\n  };\n\n  _proto._onTargetUpdated = function _onTargetUpdated() {\n    if (this._shadow) {\n      this._shadow.setSymbol(this.target._getSymbol());\n    }\n  };\n\n  _proto._prepareDragStageLayer = function _prepareDragStageLayer() {\n    var map = this.target.getMap(),\n        layer = this.target.getLayer();\n    this._dragStageLayer = map.getLayer(DRAG_STAGE_LAYER_ID);\n\n    if (!this._dragStageLayer) {\n      this._dragStageLayer = new VectorLayer(DRAG_STAGE_LAYER_ID, {\n        enableAltitude: layer.options['enableAltitude'],\n        altitudeProperty: layer.options['altitudeProperty']\n      });\n      map.addLayer(this._dragStageLayer);\n    }\n\n    var resources = new ResourceCache();\n    resources.merge(layer._getRenderer().resources);\n    this._dragStageLayer._getRenderer().resources = resources;\n  };\n\n  _proto._startDrag = function _startDrag(param) {\n    var map = this.target.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var parent = this.target._getParent();\n\n    if (parent) {\n      return;\n    }\n\n    if (this.isDragging()) {\n      return;\n    }\n\n    var domEvent = param['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n      return;\n    }\n\n    this.container = map._panels.mapWrapper || map._containerDOM;\n    this.target.on('click', this._endDrag, this);\n    this._lastCoord = this._correctCoord(param['coordinate']);\n    this._lastPoint = param['containerPoint'];\n\n    this._prepareDragHandler();\n\n    this._dragHandler.onMouseDown(param['domEvent']);\n\n    on(this.container, 'mouseleave', this._endDrag, this);\n    this._startParam = param;\n    this._moved = false;\n    return;\n  };\n\n  _proto._dragging = function _dragging(param) {\n    var target = this.target;\n\n    var map = target.getMap(),\n        e = map._parseEvent(param['domEvent']);\n\n    var domEvent = e['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1) {\n      return;\n    }\n\n    if (!this._moved) {\n      this._moved = true;\n      target.on('symbolchange', this._onTargetUpdated, this);\n      this._isDragging = true;\n\n      this._prepareShadow();\n\n      if (!target.options['dragShadow']) {\n        target.hide();\n      }\n\n      this._shadow._fireEvent('dragstart', e);\n\n      this.target._fireEvent('dragstart', this._startParam || e);\n\n      delete this._startParam;\n      return;\n    }\n\n    if (!this._shadow) {\n      return;\n    }\n\n    var axis = this._shadow.options['dragOnAxis'],\n        coord = this._correctCoord(e['coordinate']),\n        point = e['containerPoint'];\n\n    this._lastPoint = this._lastPoint || point;\n    this._lastCoord = this._lastCoord || coord;\n    var pointOffset = point.sub(this._lastPoint);\n    var coordOffset = coord.sub(this._lastCoord);\n\n    if (axis === 'x') {\n      pointOffset.y = coordOffset.y = 0;\n    } else if (axis === 'y') {\n      pointOffset.x = coordOffset.x = 0;\n    }\n\n    this._lastPoint = point;\n    this._lastCoord = coord;\n\n    this._shadow.translate(coordOffset);\n\n    if (!target.options['dragShadow']) {\n      target.translate(coordOffset);\n    }\n\n    e['coordOffset'] = coordOffset;\n    e['pointOffset'] = pointOffset;\n\n    this._shadow._fireEvent('dragging', e);\n\n    target._fireEvent('dragging', e);\n  };\n\n  _proto._endDrag = function _endDrag(param) {\n    if (this._dragHandler) {\n      this._dragHandler.disable();\n\n      delete this._dragHandler;\n    }\n\n    if (this.container) {\n      off(this.container, 'mouseleave', this._endDrag, this);\n    }\n\n    if (!this.target) {\n      return;\n    }\n\n    var target = this.target;\n    target.off('click', this._endDrag, this);\n    target.off('symbolchange', this._onTargetUpdated, this);\n    delete this._lastCoord;\n    delete this._lastPoint;\n    this._isDragging = false;\n    var map = target.getMap();\n\n    if (this.enabled() && map) {\n      var e = map._parseEvent(param ? param['domEvent'] : null);\n\n      this._updateTargetAndRemoveShadow(e);\n\n      if (this._moved) {\n        target._fireEvent('dragend', e);\n      }\n    }\n  };\n\n  _proto.isDragging = function isDragging() {\n    if (!this._isDragging) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto._updateTargetAndRemoveShadow = function _updateTargetAndRemoveShadow(eventParam) {\n    var target = this.target,\n        map = target.getMap();\n\n    if (!target.options['dragShadow']) {\n      target.show();\n    }\n\n    var shadow = this._shadow;\n\n    if (shadow) {\n      if (target.options['dragShadow']) {\n        if (target.getGeometries) {\n          var shadows = shadow.getGeometries();\n          var geos = target.getGeometries();\n          shadows.forEach(function (g, i) {\n            geos[i].setCoordinates(shadows[i].getCoordinates());\n          });\n        } else {\n          target.setCoordinates(shadow.getCoordinates());\n        }\n      }\n\n      shadow._fireEvent('dragend', eventParam);\n\n      shadow.remove();\n      delete this._shadow;\n    }\n\n    if (this._shadowConnectors) {\n      map.getLayer(DRAG_STAGE_LAYER_ID).removeGeometry(this._shadowConnectors);\n      delete this._shadowConnectors;\n    }\n\n    if (this._dragStageLayer) {\n      this._dragStageLayer.remove();\n    }\n  };\n\n  _proto._correctCoord = function _correctCoord(coord) {\n    var map = this.target.getMap();\n\n    if (!map.getPitch()) {\n      return coord;\n    }\n\n    var painter = this.target._getPainter();\n\n    if (!painter.getMinAltitude()) {\n      return coord;\n    }\n\n    var alt = (painter.getMinAltitude() + painter.getMaxAltitude()) / 2;\n    return map.locateByPoint(coord, 0, -alt);\n  };\n\n  return GeometryDragHandler;\n}(Handler$1);\n\nGeometry.mergeOptions({\n  'draggable': false,\n  'dragShadow': true,\n  'dragOnAxis': null\n});\nGeometry.addInitHook('addHandler', 'draggable', GeometryDragHandler);\nGeometry.include({\n  isDragging: function isDragging() {\n    if (this._getParent()) {\n      return this._getParent().isDragging();\n    }\n\n    if (this['draggable']) {\n      return this['draggable'].isDragging();\n    }\n\n    return false;\n  }\n});\nGeometry.include({\n  startEdit: function startEdit(opts) {\n    if (!this.getMap() || !this.options['editable']) {\n      return this;\n    }\n\n    this.endEdit();\n    this._editor = new GeometryEditor(this, opts);\n\n    this._editor.start();\n\n    this.fire('editstart');\n    return this;\n  },\n  endEdit: function endEdit() {\n    if (this._editor) {\n      this._editor.stop();\n\n      delete this._editor;\n      this.fire('editend');\n    }\n\n    return this;\n  },\n  redoEdit: function redoEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.redo();\n\n    this.fire('redoedit');\n    return this;\n  },\n  undoEdit: function undoEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.undo();\n\n    this.fire('undoedit');\n    return this;\n  },\n  cancelEdit: function cancelEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.cancel();\n\n    this.fire('canceledit');\n    return this;\n  },\n  isEditing: function isEditing() {\n    if (this._editor) {\n      return this._editor.isEditing();\n    }\n\n    return false;\n  }\n});\nGeometry.include({\n  _onEvent: function _onEvent(event, type) {\n    if (!this.getMap()) {\n      return;\n    }\n\n    var eventType = type || this._getEventTypeToFire(event);\n\n    if (eventType === 'contextmenu' && this.listens('contextmenu')) {\n      stopPropagation(event);\n      preventDefault(event);\n    }\n\n    var params = this._getEventParams(event);\n\n    this._fireEvent(eventType, params);\n  },\n  _getEventTypeToFire: function _getEventTypeToFire(domEvent) {\n    return domEvent.type;\n  },\n  _getEventParams: function _getEventParams(e) {\n    var map = this.getMap();\n    var eventParam = {\n      'domEvent': e\n    };\n    var actual = e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n\n    if (actual) {\n      var containerPoint = getEventContainerPoint(actual, map._containerDOM);\n      eventParam['coordinate'] = map.containerPointToCoordinate(containerPoint);\n      eventParam['containerPoint'] = containerPoint;\n      eventParam['viewPoint'] = map.containerPointToViewPoint(containerPoint);\n      eventParam['pont2d'] = map._containerPointToPoint(containerPoint);\n    }\n\n    return eventParam;\n  }\n});\nGeometry.include({\n  setInfoWindow: function setInfoWindow(options) {\n    this.removeInfoWindow();\n\n    if (options instanceof InfoWindow) {\n      this._infoWindow = options;\n      this._infoWinOptions = extend({}, this._infoWindow.options);\n\n      this._infoWindow.addTo(this);\n\n      return this;\n    }\n\n    this._infoWinOptions = extend({}, options);\n\n    if (this._infoWindow) {\n      this._infoWindow.setOptions(options);\n    } else if (this.getMap()) {\n      this._bindInfoWindow(this._infoWinOptions);\n    }\n\n    return this;\n  },\n  getInfoWindow: function getInfoWindow() {\n    if (!this._infoWindow) {\n      return null;\n    }\n\n    return this._infoWindow;\n  },\n  openInfoWindow: function openInfoWindow(coordinate) {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (!coordinate) {\n      coordinate = this.getCenter();\n    }\n\n    if (!this._infoWindow) {\n      if (this._infoWinOptions && this.getMap()) {\n        this._bindInfoWindow(this._infoWinOptions);\n\n        this._infoWindow.show(coordinate);\n      }\n    } else {\n      this._infoWindow.show(coordinate);\n    }\n\n    return this;\n  },\n  closeInfoWindow: function closeInfoWindow() {\n    if (this._infoWindow) {\n      this._infoWindow.hide();\n    }\n\n    return this;\n  },\n  removeInfoWindow: function removeInfoWindow() {\n    this._unbindInfoWindow();\n\n    delete this._infoWinOptions;\n    delete this._infoWindow;\n    return this;\n  },\n  _bindInfoWindow: function _bindInfoWindow(options) {\n    this._infoWindow = new InfoWindow(options);\n\n    this._infoWindow.addTo(this);\n\n    return this;\n  },\n  _unbindInfoWindow: function _unbindInfoWindow() {\n    if (this._infoWindow) {\n      this.closeInfoWindow();\n\n      this._infoWindow.remove();\n\n      delete this._infoWindow;\n    }\n\n    return this;\n  }\n});\n\nvar LRUCache = function () {\n  function LRUCache(max, onRemove) {\n    this.max = max;\n    this.onRemove = onRemove;\n    this.reset();\n  }\n\n  var _proto = LRUCache.prototype;\n\n  _proto.reset = function reset() {\n    for (var key in this.data) {\n      this.onRemove(this.data[key]);\n    }\n\n    this.data = {};\n    this.order = [];\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this.reset();\n    delete this.onRemove;\n  };\n\n  _proto.add = function add(key, data) {\n    if (this.has(key)) {\n      this.order.splice(this.order.indexOf(key), 1);\n      this.data[key] = data;\n      this.order.push(key);\n    } else {\n      this.data[key] = data;\n      this.order.push(key);\n\n      if (this.order.length > this.max) {\n        var removedData = this.getAndRemove(this.order[0]);\n        if (removedData) this.onRemove(removedData);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.has = function has(key) {\n    return key in this.data;\n  };\n\n  _proto.keys = function keys() {\n    return this.order;\n  };\n\n  _proto.getAndRemove = function getAndRemove(key) {\n    if (!this.has(key)) {\n      return null;\n    }\n\n    var data = this.data[key];\n    delete this.data[key];\n    this.order.splice(this.order.indexOf(key), 1);\n    return data;\n  };\n\n  _proto.get = function get(key) {\n    if (!this.has(key)) {\n      return null;\n    }\n\n    var data = this.data[key];\n    return data;\n  };\n\n  _proto.remove = function remove(key) {\n    if (!this.has(key)) {\n      return this;\n    }\n\n    var data = this.data[key];\n    delete this.data[key];\n    this.onRemove(data);\n    this.order.splice(this.order.indexOf(key), 1);\n    return this;\n  };\n\n  _proto.setMaxSize = function setMaxSize(max) {\n    this.max = max;\n\n    while (this.order.length > this.max) {\n      var removedData = this.getAndRemove(this.order[0]);\n      if (removedData) this.onRemove(removedData);\n    }\n\n    return this;\n  };\n\n  return LRUCache;\n}();\n\nvar TEMP_POINT$3 = new Point(0, 0);\nvar TEMP_POINT1$2 = new Point(0, 0);\nvar TEMP_POINT2$1 = new Point(0, 0);\n\nvar TileLayerCanvasRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(TileLayerCanvasRenderer, _CanvasRenderer);\n\n  function TileLayerCanvasRenderer(layer) {\n    var _this;\n\n    _this = _CanvasRenderer.call(this, layer) || this;\n    _this.tilesInView = {};\n    _this.tilesLoading = {};\n    _this._parentTiles = [];\n    _this._childTiles = [];\n    _this.tileCache = new LRUCache(layer.options['maxCacheSize'], _this.deleteTile.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n    return _this;\n  }\n\n  var _proto = TileLayerCanvasRenderer.prototype;\n\n  _proto.getCurrentTileZoom = function getCurrentTileZoom() {\n    return this._tileZoom;\n  };\n\n  _proto.draw = function draw() {\n    var map = this.getMap();\n\n    if (!this.isDrawable()) {\n      return;\n    }\n\n    var mask2DExtent = this.prepareCanvas();\n\n    if (mask2DExtent) {\n      if (!mask2DExtent.intersects(this.canvasExtent2D)) {\n        this.completeRender();\n        return;\n      }\n    }\n\n    var layer = this.layer;\n    var tileGrids = layer.getTiles().tileGrids;\n\n    if (!tileGrids || !tileGrids.length) {\n      this.completeRender();\n      return;\n    }\n\n    var loadingCount = 0;\n    var loading = false;\n    var checkedTiles = {};\n    var tiles = [],\n        parentTiles = [],\n        parentKeys = {},\n        childTiles = [],\n        childKeys = {},\n        placeholders = [],\n        placeholderKeys = {};\n    var tileQueue = {};\n\n    var preLoadingCount = this._markTiles(),\n        loadingLimit = this._getLoadLimit();\n\n    var l = tileGrids.length;\n    this._tileZoom = tileGrids[0]['zoom'];\n    this._tileOffset = tileGrids[0]['offset'];\n\n    for (var i = 0; i < l; i++) {\n      var tileGrid = tileGrids[i];\n      var allTiles = tileGrid['tiles'];\n\n      var placeholder = this._generatePlaceHolder(tileGrid.zoom);\n\n      for (var _i = 0, _l = allTiles.length; _i < _l; _i++) {\n        var tile = allTiles[_i],\n            tileId = tile['id'];\n        var tileLoading = false;\n\n        if (this._isLoadingTile(tileId)) {\n          tileLoading = loading = true;\n          this.tilesLoading[tileId].current = true;\n        } else {\n          var cached = this._getCachedTile(tileId);\n\n          if (cached) {\n            if (cached.image && this.getTileOpacity(cached.image) < 1) {\n              tileLoading = loading = true;\n            }\n\n            tiles.push(cached);\n          } else {\n            tileLoading = loading = true;\n            var hitLimit = loadingLimit && loadingCount + preLoadingCount[0] > loadingLimit;\n\n            if (!hitLimit && (!map.isInteracting() || map.isMoving() || map.isRotating())) {\n              loadingCount++;\n              tileQueue[tileId + '@' + tile['point'].toArray().join()] = tile;\n            }\n          }\n        }\n\n        if (!tileLoading) continue;\n\n        if (checkedTiles[tileId]) {\n          continue;\n        }\n\n        checkedTiles[tileId] = 1;\n\n        if (placeholder && !placeholderKeys[tileId]) {\n          tile.cache = false;\n          placeholders.push({\n            image: placeholder,\n            info: tile\n          });\n          placeholderKeys[tileId] = 1;\n        }\n\n        var parentTile = this._findParentTile(tile);\n\n        if (parentTile) {\n          var parentId = parentTile.info.id;\n\n          if (parentKeys[parentId] === undefined) {\n            parentKeys[parentId] = parentTiles.length;\n            parentTiles.push(parentTile);\n          }\n        } else if (!parentTiles.length) {\n          var children = this._findChildTiles(tile);\n\n          if (children.length) {\n            children.forEach(function (c) {\n              if (!childKeys[c.info.id]) {\n                childTiles.push(c);\n                childKeys[c.info.id] = 1;\n              }\n            });\n          }\n        }\n      }\n    }\n\n    if (parentTiles.length) {\n      childTiles.length = 0;\n      this._childTiles.length = 0;\n    }\n\n    this._drawTiles(tiles, parentTiles, childTiles, placeholders);\n\n    if (!loadingCount) {\n      if (!loading) {\n        if (!map.isAnimating() && (this._parentTiles.length || this._childTiles.length)) {\n          this._parentTiles = [];\n          this._childTiles = [];\n          this.setToRedraw();\n        }\n\n        this.completeRender();\n      }\n    } else {\n      this.loadTileQueue(tileQueue);\n    }\n\n    this._retireTiles();\n  };\n\n  _proto.isTileCachedOrLoading = function isTileCachedOrLoading(tileId) {\n    return this.tilesLoading[tileId] || this.tilesInView[tileId] || this.tileCache.get(tileId);\n  };\n\n  _proto._drawTiles = function _drawTiles(tiles, parentTiles, childTiles, placeholders) {\n    var _this2 = this;\n\n    if (parentTiles.length) {\n      parentTiles.sort(function (t1, t2) {\n        return Math.abs(t2.info.z - _this2._tileZoom) - Math.abs(t1.info.z - _this2._tileZoom);\n      });\n      this._parentTiles = parentTiles;\n    }\n\n    if (childTiles.length) {\n      this._childTiles = childTiles;\n    }\n\n    var context = {\n      tiles: tiles,\n      parentTiles: this._parentTiles,\n      childTiles: this._childTiles\n    };\n    this.onDrawTileStart(context);\n\n    this._parentTiles.forEach(function (t) {\n      return _this2._drawTileAndCache(t);\n    });\n\n    this._childTiles.forEach(function (t) {\n      return _this2._drawTileOffset(t.info, t.image);\n    });\n\n    placeholders.forEach(function (t) {\n      return _this2._drawTileOffset(t.info, t.image);\n    });\n    var layer = this.layer,\n        map = this.getMap();\n\n    if (!layer.options['cascadeTiles'] || map.getPitch() <= map.options['cascadePitches'][0]) {\n      tiles.forEach(function (t) {\n        return _this2._drawTileAndCache(t);\n      });\n    } else {\n      this.writeZoomStencil();\n      var started = false;\n\n      for (var i = 0, l = tiles.length; i < l; i++) {\n        if (tiles[i].info.z !== this._tileZoom) {\n          if (!started) {\n            this.startZoomStencilTest();\n            started = true;\n          } else {\n            this.resumeZoomStencilTest();\n          }\n        } else if (started) {\n          this.pauseZoomStencilTest();\n        }\n\n        this._drawTileAndCache(tiles[i]);\n      }\n\n      this.endZoomStencilTest();\n    }\n\n    this.onDrawTileEnd(context);\n  };\n\n  _proto.writeZoomStencil = function writeZoomStencil() {};\n\n  _proto.startZoomStencilTest = function startZoomStencilTest() {};\n\n  _proto.endZoomStencilTest = function endZoomStencilTest() {};\n\n  _proto.pauseZoomStencilTest = function pauseZoomStencilTest() {};\n\n  _proto.resumeZoomStencilTest = function resumeZoomStencilTest() {};\n\n  _proto.onDrawTileStart = function onDrawTileStart() {};\n\n  _proto.onDrawTileEnd = function onDrawTileEnd() {};\n\n  _proto._drawTileOffset = function _drawTileOffset(info, image) {\n    if (!image) {\n      return;\n    }\n\n    var offset = this._tileOffset;\n\n    if (!offset[0] && !offset[1]) {\n      this.drawTile(info, image);\n      return;\n    }\n\n    var map = this.getMap();\n\n    var scale = map._getResolution(this._tileZoom) / map._getResolution(info.z);\n\n    offset[0] *= scale;\n    offset[1] *= scale;\n\n    info.point._sub(offset);\n\n    info.extent2d._sub(offset);\n\n    this.drawTile(info, image);\n\n    info.point._add(offset);\n\n    info.extent2d._add(offset);\n\n    offset[0] /= scale;\n    offset[1] /= scale;\n  };\n\n  _proto._drawTileAndCache = function _drawTileAndCache(tile) {\n    tile.current = true;\n    this.tilesInView[tile.info.id] = tile;\n\n    this._drawTileOffset(tile.info, tile.image);\n\n    this.tileCache.add(tile.info.id, tile);\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.getPitch()) {\n      return _CanvasRenderer.prototype.needToRedraw.call(this);\n    }\n\n    if (map.isRotating() || map.isZooming()) {\n      return true;\n    }\n\n    if (map.isMoving()) {\n      return !!this.layer.options['forceRenderOnMoving'];\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto.hitDetect = function hitDetect() {\n    return false;\n  };\n\n  _proto._getLoadLimit = function _getLoadLimit() {\n    if (this.getMap().isInteracting()) {\n      return this.layer.options['loadingLimitOnInteracting'];\n    }\n\n    return 0;\n  };\n\n  _proto.isDrawable = function isDrawable() {\n    if (this.getMap().getPitch()) {\n      if (console) {\n        console.warn('TileLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n      }\n\n      this.clear();\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.clear = function clear() {\n    this._retireTiles(true);\n\n    this.tileCache.reset();\n    this.tilesInView = {};\n    this.tilesLoading = {};\n    this._parentTiles = [];\n    this._childTiles = [];\n\n    _CanvasRenderer.prototype.clear.call(this);\n  };\n\n  _proto._isLoadingTile = function _isLoadingTile(tileId) {\n    return !!this.tilesLoading[tileId];\n  };\n\n  _proto.clipCanvas = function clipCanvas(context) {\n    return _CanvasRenderer.prototype.clipCanvas.call(this, context);\n  };\n\n  _proto._clipByPitch = function _clipByPitch(ctx) {\n    var map = this.getMap();\n\n    if (map.getPitch() <= map.options['maxVisualPitch']) {\n      return false;\n    }\n\n    if (!this.layer.options['clipByPitch']) {\n      return false;\n    }\n\n    var clipExtent = map.getContainerExtent();\n    var r = map.getDevicePixelRatio();\n    ctx.save();\n    ctx.strokeStyle = 'rgba(0, 0, 0, 0)';\n    ctx.beginPath();\n    ctx.rect(0, Math.ceil(clipExtent.ymin) * r, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(clipExtent.getHeight()) * r);\n    ctx.stroke();\n    ctx.clip();\n    return true;\n  };\n\n  _proto.loadTileQueue = function loadTileQueue(tileQueue) {\n    for (var p in tileQueue) {\n      if (tileQueue.hasOwnProperty(p)) {\n        var tile = tileQueue[p];\n        var tileImage = this.loadTile(tile);\n\n        if (tileImage.loadTime === undefined) {\n          this.tilesLoading[tile['id']] = {\n            image: tileImage,\n            current: true,\n            info: tile\n          };\n        }\n      }\n    }\n  };\n\n  _proto.loadTile = function loadTile(tile) {\n    var tileSize = this.layer.getTileSize();\n    var tileImage = new Image();\n    tileImage.width = tileSize['width'];\n    tileImage.height = tileSize['height'];\n    tileImage.onload = this.onTileLoad.bind(this, tileImage, tile);\n    tileImage.onerror = this.onTileError.bind(this, tileImage, tile);\n    this.loadTileImage(tileImage, tile['url']);\n    return tileImage;\n  };\n\n  _proto.loadTileImage = function loadTileImage(tileImage, url) {\n    var crossOrigin = this.layer.options['crossOrigin'];\n\n    if (!isNil(crossOrigin)) {\n      tileImage.crossOrigin = crossOrigin;\n    }\n\n    return loadImage(tileImage, [url]);\n  };\n\n  _proto.abortTileLoading = function abortTileLoading(tileImage) {\n    if (!tileImage) return;\n    tileImage.onload = falseFn;\n    tileImage.onerror = falseFn;\n    tileImage.src = emptyImageUrl;\n  };\n\n  _proto.onTileLoad = function onTileLoad(tileImage, tileInfo) {\n    if (!this.layer) {\n      return;\n    }\n\n    var id = tileInfo['id'];\n\n    if (!this.tilesInView) {\n      return;\n    }\n\n    var e = {\n      tile: tileInfo,\n      tileImage: tileImage\n    };\n    this.layer.fire('tileload', e);\n    tileImage = e.tileImage;\n    tileImage.loadTime = now();\n    delete this.tilesLoading[id];\n\n    this._addTileToCache(tileInfo, tileImage);\n\n    this.setToRedraw();\n  };\n\n  _proto.onTileError = function onTileError(tileImage, tileInfo) {\n    if (!this.layer) {\n      return;\n    }\n\n    tileImage.onerrorTick = tileImage.onerrorTick || 0;\n    var tileRetryCount = this.layer.options['tileRetryCount'];\n\n    if (tileRetryCount > tileImage.onerrorTick) {\n      tileImage.onerrorTick++;\n      tileImage.src = tileInfo.url;\n      return;\n    }\n\n    if (tileImage instanceof Image) {\n      this.abortTileLoading(tileImage, tileInfo);\n    }\n\n    tileImage.loadTime = 0;\n    delete this.tilesLoading[tileInfo['id']];\n\n    this._addTileToCache(tileInfo, tileImage);\n\n    this.setToRedraw();\n    this.layer.fire('tileerror', {\n      tile: tileInfo\n    });\n  };\n\n  _proto.drawTile = function drawTile(tileInfo, tileImage) {\n    if (!tileImage || !this.getMap()) {\n      return;\n    }\n\n    var point = tileInfo.point,\n        tileZoom = tileInfo.z,\n        tileId = tileInfo.id;\n\n    var map = this.getMap(),\n        tileSize = tileInfo.size,\n        zoom = map.getZoom(),\n        ctx = this.context,\n        cp = map._pointToContainerPoint(point, tileZoom, 0, TEMP_POINT$3),\n        bearing = map.getBearing(),\n        transformed = bearing || zoom !== tileZoom;\n\n    var opacity = this.getTileOpacity(tileImage);\n    var alpha = ctx.globalAlpha;\n\n    if (opacity < 1) {\n      ctx.globalAlpha = opacity;\n      this.setToRedraw();\n    }\n\n    if (!transformed) {\n      cp._round();\n    }\n\n    var x = cp.x,\n        y = cp.y;\n    var w = tileSize[0],\n        h = tileSize[1];\n\n    if (transformed) {\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (bearing) {\n        ctx.rotate(-bearing * Math.PI / 180);\n        w += 0.1;\n        h += 0.1;\n      }\n\n      if (zoom !== tileZoom) {\n        var scale = map._getResolution(tileZoom) / map._getResolution();\n\n        ctx.scale(scale, scale);\n      }\n\n      x = y = 0;\n    }\n\n    Canvas.image(ctx, tileImage, x, y, w, h);\n\n    if (this.layer.options['debug']) {\n      var color = this.layer.options['debugOutline'];\n      ctx.save();\n      ctx.strokeStyle = color;\n      ctx.fillStyle = color;\n      ctx.strokeWidth = 10;\n      ctx.font = '20px monospace';\n\n      var _point = new Point(x, y);\n\n      Canvas.rectangle(ctx, _point, {\n        width: w,\n        height: h\n      }, 1, 0);\n      Canvas.fillText(ctx, this.getDebugInfo(tileId), _point._add(10, 20), color);\n      Canvas.drawCross(ctx, x + w / 2, y + h / 2, 2, color);\n      ctx.restore();\n    }\n\n    if (transformed) {\n      ctx.restore();\n    }\n\n    if (ctx.globalAlpha !== alpha) {\n      ctx.globalAlpha = alpha;\n    }\n\n    this.setCanvasUpdated();\n  };\n\n  _proto.getDebugInfo = function getDebugInfo(tileId) {\n    var xyz = tileId.split('_');\n    var length = xyz.length;\n    return 'x:' + xyz[length - 2] + ', y:' + xyz[length - 3] + ', z:' + xyz[length - 1];\n  };\n\n  _proto._findChildTiles = function _findChildTiles(info) {\n    var layer = this._getLayerOfTile(info.layer);\n\n    if (!layer.options['background']) {\n      return [];\n    }\n\n    var map = this.getMap();\n    var children = [];\n\n    var min = info.extent2d.getMin(),\n        max = info.extent2d.getMax(),\n        pmin = layer._project(map._pointToPrj(min, info.z, TEMP_POINT1$2), TEMP_POINT1$2),\n        pmax = layer._project(map._pointToPrj(max, info.z, TEMP_POINT2$1), TEMP_POINT2$1);\n\n    var zoomDiff = 2;\n\n    for (var i = 1; i < zoomDiff; i++) {\n      this._findChildTilesAt(children, pmin, pmax, layer, info.z + i);\n    }\n\n    return children;\n  };\n\n  _proto._findChildTilesAt = function _findChildTilesAt(children, pmin, pmax, layer, childZoom) {\n    var zoomOffset = layer.options['zoomOffset'];\n    var layerId = layer.getId(),\n        res = layer.getSpatialReference().getResolution(childZoom + zoomOffset);\n\n    if (!res) {\n      return;\n    }\n\n    var dmin = layer._getTileConfig().getTileIndex(pmin, res),\n        dmax = layer._getTileConfig().getTileIndex(pmax, res);\n\n    var sx = Math.min(dmin.idx, dmax.idx),\n        ex = Math.max(dmin.idx, dmax.idx);\n    var sy = Math.min(dmin.idy, dmax.idy),\n        ey = Math.max(dmin.idy, dmax.idy);\n    var id, tile;\n\n    for (var i = sx; i < ex; i++) {\n      for (var ii = sy; ii < ey; ii++) {\n        id = layer._getTileId(i, ii, childZoom + zoomOffset, layerId);\n\n        if (this.tileCache.has(id)) {\n          tile = this.tileCache.getAndRemove(id);\n          children.push(tile);\n          this.tileCache.add(id, tile);\n        }\n      }\n    }\n  };\n\n  _proto._findParentTile = function _findParentTile(info) {\n    var map = this.getMap(),\n        layer = this._getLayerOfTile(info.layer);\n\n    if (!layer.options['background']) {\n      return null;\n    }\n\n    var sr = layer.getSpatialReference();\n    var d = sr.getZoomDirection(),\n        zoomOffset = layer.options['zoomOffset'],\n        zoomDiff = layer.options['backgroundZoomDiff'];\n\n    var center = info.extent2d.getCenter(),\n        prj = layer._project(map._pointToPrj(center, info.z));\n\n    for (var diff = 1; diff <= zoomDiff; diff++) {\n      var z = info.z - d * diff;\n      var res = sr.getResolution(z + zoomOffset);\n      if (!res) continue;\n\n      var tileIndex = layer._getTileConfig().getTileIndex(prj, res);\n\n      var id = layer._getTileId(tileIndex.x, tileIndex.y, z + zoomOffset, info.layer);\n\n      if (this.tileCache.has(id)) {\n        var tile = this.tileCache.getAndRemove(id);\n        this.tileCache.add(id, tile);\n        return tile;\n      }\n    }\n\n    return null;\n  };\n\n  _proto._getLayerOfTile = function _getLayerOfTile(layerId) {\n    return this.layer.getChildLayer ? this.layer.getChildLayer(layerId) : this.layer;\n  };\n\n  _proto._getCachedTile = function _getCachedTile(tileId) {\n    var tilesInView = this.tilesInView;\n    var cached = this.tileCache.getAndRemove(tileId);\n\n    if (cached) {\n      tilesInView[tileId] = cached;\n      var tilesLoading = this.tilesLoading;\n\n      if (tilesLoading && tilesLoading[tileId]) {\n        tilesLoading[tileId].current = false;\n        var _tilesLoading$tileId = tilesLoading[tileId],\n            image = _tilesLoading$tileId.image,\n            info = _tilesLoading$tileId.info;\n        this.abortTileLoading(image, info);\n        console.log('_getCachedTile');\n        delete tilesLoading[tileId];\n      }\n    } else {\n      cached = tilesInView[tileId];\n    }\n\n    return cached;\n  };\n\n  _proto._addTileToCache = function _addTileToCache(tileInfo, tileImage) {\n    this.tilesInView[tileInfo.id] = {\n      image: tileImage,\n      current: true,\n      info: tileInfo\n    };\n  };\n\n  _proto.getTileOpacity = function getTileOpacity(tileImage) {\n    if (!this.layer.options['fadeAnimation'] || !tileImage.loadTime) {\n      return 1;\n    }\n\n    return Math.min(1, (now() - tileImage.loadTime) / (1000 / 60 * 10));\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.clear();\n    delete this.tileCache;\n    delete this._tilePlaceHolder;\n\n    _CanvasRenderer.prototype.onRemove.call(this);\n  };\n\n  _proto._markTiles = function _markTiles() {\n    var a = 0,\n        b = 0;\n\n    if (this.tilesLoading) {\n      for (var p in this.tilesLoading) {\n        this.tilesLoading[p].current = false;\n        a++;\n      }\n    }\n\n    if (this.tilesInView) {\n      for (var _p in this.tilesInView) {\n        this.tilesInView[_p].current = false;\n        b++;\n      }\n    }\n\n    return [a, b];\n  };\n\n  _proto._retireTiles = function _retireTiles(force) {\n    for (var i in this.tilesLoading) {\n      var tile = this.tilesLoading[i];\n\n      if (force || !tile.current) {\n        if (tile.image) {\n          this.abortTileLoading(tile.image, tile.info);\n        }\n\n        this.deleteTile(tile);\n        delete this.tilesLoading[i];\n      }\n    }\n\n    for (var _i2 in this.tilesInView) {\n      var _tile = this.tilesInView[_i2];\n\n      if (!_tile.current) {\n        delete this.tilesInView[_i2];\n\n        if (!this.tileCache.has(_i2)) {\n          this.deleteTile(_tile);\n        }\n      }\n    }\n  };\n\n  _proto.deleteTile = function deleteTile(tile) {\n    if (!tile || !tile.image) {\n      return;\n    }\n\n    tile.image.onload = null;\n    tile.image.onerror = null;\n  };\n\n  _proto._generatePlaceHolder = function _generatePlaceHolder(z) {\n    var map = this.getMap();\n    var placeholder = this.layer.options['placeholder'];\n\n    if (!placeholder || map.getPitch()) {\n      return null;\n    }\n\n    var tileSize = this.layer.getTileSize(),\n        scale = map._getResolution(z) / map._getResolution(),\n        canvas = this._tilePlaceHolder = this._tilePlaceHolder || Canvas.createCanvas(1, 1);\n\n    canvas.width = tileSize.width * scale;\n    canvas.height = tileSize.height * scale;\n\n    if (isFunction(placeholder)) {\n      placeholder(canvas);\n    } else {\n      defaultPlaceholder(canvas);\n    }\n\n    return canvas;\n  };\n\n  return TileLayerCanvasRenderer;\n}(CanvasRenderer);\n\nTileLayer.registerRenderer('canvas', TileLayerCanvasRenderer);\n\nfunction falseFn() {\n  return false;\n}\n\nfunction defaultPlaceholder(canvas) {\n  var ctx = canvas.getContext('2d'),\n      cw = canvas.width,\n      ch = canvas.height,\n      w = cw / 16,\n      h = ch / 16;\n  ctx.beginPath();\n\n  for (var i = 0; i < 16; i++) {\n    ctx.moveTo(0, i * h);\n    ctx.lineTo(cw, i * h);\n    ctx.moveTo(i * w, 0);\n    ctx.lineTo(i * w, ch);\n  }\n\n  ctx.strokeStyle = 'rgba(180, 180, 180, 0.1)';\n  ctx.lineWidth = 1;\n  ctx.stroke();\n  ctx.beginPath();\n  var path = [[0, 0], [cw, 0], [0, ch], [cw, ch], [0, 0], [0, ch], [cw, 0], [cw, ch], [0, ch / 2], [cw, ch / 2], [cw / 2, 0], [cw / 2, ch]];\n\n  for (var _i3 = 1; _i3 < path.length; _i3 += 2) {\n    ctx.moveTo(path[_i3 - 1][0], path[_i3 - 1][1]);\n    ctx.lineTo(path[_i3][0], path[_i3][1]);\n  }\n\n  ctx.lineWidth = 1 * 4;\n  ctx.stroke();\n}\n\nvar TileLayerGLRenderer = function (_ImageGLRenderable) {\n  _inheritsLoose(TileLayerGLRenderer, _ImageGLRenderable);\n\n  function TileLayerGLRenderer() {\n    return _ImageGLRenderable.apply(this, arguments) || this;\n  }\n\n  var _proto = TileLayerGLRenderer.prototype;\n\n  _proto.isDrawable = function isDrawable() {\n    return true;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (this._gl() && !map.getPitch() && map.isZooming() && !map.isMoving() && !map.isRotating()) {\n      return true;\n    }\n\n    return _ImageGLRenderable.prototype.needToRedraw.call(this);\n  };\n\n  _proto.drawTile = function drawTile(tileInfo, tileImage) {\n    var map = this.getMap();\n\n    if (!tileInfo || !map || !tileImage) {\n      return;\n    }\n\n    var scale = tileInfo._glScale = tileInfo._glScale || map.getGLScale(tileInfo.z),\n        w = tileInfo.size[0],\n        h = tileInfo.size[1];\n\n    if (tileInfo.cache !== false) {\n      this._bindGLBuffer(tileImage, w, h);\n    }\n\n    if (!this._gl()) {\n      _ImageGLRenderable.prototype.drawTile.call(this, tileInfo, tileImage);\n\n      return;\n    }\n\n    var point = tileInfo.point;\n    var x = point.x * scale,\n        y = point.y * scale;\n    var opacity = this.getTileOpacity(tileImage);\n    var debugInfo = null;\n\n    if (this.layer.options['debug']) {\n      debugInfo = this.getDebugInfo(tileInfo.id);\n    }\n\n    this.drawGLImage(tileImage, x, y, w, h, scale, opacity, debugInfo);\n\n    if (opacity < 1) {\n      this.setToRedraw();\n    } else {\n      this.setCanvasUpdated();\n    }\n  };\n\n  _proto.writeZoomStencil = function writeZoomStencil() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\n  };\n\n  _proto.startZoomStencilTest = function startZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n  };\n\n  _proto.endZoomStencilTest = function endZoomStencilTest() {\n    this.pauseZoomStencilTest();\n  };\n\n  _proto.pauseZoomStencilTest = function pauseZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n  };\n\n  _proto.resumeZoomStencilTest = function resumeZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n  };\n\n  _proto._bindGLBuffer = function _bindGLBuffer(image, w, h) {\n    if (!image.glBuffer) {\n      image.glBuffer = this.bufferTileData(0, 0, w, h);\n    }\n  };\n\n  _proto.loadTileImage = function loadTileImage(tileImage, url) {\n    var crossOrigin = this.layer.options['crossOrigin'];\n    tileImage.crossOrigin = crossOrigin !== null ? crossOrigin : '';\n    tileImage.src = url;\n    return;\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    if (!this.canvas.gl || !this.canvas.gl.wrap) {\n      this.createCanvas2();\n    }\n  };\n\n  _proto.createContext = function createContext() {\n    _ImageGLRenderable.prototype.createContext.call(this);\n\n    this.createGLContext();\n  };\n\n  _proto.resizeCanvas = function resizeCanvas(canvasSize) {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.resizeCanvas.call(this, canvasSize);\n\n    this.resizeGLCanvas();\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.clearCanvas.call(this);\n\n    this.clearGLCanvas();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    if (!this._gl() || !this.canvas2) {\n      return _ImageGLRenderable.prototype.getCanvasImage.call(this);\n    }\n\n    var img = _ImageGLRenderable.prototype.getCanvasImage.call(this);\n\n    if (img) {\n      img.image = this.canvas2;\n    }\n\n    return img;\n  };\n\n  _proto._gl = function _gl() {\n    if (this.canvas.gl && this.canvas.gl.wrap) {\n      return true;\n    }\n\n    var map = this.getMap();\n    return map && (map.getPitch() || map.getBearing()) || this.layer && !!this.layer.options['fragmentShader'];\n  };\n\n  _proto.deleteTile = function deleteTile(tile) {\n    _ImageGLRenderable.prototype.deleteTile.call(this, tile);\n\n    if (tile && tile.image) {\n      this.disposeImage(tile.image);\n    }\n\n    delete tile.image;\n  };\n\n  _proto.onRemove = function onRemove() {\n    _ImageGLRenderable.prototype.onRemove.call(this);\n\n    this.removeGLCanvas();\n  };\n\n  return TileLayerGLRenderer;\n}(ImageGLRenderable(TileLayerCanvasRenderer));\n\nTileLayer.registerRenderer('gl', TileLayerGLRenderer);\n\nfunction _loadTile(tile) {\n  var tileSize = this.layer.getTileSize(),\n      canvasClass = this.canvas.constructor,\n      map = this.getMap();\n  var r = map.getDevicePixelRatio();\n  var tileCanvas = Canvas.createCanvas(tileSize['width'] * r, tileSize['height'] * r, canvasClass);\n  tileCanvas['layer'] = this.layer;\n  var me = this;\n  var extent = new Extent(map.pointToCoordinate(tile['point']), map.pointToCoordinate(tile['point'].add(tileSize.toPoint())), map.getProjection());\n  this.layer.drawTile(tileCanvas, {\n    'url': tile['url'],\n    'point': tile['point'],\n    'center': map.pointToCoordinate(tile['point'].add(tileSize['width'] / 2, tileSize['height'] / 2)),\n    'extent': extent,\n    'z': tile['z'],\n    'x': tile['x'],\n    'y': tile['y']\n  }, function (error) {\n    if (error) {\n      me.onTileError(tileCanvas, tile);\n      return;\n    }\n\n    me.onTileLoad(tileCanvas, tile);\n  });\n  return tileCanvas;\n}\n\nvar CanvasRenderer$1 = function (_TileLayerCanvasRende) {\n  _inheritsLoose(CanvasRenderer, _TileLayerCanvasRende);\n\n  function CanvasRenderer() {\n    return _TileLayerCanvasRende.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasRenderer.prototype;\n\n  _proto.loadTile = function loadTile() {\n    return _loadTile.apply(this, arguments);\n  };\n\n  return CanvasRenderer;\n}(TileLayerCanvasRenderer);\n\nvar GLRenderer = function (_TileLayerGLRenderer) {\n  _inheritsLoose(GLRenderer, _TileLayerGLRenderer);\n\n  function GLRenderer() {\n    return _TileLayerGLRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = GLRenderer.prototype;\n\n  _proto2.loadTile = function loadTile() {\n    return _loadTile.apply(this, arguments);\n  };\n\n  return GLRenderer;\n}(TileLayerGLRenderer);\n\nCanvasTileLayer.registerRenderer('canvas', CanvasRenderer$1);\nCanvasTileLayer.registerRenderer('gl', GLRenderer);\n\nvar OverlayLayerRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(OverlayLayerRenderer, _CanvasRenderer);\n\n  function OverlayLayerRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto = OverlayLayerRenderer.prototype;\n\n  _proto.checkResources = function checkResources() {\n    var geometries = this._geosToCheck;\n\n    if (!this._resourceChecked && !geometries) {\n      geometries = this.layer._geoList;\n    }\n\n    if (!isArrayHasData(geometries)) {\n      return [];\n    }\n\n    var resources = [];\n    var cache = {};\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      var geo = geometries[i];\n\n      var res = geo._getExternalResources();\n\n      if (!res.length) {\n        continue;\n      }\n\n      if (!this.resources) {\n        resources.push.apply(resources, res);\n      } else {\n        for (var _i = 0; _i < res.length; _i++) {\n          var url = res[_i][0];\n\n          if (!this.resources.isResourceLoaded(res[_i]) && !cache[url]) {\n            resources.push(res[_i]);\n            cache[url] = 1;\n          }\n        }\n      }\n    }\n\n    this._resourceChecked = true;\n    delete this._geosToCheck;\n    return resources;\n  };\n\n  _proto.render = function render() {\n    this.layer._sortGeometries();\n\n    return _CanvasRenderer.prototype.render.apply(this, arguments);\n  };\n\n  _proto._addGeoToCheckRes = function _addGeoToCheckRes(res) {\n    if (!res) {\n      return;\n    }\n\n    if (!Array.isArray(res)) {\n      res = [res];\n    }\n\n    if (!this._geosToCheck) {\n      this._geosToCheck = [];\n    }\n\n    pushIn(this._geosToCheck, res);\n  };\n\n  _proto.onGeometryAdd = function onGeometryAdd(geometries) {\n    this._addGeoToCheckRes(geometries);\n\n    redraw(this);\n  };\n\n  _proto.onGeometryRemove = function onGeometryRemove() {\n    redraw(this);\n  };\n\n  _proto.onGeometrySymbolChange = function onGeometrySymbolChange(e) {\n    this._addGeoToCheckRes(e.target);\n\n    redraw(this);\n  };\n\n  _proto.onGeometryShapeChange = function onGeometryShapeChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryPositionChange = function onGeometryPositionChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryZIndexChange = function onGeometryZIndexChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryShow = function onGeometryShow() {\n    redraw(this);\n  };\n\n  _proto.onGeometryHide = function onGeometryHide() {\n    redraw(this);\n  };\n\n  _proto.onGeometryPropertiesChange = function onGeometryPropertiesChange() {\n    redraw(this);\n  };\n\n  return OverlayLayerRenderer;\n}(CanvasRenderer);\n\nfunction redraw(renderer) {\n  if (renderer.layer.options['drawImmediate']) {\n    renderer.render();\n  }\n\n  renderer.setToRedraw();\n}\n\nvar TEMP_EXTENT$4 = new PointExtent();\n\nvar VectorLayerRenderer = function (_OverlayLayerCanvasRe) {\n  _inheritsLoose(VectorLayerRenderer, _OverlayLayerCanvasRe);\n\n  function VectorLayerRenderer() {\n    return _OverlayLayerCanvasRe.apply(this, arguments) || this;\n  }\n\n  var _proto = VectorLayerRenderer.prototype;\n\n  _proto.checkResources = function checkResources() {\n    var _this = this;\n\n    var resources = _OverlayLayerCanvasRe.prototype.checkResources.apply(this, arguments);\n\n    var style = this.layer.getStyle();\n\n    if (style) {\n      if (!Array.isArray(style)) {\n        style = [style];\n      }\n\n      style.forEach(function (s) {\n        var res = getExternalResources(s['symbol'], true);\n\n        for (var i = 0, l = res.length; i < l; i++) {\n          if (!_this.resources.isResourceLoaded(res[i])) {\n            resources.push(res[i]);\n          }\n        }\n      });\n    }\n\n    return resources;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isInteracting() && this.layer.options['enableAltitude']) {\n      return true;\n    }\n\n    if (map.isZooming() && !map.isRotating() && !map.getPitch() && !this._hasPoint && this.layer.constructor === VectorLayer) {\n      return false;\n    }\n\n    return _OverlayLayerCanvasRe.prototype.needToRedraw.call(this);\n  };\n\n  _proto.draw = function draw() {\n    if (!this.getMap()) {\n      return;\n    }\n\n    if (!this.layer.isVisible() || this.layer.isEmpty()) {\n      this.clearCanvas();\n      this.completeRender();\n      return;\n    }\n\n    this.prepareCanvas();\n    this.drawGeos();\n    this.completeRender();\n  };\n\n  _proto.isBlank = function isBlank() {\n    if (!this.context) {\n      return false;\n    }\n\n    return !this.context.canvas._drawn;\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    if (!this._geosToDraw) {\n      return;\n    }\n\n    this._updateDisplayExtent();\n\n    var map = this.getMap();\n    var count = this.layer.getCount();\n    var res = this.getMap().getResolution();\n\n    if (map.isZooming() && map.options['seamlessZoom'] && this._drawnRes !== undefined && res > this._drawnRes * 1.5 && this._geosToDraw.length < count || map.isMoving() || map.isInteracting()) {\n      this.prepareToDraw();\n      this.forEachGeo(this.checkGeo, this);\n      this._drawnRes = res;\n    }\n\n    for (var i = 0, l = this._geosToDraw.length; i < l; i++) {\n      var geo = this._geosToDraw[i];\n\n      if (!geo.isVisible()) {\n        continue;\n      }\n\n      geo._paint(this._displayExtent);\n    }\n  };\n\n  _proto.show = function show() {\n    this.layer.forEach(function (geo) {\n      geo._repaint();\n    });\n\n    _OverlayLayerCanvasRe.prototype.show.apply(this, arguments);\n  };\n\n  _proto.forEachGeo = function forEachGeo(fn, context) {\n    this.layer.forEach(fn, context);\n  };\n\n  _proto.drawGeos = function drawGeos() {\n    this._drawnRes = this.getMap().getResolution();\n\n    this._updateDisplayExtent();\n\n    this.prepareToDraw();\n    this.forEachGeo(this.checkGeo, this);\n\n    for (var i = 0, len = this._geosToDraw.length; i < len; i++) {\n      this._geosToDraw[i]._paint();\n    }\n  };\n\n  _proto.prepareToDraw = function prepareToDraw() {\n    this._hasPoint = false;\n    this._geosToDraw = [];\n  };\n\n  _proto.checkGeo = function checkGeo(geo) {\n    if (!geo || !geo.isVisible() || !geo.getMap() || !geo.getLayer() || !geo.getLayer().isCanvasRender()) {\n      return;\n    }\n\n    var painter = geo._getPainter();\n\n    var extent2D = painter.get2DExtent(this.resources, TEMP_EXTENT$4);\n\n    if (!extent2D || !extent2D.intersects(this._displayExtent)) {\n      return;\n    }\n\n    if (painter.hasPoint()) {\n      this._hasPoint = true;\n    }\n\n    this._geosToDraw.push(geo);\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    delete this.canvasExtent2D;\n\n    _OverlayLayerCanvasRe.prototype.onZoomEnd.apply(this, arguments);\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.forEachGeo(function (g) {\n      g.onHide();\n    });\n    delete this._geosToDraw;\n  };\n\n  _proto.onGeometryPropertiesChange = function onGeometryPropertiesChange(param) {\n    if (param) {\n      this.layer._styleGeometry(param['target']);\n    }\n\n    _OverlayLayerCanvasRe.prototype.onGeometryPropertiesChange.call(this, param);\n  };\n\n  _proto._updateDisplayExtent = function _updateDisplayExtent() {\n    var extent2D = this.canvasExtent2D;\n\n    if (this._maskExtent) {\n      if (!this._maskExtent.intersects(extent2D)) {\n        this.completeRender();\n        return;\n      }\n\n      extent2D = extent2D.intersection(this._maskExtent);\n    }\n\n    this._displayExtent = extent2D;\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var geometries = this._geosToDraw;\n\n    if (!geometries) {\n      return [];\n    }\n\n    return this.layer._hitGeos(geometries, coordinate, options);\n  };\n\n  return VectorLayerRenderer;\n}(OverlayLayerRenderer);\n\nVectorLayer.registerRenderer('canvas', VectorLayerRenderer);\n\nvar MapRenderer = function (_Class) {\n  _inheritsLoose(MapRenderer, _Class);\n\n  function MapRenderer(map) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.map = map;\n    _this._handlerQueue = {};\n    return _this;\n  }\n\n  var _proto = MapRenderer.prototype;\n\n  _proto.callInNextFrame = function callInNextFrame(fn) {\n    this._handlerQueue.push(fn);\n  };\n\n  _proto.executeFrameCallbacks = function executeFrameCallbacks() {\n    var running = this._handlerQueue;\n    this._handlerQueue = [];\n\n    for (var i = 0, l = running.length; i < l; i++) {\n      running[i]();\n    }\n  };\n\n  _proto.offsetPlatform = function offsetPlatform(offset, force) {\n    if (!this.map._panels.front) {\n      return this;\n    }\n\n    if (!force && offset.x === 0 && offset.y === 0) {\n      return this;\n    }\n\n    var panels = this.map._panels;\n    var hasFront = this._frontCount = panels.back.layerDOM.childElementCount;\n    var hasBack = this._backCount = panels.front.layerDOM.childElementCount;\n    var hasUI = this._uiCount = panels.front.uiDOM.childElementCount;\n\n    if (hasFront || hasBack || hasUI) {\n      var pos = this.map.offsetPlatform();\n\n      if (offset) {\n        pos = pos.add(offset)._round();\n      } else {\n        pos = pos.round();\n      }\n\n      if (hasBack) {\n        offsetDom(panels.back, pos);\n      }\n\n      if (hasFront || hasUI) {\n        offsetDom(panels.front, pos);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.domChanged = function domChanged() {\n    var panels = this.map._panels;\n\n    if (!panels.front) {\n      return false;\n    }\n\n    var frontCount = panels.back.layerDOM.childElementCount;\n\n    if (this._frontCount === undefined || this._frontCount !== frontCount) {\n      return true;\n    }\n\n    var backCount = panels.front.layerDOM.childElementCount;\n\n    if (this._backCount === undefined || this._backCount !== backCount) {\n      return true;\n    }\n\n    var uiCount = panels.front.uiDOM.childElementCount;\n\n    if (this._uiCount === undefined || this._uiCount !== uiCount) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.resetContainer = function resetContainer() {\n    if (!this.map) {\n      return;\n    }\n\n    this.map._resetMapViewPoint();\n\n    if (this.map._panels.front) {\n      var pos = new Point(0, 0);\n      offsetDom(this.map._panels.back, pos);\n      offsetDom(this.map._panels.front, pos);\n    }\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    this.resetContainer();\n  };\n\n  _proto.onLoad = function onLoad() {\n    this._frameLoop();\n  };\n\n  return MapRenderer;\n}(Class);\n\nvar MapCanvasRenderer = function (_MapRenderer) {\n  _inheritsLoose(MapCanvasRenderer, _MapRenderer);\n\n  function MapCanvasRenderer(map) {\n    var _this;\n\n    _this = _MapRenderer.call(this, map) || this;\n    _this._containerIsCanvas = !!map._containerDOM.getContext;\n\n    _this._registerEvents();\n\n    _this._loopTime = 0;\n    return _this;\n  }\n\n  var _proto = MapCanvasRenderer.prototype;\n\n  _proto.load = function load() {\n    this.initContainer();\n  };\n\n  _proto.renderFrame = function renderFrame(framestamp) {\n    if (!this.map) {\n      return false;\n    }\n\n    delete this._isViewChanged;\n    var map = this.map;\n\n    map._fireEvent('framestart');\n\n    this.updateMapDOM();\n\n    var layers = this._getAllLayerToRender();\n\n    this.drawLayers(layers, framestamp);\n    var updated = this.drawLayerCanvas(layers);\n\n    if (updated) {\n      this._drawCenterCross();\n    }\n\n    map._fireEvent('frameend');\n\n    this._recordView();\n\n    this._mapview = this._getMapView();\n    delete this._spatialRefChanged;\n\n    this._fireLayerLoadEvents();\n\n    this.executeFrameCallbacks();\n    this._canvasUpdated = false;\n    return true;\n  };\n\n  _proto.updateMapDOM = function updateMapDOM() {\n    var map = this.map;\n\n    if (map.isZooming()) {\n      return;\n    }\n\n    var offset = map._getViewPointFrameOffset();\n\n    if (offset) {\n      map.offsetPlatform(offset);\n    } else if (this.domChanged()) {\n      this.offsetPlatform(null, true);\n    }\n  };\n\n  _proto.drawLayers = function drawLayers(layers, framestamp) {\n    var map = this.map,\n        isInteracting = map.isInteracting(),\n        canvasIds = [],\n        updatedIds = [],\n        fps = map.options['fpsOnInteracting'] || 0,\n        timeLimit = fps === 0 ? 0 : 1000 / fps,\n        layerLimit = this.map.options['layerCanvasLimitOnInteracting'],\n        l = layers.length;\n    var baseLayer = map.getBaseLayer();\n    var t = 0;\n\n    for (var i = 0; i < l; i++) {\n      var layer = layers[i];\n\n      if (!layer.isVisible()) {\n        continue;\n      }\n\n      var isCanvas = layer.isCanvasRender();\n\n      if (isCanvas) {\n        canvasIds.push(layer.getId());\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (!renderer) {\n        continue;\n      }\n\n      var needsRedraw = this._checkLayerRedraw(layer);\n\n      if (isCanvas && renderer.isCanvasUpdated()) {\n        if (!needsRedraw) {\n          updatedIds.push(layer.getId());\n        }\n\n        this.setLayerCanvasUpdated();\n      }\n\n      var transformMatrix = renderer.__zoomTransformMatrix;\n      delete renderer.__zoomTransformMatrix;\n\n      if (!needsRedraw) {\n        if (isCanvas && isInteracting) {\n          if (map.isZooming() && !map.getPitch()) {\n            renderer.prepareRender();\n            renderer.__zoomTransformMatrix = this._zoomMatrix;\n          } else if (map.getPitch() || map.isRotating()) {\n            renderer.clearCanvas();\n          }\n        }\n\n        continue;\n      }\n\n      if (isInteracting && isCanvas) {\n        if (layerLimit > 0 && l - 1 - i > layerLimit && layer !== baseLayer) {\n          layer._getRenderer().clearCanvas();\n\n          continue;\n        }\n\n        t += this._drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp);\n      } else if (isInteracting && renderer.drawOnInteracting) {\n        if (renderer.prepareRender) {\n          renderer.prepareRender();\n        }\n\n        if (renderer.checkAndDraw) {\n          renderer.checkAndDraw(renderer.drawOnInteracting, this._eventParam, framestamp);\n        } else {\n          renderer.drawOnInteracting(this._eventParam, framestamp);\n        }\n      } else {\n        renderer.render(framestamp);\n\n        if (isCanvas && transformMatrix && renderer.isLoadingResource()) {\n          renderer.__zoomTransformMatrix = transformMatrix;\n        }\n      }\n\n      if (isCanvas) {\n        updatedIds.push(layer.getId());\n        this.setLayerCanvasUpdated();\n      }\n    }\n\n    var preCanvasIds = this._canvasIds || [];\n    var preUpdatedIds = this._updatedIds || [];\n    this._canvasIds = canvasIds;\n    this._updatedIds = updatedIds;\n\n    if (!this.isLayerCanvasUpdated()) {\n      var sep = '---';\n\n      if (preCanvasIds.join(sep) !== canvasIds.join(sep) || preUpdatedIds.join(sep) !== updatedIds.join(sep)) {\n        this.setLayerCanvasUpdated();\n      }\n    }\n  };\n\n  _proto._checkLayerRedraw = function _checkLayerRedraw(layer) {\n    if (this.isSpatialReferenceChanged()) {\n      return true;\n    }\n\n    var map = this.map;\n\n    var renderer = layer._getRenderer();\n\n    if (layer.isCanvasRender()) {\n      return renderer.testIfNeedRedraw();\n    } else {\n      if (renderer.needToRedraw && renderer.needToRedraw()) {\n        return true;\n      }\n\n      return map.isInteracting() || this.isViewChanged();\n    }\n  };\n\n  _proto._drawCanvasLayerOnInteracting = function _drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp) {\n    var map = this.map,\n        renderer = layer._getRenderer(),\n        drawTime = renderer.getDrawTime(),\n        inTime = timeLimit === 0 || timeLimit > 0 && t + drawTime <= timeLimit;\n\n    if (renderer.mustRenderOnInteracting && renderer.mustRenderOnInteracting()) {\n      renderer.render(framestamp);\n    } else if (renderer.drawOnInteracting && (layer === map.getBaseLayer() || inTime || map.isZooming() && layer.options['forceRenderOnZooming'] || map.isMoving() && layer.options['forceRenderOnMoving'] || map.isRotating() && layer.options['forceRenderOnRotating'])) {\n      renderer.prepareRender();\n      renderer.prepareCanvas();\n\n      if (renderer.checkAndDraw) {\n        renderer.checkAndDraw(renderer.drawOnInteracting, this._eventParam, framestamp);\n      } else {\n        renderer.drawOnInteracting(this._eventParam, framestamp);\n      }\n\n      return drawTime;\n    } else if (map.isZooming() && !map.getPitch() && !map.isRotating()) {\n      renderer.prepareRender();\n      renderer.__zoomTransformMatrix = this._zoomMatrix;\n    } else if (map.getPitch() || map.isRotating()) {\n      renderer.clearCanvas();\n    }\n\n    if (renderer.drawOnInteracting && !inTime) {\n      renderer.onSkipDrawOnInteracting(this._eventParam, framestamp);\n    }\n\n    return 0;\n  };\n\n  _proto._fireLayerLoadEvents = function _fireLayerLoadEvents() {\n    if (this._updatedIds && this._updatedIds.length > 0) {\n      var map = this.map;\n\n      this._updatedIds.reverse().forEach(function (id) {\n        var layer = map.getLayer(id);\n\n        if (!layer) {\n          return;\n        }\n\n        var renderer = layer._getRenderer();\n\n        if (!renderer || !renderer.isRenderComplete()) {\n          return;\n        }\n\n        layer.fire('layerload');\n      });\n    }\n  };\n\n  _proto.isLayerCanvasUpdated = function isLayerCanvasUpdated() {\n    return this._canvasUpdated;\n  };\n\n  _proto.setLayerCanvasUpdated = function setLayerCanvasUpdated() {\n    this._canvasUpdated = true;\n  };\n\n  _proto.drawLayerCanvas = function drawLayerCanvas(layers) {\n    var map = this.map;\n\n    if (!map) {\n      return false;\n    }\n\n    if (!this.isLayerCanvasUpdated() && !this.isViewChanged()) {\n      return false;\n    }\n\n    if (!this.canvas) {\n      this.createCanvas();\n    }\n\n    map._fireEvent('renderstart', {\n      'context': this.context\n    });\n\n    if (!this._updateCanvasSize()) {\n      this.clearCanvas();\n    }\n\n    var interacting = map.isInteracting(),\n        limit = map.options['layerCanvasLimitOnInteracting'];\n    var len = layers.length;\n    var baseLayerImage;\n    var images = [];\n\n    for (var i = 0; i < len; i++) {\n      if (!layers[i].isVisible() || !layers[i].isCanvasRender()) {\n        continue;\n      }\n\n      var renderer = layers[i]._getRenderer();\n\n      if (!renderer) {\n        continue;\n      }\n\n      var layerImage = this._getLayerImage(layers[i]);\n\n      if (layerImage && layerImage['image']) {\n        if (layers[i] === map.getBaseLayer()) {\n          baseLayerImage = [layers[i], layerImage];\n        } else {\n          images.push([layers[i], layerImage]);\n        }\n      }\n    }\n\n    if (baseLayerImage) {\n      this._drawLayerCanvasImage(baseLayerImage[0], baseLayerImage[1]);\n\n      this._drawFog();\n    }\n\n    len = images.length;\n    var start = interacting && limit >= 0 && len > limit ? len - limit : 0;\n\n    for (var _i = start; _i < len; _i++) {\n      this._drawLayerCanvasImage(images[_i][0], images[_i][1]);\n    }\n\n    map._fireEvent('renderend', {\n      'context': this.context\n    });\n\n    return true;\n  };\n\n  _proto.setToRedraw = function setToRedraw() {\n    var layers = this._getAllLayerToRender();\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var renderer = layers[i].getRenderer();\n\n      if (renderer && renderer.canvas && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.updateMapSize = function updateMapSize(size) {\n    if (!size || this._containerIsCanvas) {\n      return;\n    }\n\n    var width = size['width'] + 'px',\n        height = size['height'] + 'px';\n    var panels = this.map._panels;\n    panels.mapWrapper.style.width = width;\n    panels.mapWrapper.style.height = height;\n\n    this._updateCanvasSize();\n  };\n\n  _proto.getMainPanel = function getMainPanel() {\n    if (!this.map) {\n      return null;\n    }\n\n    if (this._containerIsCanvas) {\n      return this.map._containerDOM;\n    }\n\n    if (this.map._panels) {\n      return this.map._panels.mapWrapper;\n    }\n\n    return null;\n  };\n\n  _proto.toDataURL = function toDataURL(mimeType) {\n    if (!this.canvas) {\n      return null;\n    }\n\n    return this.canvas.toDataURL(mimeType);\n  };\n\n  _proto.remove = function remove() {\n    if (Browser$1.webgl && typeof document !== 'undefined') {\n      removeDomEvent(document, 'visibilitychange', this._onVisibilitychange, this);\n    }\n\n    if (this._resizeInterval) {\n      clearInterval(this._resizeInterval);\n    }\n\n    delete this.context;\n    delete this.canvas;\n    delete this.map;\n    delete this._spatialRefChanged;\n\n    this._cancelFrameLoop();\n  };\n\n  _proto.hitDetect = function hitDetect(point) {\n    var map = this.map;\n\n    if (!map || !map.options['hitDetect'] || map.isInteracting()) {\n      return;\n    }\n\n    var layers = map._getLayers();\n\n    var cursor = 'default';\n    var limit = map.options['hitDetectLimit'] || 0;\n    var counter = 0;\n\n    for (var i = layers.length - 1; i >= 0; i--) {\n      var layer = layers[i];\n\n      if (!layer.options['hitDetect'] || layer.isEmpty && layer.isEmpty()) {\n        continue;\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (!renderer || !renderer.hitDetect) {\n        continue;\n      }\n\n      if (renderer.isBlank && renderer.isBlank()) {\n        continue;\n      }\n\n      if (layer.options['cursor'] !== 'default' && renderer.hitDetect(point)) {\n        cursor = layer.options['cursor'] || 'pointer';\n        break;\n      }\n\n      counter++;\n\n      if (limit > 0 && counter > limit) {\n        break;\n      }\n    }\n\n    map._trySetCursor(cursor);\n  };\n\n  _proto._getLayerImage = function _getLayerImage(layer) {\n    var renderer = layer._getRenderer();\n\n    if (renderer.getCanvasImage) {\n      return renderer.getCanvasImage();\n    }\n\n    return null;\n  };\n\n  _proto.initContainer = function initContainer() {\n    var panels = this.map._panels;\n\n    function createContainer(name, className, cssText, enableSelect) {\n      var c = createEl('div', className);\n\n      if (cssText) {\n        c.style.cssText = cssText;\n      }\n\n      panels[name] = c;\n\n      if (!enableSelect) {\n        preventSelection(c);\n      }\n\n      return c;\n    }\n\n    var containerDOM = this.map._containerDOM;\n\n    if (this._containerIsCanvas) {\n      return;\n    }\n\n    containerDOM.innerHTML = '';\n    var POSITION0 = 'position:absolute;top:0px;left:0px;';\n    var mapWrapper = createContainer('mapWrapper', 'maptalks-wrapper', 'position:absolute;overflow:hidden;', true),\n        mapAllLayers = createContainer('allLayers', 'maptalks-all-layers', POSITION0 + 'padding:0px;margin:0px;z-index:0;overflow:visible;', true),\n        backStatic = createContainer('backStatic', 'maptalks-back-static', POSITION0 + 'z-index:0;', true),\n        back = createContainer('back', 'maptalks-back', POSITION0 + 'z-index:1;'),\n        backLayer = createContainer('backLayer', 'maptalks-back-layer', POSITION0),\n        canvasContainer = createContainer('canvasContainer', 'maptalks-canvas-layer', POSITION0 + 'border:none;z-index:2;'),\n        frontStatic = createContainer('frontStatic', 'maptalks-front-static', POSITION0 + 'z-index:3;', true),\n        front = createContainer('front', 'maptalks-front', POSITION0 + 'z-index:4;', true),\n        frontLayer = createContainer('frontLayer', 'maptalks-front-layer', POSITION0 + 'z-index:0;'),\n        ui = createContainer('ui', 'maptalks-ui', POSITION0 + 'border:none;z-index:1;', true),\n        control = createContainer('control', 'maptalks-control', 'z-index:1', true);\n    containerDOM.appendChild(mapWrapper);\n    mapAllLayers.appendChild(backStatic);\n    back.appendChild(backLayer);\n    back.layerDOM = backLayer;\n    mapAllLayers.appendChild(back);\n    mapAllLayers.appendChild(canvasContainer);\n    front.appendChild(frontLayer);\n    front.layerDOM = frontLayer;\n    front.uiDOM = ui;\n    mapAllLayers.appendChild(frontStatic);\n    mapAllLayers.appendChild(front);\n    front.appendChild(ui);\n    mapWrapper.appendChild(mapAllLayers);\n    mapWrapper.appendChild(control);\n    this.createCanvas();\n    this.resetContainer();\n\n    var mapSize = this.map._getContainerDomSize();\n\n    this.updateMapSize(mapSize);\n  };\n\n  _proto.isViewChanged = function isViewChanged() {\n    if (this._isViewChanged !== undefined) {\n      return this._isViewChanged;\n    }\n\n    var previous = this._mapview;\n\n    var view = this._getMapView();\n\n    this._isViewChanged = !previous || !equalMapView(previous, view);\n    return this._isViewChanged;\n  };\n\n  _proto._recordView = function _recordView() {\n    var map = this.map;\n\n    if (!map._onViewChange || map.isInteracting() || map.isAnimating()) {\n      return;\n    }\n\n    if (!equalMapView(map.getView(), map._getCurrentView())) {\n      map._onViewChange(map.getView());\n    }\n  };\n\n  _proto.isSpatialReferenceChanged = function isSpatialReferenceChanged() {\n    return this._spatialRefChanged;\n  };\n\n  _proto._getMapView = function _getMapView() {\n    var map = this.map;\n\n    var center = map._getPrjCenter();\n\n    return {\n      x: center.x,\n      y: center.y,\n      zoom: map.getZoom(),\n      pitch: map.getPitch(),\n      bearing: map.getBearing(),\n      width: map.width,\n      height: map.height\n    };\n  };\n\n  _proto._frameLoop = function _frameLoop(framestamp) {\n    var _this2 = this;\n\n    if (!this.map) {\n      this._cancelFrameLoop();\n\n      return;\n    }\n\n    this.renderFrame(framestamp);\n    this._animationFrame = requestAnimFrame(function (framestamp) {\n      _this2._frameLoop(framestamp);\n    });\n  };\n\n  _proto._cancelFrameLoop = function _cancelFrameLoop() {\n    if (this._animationFrame) {\n      cancelAnimFrame(this._animationFrame);\n    }\n  };\n\n  _proto._drawLayerCanvasImage = function _drawLayerCanvasImage(layer, layerImage) {\n    var ctx = this.context;\n    var point = layerImage['point'].round();\n    var dpr = this.map.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      point._multi(dpr);\n    }\n\n    var canvasImage = layerImage['image'];\n    var width = canvasImage.width,\n        height = canvasImage.height;\n\n    if (point.x + width <= 0 || point.y + height <= 0) {\n      return;\n    }\n\n    var op = layer.options['opacity'];\n\n    if (!isNumber(op)) {\n      op = 1;\n    }\n\n    if (op <= 0) {\n      return;\n    }\n\n    var imgOp = layerImage['opacity'];\n\n    if (!isNumber(imgOp)) {\n      imgOp = 1;\n    }\n\n    if (imgOp <= 0) {\n      return;\n    }\n\n    var alpha = ctx.globalAlpha;\n\n    if (op < 1) {\n      ctx.globalAlpha *= op;\n    }\n\n    if (imgOp < 1) {\n      ctx.globalAlpha *= imgOp;\n    }\n\n    if (layer.options['cssFilter']) {\n      ctx.filter = layer.options['cssFilter'];\n    }\n\n    var renderer = layer.getRenderer();\n    var matrix = renderer.__zoomTransformMatrix;\n    var clipped = renderer.clipCanvas(this.context);\n\n    if (matrix) {\n      ctx.save();\n      ctx.setTransform.apply(ctx, matrix);\n    }\n\n    ctx.drawImage(canvasImage, 0, 0, width, height, point.x, point.y, width, height);\n\n    if (matrix) {\n      ctx.restore();\n    }\n\n    if (clipped) {\n      ctx.restore();\n    }\n\n    if (ctx.filter !== 'none') {\n      ctx.filter = 'none';\n    }\n\n    ctx.globalAlpha = alpha;\n  };\n\n  _proto._drawCenterCross = function _drawCenterCross() {\n    var cross = this.map.options['centerCross'];\n\n    if (cross) {\n      var ctx = this.context;\n      var p = new Point(this.canvas.width / 2, this.canvas.height / 2);\n\n      if (isFunction(cross)) {\n        cross(ctx, p);\n      } else {\n        Canvas.drawCross(this.context, p.x, p.y, 2, '#f00');\n      }\n    }\n  };\n\n  _proto._drawContainerExtent = function _drawContainerExtent() {\n    var cascadePitches = this.map.options.cascadePitches;\n\n    var h30 = this.map.height - this.map._getVisualHeight(cascadePitches[0]);\n\n    var h60 = this.map.height - this.map._getVisualHeight(cascadePitches[1]);\n\n    var extent = this.map.getContainerExtent();\n    var ctx = this.context;\n    ctx.beginPath();\n    ctx.moveTo(0, extent.ymin);\n    ctx.lineTo(extent.xmax, extent.ymin);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, h30);\n    ctx.lineTo(extent.xmax, h30);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, h60);\n    ctx.lineTo(extent.xmax, h60);\n    ctx.stroke();\n  };\n\n  _proto._drawFog = function _drawFog() {\n    var map = this.map;\n\n    if (map.getPitch() <= map.options['maxVisualPitch'] || !map.options['fog']) {\n      return;\n    }\n\n    var fogThickness = 30;\n    var r = map.getDevicePixelRatio();\n    var ctx = this.context,\n        clipExtent = map.getContainerExtent();\n    var top = (map.height - map._getVisualHeight(75)) * r;\n    if (top < 0) top = 0;\n    var bottom = clipExtent.ymin * r,\n        h = Math.ceil(bottom - top),\n        color = map.options['fogColor'].join();\n    var gradient = ctx.createLinearGradient(0, top, 0, bottom + fogThickness);\n    var landscape = 1 - fogThickness / (h + fogThickness);\n    gradient.addColorStop(0, \"rgba(\" + color + \", 0)\");\n    gradient.addColorStop(0.3, \"rgba(\" + color + \", 0.3)\");\n    gradient.addColorStop(landscape, \"rgba(\" + color + \", 1)\");\n    gradient.addColorStop(1, \"rgba(\" + color + \", 0)\");\n    ctx.beginPath();\n    ctx.fillStyle = gradient;\n    ctx.fillRect(0, top, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(h + fogThickness));\n  };\n\n  _proto._getAllLayerToRender = function _getAllLayerToRender() {\n    return this.map._getLayers();\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    Canvas.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  _proto._updateCanvasSize = function _updateCanvasSize() {\n    if (!this.canvas || this._containerIsCanvas) {\n      return false;\n    }\n\n    var map = this.map,\n        mapSize = map.getSize(),\n        canvas = this.canvas,\n        r = map.getDevicePixelRatio();\n\n    if (mapSize['width'] * r === canvas.width && mapSize['height'] * r === canvas.height) {\n      return false;\n    }\n\n    canvas.height = r * mapSize['height'];\n    canvas.width = r * mapSize['width'];\n\n    if (canvas.style) {\n      canvas.style.width = mapSize['width'] + 'px';\n      canvas.style.height = mapSize['height'] + 'px';\n    }\n\n    return true;\n  };\n\n  _proto.createCanvas = function createCanvas() {\n    if (this._containerIsCanvas) {\n      this.canvas = this.map._containerDOM;\n    } else {\n      this.canvas = createEl('canvas');\n\n      this._updateCanvasSize();\n\n      this.map._panels.canvasContainer.appendChild(this.canvas);\n    }\n\n    this.context = this.canvas.getContext('2d');\n  };\n\n  _proto._checkSize = function _checkSize() {\n    if (!this.map || this.map.isInteracting()) {\n      return;\n    }\n\n    computeDomPosition(this.map._containerDOM);\n    this.map.checkSize();\n  };\n\n  _proto._setCheckSizeInterval = function _setCheckSizeInterval(interval) {\n    var _this3 = this;\n\n    clearInterval(this._resizeInterval);\n    this._checkSizeInterval = interval;\n    this._resizeInterval = setInterval(function () {\n      if (!_this3.map || _this3.map.isRemoved()) {\n        clearInterval(_this3._resizeInterval);\n      } else {\n        _this3._checkSize();\n      }\n    }, this._checkSizeInterval);\n  };\n\n  _proto._registerEvents = function _registerEvents() {\n    var _this4 = this;\n\n    var map = this.map;\n\n    if (map.options['checkSize'] && !IS_NODE && typeof window !== 'undefined') {\n      this._setCheckSizeInterval(map.options['checkSizeInterval']);\n    }\n\n    if (!Browser$1.mobile) {\n      map.on('_mousemove', this._onMapMouseMove, this);\n    }\n\n    map.on('_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart', function (param) {\n      _this4._eventParam = param;\n    });\n    map.on('_zooming', function (param) {\n      if (!map.getPitch()) {\n        _this4._zoomMatrix = param['matrix']['container'];\n      }\n\n      _this4._eventParam = param;\n    });\n    map.on('_zoomend', function (param) {\n      _this4._eventParam = param;\n      delete _this4._zoomMatrix;\n    });\n    map.on('_spatialreferencechange', function () {\n      _this4._spatialRefChanged = true;\n    });\n\n    if (Browser$1.webgl && typeof document !== 'undefined') {\n      addDomEvent(document, 'visibilitychange', this._onVisibilitychange, this);\n    }\n  };\n\n  _proto._onMapMouseMove = function _onMapMouseMove(param) {\n    var _this5 = this;\n\n    var map = this.map;\n\n    if (map.isInteracting() || !map.options['hitDetect']) {\n      return;\n    }\n\n    if (this._hitDetectFrame) {\n      cancelAnimFrame(this._hitDetectFrame);\n    }\n\n    this._hitDetectFrame = requestAnimFrame(function () {\n      _this5.hitDetect(param['containerPoint']);\n    });\n  };\n\n  _proto._getCanvasLayers = function _getCanvasLayers() {\n    return this.map._getLayers(function (layer) {\n      return layer.isCanvasRender();\n    });\n  };\n\n  _proto._onVisibilitychange = function _onVisibilitychange() {\n    if (document.visibilityState !== 'visible') {\n      return;\n    }\n\n    this.setToRedraw();\n  };\n\n  return MapCanvasRenderer;\n}(MapRenderer);\n\nMap$1.registerRenderer('canvas', MapCanvasRenderer);\nMap$1.mergeOptions({\n  'fog': false,\n  'fogColor': [233, 233, 233]\n});\nvar index$6 =\n/*#__PURE__*/\nObject.freeze({\n  ResourceCache: ResourceCache,\n  CanvasRenderer: CanvasRenderer,\n  ImageGLRenderable: ImageGLRenderable,\n  MapRenderer: MapRenderer,\n  MapCanvasRenderer: MapCanvasRenderer,\n  Renderable: Renderable,\n  ImageLayerCanvasRenderer: ImageLayerCanvasRenderer,\n  ImageLayerGLRenderer: ImageLayerGLRenderer,\n  TileLayerCanvasRenderer: TileLayerCanvasRenderer,\n  TileLayerGLRenderer: TileLayerGLRenderer,\n  CanvasTileLayerCanvasRenderer: CanvasRenderer$1,\n  CanvasTileLayerGLRenderer: GLRenderer,\n  OverlayLayerCanvasRenderer: OverlayLayerRenderer,\n  VectorLayerCanvasRenderer: VectorLayerRenderer,\n  CanvasLayerRenderer: CanvasLayerRenderer\n});\nvar CenterPointRenderer = {\n  _getRenderPoints: function _getRenderPoints() {\n    return [[this._getCenter2DPoint(this.getMap().getGLZoom())], null];\n  }\n};\nMarker.include(CenterPointRenderer);\nEllipse.include(CenterPointRenderer);\nCircle.include(CenterPointRenderer);\nSector.include(CenterPointRenderer);\nRectangle.include({\n  _getRenderPoints: function _getRenderPoints(placement) {\n    var map = this.getMap();\n\n    if (placement === 'vertex') {\n      var shell = this._trimRing(this.getShell());\n\n      var points = [];\n\n      for (var i = 0, len = shell.length; i < len; i++) {\n        points.push(map.coordToPoint(shell[i], map.getGLZoom()));\n      }\n\n      return [points, null];\n    } else {\n      var c = map.coordToPoint(this.getCenter(), map.getGLZoom());\n      return [[c], null];\n    }\n  }\n});\nvar PolyRenderer = {\n  _getRenderPoints: function _getRenderPoints(placement) {\n    var map = this.getMap();\n    var glZoom = map.getGLZoom();\n    var points,\n        rotations = null;\n\n    if (placement === 'point') {\n      points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n\n      if (points && points.length > 0 && Array.isArray(points[0])) {\n        points = points[0].concat(points[1]);\n      }\n    } else if (placement === 'vertex') {\n      points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n      rotations = [];\n\n      if (points && points.length > 0 && Array.isArray(points[0])) {\n        for (var i = 0, l = points.length; i < l; i++) {\n          for (var ii = 0, ll = points[i].length; ii < ll; ii++) {\n            if (ii === 0) {\n              rotations.push([points[i][ii], points[i][ii + 1]]);\n            } else {\n              rotations.push([points[i][ii - 1], points[i][ii]]);\n            }\n          }\n        }\n\n        points = points[0].concat(points[1]);\n      } else {\n        for (var _i = 0, _l = points.length; _i < _l; _i++) {\n          if (_i === 0) {\n            rotations.push([points[_i], points[_i + 1]]);\n          } else {\n            rotations.push([points[_i - 1], points[_i]]);\n          }\n        }\n      }\n    } else if (placement === 'line') {\n      points = [];\n      rotations = [];\n\n      var vertice = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom),\n          isSplitted = vertice.length > 0 && Array.isArray(vertice[0]);\n\n      if (isSplitted) {\n        var ring;\n\n        for (var _i2 = 1, _l2 = vertice.length; _i2 < _l2; _i2++) {\n          ring = vertice[_i2];\n\n          if (this instanceof Polygon && ring.length > 0 && !ring[0].equals(ring[ring.length - 1])) {\n            ring.push(ring[0]);\n          }\n\n          for (var _ii = 1, _ll = ring.length; _ii < _ll; _ii++) {\n            points.push(ring[_ii].add(ring[_ii - 1])._multi(0.5));\n            rotations.push([ring[_ii - 1], ring[_ii]]);\n          }\n        }\n      } else {\n        if (this instanceof Polygon && vertice.length > 0 && !vertice[0].equals(vertice[vertice.length - 1])) {\n          vertice.push(vertice[0]);\n        }\n\n        for (var _i3 = 1, _l3 = vertice.length; _i3 < _l3; _i3++) {\n          points.push(vertice[_i3].add(vertice[_i3 - 1])._multi(0.5));\n          rotations.push([vertice[_i3 - 1], vertice[_i3]]);\n        }\n      }\n    } else if (placement === 'vertex-first') {\n      var coords = this._getPrjCoordinates();\n\n      points = coords.length ? [map._prjToPoint(coords[0], glZoom)] : [];\n      rotations = coords.length ? [[map._prjToPoint(coords[0], glZoom), map._prjToPoint(coords[1], glZoom)]] : [];\n    } else if (placement === 'vertex-last') {\n      var _coords = this._getPrjCoordinates();\n\n      var _l4 = _coords.length;\n      points = _l4 ? [map._prjToPoint(_coords[_l4 - 1], glZoom)] : [];\n      var current = _l4 - 1,\n          previous = _l4 > 1 ? _l4 - 2 : _l4 - 1;\n      rotations = _l4 ? [[map._prjToPoint(_coords[previous], glZoom), map._prjToPoint(_coords[current], glZoom)]] : [];\n    } else {\n      var pcenter = this._getProjection().project(this.getCenter());\n\n      points = [map._prjToPoint(pcenter, glZoom)];\n    }\n\n    return [points, rotations];\n  }\n};\nLineString.include(PolyRenderer);\nPolygon.include(PolyRenderer);\nGeometry.include({\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return false;\n  },\n  _redrawWhenRotate: function _redrawWhenRotate() {\n    return false;\n  }\n});\nvar el = {\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return true;\n  },\n  _redrawWhenRotate: function _redrawWhenRotate() {\n    return this instanceof Ellipse || this instanceof Sector;\n  },\n  _paintAsPath: function _paintAsPath() {\n    var map = this.getMap();\n\n    var altitude = this._getPainter().getAltitude();\n\n    return altitude > 0 || map.getPitch() || this instanceof Ellipse && map.getBearing();\n  },\n  _getPaintParams: function _getPaintParams() {\n    var map = this.getMap();\n\n    if (this._paintAsPath()) {\n      return Polygon.prototype._getPaintParams.call(this, true);\n    }\n\n    var pcenter = this._getPrjCoordinates();\n\n    var pt = map._prjToPoint(pcenter, map.getGLZoom());\n\n    var size = this._getRenderSize(pt);\n\n    return [pt].concat(size);\n  },\n  _paintOn: function _paintOn() {\n    if (this._paintAsPath()) {\n      return Canvas.polygon.apply(Canvas, arguments);\n    } else {\n      return Canvas.ellipse.apply(Canvas, arguments);\n    }\n  },\n  _getRenderSize: function _getRenderSize(pt) {\n    var map = this.getMap(),\n        z = map.getGLZoom();\n\n    var prjExtent = this._getPrjExtent();\n\n    var pmin = map._prjToPoint(prjExtent.getMin(), z),\n        pmax = map._prjToPoint(prjExtent.getMax(), z);\n\n    return [Math.abs(pmax.x - pmin.x) / 2, Math.abs(pmax.y - pt.y), Math.abs(pt.y - pmin.y)];\n  }\n};\nEllipse.include(el);\nCircle.include(el);\nRectangle.include({\n  _getPaintParams: function _getPaintParams() {\n    var map = this.getMap();\n    var pointZoom = map.getGLZoom();\n\n    var shell = this._getPrjShell();\n\n    var points = this._getPath2DPoints(shell, false, pointZoom);\n\n    return [points];\n  },\n  _paintOn: Canvas.polygon\n});\nSector.include(el, {\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return true;\n  },\n  _getPaintParams: function _getPaintParams() {\n    if (this._paintAsPath()) {\n      return Polygon.prototype._getPaintParams.call(this, true);\n    }\n\n    var map = this.getMap();\n\n    var pt = map._prjToPoint(this._getPrjCoordinates(), map.getGLZoom());\n\n    var size = this._getRenderSize(pt);\n\n    return [pt, size[0], [this.getStartAngle(), this.getEndAngle()]];\n  },\n  _paintOn: function _paintOn() {\n    if (this._paintAsPath()) {\n      return Canvas.polygon.apply(Canvas, arguments);\n    } else {\n      var r = this.getMap().getBearing();\n      var args = arguments;\n\n      if (r) {\n        args[3] = args[3].slice(0);\n        args[3][0] += r;\n        args[3][1] += r;\n      }\n\n      return Canvas.sector.apply(Canvas, args);\n    }\n  }\n});\nPath.include({\n  _paintAsPath: function _paintAsPath() {\n    return true;\n  }\n});\nLineString.include({\n  arrowStyles: {\n    'classic': [3, 4]\n  },\n  _getArrowShape: function _getArrowShape(prePoint, point, lineWidth, arrowStyle, tolerance) {\n    if (!prePoint || !point || prePoint.equals(point)) {\n      return null;\n    }\n\n    if (!tolerance) {\n      tolerance = 0;\n    }\n\n    var width = lineWidth * arrowStyle[0],\n        height = lineWidth * arrowStyle[1] + tolerance,\n        hw = width / 2 + tolerance;\n    var normal;\n\n    if (point.nextCtrlPoint || point.prevCtrlPoint) {\n      if (point.prevCtrlPoint) {\n        normal = point.sub(new Point(point.prevCtrlPoint));\n      } else {\n        normal = point.sub(new Point(point.nextCtrlPoint));\n      }\n    } else {\n      normal = point.sub(prePoint);\n    }\n\n    normal._unit();\n\n    var p1 = point.sub(normal.multi(height));\n\n    normal._perp();\n\n    var p0 = p1.add(normal.multi(hw));\n\n    normal._multi(-1);\n\n    var p2 = p1.add(normal.multi(hw));\n    return [p0, point, p2, p0];\n  },\n  _getPaintParams: function _getPaintParams() {\n    var prjVertexes = this._getPrjCoordinates();\n\n    var points = this._getPath2DPoints(prjVertexes, false, this.getMap().getGLZoom());\n\n    return [points];\n  },\n  _paintOn: function _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n    if (this.options['smoothness']) {\n      Canvas.paintSmoothLine(ctx, points, lineOpacity, this.options['smoothness'], false, this._animIdx, this._animTailRatio);\n    } else {\n      Canvas.path(ctx, points, lineOpacity, null, dasharray);\n    }\n\n    this._paintArrow(ctx, points, lineOpacity);\n  },\n  _getArrowPlacement: function _getArrowPlacement() {\n    return this.options['arrowPlacement'];\n  },\n  _getArrowStyle: function _getArrowStyle() {\n    var arrowStyle = this.options['arrowStyle'];\n\n    if (arrowStyle) {\n      return Array.isArray(arrowStyle) ? arrowStyle : this.arrowStyles[arrowStyle];\n    }\n\n    return null;\n  },\n  _getArrows: function _getArrows(points, lineWidth, tolerance) {\n    var arrowStyle = this._getArrowStyle();\n\n    if (!arrowStyle || points.length < 2) {\n      return [];\n    }\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n    var segments = isSplitted ? points : [points];\n\n    var placement = this._getArrowPlacement();\n\n    var arrows = [];\n    var map = this.getMap(),\n        first = map.coordToContainerPoint(this.getFirstCoordinate()),\n        last = map.coordToContainerPoint(this.getLastCoordinate());\n\n    for (var i = segments.length - 1; i >= 0; i--) {\n      if (placement === 'vertex-first' || placement === 'vertex-firstlast' && segments[i][0].closeTo(first, 0.01)) {\n        var arrow = this._getArrowShape(segments[i][1], segments[i][0], lineWidth, arrowStyle, tolerance);\n\n        if (arrow) {\n          arrows.push(arrow);\n        }\n      }\n\n      if (placement === 'vertex-last' || placement === 'vertex-firstlast' && segments[i][segments[i].length - 1].closeTo(last, 0.01)) {\n        var _arrow = this._getArrowShape(segments[i][segments[i].length - 2], segments[i][segments[i].length - 1], lineWidth, arrowStyle, tolerance);\n\n        if (_arrow) {\n          arrows.push(_arrow);\n        }\n      } else if (placement === 'point') {\n        this._getArrowPoints(arrows, segments[i], lineWidth, arrowStyle, tolerance);\n      }\n    }\n\n    return arrows;\n  },\n  _getArrowPoints: function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    for (var ii = 0, ll = segments.length - 1; ii < ll; ii++) {\n      var arrow = this._getArrowShape(segments[ii], segments[ii + 1], lineWidth, arrowStyle, tolerance);\n\n      if (arrow) {\n        arrows.push(arrow);\n      }\n    }\n  },\n  _paintArrow: function _paintArrow(ctx, points, lineOpacity) {\n    var lineWidth = this._getInternalSymbol()['lineWidth'];\n\n    if (!isNumber(lineWidth) || lineWidth < 3) {\n      lineWidth = 3;\n    }\n\n    var arrows = this._getArrows(points, lineWidth);\n\n    if (!arrows.length) {\n      return;\n    }\n\n    if (ctx.setLineDash) {\n      ctx.setLineDash([]);\n    }\n\n    for (var i = arrows.length - 1; i >= 0; i--) {\n      ctx.fillStyle = ctx.strokeStyle;\n      Canvas.polygon(ctx, arrows[i], lineOpacity, lineOpacity);\n    }\n  }\n});\nPolygon.include({\n  _getPaintParams: function _getPaintParams(disableSimplify) {\n    var maxZoom = this.getMap().getGLZoom();\n\n    var prjVertexes = this._getPrjShell();\n\n    var points = this._getPath2DPoints(prjVertexes, disableSimplify, maxZoom);\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      points = [[points[0]], [points[1]]];\n    }\n\n    var prjHoles = this._getPrjHoles();\n\n    var holePoints = [];\n\n    if (prjHoles && prjHoles.length > 0) {\n      var simplified = this._simplified;\n\n      for (var i = 0; i < prjHoles.length; i++) {\n        var hole = this._getPath2DPoints(prjHoles[i], disableSimplify, maxZoom);\n\n        if (Array.isArray(hole) && isSplitted) {\n          if (Array.isArray(hole[0])) {\n            points[0].push(hole[0]);\n            points[1].push(hole[1]);\n          } else {\n            points[0].push(hole);\n          }\n        } else {\n          holePoints.push(hole);\n        }\n      }\n\n      if (simplified) {\n        this._simplified = simplified;\n      }\n    }\n\n    if (!isSplitted) {\n      points = [points];\n      pushIn(points, holePoints);\n    }\n\n    return [points];\n  },\n  _paintOn: function _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n    Canvas.polygon(ctx, points, lineOpacity, fillOpacity, dasharray, this.options['smoothness']);\n  }\n});\nMap$1.VERSION = version;\nexport { index$1 as Util, dom as DomUtil, strings as StringUtil, index as MapboxUtil, Map$1 as Map, index$4 as ui, index$5 as control, index$6 as renderer, index$3 as symbolizer, Animation$1 as animation, Browser$1 as Browser, Ajax, Canvas, Promise$1 as Promise, Class, Eventable, JSONAble, Handlerable, Handler$1 as Handler, DragHandler, MapTool, DrawTool, AreaTool, DistanceTool, SpatialReference, INTERNAL_LAYER_PREFIX, GEOMETRY_COLLECTION_TYPES, GEOJSON_TYPES, RESOURCE_PROPERTIES, RESOURCE_SIZE_PROPERTIES, NUMERICAL_PROPERTIES, COLOR_PROPERTIES, DEFAULT_TEXT_SIZE, projections as projection, index$2 as measurer, Coordinate, CRS, Extent, Point, PointExtent, Size, Transformation, Layer, TileLayer, GroupTileLayer, WMSTileLayer, CanvasTileLayer, ImageLayer, OverlayLayer, VectorLayer, CanvasLayer, ParticleLayer, TileSystem, TileConfig, ArcCurve, Circle, ConnectorLine, ArcConnectorLine, CubicBezierCurve, Curve, Ellipse, GeoJSON, Geometry, GeometryCollection, Label, LineString, Marker, MultiLineString, MultiPoint, MultiPolygon, Polygon, QuadBezierCurve, Rectangle, Sector, TextBox, TextMarker };",{"version":3,"sources":["D:\\cdRule\\src\\components\\Map\\core\\maptalks.es.js"],"names":["version","INTERNAL_LAYER_PREFIX","GEOMETRY_COLLECTION_TYPES","GEOJSON_TYPES","RESOURCE_PROPERTIES","RESOURCE_SIZE_PROPERTIES","NUMERICAL_PROPERTIES","COLOR_PROPERTIES","DEFAULT_TEXT_SIZE","Date","i","arguments","src","dest","obj","isNaN","n","isNil","hasOwnProperty","Object","arr","seperator","Array","pi","Math","d","r","IS_NODE","process","requestAnimFrame","setTimeout","cancelAnimFrame","timeToCall","window","requestFn","getPrefixed","cancelFn","prefix","url","loadImage","img","imgDesc","uid","GUID","isString","JSON","ii","ll","array","context","fn","result","len","p","forEachCoord","pp","v","x","Number","rounded","a","b","max","w","urlPattern","cssUrlReWithQuote","cssUrlRe","test","isCssUrl","matches","b64chrs","str","String","output","idx","map","block","charCode","byteCharacters","atob","arraybuffer","view","blob","type","contentType","dx","x1","dy","y1","emptyImageUrl","obj2","approx","obj1","delta","val","expected","interval","count","me","clearTimeout","cb","keys","key","value","types","compile","op","filter","compileComparisonOp","compileLogicalOp","compileNegation","compileInOp","compileHasOp","property","left","compilePropertyReference","right","checkType","expressions","values","json","geometry","g","compileStyle","compiled","styles","createFilter","extend$1","isFunctionDefinition","fun","isFeatureConstant","isZoomConstant","zoomAndFeatureDependent","parameters","featureDependent","zoomDependent","innerFun","featureFunctions","featureFunctionStops","s","stop","zoom","default","stops","createFunction","base","feature","c","input","interpolate$1","coalesce","evaluatedLower","outputLower","evaluatedUpper","outputUpper","interpolateArray","interpolateNumber","difference","inputUpper","progress","ratio","createFunction1","hit","multResult","loaded","loadFunctionTypes","props","buildFn","get","interpolated","argFn","set","configurable","enumerable","_i","t","res","l","_fn","index","getFilterFeature","hasFunctionDefinition","piecewiseConstant","getFunctionTypeResources","symbol","translateToSVGStyles","isNumber","svgStyles","pathes","pathesToRender","path","extend","svg","strPath","b64","btoa","symbols","resources","convertResourceUrl","iii","extractCssUrl","resSizeProp","h","_iii","getMarkerPathBase64","_convertUrl","getSymbolStamp","hasOwn","isFunction","isGradient","getGradientStamp","_symbol","lower","sources","args","index$1","now","isInteger","isObject","join","isEmpty","toRadian","toDegree","isSVG","UID","parseJSON","pushIn","removeFromArray","getValueOrDefault","sign","log2","interpolate","wrap","clamp","isArrayHasData","isURL","b64toBlob","computeDegree","equalMapView","flash","_defaults","getExternalResources","lowerSymbolOpacity","extendSymbol","Browser","ua","navigator","doc","document","ie","webkit","phantomjs","android23","chrome","gecko","mobile","msPointer","pointer","ie3d","webkit3d","gecko3d","opera12","any3d","chromeVersion","touch","canvas","gl","webgl","devicePixelRatio","ielt9","edge","android","safari","mobileWebkit","mobileWebkit3d","mobileOpera","mobileGecko","retina","language","ie9","ie10","Browser$1","subClass","superClass","self","Position","_proto","point","y","nx","ny","Point","_inheritsLoose","_Position","cos","sin","Size","width","size","specialPattern","trim","rulerCtx","stringWidth","domRuler","getDomRuler","font","removeDomNode","content","chrWidth","minChrCount","wrapWidth","testStr","prew","chr","contentExpRe","height","horizontalAlignment","alignW","verticalAlignment","alignH","DEFAULT_FONT","style","getFont","lineSpacing","stringLength","textWidth","textHeight","wrapChar","textRows","text","actualWidth","texts","tWidth","contents","splitContent","_contents","_w","rowNum","textSize","strings","escapeSpecialChars","splitWords","getFontHeight","replaceVariable","getAlignPoint","splitTextToRow","first","testProp","TRANSFORM","TRANSFORMORIGIN","TRANSITION","CSSFILTER","el","setClass","createEl","setStyle","container","node","eventHandler","e","handler","typeArr","listensDomEvent","removeDomEvent","callback","capture","passive","handlers","j","jlen","doRemove","hitHandler","event","dom","setTransform","offset","padding","parseInt","rect","offsetWidth","offsetHeight","scaleX","scaleY","ev","domPos","computeDomPosition","suffix","cssText","endsWith","className","getClass","hasClass","classes","pos","m","ruler","span","on","off","createElOn","addDomEvent","preventDefault","stopPropagation","preventSelection","offsetDom","getEventContainerPoint","addClass","setOpacity","setTransformMatrix","removeTransform","isHTML","measureDom","Ajax","jsonp","name","script","options","client","post","postData","_t","_wrapCallback","response","data","cacheControl","expires","_getClient","getArrayBuffer","getImage","URL","onload","imgData","resp","DEFAULT_STROKE_COLOR","DEFAULT_FILL_COLOR","DEFAULT_TEXT_COLOR","hitTesting","TEMP_CANVAS","RADIAN","textOffsetY","Canvas","setHitTesting","createCanvas","prepareCanvasFont","ctx","fill","prepareCanvas","strokeWidth","strokePattern","strokeColor","patternOffset","polygonPattern","fillImgUrl","extractImageUrl","fillTexture","console","_createGradient","gradient","places","min","extent","_setStrokePattern","imgUrl","imageTexture","imageRes","patternCanvas","clearRect","fillCanvas","fillOpacity","isPattern","alpha","getRgba","color","image","textDesc","_textOnMultiRow","ptAlign","lineHeight","basePoint","maxHeight","rowAlign","_textOnLine","textHaloAlpha","drawHalo","textHaloRadius","shadowBlur","shadowOffsetX","shadowOffsetY","pt","gco","fillText","_stroke","strokeOpacity","_path","degree","p1","p2","cosd","isDashed","isPatternLine","ignoreStrokePattern","points","prePoint","fillWithPattern","nextPoint","drawDashLine","_multiClip","polygon","fillFirst","savedCtx","copyProperties","_ring","ring","paintSmoothLine","u0","u1","qxa","bx1","bx2","qxb","qxc","x2","qxd","qya","by1","by2","qyb","qyc","y2","qyd","xb","xc","xd","yb","yc","yd","xc1","x0","yc1","y0","xc2","yc2","xc3","yc3","len1","len2","len3","x3","y3","k1","k2","xm1","ym1","xm2","ym2","ctrl1X","ctrl1Y","ctrl2X","ctrl2Y","ctrlPoints","interpolate$$1","close","tailRatio","getCubicControlPoints","lastPoint","preCtrlPoints","_arcBetween","dist","p1p2","cp2","da","cx","cy","startAngle","endAngle","_lineTo","bezierCurveAndFill","start","_bezierCurveTo","p3","ellipse","k","ox","oy","oy1","b1","heightTop","bezierEllipse","rectangle","sector","rad","angles","sDeg","eDeg","_isPattern","drawCross","copy","target","fromX","startPoint","fromY","toX","endPoint","toY","pattern","lt","gt","capmin","capmax","checkX","thereYet","cap","checkY","offsetX","offsetY","dash","ang","commonjsGlobal","exports","module","zousanMin","createCommonjsModule","u","f","o","attributes","setImmediate","resolve","reject","then","timeout","Error","promise","Promise$1","Eventable","_Base","_class","eventTypes","eventsOn","evtType","handlerChain","once","evetTypes","eventsOff","jl","eventType","wrapKey","listeners","listener","eventMap","called","eventKeys","param","queue","bubble","passed","Handler","Handler$1","Class","proto","config","conf","parentProto","hooks","_len","_key","init","registeredTypes","JSONAble","clazz","START_EVENTS","MOVE_EVENTS","mousedown","touchstart","pointerdown","MSPointerDown","END_EVENTS","DragHandler","_this","_Handler","actual","newPos","Coordinate","coordinates","coord","child","CRS","proj","code","TEMP_POINT0","TEMP_COORD0","TEMP_COORD1","TEMP_COORD2","TEMP_COORD3","TEMP_COORD4","TEMP_COORD5","TEMP_COORD6","TEMP_COORD7","MINMAX","TEMP_COMBINE","Extent","projection","out","ext2","rxmin","rymin","rxmax","rymax","intersects","TEMP_EXTENT","inited","xmin","ymin","xmax","ymax","ext","distance","minmax","PointExtent","_Extent","Transformation","Common","project","unproject","projectCoords","circum","sx","sy","pre","prj","current","wrapX","wrapY","unprojectCoords","isSphere","isOutSphere","wrapCoord","wrapped","pcoord","getCircum","getSphereExtent","Common$1","measureLength","c1","Identity","measureLenBetween","c2","measureArea","area","locate","_locate","xDist","yDist","rotate","_rotate","tmp","pivot","angle","Sphere","ry","rx","initialAngle","rhumbBearing","finalAngle","calculateRhumbDestination","bear360","calculateRhumbBearing","bear180","phi1","from","phi2","to","deltaLambda","deltaPsi","theta","lambda1","origin","DeltaPhi","DeltaPsi","q","DeltaLambda","lambda2","WGS84Sphere","sphere","BaiduSphere","DEFAULT","measurers","registerMeasurer","Measurer","getInstance","mName","index$2","EPSG3857","metersPerDegree","maxLatitude","lng","lnglat","lat","pLnglat","PROJ4326","Projection_EPSG4490","Projection_Baidu","EARTHRADIUS","MCBAND","LLBAND","MC2LL","LL2MC","convertMC2LL","cD","cB","cE","T","convertLL2MC","cC","convertor","toRadians","toDegrees","getRange","getLoop","Projection_IDENTITY","DEFAULT$1","projections","EPSG4326","EPSG4490","BAIDU","IDENTITY","Renderable","CanvasRenderer","_Class","_this2","drawFn","containerPoint","promises","cache","resourceUrls","dpr","canvasSize","mask","maskExtent2D","old","masks","painter","_mask","southWest","onSpatialReferenceChange","painted","crossOrigin","err","ResourceCache","_proto2","checkSVG","parts","segment","clipSegment","codeA","useLastCode","_getBitCode","codeB","_lastCode","codeOut","_getEdgeIntersection","newCode","edges","clippedPoints","bounds","southeast","center","xfocus","f1","f2","Symbolizer","CanvasSymbolizer","_Symbolizer","prop","set$1","setProp","TEMP_POINT0$1","TEMP_POINT1","PointSymbolizer","_CanvasSymbolizer","glZoom","renderPoints","placement","dxdy","cpoints","flat","rotations","p0","maxZoom","VectorMarkerSymbolizer","_PointSymbolizer","lineWidth","cookedPoints","strokeAndFill","stamp","anchor","shadow","canvasClass","margin","markerType","vectorArray","lineOpacity","gradientExtent","hLineWidth","_j","_j2","lineCap","_lineCap","alignPoint","rotation","ha","va","hh","hw","top","v0","v1","v2","v3","extWidth","DebugSymbolizer","layer","outline","id","cross","ImageMarkerSymbolizer","imgURL","TEMP_COORD0$1","TEMP_COORD1$1","StrokeAndFillSymbolizer","_assertThisInitialized","paintParams","isGradient$$1","isPath","isSplitted","params","_params","grad","lineColor","CACHE_KEY","TextMarkerSymbolizer","textContent","genCacheKey","VectorPathMarkerSymbolizer","_ImageMarkerSymbolize","renderer","defaultSymbol","polygonFill","polygonOpacity","DrawAltitudeSymbolizer","properties","groundPoints","groundPoint","index$3","registerSymbolizers","TEMP_POINT0$2","TEMP_PAINT_EXTENT","TEMP_EXTENT$1","TEMP_FIXED_EXTENT","TEMP_CLIP_EXTENT0","TEMP_CLIP_EXTENT1","Painter","geoSymbol","symbolizers","regSymbolizers","symbolizer","pitched","rotated","paintAsPath","zoomScale","tr","mapExtent","cPoints","containerOffset","altitude","clipped","clipPoints","alt","cring","cc","pointContainerPoint","pointPlacement","extent2D","glExtent2D","smoothness","clipPolygon","part","clipLine","segsWithAlt","interpolateAlt","cp","minAltitude","frustumAlt","contexts","markerExtent","bak","tolerance","testCanvas","isDynamicSize","_this$_fixedExtent","glScale","maxAltitude","extent2","groundExtent","propAlt","z","textcache","orig","w0","w1","t0","TEMP_EXTENT$2","CollectionPainter","geometries","DefaultSpatialReference","resolutions","PI","SpatialReference","prjName","sp1","sp2","r1","r2","defaultSpatialRef","fullExtent","next","Geometry","opts","_JSONAble","oldId","prjExt","zIndex","topZ","bottomZ","translated","ret","gJson","geoJSON","other","measurer","cookedSymbols","needRepaint","geoProperties","layerOpts","Handlerable","options$1","Layer","minZoom","layers","topLayer","bottomLayer","_this3","_renderer","emitter","fire","options$2","Map$1","baseLayer","_Handlerable","Map","writable","oldRef","ref","pcenter","visualHeight","pitch","maxVisualPitch","fov","visualPitch","cameraToCenter","tanB","tanP","visualDistance","maxExt","fromZoom","scale","targetRes","scaleZoom","minRes","maxRes","gap","viewMaxZoom","viewMinZoom","animation","containerExtent","zoomOffset","isChange","mapLayers","removed","layersToOrder","minZ","_l","mimeType","save","file","dataURL","dlLink","viewPoint","justStart","watched","oldHeight","oldWidth","resizeOffset","hided","prjCenter","moveTo","cursor","hasCursor","panel","layerList","layerLists","containerDOM","mSize","pixel","pCenter","panelOffset","coordinateToPoint","COORD","prjCoord","pointToCoordinate","coordinateToViewPoint","viewPointToCoordinate","coordinateToContainerPoint","pCoordinate","containerPointToCoordinate","containerToExtent","POINT0","POINT1","distanceToPixel","distanceToPoint","POINT","paramCenter","pixelToDistance","COORD0","COORD1","fullExt","pointToDistance","locateByPoint","_get2DExtent","cached","cExtent","_pointToExtent","min2d","max2d","_ref","minx","maxx","_ref2","miny","maxy","_getViewPointFrameOffset","_viewPointToPrj","_prjToContainerPoint","_prjToViewPoint","_viewPointToPoint","_pointToViewPoint","MapDoubleClickZoomHandler","oldZoom","MapDragHandler","mx","my","prePitch","preBearing","db","bearing","_bearing","EVENTS","MapGeometryEventsHandler","oneMoreEvent","domEvent","downTime","time","coordinate","geometryCursorStyle","identifyOptions","eventToFire","fireGeometryEvent","propagation","geoMap","geo","iid","oldTargets","oldTarget","oldTargetId","_i2","wheelZoomDelta","defaultZoomRate","wheelZoomRate","maxScalePerFrame","MapScrollWheelZoomHandler","evt","zoomRate","targetZoom","levelValue","nextZoom","duration","_origin","frame","MapTouchZoomHandler","d1","d2","vector","preY","KEY","Easing","in","inAndOut","linear","upAndDown","Frame","Player","Animation","speed","_resolveStyles","_styles","childStyles","isChild","resolveChild","resolveVal","framing","easing","startStyles","dStyles","destStyles","deltaStyles","_dStyles","_startStyles","children","elapsed","state","_requestAnimFrame","_a","_run","running","animate","player","_prepare","play","pause","cancel","finish","reverse","onFrame","_frame","Animation$1","simplify","prevPoint","newPoints","getSqDist","maxSqDist","sqDist","getSqSegDist","simplifyDPStep","simplified","last","sqTolerance","highestQuality","simplifyRadialDist","simplifyDouglasPeucker","options$3","Path","_Geometry","isPolygon","animCoords","prjAnimCoords","length","_coordinates","currentCoord","targetLength","segLen","prjCoords","lastCoord","targetCoord","_animCoords","_prjAnimCoords","meExtent","clipFn","sumx","sumy","counter","isSimplify","isMulti","hasAltitude","shell","rings","coords","vertexes","JSON_TYPE","Polygon","_Path","holes","isClose","options$4","Marker","_CenterMixin","computeExtent","CenterMixin","options$5","LineString","GeometryCollection","_geometries","selected","isFn","is","invalidGeoError","sumX","sumY","computeExtent$1","anchors","geoExtent","MultiGeometry","_GeometryCollection","MultiPoint","_MultiGeometry","distanceTo","MultiPath","MultiLineString","_MultiPath","MultiPolygon","types$1","GeoJSON","toGeometry","resultGeos","resultGeo","_convert","foreachFn","features","_result2","mGeos","_result","options$6","Circle","circle","numberOfPoints","radius","vertex","se","withInEllipse","pminmax","leftx","rightx","topy","bottomy","p4","options$7","Ellipse","deg","pps","longer","Rectangle","_Polygon","nw","fExt","sphereExtent","prjs","options$8","Sector","_Circle","pc","atan2","sAngle","eAngle","between","options$9","Curve","_LineString","ctrlPoint","segments","arrow","arrows","_arrow","options$a","ArcCurve","_Curve","arc","CubicBezierCurve","curve","QuadBezierCurve","defaultSymbol$1","defaultBoxSymbol","TextMarker","_Marker","_style","options$b","TextBox","_TextMarker","textBox","_content","textStyle","maxWidth","hAlign","vAlign","options$c","textSymbol","Label","label","boxStyle","sizes","boxSize","textAlignPoint","Connectable","srcPoints","targetPoints","minDist","oldCoordinates","trigger","options$d","showOn","ConnectorLine","_Connectable","ArcConnectorLine","_Connectable2","options$e","TEMP_EXTENT$3","OverlayLayer","_Layer","filtered","copyOnWrite","fitView","geos","step","geoId","internalId","hits","low","high","middle","options$f","VectorLayer","_OverlayLayer","profile","clipExtent","geoJSONs","geoExt","MapTool","_Eventable","events","options$g","registeredMode","DrawTool","_MapTool","_mouseUpHandler","autoPanAtEdge","registerMode","action","actions","_map","_mapDoubleClickZoom","mode","_events","clickCoords","drawLayer","mapSize","drawLayerId","drawToolLayer","drawTool","MapBoxZoomHander","PANOFFSET","MapAutoPanAtEdgeHandler","animateTo","currView","empty","_from","_to","zoomOrigin","framer","_center","_animateTo","isAnimating","isRotating","_endAnim","endCoord","_endCoord","_startAnim","_stopAnim","_resumePrev","prevPlayer","_registerDomEvents","_removeDomEvents","_handleDOMEvent","mimicClick","_ignoreEvent","preTarget","_isEventOutMap","actualEvent","eventPos","_parseEvent","eventParam","_parseEventFromCoord","_getActualEvent","_fireDOMEvent","isFullScreen","requestFullScreen","cancelFullScreen","_requestFullScreen","screen","newWin","location","_cancelFullScreen","panTo","_panTo","panBy","_panAnimation","layerType","layerJSON","toJSON","extraLayerOptions","layersJSON","_layers","exportOption","_opts","layerJSONs","computeLength","computeGeometryLength","computeGeometryArea","identify","reqLayers","layerHits","_zoom","_zoomAnimation","_checkZoomOrigin","_startZoomAnim","startScale","endScale","onZoomStart","onZooming","frameZoom","fromRes","originOffset","matrix","onZoomEnd","startZoomVal","_zoomTo","_checkZoom","fovy","nf","near","far","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b0","b2","b3","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","ax","ay","az","bx","by","bz","hypot","m11","te","m12","m13","m21","m22","m23","m31","m32","m33","trace","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","subtract","normalize","up","RADIAN$1","DEFAULT_FOV","TEMP_COORD","getFov","setFov","getBearing","setBearing","getPitch","setPitch","isTransforming","getFrustumAltitude","_calcFrustumAltitude","cameraAlt","_pointToContainerPoint","_scale","set$2","applyMatrix","w2","h2","centerPoint","_projIfBehindCamera","vectorFromCam","sub","camNormDot","dot","scale$1","add","_containerPointToPoint","coord0","coord1","z0","z1","_x","_y","scale$$1","_calcMatrices","m0","createMat4","m1","worldMatrix","farZ","projMatrix","perspective","invert","multiply","_getCameraFar","cameraCenterDistance","tanFov","_calcCascadeMatrixes","viewMatrix","cascadePitch0","cascadePitch1","projViewMatrix0","projViewMatrix1","cal","_calcDomMatrix","minusY","cameraToCenterDistance","translate","rotateX","rotateZ","identity","_getCameraWorldMatrix","targetZ","center2D","cz","lookAt","cameraForward","matrixToQuaternion","quaternionToMatrix","setPosition","_getFovRatio","_renderLayers","_onViewChange","zoomToPreviousView","hasPreviousView","zoomToNextView","hasNextView","_zoomToView","getViewHistory","_fireViewChange","_getCurrentView","options$h","DistanceTool","_DrawTool","toMeasure","units","layerId","markerLayerId","marker","startLabel","ms","vertexLabel","dxSymbol","endMarker","measureLineLayer","measureMarkerLayer","options$i","AreaTool","_DistanceTool","sqmi","vertexMarker","endLabel","circleHooks","prjPath","nextCoord","ellipseHooks","rectangleHooks","firstClick","polygonHooks","line","pSymbol","lineStringHooks","markerWidth","markerHeight","tileInfo","arcConf","tileSize","lods","tileSystem","spatialRef","parse","options$j","UIComponent","visible","anim","transition","animations","trimed","mapWidth","mapHeight","clientWidth","clientHeight","eventsToStop","ownerEvents","onMoving","owner","options$k","domEvents","UIMarker","EVENTS$1","UIMarkerDragHandler","tagName","coordOffset","pointOffset","options$l","InfoWindow","_UIComponent","title","_dom","msgContent","closeBtn","markerSize","fixExtent","defaultWidth","options$m","ToolTip","cssName","defaultOptions","Menu","menuItems","_removePrevDOM","ul","items","item","itemDOM","itemTitle","onMenuClick","Menuable","setMenu","openMenu","setMenuItems","getMenuItems","closeMenu","removeMenu","_bindMenu","_unbindMenu","_defaultOpenMenu","index$4","Control","controlContainer","position","addControl","control","removeControl","options$n","layerEvents","Attribution","_Control","attributions","options$o","LayerSwitcher","button","baseLayers","li","elm","_li","_ul","_label","_layer","excludeLayers","enabled","_baseLayer","options$p","Overview","mapContainer","level","showIndex","options$q","Panel","closeButton","panelContent","startPosition","options$r","Scale","css","maxMeters","meters","maxFeet","maxMiles","miles","feet","pow10","num","options$s","Toolbar","targetDom","itemSize","onButtonClick","dropMenu","childIndex","menuDom","menuUL","liWidth","options$t","UNIT","Zoom","levelDOM","zoomDOM","zoomInButton","box","reading","zoomOutButton","totalRange","zoomRange","index$5","TileSystem","semiCircum","TileConfig","tileX","tileY","tileIndex","idy","repeatWorld","transformation","nwIndex","seIndex","planes","setPlanes","plane","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","distance$1","isSetAvailable","TileHashset","options$u","URL_PATTERN","TEMP_POINT","TEMP_POINT0$3","TEMP_POINT1$1","TEMP_POINT2","TEMP_POINT3","TEMP_POINT4","TEMP_POINT5","TEMP_POINT6","TILE_BOX","ARR3","TileLayer","parentRenderer","parentLayer","tileGrids","visualHeight1","tileZoom","_currentTiles","visualHeight0","extent0","currentTiles","cascadeHeight","cascadeLevels","extent1","cascadeTiles1","cascadeTiles2","urlTemplate","domain","subdomains","length$$1","sr","frustumMatrix","cascadeLevel","hasOffset","emptyGrid","tileConfig","mapSR","extent2d","maskExtent","intersection","pmin","pmax","centerTile","ltTile","rbTile","bottom","allCount","tiles","leftVisitEnd","rightVisitEnd","tileId","_tileInfo","point0","pnw","pse","tileExtent","yOrder","corner","corner0","tileIdx","tile","childExtent","mapProjection","tileCenter","ndc","transformMat4","intersectsBox","_onSpatialReferenceChange","GroupTileLayer","_TileLayer","childGrid","_this4","ids","options$v","crs","uppercase","detectRetina","defaultWmsParams","service","request","format","transparent","WMSTileLayer","wmsParams","parseFloat","projectionKey","bbox","getParamString","encodeURIComponent","existingUrl","CanvasTileLayer","names","shader","error","vertexShader","compileShader","fragmentShader","program","FSIZE","Float32Array","STRIDE","attr","_attr","shaders","arr16","DEBUG_POINT","ImageGLRenderable","renderable","uMatrix","glBuffer","_ctx","indices","createGLContext","texture","textures","imageBuffers","buffer","enableVertexAttrib","_createProgram2","createProgram","uSampler","texIdx","uniforms","uniform","set8","set8Int","options$w","TEMP_POINT$1","ImageLayer","images","EMPTY_ARRAY","ImageLayerCanvasRenderer","_CanvasRenderer","urls","unloaded","globalAlpha","opacity","ImageLayerGLRenderer","_ImageGLRenderable","_proto3","CanvasLayerRenderer","canvasImg","bufferContext","prevent","ensureParams","options$x","CanvasLayer","TEMP_POINT$2","options$y","ParticleLayer","_CanvasLayer","trail","_CanvasLayerRenderer","EDIT_STAGE_LAYER_PREFIX","options$z","createHandleSymbol","GeometryEditor","stageId","shadowId","_exeAndReset","handle","onDown","onMove","onUp","cursors","axis","blackList","resizeHandles","anchorIndexes","handleSymbol","fnLocateHandles","pExt","getResizeAnchors","_loop","isBlack","ele","onHandleMove","onHandleUp","_ret","_this5","geometryToEdit","getUpdates","resizeAbilities","aspectRatio","newCoordinates","handleViewPoint","mirrorHandle","mirrorViewPoint","viewCenter","wh","ability","updates","_this6","_this7","isRect","targetPoint","mirror","pointSub","absSub","verticeLimit","propertyOfVertexRefreshFn","propertyOfVertexIndex","vertexHandles","newVertexHandles","prjCoordinates","getVertexPrjCoordinates","nextIndex","createNewVertexHandle","onVertexAddOrRemove","vertice","nVertex","pVertex","getVertexCoordinates","moveVertexHandle","onRefresh","vertexCoordinates","nextVertex","vertexIndex","createVertexHandle","refreshVertex","_i3","updating","_len2","_key2","lastOperation","record","history","_this8","TextEditable","startEditText","endEditText","html","isEditingText","getTextEditor","_prepareEditor","editContainer","_getEditorOffset","textAlign","_createEditor","labelSize","textColor","spacing","editor","_setCursorToLast","range","stylesToAnimate","isFocusing","fnName","toTranslate","preTranslate","dSymbol","_prepareAnimationStyles","symbolToAnimate","symbolInStyles","_fireAnimateEvent","playState","DRAG_STAGE_LAYER_ID","EVENTS$2","GeometryDragHandler","shadows","shadowConnectors","connectors","targetConn","connOptions","connSymbol","conn","enableAltitude","altitudeProperty","parent","isDragging","startEdit","endEdit","redoEdit","undoEdit","cancelEdit","isEditing","_onEvent","_getEventTypeToFire","_getEventParams","setInfoWindow","getInfoWindow","openInfoWindow","closeInfoWindow","removeInfoWindow","_bindInfoWindow","_unbindInfoWindow","LRUCache","removedData","TEMP_POINT$3","TEMP_POINT1$2","TEMP_POINT2$1","TileLayerCanvasRenderer","mask2DExtent","loadingCount","loading","checkedTiles","parentTiles","parentKeys","childTiles","childKeys","placeholders","placeholderKeys","tileQueue","preLoadingCount","loadingLimit","tileGrid","allTiles","placeholder","tileLoading","hitLimit","info","parentTile","parentId","t2","t1","_childTiles","started","tileImage","tileRetryCount","transformed","_point","xyz","zoomDiff","childZoom","dmin","dmax","ex","ey","diff","tilesInView","tilesLoading","_tilesLoading$tileId","force","_tile","defaultPlaceholder","cw","ch","TileLayerGLRenderer","debugInfo","tileCanvas","CanvasRenderer$1","_TileLayerCanvasRende","_loadTile","GLRenderer","_TileLayerGLRenderer","OverlayLayerRenderer","redraw","TEMP_EXTENT$4","VectorLayerRenderer","_OverlayLayerCanvasRe","MapRenderer","panels","hasFront","hasBack","hasUI","frontCount","backCount","uiCount","MapCanvasRenderer","_MapRenderer","updated","isInteracting","canvasIds","updatedIds","fps","timeLimit","layerLimit","isCanvas","needsRedraw","transformMatrix","preCanvasIds","preUpdatedIds","sep","drawTime","inTime","interacting","limit","layerImage","baseLayerImage","clearInterval","POSITION0","mapWrapper","createContainer","mapAllLayers","backStatic","back","backLayer","canvasContainer","frontStatic","front","frontLayer","ui","previous","canvasImage","imgOp","cascadePitches","h30","h60","fogThickness","landscape","setInterval","index$6","CanvasTileLayerCanvasRenderer","CanvasTileLayerGLRenderer","OverlayLayerCanvasRenderer","VectorLayerCanvasRenderer","CenterPointRenderer","_getRenderPoints","PolyRenderer","_l2","_ii","_ll","_l3","_coords","_l4","_redrawWhenPitch","_redrawWhenRotate","_paintAsPath","_getPaintParams","_paintOn","_getRenderSize","prjExtent","pointZoom","arrowStyles","_getArrowShape","arrowStyle","normal","prjVertexes","_getArrowPlacement","_getArrowStyle","_getArrows","_getArrowPoints","_paintArrow","prjHoles","holePoints","hole"],"mappings":"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","sourcesContent":["/*!\n * maptalks v0.47.5\n * LICENSE : BSD-3-Clause\n * (c) 2016-2020 maptalks.org\n */\nvar version = \"0.47.5\";\n\nvar INTERNAL_LAYER_PREFIX = '_maptalks__internal_layer_';\nvar GEOMETRY_COLLECTION_TYPES = ['MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\nvar GEOJSON_TYPES = ['FeatureCollection', 'Feature', 'Point', 'LineString', 'Polygon'].concat(GEOMETRY_COLLECTION_TYPES);\nvar RESOURCE_PROPERTIES = ['markerFile', 'polygonPatternFile', 'linePatternFile', 'markerFillPatternFile', 'markerLinePatternFile'];\nvar RESOURCE_SIZE_PROPERTIES = [['markerWidth', 'markerHeight'], [], [null, 'lineWidth'], [], [null, 'markerLineWidth']];\nvar NUMERICAL_PROPERTIES = {\n  'lineWidth': 1,\n  'lineOpacity': 1,\n  'lineDx': 1,\n  'lineDy': 1,\n  'polygonOpacity': 1,\n  'markerWidth': 1,\n  'markerHeight': 1,\n  'markerDx': 1,\n  'markerDy': 1,\n  'markerOpacity': 1,\n  'markerFillOpacity': 1,\n  'markerLineWidth': 1,\n  'markerLineOpacity': 1,\n  'textSize': 1,\n  'textOpacity': 1,\n  'textHaloRadius': 1,\n  'textWrapWidth': 1,\n  'textLineSpacing': 1,\n  'textDx': 1,\n  'textDy': 1\n};\nvar COLOR_PROPERTIES = ['lineColor', 'polygonFill', 'markerFill', 'markerLineColor', 'textFill'];\nvar DEFAULT_TEXT_SIZE = 14;\n\nfunction now() {\n  return Date.now();\n}\nfunction extend(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    for (var k in src) {\n      dest[k] = src[k];\n    }\n  }\n\n  return dest;\n}\nfunction isNil(obj) {\n  return obj == null;\n}\nfunction isNumber(val) {\n  return typeof val === 'number' && !isNaN(val);\n}\nfunction isInteger(n) {\n  return (n | 0) === n;\n}\nfunction isObject(obj) {\n  return typeof obj === 'object' && !!obj;\n}\nfunction isString(obj) {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  return typeof obj === 'string' || obj.constructor !== null && obj.constructor === String;\n}\nfunction isFunction(obj) {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  return typeof obj === 'function' || obj.constructor !== null && obj.constructor === Function;\n}\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nfunction hasOwn(obj, key) {\n  return hasOwnProperty.call(obj, key);\n}\nfunction join(arr, seperator) {\n  if (arr.join) {\n    return arr.join(seperator || ',');\n  } else {\n    return Array.prototype.join.call(arr, seperator || ',');\n  }\n}\nfunction isEmpty(object) {\n  var property;\n\n  for (property in object) {\n    return false;\n  }\n\n  return !property;\n}\nvar pi = Math.PI / 180;\nfunction toRadian(d) {\n  return d * pi;\n}\nfunction toDegree(r) {\n  return r / pi;\n}\n\nvar IS_NODE = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]' && !process.versions['electron'] && !process.versions['nw'] && !process.versions['node-webkit'];\n\nvar requestAnimFrame, cancelAnimFrame;\n\n(function () {\n  if (IS_NODE) {\n    requestAnimFrame = function requestAnimFrame(fn) {\n      return setTimeout(fn, 16);\n    };\n\n    cancelAnimFrame = clearTimeout;\n    return;\n  }\n\n  var requestFn, cancelFn;\n  var timeToCall = 1000 / 30;\n\n  function timeoutDefer(fn) {\n    return setTimeout(fn, timeToCall);\n  }\n\n  function getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n  }\n\n  if (typeof window != 'undefined') {\n    requestFn = window['requestAnimationFrame'] || getPrefixed('RequestAnimationFrame') || timeoutDefer;\n\n    cancelFn = window['cancelAnimationFrame'] || getPrefixed('CancelAnimationFrame') || getPrefixed('CancelRequestAnimationFrame') || function (id) {\n      window.clearTimeout(id);\n    };\n  } else {\n    requestFn = timeoutDefer;\n    cancelFn = clearTimeout;\n  }\n\n  requestAnimFrame = function requestAnimFrame(fn) {\n    return requestFn(fn);\n  };\n\n  cancelAnimFrame = function cancelAnimFrame(id) {\n    if (id) {\n      cancelFn(id);\n    }\n  };\n})();\nfunction isSVG(url) {\n  var prefix = 'data:image/svg+xml';\n\n  if (url.length > 4 && url.slice(-4) === '.svg') {\n    return 1;\n  } else if (url.slice(0, prefix.length) === prefix) {\n    return 2;\n  }\n\n  return 0;\n}\nfunction loadImage(img, imgDesc) {\n  if (IS_NODE && loadImage.node) {\n    loadImage.node(img, imgDesc);\n    return;\n  }\n\n  img.src = imgDesc[0];\n}\nvar uid = 0;\nfunction UID() {\n  return uid++;\n}\nvar GUID = UID;\nfunction parseJSON(str) {\n  if (!str || !isString(str)) {\n    return str;\n  }\n\n  return JSON.parse(str);\n}\nfunction pushIn(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    if (src) {\n      for (var ii = 0, ll = src.length; ii < ll; ii++) {\n        dest.push(src[ii]);\n      }\n    }\n  }\n\n  return dest.length;\n}\nfunction removeFromArray(obj, array) {\n  var i = array.indexOf(obj);\n\n  if (i > -1) {\n    array.splice(i, 1);\n  }\n}\nfunction forEachCoord(arr, fn, context) {\n  if (!Array.isArray(arr)) {\n    return context ? fn.call(context, arr) : fn(arr);\n  }\n\n  var result = [];\n  var p, pp;\n\n  for (var i = 0, len = arr.length; i < len; i++) {\n    p = arr[i];\n\n    if (isNil(p)) {\n      result.push(null);\n      continue;\n    }\n\n    if (Array.isArray(p)) {\n      result.push(forEachCoord(p, fn, context));\n    } else {\n      pp = context ? fn.call(context, p) : fn(p);\n      result.push(pp);\n    }\n  }\n\n  return result;\n}\nfunction getValueOrDefault(v, d) {\n  return v === undefined ? d : v;\n}\nfunction sign(x) {\n  if (Math.sign) {\n    return Math.sign(x);\n  }\n\n  x = +x;\n\n  if (x === 0 || isNaN(x)) {\n    return Number(x);\n  }\n\n  return x > 0 ? 1 : -1;\n}\nfunction log2(x) {\n  if (Math.log2) {\n    return Math.log2(x);\n  }\n\n  var v = Math.log(x) * Math.LOG2E;\n  var rounded = Math.round(v);\n\n  if (Math.abs(rounded - v) < 1E-14) {\n    return rounded;\n  } else {\n    return v;\n  }\n}\nfunction interpolate(a, b, t) {\n  return a * (1 - t) + b * t;\n}\nfunction wrap(n, min, max) {\n  if (n === max || n === min) {\n    return n;\n  }\n\n  var d = max - min;\n  var w = ((n - min) % d + d) % d + min;\n  return w;\n}\nfunction clamp(n, min, max) {\n  return Math.min(max, Math.max(min, n));\n}\nfunction isArrayHasData(obj) {\n  return Array.isArray(obj) && obj.length > 0;\n}\nvar urlPattern = /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i;\nfunction isURL(url) {\n  return urlPattern.test(url);\n}\nvar cssUrlReWithQuote = /^url\\((['\"])(.+)\\1\\)$/i;\nvar cssUrlRe = /^url\\(([^'\"].*[^'\"])\\)$/i;\nfunction isCssUrl(str) {\n  if (!isString(str)) {\n    return 0;\n  }\n\n  if (cssUrlRe.test(str)) {\n    return 1;\n  }\n\n  if (cssUrlReWithQuote.test(str)) {\n    return 2;\n  }\n\n  return 3;\n}\nfunction extractCssUrl(str) {\n  var test = isCssUrl(str);\n  var matches;\n\n  if (test === 3) {\n    return str;\n  } else if (test === 1) {\n    matches = cssUrlRe.exec(str);\n    return matches[1];\n  } else if (test === 2) {\n    matches = cssUrlReWithQuote.exec(str);\n    return matches[2];\n  } else {\n    return str;\n  }\n}\nvar b64chrs = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\nfunction btoa(input) {\n  if (typeof window !== 'undefined' && window.btoa) {\n    return window.btoa(input);\n  }\n\n  var str = String(input);\n  var output = '';\n\n  for (var block, charCode, idx = 0, map = b64chrs; str.charAt(idx | 0) || (map = '=', idx % 1); output += map.charAt(63 & block >> 8 - idx % 1 * 8)) {\n    charCode = str.charCodeAt(idx += 3 / 4);\n\n    if (charCode > 0xFF) {\n      throw new Error('\\'btoa\\' failed: The string to be encoded contains characters outside of the Latin1 range.');\n    }\n\n    block = block << 8 | charCode;\n  }\n\n  return output;\n}\nfunction b64toBlob(b64Data, contentType) {\n  var byteCharacters = atob(b64Data);\n  var arraybuffer = new ArrayBuffer(byteCharacters.length);\n  var view = new Uint8Array(arraybuffer);\n\n  for (var i = 0; i < byteCharacters.length; i++) {\n    view[i] = byteCharacters.charCodeAt(i) & 0xff;\n  }\n\n  var blob = new Blob([arraybuffer], {\n    type: contentType\n  });\n  return blob;\n}\nfunction computeDegree(x0, y0, x1, y1) {\n  var dx = x1 - x0;\n  var dy = y1 - y0;\n  return Math.atan2(dy, dx);\n}\nvar emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\nfunction equalMapView(obj1, obj2) {\n  if (!obj1 && !obj2) {\n    return true;\n  } else if (!obj1 || !obj2) {\n    return false;\n  }\n\n  for (var p in obj1) {\n    if (p === 'center') {\n      if (!obj2[p] || !approx(obj1[p][0], obj2[p][0]) || !approx(obj1[p][1], obj2[p][1])) {\n        return false;\n      }\n    } else if (obj1[p] !== obj2[p]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction approx(val, expected, delta) {\n  if (delta == null) {\n    delta = 1e-6;\n  }\n\n  return val >= expected - delta && val <= expected + delta;\n}\n\nfunction flash(interval, count, cb, context) {\n  if (!interval) {\n    interval = 100;\n  }\n\n  if (!count) {\n    count = 4;\n  }\n\n  var me = this;\n  count *= 2;\n\n  if (this._flashTimeout) {\n    clearTimeout(this._flashTimeout);\n  }\n\n  function flashGeo() {\n    if (count === 0) {\n      me.show();\n\n      if (cb) {\n        if (context) {\n          cb.call(context);\n        } else {\n          cb();\n        }\n      }\n\n      return;\n    }\n\n    if (count % 2 === 0) {\n      me.hide();\n    } else {\n      me.show();\n    }\n\n    count--;\n    me._flashTimeout = setTimeout(flashGeo, interval);\n  }\n\n  this._flashTimeout = setTimeout(flashGeo, interval);\n  return this;\n}\nfunction _defaults(obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n}\n\nvar types = ['Unknown', 'Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\nfunction createFilter(filter) {\n  return new Function('f', \"var p = (f && f.properties || {}); return \" + compile(filter));\n}\n\nfunction compile(filter) {\n  if (!filter) return 'true';\n  var op = filter[0];\n  if (filter.length <= 1) return op === 'any' ? 'false' : 'true';\n  var str = op === '==' ? compileComparisonOp(filter[1], filter[2], '===', false) : op === '!=' ? compileComparisonOp(filter[1], filter[2], '!==', false) : op === '<' || op === '>' || op === '<=' || op === '>=' ? compileComparisonOp(filter[1], filter[2], op, true) : op === 'any' ? compileLogicalOp(filter.slice(1), '||') : op === 'all' ? compileLogicalOp(filter.slice(1), '&&') : op === 'none' ? compileNegation(compileLogicalOp(filter.slice(1), '||')) : op === 'in' ? compileInOp(filter[1], filter.slice(2)) : op === '!in' ? compileNegation(compileInOp(filter[1], filter.slice(2))) : op === 'has' ? compileHasOp(filter[1]) : op === '!has' ? compileNegation(compileHasOp(filter[1])) : 'true';\n  return \"(\" + str + \")\";\n}\n\nfunction compilePropertyReference(property) {\n  return property[0] === '$' ? 'f.' + property.substring(1) : 'p[' + JSON.stringify(property) + ']';\n}\n\nfunction compileComparisonOp(property, value, op, checkType) {\n  var left = compilePropertyReference(property);\n  var right = property === '$type' ? types.indexOf(value) : JSON.stringify(value);\n  return (checkType ? \"typeof \" + left + \"=== typeof \" + right + \"&&\" : '') + left + op + right;\n}\n\nfunction compileLogicalOp(expressions, op) {\n  return expressions.map(compile).join(op);\n}\n\nfunction compileInOp(property, values) {\n  if (property === '$type') values = values.map(function (value) {\n    return types.indexOf(value);\n  });\n  var left = JSON.stringify(values.sort(compare));\n  var right = compilePropertyReference(property);\n  if (values.length <= 200) return left + \".indexOf(\" + right + \") !== -1\";\n  return \"function(v, a, i, j) {\\n        while (i <= j) { var m = (i + j) >> 1;\\n            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;\\n        }\\n    return false; }(\" + right + \", \" + left + \",0,\" + (values.length - 1) + \")\";\n}\n\nfunction compileHasOp(property) {\n  return property === '$id' ? '\"id\" in f' : JSON.stringify(property) + \" in p\";\n}\n\nfunction compileNegation(expression) {\n  return \"!(\" + expression + \")\";\n}\n\nfunction compare(a, b) {\n  return a < b ? -1 : a > b ? 1 : 0;\n}\n\nfunction getFilterFeature(geometry) {\n  var json = geometry._toJSON(),\n      g = json['feature'];\n\n  g['type'] = types.indexOf(g['geometry']['type']);\n  g['subType'] = json['subType'];\n  return g;\n}\nfunction compileStyle(styles) {\n  if (!Array.isArray(styles)) {\n    return compileStyle([styles]);\n  }\n\n  var compiled = [];\n\n  for (var i = 0; i < styles.length; i++) {\n    var filter = void 0;\n\n    if (styles[i]['filter'] === true) {\n      filter = function filter() {\n        return true;\n      };\n    } else {\n      filter = createFilter(styles[i]['filter']);\n    }\n\n    compiled.push(extend$1({}, styles[i], {\n      filter: filter\n    }));\n  }\n\n  return compiled;\n}\n\nfunction extend$1(dest) {\n  for (var i = 1; i < arguments.length; i++) {\n    var src = arguments[i];\n\n    for (var k in src) {\n      dest[k] = src[k];\n    }\n  }\n\n  return dest;\n}\n\nfunction createFunction(parameters, defaultType) {\n  var fun;\n  var isFeatureConstant, isZoomConstant;\n\n  if (!isFunctionDefinition(parameters)) {\n    fun = function fun() {\n      return parameters;\n    };\n\n    isFeatureConstant = true;\n    isZoomConstant = true;\n  } else {\n    var zoomAndFeatureDependent = parameters.stops && typeof parameters.stops[0][0] === 'object';\n    var featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\n    var zoomDependent = zoomAndFeatureDependent || !featureDependent;\n    var type = parameters.type || defaultType || 'exponential';\n    var innerFun;\n\n    if (type === 'exponential') {\n      innerFun = evaluateExponentialFunction;\n    } else if (type === 'interval') {\n      innerFun = evaluateIntervalFunction;\n    } else if (type === 'categorical') {\n      innerFun = evaluateCategoricalFunction;\n    } else if (type === 'identity') {\n      innerFun = evaluateIdentityFunction;\n    } else {\n      throw new Error('Unknown function type \"' + type + '\"');\n    }\n\n    if (zoomAndFeatureDependent) {\n      var featureFunctions = {};\n      var featureFunctionStops = [];\n\n      for (var s = 0; s < parameters.stops.length; s++) {\n        var stop = parameters.stops[s];\n\n        if (featureFunctions[stop[0].zoom] === undefined) {\n          featureFunctions[stop[0].zoom] = {\n            zoom: stop[0].zoom,\n            type: parameters.type,\n            property: parameters.property,\n            default: parameters.default,\n            stops: []\n          };\n        }\n\n        featureFunctions[stop[0].zoom].stops.push([stop[0].value, stop[1]]);\n      }\n\n      for (var z in featureFunctions) {\n        featureFunctionStops.push([featureFunctions[z].zoom, createFunction(featureFunctions[z])]);\n      }\n\n      fun = function fun(zoom, feature) {\n        var value = evaluateExponentialFunction({\n          stops: featureFunctionStops,\n          base: parameters.base\n        }, zoom)(zoom, feature);\n        return typeof value === 'function' ? value(zoom, feature) : value;\n      };\n\n      isFeatureConstant = false;\n      isZoomConstant = false;\n    } else if (zoomDependent) {\n      fun = function fun(zoom) {\n        var value = innerFun(parameters, zoom);\n        return typeof value === 'function' ? value(zoom) : value;\n      };\n\n      isFeatureConstant = true;\n      isZoomConstant = false;\n    } else {\n      fun = function fun(zoom, feature) {\n        var value = innerFun(parameters, feature ? feature[parameters.property] : null);\n        return typeof value === 'function' ? value(zoom, feature) : value;\n      };\n\n      isFeatureConstant = false;\n      isZoomConstant = true;\n    }\n  }\n\n  fun.isZoomConstant = isZoomConstant;\n  fun.isFeatureConstant = isFeatureConstant;\n  return fun;\n}\n\nfunction coalesce(a, b, c) {\n  if (a !== undefined) return a;\n  if (b !== undefined) return b;\n  if (c !== undefined) return c;\n  return null;\n}\n\nfunction evaluateCategoricalFunction(parameters, input) {\n  for (var i = 0; i < parameters.stops.length; i++) {\n    if (input === parameters.stops[i][0]) {\n      return parameters.stops[i][1];\n    }\n  }\n\n  return parameters.default;\n}\n\nfunction evaluateIntervalFunction(parameters, input) {\n  for (var i = 0; i < parameters.stops.length; i++) {\n    if (input < parameters.stops[i][0]) break;\n  }\n\n  return parameters.stops[Math.max(i - 1, 0)][1];\n}\n\nfunction evaluateExponentialFunction(parameters, input) {\n  var base = parameters.base !== undefined ? parameters.base : 1;\n  var i = 0;\n\n  while (true) {\n    if (i >= parameters.stops.length) break;else if (input <= parameters.stops[i][0]) break;else i++;\n  }\n\n  if (i === 0) {\n    return parameters.stops[i][1];\n  } else if (i === parameters.stops.length) {\n    return parameters.stops[i - 1][1];\n  } else {\n    return interpolate$1(input, base, parameters.stops[i - 1][0], parameters.stops[i][0], parameters.stops[i - 1][1], parameters.stops[i][1]);\n  }\n}\n\nfunction evaluateIdentityFunction(parameters, input) {\n  return coalesce(input, parameters.default);\n}\n\nfunction interpolate$1(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  if (typeof outputLower === 'function') {\n    return function () {\n      var evaluatedLower = outputLower.apply(undefined, arguments);\n      var evaluatedUpper = outputUpper.apply(undefined, arguments);\n      return interpolate$1(input, base, inputLower, inputUpper, evaluatedLower, evaluatedUpper);\n    };\n  } else if (outputLower.length) {\n    return interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper);\n  } else {\n    return interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper);\n  }\n}\n\nfunction interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  var difference = inputUpper - inputLower;\n  var progress = input - inputLower;\n  var ratio;\n\n  if (base === 1) {\n    ratio = progress / difference;\n  } else {\n    ratio = (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\n  }\n\n  return outputLower * (1 - ratio) + outputUpper * ratio;\n}\n\nfunction interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper) {\n  var output = [];\n\n  for (var i = 0; i < outputLower.length; i++) {\n    output[i] = interpolateNumber(input, base, inputLower, inputUpper, outputLower[i], outputUpper[i]);\n  }\n\n  return output;\n}\n\nfunction isFunctionDefinition(obj) {\n  return obj && typeof obj === 'object' && (obj.stops || obj.property && obj.type === 'identity');\n}\nfunction hasFunctionDefinition(obj) {\n  for (var p in obj) {\n    if (isFunctionDefinition(obj[p])) {\n      return true;\n    }\n  }\n\n  return false;\n}\nfunction interpolated(parameters) {\n  return createFunction1(parameters, 'exponential');\n}\nfunction piecewiseConstant(parameters) {\n  return createFunction1(parameters, 'interval');\n}\nfunction loadFunctionTypes(obj, argFn) {\n  if (!obj) {\n    return null;\n  }\n\n  var hit = false;\n\n  if (Array.isArray(obj)) {\n    var multResult = [],\n        loaded;\n\n    for (var i = 0; i < obj.length; i++) {\n      loaded = loadFunctionTypes(obj[i], argFn);\n\n      if (!loaded) {\n        multResult.push(obj[i]);\n      } else {\n        multResult.push(loaded);\n        hit = true;\n      }\n    }\n\n    return hit ? multResult : obj;\n  }\n\n  var result = {\n    '__fn_types_loaded': true\n  },\n      props = [],\n      p;\n\n  for (p in obj) {\n    if (obj.hasOwnProperty(p)) {\n      props.push(p);\n    }\n  }\n\n  var buildFn = function buildFn(p) {\n    Object.defineProperty(result, p, {\n      get: function get() {\n        if (!this['__fn_' + p]) {\n          this['__fn_' + p] = interpolated(this['_' + p]);\n        }\n\n        return this['__fn_' + p].apply(this, argFn());\n      },\n      set: function set(v) {\n        this['_' + p] = v;\n      },\n      configurable: true,\n      enumerable: true\n    });\n  };\n\n  for (var _i = 0, len = props.length; _i < len; _i++) {\n    p = props[_i];\n\n    if (isFunctionDefinition(obj[p])) {\n      hit = true;\n      result['_' + p] = obj[p];\n      buildFn(p);\n    } else {\n      result[p] = obj[p];\n    }\n  }\n\n  return hit ? result : obj;\n}\nfunction getFunctionTypeResources(t) {\n  if (!t || !t.stops) {\n    return [];\n  }\n\n  var res = [];\n\n  for (var i = 0, l = t.stops.length; i < l; i++) {\n    res.push(t.stops[i][1]);\n  }\n\n  return res;\n}\n\nfunction createFunction1(parameters, defaultType) {\n  if (!isFunctionDefinition(parameters)) {\n    return function () {\n      return parameters;\n    };\n  }\n\n  parameters = JSON.parse(JSON.stringify(parameters));\n  var isZoomConstant = true;\n  var isFeatureConstant = true;\n  var stops = parameters.stops;\n\n  if (stops) {\n    for (var i = 0; i < stops.length; i++) {\n      if (isFunctionDefinition(stops[i][1])) {\n        var _fn = createFunction1(stops[i][1], defaultType);\n\n        isZoomConstant = isZoomConstant && _fn.isZoomConstant;\n        isFeatureConstant = isFeatureConstant && _fn.isFeatureConstant;\n        stops[i] = [stops[i][0], _fn];\n      }\n    }\n  }\n\n  var fn = createFunction(parameters, defaultType);\n  fn.isZoomConstant = isZoomConstant && fn.isZoomConstant;\n  fn.isFeatureConstant = isFeatureConstant && fn.isFeatureConstant;\n  return fn;\n}\n\n\n\nvar index = /*#__PURE__*/Object.freeze({\n  createFilter: createFilter,\n  getFilterFeature: getFilterFeature,\n  compileStyle: compileStyle,\n  isFunctionDefinition: isFunctionDefinition,\n  hasFunctionDefinition: hasFunctionDefinition,\n  interpolated: interpolated,\n  piecewiseConstant: piecewiseConstant,\n  loadFunctionTypes: loadFunctionTypes,\n  getFunctionTypeResources: getFunctionTypeResources\n});\n\nfunction translateToSVGStyles(s) {\n  var result = {\n    'stroke': {\n      'stroke': s['markerLineColor'],\n      'stroke-width': s['markerLineWidth'],\n      'stroke-opacity': s['markerLineOpacity'],\n      'stroke-dasharray': null,\n      'stroke-linecap': 'butt',\n      'stroke-linejoin': 'round'\n    },\n    'fill': {\n      'fill': s['markerFill'],\n      'fill-opacity': s['markerFillOpacity']\n    }\n  };\n\n  if (result['stroke']['stroke-width'] === 0) {\n    result['stroke']['stroke-opacity'] = 0;\n  }\n\n  return result;\n}\nfunction getMarkerPathBase64(symbol, width, height) {\n  if (!symbol['markerPath']) {\n    return null;\n  }\n\n  var op = 1;\n  var styles = translateToSVGStyles(symbol);\n\n  if (isNumber(symbol['markerOpacity'])) {\n    op = symbol['markerOpacity'];\n  }\n\n  if (isNumber(symbol['opacity'])) {\n    op *= symbol['opacity'];\n  }\n\n  var svgStyles = {};\n\n  if (styles) {\n    for (var p in styles['stroke']) {\n      if (styles['stroke'].hasOwnProperty(p)) {\n        if (!isNil(styles['stroke'][p])) {\n          svgStyles[p] = styles['stroke'][p];\n        }\n      }\n    }\n\n    for (var _p in styles['fill']) {\n      if (styles['fill'].hasOwnProperty(_p)) {\n        if (!isNil(styles['fill'][_p])) {\n          svgStyles[_p] = styles['fill'][_p];\n        }\n      }\n    }\n  }\n\n  var pathes = Array.isArray(symbol['markerPath']) ? symbol['markerPath'] : [symbol['markerPath']];\n  var path;\n  var pathesToRender = [];\n\n  for (var i = 0; i < pathes.length; i++) {\n    path = isString(pathes[i]) ? {\n      'path': pathes[i]\n    } : pathes[i];\n    path = extend({}, path, svgStyles);\n    path['d'] = path['path'];\n    delete path['path'];\n    pathesToRender.push(path);\n  }\n\n  var svg = ['<svg version=\"1.1\"', 'xmlns=\"http://www.w3.org/2000/svg\"'];\n\n  if (op < 1) {\n    svg.push('opacity=\"' + op + '\"');\n  }\n\n  if (symbol['markerPathWidth'] && symbol['markerPathHeight']) {\n    svg.push('viewBox=\"0 0 ' + symbol['markerPathWidth'] + ' ' + symbol['markerPathHeight'] + '\"');\n  }\n\n  svg.push('preserveAspectRatio=\"none\"');\n\n  if (width) {\n    svg.push('width=\"' + width + '\"');\n  }\n\n  if (height) {\n    svg.push('height=\"' + height + '\"');\n  }\n\n  svg.push('><defs></defs>');\n\n  for (var _i = 0; _i < pathesToRender.length; _i++) {\n    var strPath = '<path ';\n\n    for (var _p2 in pathesToRender[_i]) {\n      if (pathesToRender[_i].hasOwnProperty(_p2)) {\n        strPath += ' ' + _p2 + '=\"' + pathesToRender[_i][_p2] + '\"';\n      }\n    }\n\n    strPath += '></path>';\n    svg.push(strPath);\n  }\n\n  svg.push('</svg>');\n  var b64 = 'data:image/svg+xml;base64,' + btoa(svg.join(' '));\n  return b64;\n}\nfunction getExternalResources(symbol, toAbsolute) {\n  if (!symbol) {\n    return [];\n  }\n\n  var symbols = symbol;\n\n  if (!Array.isArray(symbol)) {\n    symbols = [symbol];\n  }\n\n  var resources = [];\n  var props = RESOURCE_PROPERTIES;\n  var res, resSizeProp;\n  var w, h;\n\n  for (var i = symbols.length - 1; i >= 0; i--) {\n    symbol = symbols[i];\n\n    if (!symbol) {\n      continue;\n    }\n\n    if (toAbsolute) {\n      symbol = convertResourceUrl(symbol);\n    }\n\n    for (var ii = 0; ii < props.length; ii++) {\n      res = symbol[props[ii]];\n\n      if (isFunctionDefinition(res)) {\n        res = getFunctionTypeResources(res);\n      }\n\n      if (!res) {\n        continue;\n      }\n\n      if (!Array.isArray(res)) {\n        res = [res];\n      }\n\n      for (var iii = 0; iii < res.length; iii++) {\n        if (res[iii].slice(0, 4) === 'url(') {\n          res[iii] = extractCssUrl(res[iii]);\n        }\n\n        resSizeProp = RESOURCE_SIZE_PROPERTIES[ii];\n        resources.push([res[iii], symbol[resSizeProp[0]], symbol[resSizeProp[1]]]);\n      }\n    }\n\n    if (symbol['markerType'] === 'path' && symbol['markerPath']) {\n      w = isFunctionDefinition(symbol['markerWidth']) ? 200 : symbol['markerWidth'];\n      h = isFunctionDefinition(symbol['markerHeight']) ? 200 : symbol['markerHeight'];\n\n      if (isFunctionDefinition(symbol['markerPath'])) {\n        res = getFunctionTypeResources(symbol['markerPath']);\n        var path = symbol['markerPath'];\n\n        for (var _iii = 0; _iii < res.length; _iii++) {\n          symbol['markerPath'] = res[_iii];\n          resources.push([getMarkerPathBase64(symbol), w, h]);\n        }\n\n        symbol['markerPath'] = path;\n      } else {\n        resources.push([getMarkerPathBase64(symbol), w, h]);\n      }\n    }\n  }\n\n  return resources;\n}\nfunction convertResourceUrl(symbol) {\n  if (!symbol) {\n    return null;\n  }\n\n  var s = symbol;\n\n  if (IS_NODE) {\n    return s;\n  }\n\n  var props = RESOURCE_PROPERTIES;\n  var res;\n\n  for (var ii = 0, len = props.length; ii < len; ii++) {\n    res = s[props[ii]];\n\n    if (!res) {\n      continue;\n    }\n\n    s[props[ii]] = _convertUrl(res);\n  }\n\n  return s;\n}\n\nfunction _convertUrl(res) {\n  if (isFunctionDefinition(res)) {\n    var stops = res.stops;\n\n    for (var i = 0; i < stops.length; i++) {\n      stops[i][1] = _convertUrl(stops[i][1]);\n    }\n\n    return res;\n  }\n\n  if (res.slice(0, 4) === 'url(') {\n    res = extractCssUrl(res);\n  }\n\n  return res;\n}\n\nfunction isGradient(g) {\n  return g && g['colorStops'];\n}\nfunction getGradientStamp(g) {\n  var keys = [g['type']];\n\n  if (g['places']) {\n    keys.push(g['places'].join());\n  }\n\n  if (g['colorStops']) {\n    var stops = [];\n\n    for (var i = g['colorStops'].length - 1; i >= 0; i--) {\n      stops.push(g['colorStops'][i].join());\n    }\n\n    keys.push(stops.join(','));\n  }\n\n  return keys.join('_');\n}\nfunction getSymbolStamp(symbol) {\n  var keys = [];\n\n  if (Array.isArray(symbol)) {\n    for (var i = 0; i < symbol.length; i++) {\n      keys.push(getSymbolStamp(symbol[i]));\n    }\n\n    return '[ ' + keys.join(' , ') + ' ]';\n  }\n\n  for (var p in symbol) {\n    if (hasOwn(symbol, p)) {\n      if (!isFunction(symbol[p])) {\n        if (isGradient(symbol[p])) {\n          keys.push(p + '=' + getGradientStamp(symbol[p]));\n        } else {\n          keys.push(p + '=' + symbol[p]);\n        }\n      }\n    }\n  }\n\n  return keys.join(';');\n}\nfunction lowerSymbolOpacity(symbol, ratio) {\n  function s(_symbol, _ratio) {\n    var op = _symbol['opacity'];\n\n    if (isNil(op)) {\n      _symbol['opacity'] = _ratio;\n    } else {\n      _symbol['opacity'] *= _ratio;\n    }\n  }\n\n  var lower;\n\n  if (Array.isArray(symbol)) {\n    lower = [];\n\n    for (var i = 0; i < symbol.length; i++) {\n      var d = extend({}, symbol[i]);\n      s(d, ratio);\n      lower.push(d);\n    }\n  } else {\n    lower = extend({}, symbol);\n    s(lower, ratio);\n  }\n\n  return lower;\n}\nfunction extendSymbol(symbol) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  if (!sources || !sources.length) {\n    sources = [{}];\n  }\n\n  if (Array.isArray(symbol)) {\n    var s, dest;\n    var result = [];\n\n    for (var i = 0, l = symbol.length; i < l; i++) {\n      s = symbol[i];\n      dest = {};\n\n      for (var ii = 0, ll = sources.length; ii < ll; ii++) {\n        if (!Array.isArray(sources[ii])) {\n          extend(dest, s, sources[ii] ? sources[ii] : {});\n        } else if (!isNil(sources[ii][i])) {\n          extend(dest, s, sources[ii][i]);\n        } else {\n          extend(dest, s ? s : {});\n        }\n      }\n\n      result.push(dest);\n    }\n\n    return result;\n  } else {\n    var args = [{}, symbol];\n    args.push.apply(args, sources);\n    return extend.apply(this, args);\n  }\n}\n\n\n\nvar index$1 = /*#__PURE__*/Object.freeze({\n  now: now,\n  extend: extend,\n  isNil: isNil,\n  isNumber: isNumber,\n  isInteger: isInteger,\n  isObject: isObject,\n  isString: isString,\n  isFunction: isFunction,\n  hasOwn: hasOwn,\n  join: join,\n  isEmpty: isEmpty,\n  toRadian: toRadian,\n  toDegree: toDegree,\n  IS_NODE: IS_NODE,\n  get requestAnimFrame () { return requestAnimFrame; },\n  get cancelAnimFrame () { return cancelAnimFrame; },\n  isSVG: isSVG,\n  loadImage: loadImage,\n  UID: UID,\n  GUID: GUID,\n  parseJSON: parseJSON,\n  pushIn: pushIn,\n  removeFromArray: removeFromArray,\n  forEachCoord: forEachCoord,\n  getValueOrDefault: getValueOrDefault,\n  sign: sign,\n  log2: log2,\n  interpolate: interpolate,\n  wrap: wrap,\n  clamp: clamp,\n  isArrayHasData: isArrayHasData,\n  isURL: isURL,\n  isCssUrl: isCssUrl,\n  extractCssUrl: extractCssUrl,\n  btoa: btoa,\n  b64toBlob: b64toBlob,\n  computeDegree: computeDegree,\n  emptyImageUrl: emptyImageUrl,\n  equalMapView: equalMapView,\n  flash: flash,\n  _defaults: _defaults,\n  translateToSVGStyles: translateToSVGStyles,\n  getMarkerPathBase64: getMarkerPathBase64,\n  getExternalResources: getExternalResources,\n  convertResourceUrl: convertResourceUrl,\n  isGradient: isGradient,\n  getGradientStamp: getGradientStamp,\n  getSymbolStamp: getSymbolStamp,\n  lowerSymbolOpacity: lowerSymbolOpacity,\n  extendSymbol: extendSymbol\n});\n\nvar Browser = {};\n\nif (!IS_NODE) {\n  var ua = navigator.userAgent.toLowerCase(),\n      doc = document.documentElement,\n      ie = 'ActiveXObject' in window,\n      webkit = ua.indexOf('webkit') !== -1,\n      phantomjs = ua.indexOf('phantom') !== -1,\n      android23 = ua.search('android [23]') !== -1,\n      chrome = ua.indexOf('chrome') !== -1,\n      gecko = ua.indexOf('gecko') !== -1 && !webkit && !window.opera && !ie,\n      mobile = typeof orientation !== 'undefined' || ua.indexOf('mobile') !== -1,\n      msPointer = !window.PointerEvent && window.MSPointerEvent,\n      pointer = window.PointerEvent && navigator.pointerEnabled || msPointer,\n      ie3d = ie && 'transition' in doc.style,\n      webkit3d = 'WebKitCSSMatrix' in window && 'm11' in new window.WebKitCSSMatrix() && !android23,\n      gecko3d = 'MozPerspective' in doc.style,\n      opera12 = 'OTransition' in doc.style,\n      any3d = (ie3d || webkit3d || gecko3d) && !opera12 && !phantomjs;\n  var chromeVersion = 0;\n\n  if (chrome) {\n    chromeVersion = ua.match(/chrome\\/([\\d.]+)/)[1];\n  }\n\n  var touch = !phantomjs && (pointer || 'ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch);\n  var webgl;\n\n  try {\n    var canvas = document.createElement('canvas');\n    var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    webgl = gl && gl instanceof WebGLRenderingContext;\n  } catch (err) {\n    webgl = false;\n  }\n\n  var devicePixelRatio = window.devicePixelRatio || window.screen.deviceXDPI / window.screen.logicalXDPI;\n  Browser = {\n    ie: ie,\n    ielt9: ie && !document.addEventListener,\n    edge: 'msLaunchUri' in navigator && !('documentMode' in document),\n    webkit: webkit,\n    gecko: gecko,\n    android: ua.indexOf('android') !== -1,\n    android23: android23,\n    chrome: chrome,\n    chromeVersion: chromeVersion,\n    safari: !chrome && ua.indexOf('safari') !== -1,\n    phantomjs: phantomjs,\n    ie3d: ie3d,\n    webkit3d: webkit3d,\n    gecko3d: gecko3d,\n    opera12: opera12,\n    any3d: any3d,\n    mobile: mobile,\n    mobileWebkit: mobile && webkit,\n    mobileWebkit3d: mobile && webkit3d,\n    mobileOpera: mobile && window.opera,\n    mobileGecko: mobile && gecko,\n    touch: !!touch,\n    msPointer: !!msPointer,\n    pointer: !!pointer,\n    retina: devicePixelRatio > 1,\n    devicePixelRatio: devicePixelRatio,\n    language: navigator.browserLanguage ? navigator.browserLanguage : navigator.language,\n    ie9: ie && document.documentMode === 9,\n    ie10: ie && document.documentMode === 10,\n    webgl: webgl\n  };\n}\n\nvar Browser$1 = Browser;\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nvar Position = function () {\n  function Position(x, y) {\n    if (!isNil(x) && !isNil(y)) {\n      this.x = +x;\n      this.y = +y;\n    } else if (!isNil(x.x) && !isNil(x.y)) {\n      this.x = +x.x;\n      this.y = +x.y;\n    } else if (Array.isArray(x)) {\n      this.x = +x[0];\n      this.y = +x[1];\n    }\n\n    if (this._isNaN()) {\n      throw new Error('Position is NaN');\n    }\n  }\n\n  var _proto = Position.prototype;\n\n  _proto.set = function set(x, y) {\n    this.x = x;\n    this.y = y;\n    return this;\n  };\n\n  _proto.abs = function abs() {\n    return new this.constructor(Math.abs(this.x), Math.abs(this.y));\n  };\n\n  _proto._abs = function _abs() {\n    this.x = Math.abs(this.x);\n    this.y = Math.abs(this.y);\n    return this;\n  };\n\n  _proto._round = function _round() {\n    this.x = Math.round(this.x);\n    this.y = Math.round(this.y);\n    return this;\n  };\n\n  _proto.round = function round() {\n    return new this.constructor(Math.round(this.x), Math.round(this.y));\n  };\n\n  _proto._ceil = function _ceil() {\n    this.x = Math.ceil(this.x);\n    this.y = Math.ceil(this.y);\n    return this;\n  };\n\n  _proto.ceil = function ceil() {\n    return new this.constructor(Math.ceil(this.x), Math.ceil(this.y));\n  };\n\n  _proto.distanceTo = function distanceTo(point) {\n    var x = point.x - this.x,\n        y = point.y - this.y;\n    return Math.sqrt(x * x + y * y);\n  };\n\n  _proto._floor = function _floor() {\n    this.x = Math.floor(this.x);\n    this.y = Math.floor(this.y);\n    return this;\n  };\n\n  _proto.floor = function floor() {\n    return new this.constructor(Math.floor(this.x), Math.floor(this.y));\n  };\n\n  _proto.copy = function copy() {\n    return new this.constructor(this.x, this.y);\n  };\n\n  _proto._add = function _add(x, y) {\n    if (!isNil(x.x)) {\n      this.x += x.x;\n      this.y += x.y;\n    } else if (!isNil(x[0])) {\n      this.x += x[0];\n      this.y += x[1];\n    } else {\n      this.x += x;\n      this.y += y;\n    }\n\n    return this;\n  };\n\n  _proto.add = function add(x, y) {\n    var nx, ny;\n\n    if (!isNil(x.x)) {\n      nx = this.x + x.x;\n      ny = this.y + x.y;\n    } else if (!isNil(x[0])) {\n      nx = this.x + x[0];\n      ny = this.y + x[1];\n    } else {\n      nx = this.x + x;\n      ny = this.y + y;\n    }\n\n    return new this.constructor(nx, ny);\n  };\n\n  _proto._sub = function _sub(x, y) {\n    if (!isNil(x.x)) {\n      this.x -= x.x;\n      this.y -= x.y;\n    } else if (!isNil(x[0])) {\n      this.x -= x[0];\n      this.y -= x[1];\n    } else {\n      this.x -= x;\n      this.y -= y;\n    }\n\n    return this;\n  };\n\n  _proto._substract = function _substract() {\n    return this._sub.apply(this, arguments);\n  };\n\n  _proto.sub = function sub(x, y) {\n    var nx, ny;\n\n    if (!isNil(x.x)) {\n      nx = this.x - x.x;\n      ny = this.y - x.y;\n    } else if (!isNil(x[0])) {\n      nx = this.x - x[0];\n      ny = this.y - x[1];\n    } else {\n      nx = this.x - x;\n      ny = this.y - y;\n    }\n\n    return new this.constructor(nx, ny);\n  };\n\n  _proto.substract = function substract() {\n    return this.sub.apply(this, arguments);\n  };\n\n  _proto.multi = function multi(ratio) {\n    return new this.constructor(this.x * ratio, this.y * ratio);\n  };\n\n  _proto._multi = function _multi(ratio) {\n    this.x *= ratio;\n    this.y *= ratio;\n    return this;\n  };\n\n  _proto.div = function div(n) {\n    return this.multi(1 / n);\n  };\n\n  _proto._div = function _div(n) {\n    return this._multi(1 / n);\n  };\n\n  _proto.equals = function equals(c) {\n    if (!(c instanceof this.constructor)) {\n      return false;\n    }\n\n    return this.x === c.x && this.y === c.y;\n  };\n\n  _proto._isNaN = function _isNaN() {\n    return isNaN(this.x) || isNaN(this.y);\n  };\n\n  _proto.isZero = function isZero() {\n    return this.x === 0 && this.y === 0;\n  };\n\n  _proto.toArray = function toArray() {\n    return [this.x, this.y];\n  };\n\n  _proto.toFixed = function toFixed(n) {\n    return new this.constructor(this.x.toFixed(n), this.y.toFixed(n));\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      x: this.x,\n      y: this.y\n    };\n  };\n\n  return Position;\n}();\n\nvar Point = function (_Position) {\n  _inheritsLoose(Point, _Position);\n\n  function Point() {\n    return _Position.apply(this, arguments) || this;\n  }\n\n  var _proto = Point.prototype;\n\n  _proto.closeTo = function closeTo(p, delta) {\n    if (!delta) {\n      delta = 0;\n    }\n\n    return this.x >= p.x - delta && this.x <= p.x + delta && this.y >= p.y - delta && this.y <= p.y + delta;\n  };\n\n  _proto.mag = function mag() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  };\n\n  _proto.unit = function unit() {\n    return this.copy()._unit();\n  };\n\n  _proto._unit = function _unit() {\n    this._div(this.mag());\n\n    return this;\n  };\n\n  _proto.perp = function perp() {\n    return this.copy()._perp();\n  };\n\n  _proto._perp = function _perp() {\n    var y = this.y;\n    this.y = this.x;\n    this.x = -y;\n    return this;\n  };\n\n  _proto.angleWith = function angleWith(b) {\n    return this.angleWithSep(b.x, b.y);\n  };\n\n  _proto.angleWithSep = function angleWithSep(x, y) {\n    return Math.atan2(this.x * y - this.y * x, this.x * x + this.y * y);\n  };\n\n  _proto._rotate = function _rotate(angle) {\n    var cos = Math.cos(angle),\n        sin = Math.sin(angle),\n        x = cos * this.x - sin * this.y,\n        y = sin * this.x + cos * this.y;\n    this.x = x;\n    this.y = y;\n    return this;\n  };\n\n  _proto.rotate = function rotate(a) {\n    return this.copy()._rotate(a);\n  };\n\n  return Point;\n}(Position);\n\nvar Size = function () {\n  function Size(width, height) {\n    if (isNumber(width) && isNumber(height)) {\n      this.width = width;\n      this.height = height;\n    } else if (isNumber(width['width'])) {\n      this.width = width.width;\n      this.height = width.height;\n    } else if (Array.isArray(width)) {\n      this.width = width[0];\n      this.height = width[1];\n    }\n  }\n\n  var _proto = Size.prototype;\n\n  _proto.copy = function copy() {\n    return new Size(this['width'], this['height']);\n  };\n\n  _proto.add = function add(x, y) {\n    var w, h;\n\n    if (x instanceof Size) {\n      w = this.width + x.width;\n      h = this.height + x.height;\n    } else {\n      w = this.width + x;\n      h = this.height + y;\n    }\n\n    return new Size(w, h);\n  };\n\n  _proto.equals = function equals(size) {\n    return this['width'] === size['width'] && this['height'] === size['height'];\n  };\n\n  _proto.multi = function multi(ratio) {\n    return new Size(this['width'] * ratio, this['height'] * ratio);\n  };\n\n  _proto._multi = function _multi(ratio) {\n    this['width'] *= ratio;\n    this['height'] *= ratio;\n    return this;\n  };\n\n  _proto._round = function _round() {\n    this['width'] = Math.round(this['width']);\n    this['height'] = Math.round(this['height']);\n    return this;\n  };\n\n  _proto.toPoint = function toPoint() {\n    return new Point(this['width'], this['height']);\n  };\n\n  _proto.toArray = function toArray() {\n    return [this['width'], this['height']];\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'width': this['width'],\n      'height': this['height']\n    };\n  };\n\n  return Size;\n}();\n\nfunction trim(str) {\n  return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\nvar specialPattern = /[\\b\\t\\r\\v\\f]/igm;\nfunction escapeSpecialChars(str) {\n  if (!isString(str)) {\n    return str;\n  }\n\n  return str.replace(specialPattern, '');\n}\nfunction splitWords(chr) {\n  return trim(chr).split(/\\s+/);\n}\nvar rulerCtx = typeof document !== 'undefined' ? document.createElement('canvas').getContext('2d') : null;\nfunction stringWidth(text, font) {\n  if (stringWidth.node) {\n    return stringWidth.node(text, font);\n  }\n\n  rulerCtx.font = font;\n  return rulerCtx.measureText(text).width;\n}\nfunction stringLength(text, font, size) {\n  var w = stringWidth(text, font);\n  return new Size(w, size || DEFAULT_TEXT_SIZE);\n}\nfunction getFontHeight(font) {\n  var domRuler = getDomRuler('span');\n\n  if (font !== '_default_') {\n    domRuler.style.font = font;\n  }\n\n  domRuler.innerHTML = '秦';\n  var h = domRuler.clientHeight;\n  removeDomNode(domRuler);\n  return h;\n}\nfunction splitContent(content, font, wrapWidth, textWidth) {\n  if (!content || content.length === 0) {\n    return [{\n      'text': '',\n      'width': 0\n    }];\n  }\n\n  var width = isNil(textWidth) ? stringWidth(content, font) : textWidth;\n  var chrWidth = width / content.length,\n      minChrCount = Math.floor(wrapWidth / chrWidth / 2);\n\n  if (chrWidth >= wrapWidth || minChrCount <= 0) {\n    return [{\n      'text': '',\n      'width': wrapWidth\n    }];\n  }\n\n  if (width <= wrapWidth) return [{\n    'text': content,\n    'width': width\n  }];\n  var result = [];\n  var testStr = content.substring(0, minChrCount),\n      prew = chrWidth * minChrCount;\n\n  for (var i = minChrCount, l = content.length; i < l; i++) {\n    var chr = content[i];\n    var w = stringWidth(testStr + chr);\n\n    if (w >= wrapWidth) {\n      result.push({\n        'text': testStr,\n        'width': prew\n      });\n      testStr = content.substring(i, minChrCount + i);\n      i += minChrCount - 1;\n      prew = chrWidth * minChrCount;\n    } else {\n      testStr += chr;\n      prew = w;\n    }\n\n    if (i >= l - 1) {\n      prew = stringWidth(testStr);\n      result.push({\n        'text': testStr,\n        'width': prew\n      });\n    }\n  }\n\n  return result;\n}\nvar contentExpRe = /\\{([\\w_]+)\\}/g;\nfunction replaceVariable(str, props) {\n  if (!isString(str)) {\n    return str;\n  }\n\n  return str.replace(contentExpRe, function (str, key) {\n    if (!props) {\n      return '';\n    }\n\n    var value = props[key];\n\n    if (isNil(value)) {\n      return '';\n    } else if (Array.isArray(value)) {\n      return value.join();\n    }\n\n    return value;\n  });\n}\nfunction getAlignPoint(size, horizontalAlignment, verticalAlignment) {\n  var width = size['width'],\n      height = size['height'];\n  var alignW, alignH;\n\n  if (horizontalAlignment === 'left') {\n    alignW = -width;\n  } else if (horizontalAlignment === 'right') {\n    alignW = 0;\n  } else {\n    alignW = -width / 2;\n  }\n\n  if (verticalAlignment === 'top') {\n    alignH = -height;\n  } else if (verticalAlignment === 'bottom') {\n    alignH = 0;\n  } else {\n    alignH = -height / 2;\n  }\n\n  return new Point(alignW, alignH);\n}\nvar DEFAULT_FONT = 'monospace';\nfunction getFont(style) {\n  if (style['textFont']) {\n    return style['textFont'];\n  } else {\n    return (style['textStyle'] && style['textStyle'] !== 'normal' ? style['textStyle'] + ' ' : '') + (style['textWeight'] && style['textWeight'] !== 'normal' ? style['textWeight'] + ' ' : '') + style['textSize'] + 'px ' + (!style['textFaceName'] ? DEFAULT_FONT : style['textFaceName'][0] === '\"' ? style['textFaceName'] : '\"' + style['textFaceName'] + '\"');\n  }\n}\nfunction splitTextToRow(text, style) {\n  var font = getFont(style),\n      lineSpacing = style['textLineSpacing'] || 0,\n      size = stringLength(text, font, style['textSize']),\n      textWidth = size['width'],\n      textHeight = size['height'],\n      wrapChar = style['textWrapCharacter'],\n      textRows = [];\n  var wrapWidth = style['textWrapWidth'];\n\n  if (!wrapWidth || wrapWidth > textWidth) {\n    wrapWidth = textWidth;\n  }\n\n  if (!isString(text)) {\n    text += '';\n  }\n\n  var actualWidth = 0;\n\n  if (wrapChar && text.indexOf(wrapChar) >= 0) {\n    var texts = text.split(wrapChar);\n\n    for (var i = 0, l = texts.length; i < l; i++) {\n      var t = texts[i];\n      var tWidth = stringWidth(t, font);\n\n      if (tWidth > wrapWidth) {\n        var contents = splitContent(t, font, wrapWidth, tWidth);\n\n        for (var ii = 0, ll = contents.length; ii < ll; ii++) {\n          var w = contents[ii].width;\n\n          if (w > actualWidth) {\n            actualWidth = w;\n          }\n\n          textRows.push({\n            'text': contents[ii].text,\n            'size': new Size(w, textHeight)\n          });\n        }\n      } else {\n        if (tWidth > actualWidth) {\n          actualWidth = tWidth;\n        }\n\n        textRows.push({\n          'text': t,\n          'size': new Size(tWidth, textHeight)\n        });\n      }\n    }\n  } else if (textWidth > wrapWidth) {\n    var _contents = splitContent(text, font, wrapWidth, textWidth);\n\n    for (var _i = 0; _i < _contents.length; _i++) {\n      var _w = _contents[_i].width;\n\n      if (_w > actualWidth) {\n        actualWidth = _w;\n      }\n\n      textRows.push({\n        'text': _contents[_i].text,\n        'size': new Size(_w, textHeight)\n      });\n    }\n  } else {\n    if (textWidth > actualWidth) {\n      actualWidth = textWidth;\n    }\n\n    textRows.push({\n      'text': text,\n      'size': size\n    });\n  }\n\n  var rowNum = textRows.length;\n  var textSize = new Size(actualWidth, textHeight * rowNum + lineSpacing * (rowNum - 1));\n  return {\n    'total': rowNum,\n    'size': textSize,\n    'rows': textRows,\n    'rawSize': size\n  };\n}\n\nvar strings = /*#__PURE__*/Object.freeze({\n  trim: trim,\n  escapeSpecialChars: escapeSpecialChars,\n  splitWords: splitWords,\n  stringWidth: stringWidth,\n  stringLength: stringLength,\n  getFontHeight: getFontHeight,\n  splitContent: splitContent,\n  replaceVariable: replaceVariable,\n  getAlignPoint: getAlignPoint,\n  getFont: getFont,\n  splitTextToRow: splitTextToRow\n});\n\nvar first = function first(props) {\n  return props[0];\n};\n\nvar testProp = IS_NODE ? first : function (props) {\n  var style = document.documentElement.style;\n\n  for (var i = 0; i < props.length; i++) {\n    if (props[i] in style) {\n      return props[i];\n    }\n  }\n\n  return false;\n};\nvar TRANSFORM = testProp(['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\nvar TRANSFORMORIGIN = testProp(['transformOrigin', 'WebkitTransformOrigin', 'OTransformOrigin', 'MozTransformOrigin', 'msTransformOrigin']);\nvar TRANSITION = testProp(['transition', 'WebkitTransition', 'OTransition', 'MozTransition', 'msTransition']);\nvar CSSFILTER = testProp(['filter', 'WebkitFilter', 'OFilter', 'MozFilter', 'msFilter']);\nfunction createEl(tagName, className) {\n  var el = document.createElement(tagName);\n\n  if (className) {\n    setClass(el, className);\n  }\n\n  return el;\n}\nfunction createElOn(tagName, style, container) {\n  var el = createEl(tagName);\n\n  if (style) {\n    setStyle(el, style);\n  }\n\n  if (container) {\n    container.appendChild(el);\n  }\n\n  return el;\n}\nfunction removeDomNode(node) {\n  if (!node) {\n    return this;\n  }\n\n  if (Browser$1.ielt9 || Browser$1.ie9) {\n    var d = createEl('div');\n    d.appendChild(node);\n    d.innerHTML = '';\n    d = null;\n  } else if (node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return this;\n}\nfunction addDomEvent(obj, typeArr, handler, context) {\n  if (!obj || !obj.addEventListener || !typeArr || !handler) {\n    return this;\n  }\n\n  var eventHandler = function eventHandler(e) {\n    if (!e) {\n      e = window.event;\n    }\n\n    handler.call(context || obj, e);\n    return;\n  };\n\n  var types = typeArr.split(' ');\n\n  for (var i = types.length - 1; i >= 0; i--) {\n    var type = types[i];\n\n    if (!type) {\n      continue;\n    }\n\n    if (!obj['Z__' + type]) {\n      obj['Z__' + type] = [];\n    }\n\n    var hit = listensDomEvent(obj, type, handler);\n\n    if (hit >= 0) {\n      removeDomEvent(obj, type, handler);\n    }\n\n    obj['Z__' + type].push({\n      callback: eventHandler,\n      src: handler\n    });\n\n    if (Browser$1.ie) {\n      obj.addEventListener(type, eventHandler, false);\n    } else {\n      obj.addEventListener(type, eventHandler, {\n        capture: false,\n        passive: false\n      });\n    }\n  }\n\n  return this;\n}\nfunction removeDomEvent(obj, typeArr, handler) {\n  function doRemove(type, callback) {\n    if (type === 'mousewheel' && Browser$1.gecko) {\n      type = 'DOMMouseScroll';\n    }\n\n    obj.removeEventListener(type, callback, false);\n  }\n\n  if (!obj || !obj.removeEventListener || !typeArr) {\n    return this;\n  }\n\n  var types = typeArr.split(' ');\n\n  for (var i = types.length - 1; i >= 0; i--) {\n    var type = types[i];\n\n    if (!type) {\n      continue;\n    }\n\n    if (!handler && obj['Z__' + type]) {\n      var handlers = obj['Z__' + type];\n\n      for (var j = 0, jlen = handlers.length; j < jlen; j++) {\n        doRemove(handlers[j].callback);\n      }\n\n      delete obj['Z__' + type];\n      return this;\n    }\n\n    var hit = listensDomEvent(obj, type, handler);\n\n    if (hit < 0) {\n      return this;\n    }\n\n    var hitHandler = obj['Z__' + type][hit];\n    doRemove(type, hitHandler.callback);\n    obj['Z__' + type].splice(hit, 1);\n  }\n\n  return this;\n}\nfunction listensDomEvent(obj, type, handler) {\n  if (!obj || !obj['Z__' + type] || !handler) {\n    return -1;\n  }\n\n  var handlers = obj['Z__' + type];\n\n  for (var i = 0, len = handlers.length; i < len; i++) {\n    if (handlers[i].src === handler) {\n      return i;\n    }\n  }\n\n  return -1;\n}\nfunction preventDefault(event) {\n  if (event.preventDefault) {\n    event.preventDefault();\n  } else {\n    event.returnValue = false;\n  }\n\n  return this;\n}\nfunction stopPropagation(e) {\n  if (e.stopPropagation) {\n    e.stopPropagation();\n  } else {\n    e.cancelBubble = true;\n  }\n\n  return this;\n}\nfunction preventSelection(dom) {\n  dom.onselectstart = function () {\n    return false;\n  };\n\n  dom.ondragstart = function () {\n    return false;\n  };\n\n  dom.setAttribute('unselectable', 'on');\n  return this;\n}\nfunction offsetDom(dom, offset) {\n  if (!dom) {\n    return null;\n  }\n\n  if (Browser$1.any3d) {\n    setTransform(dom, offset);\n  } else {\n    dom.style.left = offset.x + 'px';\n    dom.style.top = offset.y + 'px';\n  }\n\n  return offset;\n}\nfunction computeDomPosition(dom) {\n  var style = window.getComputedStyle(dom);\n  var padding = [parseInt(style['padding-left']), parseInt(style['padding-top'])];\n  var rect = dom.getBoundingClientRect();\n  var offsetWidth = dom.offsetWidth,\n      offsetHeight = dom.offsetHeight;\n  var scaleX = offsetWidth ? rect.width / offsetWidth : 1,\n      scaleY = offsetHeight ? rect.height / offsetHeight : 1;\n  dom.__position = [rect.left + padding[0], rect.top + padding[1], scaleX, scaleY];\n  return dom.__position;\n}\nfunction getEventContainerPoint(ev, dom) {\n  if (!ev) {\n    ev = window.event;\n  }\n\n  var domPos = dom.__position;\n\n  if (!domPos) {\n    domPos = computeDomPosition(dom);\n  }\n\n  return new Point((ev.clientX - domPos[0] - dom.clientLeft) / domPos[2], (ev.clientY - domPos[1] - dom.clientTop) / domPos[3]);\n}\n\nfunction endsWith(str, suffix) {\n  var l = str.length - suffix.length;\n  return l >= 0 && str.indexOf(suffix, l) === l;\n}\n\nfunction setStyle(dom, strCss) {\n  var cssText = dom.style.cssText;\n\n  if (!endsWith(cssText, ';')) {\n    cssText += ';';\n  }\n\n  dom.style.cssText = cssText + strCss;\n  return this;\n}\nfunction hasClass(el, name) {\n  if (el.classList !== undefined) {\n    return el.classList.contains(name);\n  }\n\n  var className = getClass(el);\n  return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\nfunction addClass(el, name) {\n  if (el.classList !== undefined && !hasClass(el, name)) {\n    var classes = splitWords(name);\n\n    for (var i = 0, len = classes.length; i < len; i++) {\n      el.classList.add(classes[i]);\n    }\n  } else {\n    var className = getClass(el);\n    setClass(el, (className ? className + ' ' : '') + name);\n  }\n\n  return this;\n}\nfunction setClass(el, name) {\n  if (isNil(el.className.baseVal)) {\n    el.className = name;\n  } else {\n    el.className.baseVal = name;\n  }\n\n  return this;\n}\nfunction getClass(el) {\n  return isNil(el.className.baseVal) ? el.className : el.className.baseVal;\n}\nfunction setOpacity(el, value) {\n  el.style.opacity = value;\n  return this;\n}\nfunction setTransform(el, offset) {\n  var pos = offset || new Point(0, 0);\n  el.style[TRANSFORM] = Browser$1.any3d ? 'translate3d(' + pos.x + 'px,' + pos.y + 'px,0px)' : 'translate(' + pos.x + 'px,' + pos.y + 'px)';\n  return this;\n}\nfunction setTransformMatrix(el, m) {\n  var text = 'matrix(' + (isString(m) ? m : m.join()) + ')';\n\n  if (el.style[TRANSFORM] !== text) {\n    el.style[TRANSFORM] = text;\n  }\n\n  return this;\n}\nfunction removeTransform(el) {\n  if (el.style[TRANSFORM]) {\n    el.style[TRANSFORM] = '';\n  }\n\n  return this;\n}\nfunction isHTML(str) {\n  return /<[a-z\\][\\s\\S]*>/i.test(str);\n}\nfunction measureDom(parentTag, dom) {\n  var ruler = getDomRuler(parentTag);\n\n  if (isString(dom)) {\n    ruler.innerHTML = dom;\n  } else {\n    ruler.appendChild(dom);\n  }\n\n  var result = new Size(ruler.clientWidth, ruler.clientHeight);\n  removeDomNode(ruler);\n  return result;\n}\nfunction getDomRuler(tag) {\n  var span = document.createElement(tag);\n  span.style.cssText = 'position:absolute;left:-10000px;top:-10000px;';\n  document.body.appendChild(span);\n  return span;\n}\nvar on = addDomEvent;\nvar off = removeDomEvent;\n\nvar dom = /*#__PURE__*/Object.freeze({\n  TRANSFORM: TRANSFORM,\n  TRANSFORMORIGIN: TRANSFORMORIGIN,\n  TRANSITION: TRANSITION,\n  CSSFILTER: CSSFILTER,\n  createEl: createEl,\n  createElOn: createElOn,\n  removeDomNode: removeDomNode,\n  addDomEvent: addDomEvent,\n  removeDomEvent: removeDomEvent,\n  listensDomEvent: listensDomEvent,\n  preventDefault: preventDefault,\n  stopPropagation: stopPropagation,\n  preventSelection: preventSelection,\n  offsetDom: offsetDom,\n  computeDomPosition: computeDomPosition,\n  getEventContainerPoint: getEventContainerPoint,\n  setStyle: setStyle,\n  hasClass: hasClass,\n  addClass: addClass,\n  setClass: setClass,\n  getClass: getClass,\n  setOpacity: setOpacity,\n  setTransform: setTransform,\n  setTransformMatrix: setTransformMatrix,\n  removeTransform: removeTransform,\n  isHTML: isHTML,\n  measureDom: measureDom,\n  getDomRuler: getDomRuler,\n  on: on,\n  off: off\n});\n\nvar Ajax = {\n  jsonp: function jsonp(url, callback) {\n    var name = '_maptalks_jsonp_' + UID();\n    if (url.match(/\\?/)) url += '&callback=' + name;else url += '?callback=' + name;\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = url;\n\n    window[name] = function (data) {\n      callback(null, data);\n      document.getElementsByTagName('head')[0].removeChild(script);\n      script = null;\n      delete window[name];\n    };\n\n    document.getElementsByTagName('head')[0].appendChild(script);\n    return this;\n  },\n  get: function get(url, options, cb) {\n    if (isFunction(options)) {\n      var t = cb;\n      cb = options;\n      options = t;\n    }\n\n    if (IS_NODE && Ajax.get.node) {\n      return Ajax.get.node(url, cb, options);\n    }\n\n    var client = Ajax._getClient(cb);\n\n    client.open('GET', url, true);\n\n    if (options) {\n      for (var k in options.headers) {\n        client.setRequestHeader(k, options.headers[k]);\n      }\n\n      client.withCredentials = options.credentials === 'include';\n\n      if (options['responseType']) {\n        client.responseType = options['responseType'];\n      }\n    }\n\n    client.send(null);\n    return client;\n  },\n  post: function post(url, options, cb) {\n    var postData;\n\n    if (!isString(url)) {\n      var t = cb;\n      postData = options;\n      options = url;\n      url = options.url;\n      cb = t;\n    } else {\n      if (isFunction(options)) {\n        var _t = cb;\n        cb = options;\n        options = _t;\n      }\n\n      options = options || {};\n      postData = options.postData;\n    }\n\n    if (IS_NODE && Ajax.post.node) {\n      options.url = url;\n      return Ajax.post.node(options, postData, cb);\n    }\n\n    var client = Ajax._getClient(cb);\n\n    client.open('POST', options.url, true);\n\n    if (!options.headers) {\n      options.headers = {};\n    }\n\n    if (!options.headers['Content-Type']) {\n      options.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n    }\n\n    if ('setRequestHeader' in client) {\n      for (var p in options.headers) {\n        if (options.headers.hasOwnProperty(p)) {\n          client.setRequestHeader(p, options.headers[p]);\n        }\n      }\n    }\n\n    if (!isString(postData)) {\n      postData = JSON.stringify(postData);\n    }\n\n    client.send(postData);\n    return client;\n  },\n  _wrapCallback: function _wrapCallback(client, cb) {\n    return function () {\n      if (client.readyState === 4) {\n        if (client.status === 200) {\n          if (client.responseType === 'arraybuffer') {\n            var response = client.response;\n\n            if (response.byteLength === 0) {\n              cb(new Error('http status 200 returned without content.'));\n            } else {\n              cb(null, {\n                data: client.response,\n                cacheControl: client.getResponseHeader('Cache-Control'),\n                expires: client.getResponseHeader('Expires'),\n                contentType: client.getResponseHeader('Content-Type')\n              });\n            }\n          } else {\n            cb(null, client.responseText);\n          }\n        } else {\n          cb(new Error(client.statusText + ',' + client.status));\n        }\n      }\n    };\n  },\n  _getClient: function _getClient(cb) {\n    var client;\n\n    try {\n      client = new XMLHttpRequest();\n    } catch (e) {\n      try {\n        client = new ActiveXObject('Msxml2.XMLHTTP');\n      } catch (e) {\n        try {\n          client = new ActiveXObject('Microsoft.XMLHTTP');\n        } catch (e) {}\n      }\n    }\n\n    client.onreadystatechange = Ajax._wrapCallback(client, cb);\n    return client;\n  },\n  getArrayBuffer: function getArrayBuffer(url, options, cb) {\n    if (isFunction(options)) {\n      var t = cb;\n      cb = options;\n      options = t;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    options['responseType'] = 'arraybuffer';\n    return Ajax.get(url, options, cb);\n  },\n  getImage: function getImage(img, url, options) {\n    return Ajax.getArrayBuffer(url, options, function (err, imgData) {\n      if (err) {\n        if (img.onerror) {\n          img.onerror(err);\n        }\n      } else if (imgData) {\n        var URL = window.URL || window.webkitURL;\n        var onload = img.onload;\n\n        img.onload = function () {\n          if (onload) {\n            onload();\n          }\n\n          URL.revokeObjectURL(img.src);\n        };\n\n        var blob = new Blob([new Uint8Array(imgData.data)], {\n          type: imgData.contentType\n        });\n        img.cacheControl = imgData.cacheControl;\n        img.expires = imgData.expires;\n        img.src = imgData.data.byteLength ? URL.createObjectURL(blob) : emptyImageUrl;\n      }\n    });\n  }\n};\n\nAjax.getJSON = function (url, options, cb) {\n  if (isFunction(options)) {\n    var t = cb;\n    cb = options;\n    options = t;\n  }\n\n  var callback = function callback(err, resp) {\n    var data = resp ? parseJSON(resp) : null;\n    cb(err, data);\n  };\n\n  if (options && options['jsonp']) {\n    return Ajax.jsonp(url, callback);\n  }\n\n  return Ajax.get(url, options, callback);\n};\n\nvar DEFAULT_STROKE_COLOR = '#000';\nvar DEFAULT_FILL_COLOR = 'rgba(255,255,255,0)';\nvar DEFAULT_TEXT_COLOR = '#000';\nvar hitTesting = false;\nvar TEMP_CANVAS = null;\nvar RADIAN = Math.PI / 180;\nvar textOffsetY = 1;\nvar Canvas = {\n  setHitTesting: function setHitTesting(testing) {\n    hitTesting = testing;\n  },\n  createCanvas: function createCanvas(width, height, canvasClass) {\n    var canvas;\n\n    if (!IS_NODE) {\n      canvas = createEl('canvas');\n      canvas.width = width;\n      canvas.height = height;\n    } else {\n      canvas = new canvasClass(width, height);\n    }\n\n    return canvas;\n  },\n  prepareCanvasFont: function prepareCanvasFont(ctx, style) {\n    ctx.textBaseline = 'top';\n    ctx.font = getFont(style);\n    var fill = style['textFill'];\n\n    if (!fill) {\n      fill = DEFAULT_TEXT_COLOR;\n    }\n\n    ctx.fillStyle = Canvas.getRgba(fill, style['textOpacity']);\n  },\n  prepareCanvas: function prepareCanvas(ctx, style, resources, testing) {\n    if (!style) {\n      return;\n    }\n\n    var strokeWidth = style['lineWidth'];\n\n    if (!isNil(strokeWidth) && ctx.lineWidth !== strokeWidth) {\n      ctx.lineWidth = strokeWidth;\n    }\n\n    var strokePattern = style['linePatternFile'];\n    var strokeColor = style['lineColor'] || DEFAULT_STROKE_COLOR;\n\n    if (testing) {\n      ctx.strokeStyle = '#000';\n    } else if (strokePattern && resources) {\n      var patternOffset;\n\n      if (style['linePatternDx'] || style['linePatternDy']) {\n        patternOffset = [style['linePatternDx'], style['linePatternDy']];\n      }\n\n      Canvas._setStrokePattern(ctx, strokePattern, strokeWidth, patternOffset, resources);\n\n      style['lineDasharray'] = [];\n    } else if (isGradient(strokeColor)) {\n      if (style['lineGradientExtent']) {\n        ctx.strokeStyle = Canvas._createGradient(ctx, strokeColor, style['lineGradientExtent']);\n      } else {\n        ctx.strokeStyle = DEFAULT_STROKE_COLOR;\n      }\n    } else {\n        ctx.strokeStyle = strokeColor;\n      }\n\n    if (style['lineJoin']) {\n      ctx.lineJoin = style['lineJoin'];\n    }\n\n    if (style['lineCap']) {\n      ctx.lineCap = style['lineCap'];\n    }\n\n    if (ctx.setLineDash && isArrayHasData(style['lineDasharray'])) {\n      ctx.setLineDash(style['lineDasharray']);\n    }\n\n    var polygonPattern = style['polygonPatternFile'];\n    var fill = style['polygonFill'] || DEFAULT_FILL_COLOR;\n\n    if (testing) {\n      ctx.fillStyle = '#000';\n    } else if (polygonPattern && resources) {\n      var fillImgUrl = extractImageUrl(polygonPattern);\n      var fillTexture = resources.getImage([fillImgUrl, null, null]);\n\n      if (!fillTexture) {\n        fillTexture = resources.getImage([fillImgUrl + '-texture', null, strokeWidth]);\n      }\n\n      if (isSVG(fillImgUrl) && fillTexture instanceof Image && (Browser$1.edge || Browser$1.ie)) {\n        var w = fillTexture.width || 20,\n            h = fillTexture.height || 20;\n        var canvas = Canvas.createCanvas(w, h);\n        Canvas.image(canvas.getContext('2d'), fillTexture, 0, 0, w, h);\n        fillTexture = canvas;\n      }\n\n      if (!fillTexture) {\n        if (typeof console !== 'undefined') {\n          console.warn('img not found for', fillImgUrl);\n        }\n      } else {\n        ctx.fillStyle = ctx.createPattern(fillTexture, 'repeat');\n\n        if (style['polygonPatternDx'] || style['polygonPatternDy']) {\n          ctx.fillStyle['polygonPatternOffset'] = [style['polygonPatternDx'], style['polygonPatternDy']];\n        }\n      }\n    } else if (isGradient(fill)) {\n      if (style['polygonGradientExtent']) {\n        ctx.fillStyle = Canvas._createGradient(ctx, fill, style['polygonGradientExtent']);\n      } else {\n        ctx.fillStyle = 'rgba(255,255,255,0)';\n      }\n    } else {\n        ctx.fillStyle = fill;\n      }\n  },\n  _createGradient: function _createGradient(ctx, g, extent) {\n    var gradient = null,\n        places = g['places'];\n    var min = extent.getMin(),\n        max = extent.getMax(),\n        width = extent.getWidth(),\n        height = extent.getHeight();\n\n    if (!g['type'] || g['type'] === 'linear') {\n      if (!places) {\n        places = [min.x, min.y, max.x, min.y];\n      } else {\n        if (places.length !== 4) {\n          throw new Error('A linear gradient\\'s places should have 4 numbers.');\n        }\n\n        places = [min.x + places[0] * width, min.y + places[1] * height, min.x + places[2] * width, min.y + places[3] * height];\n      }\n\n      gradient = ctx.createLinearGradient.apply(ctx, places);\n    } else if (g['type'] === 'radial') {\n      if (!places) {\n        var c = extent.getCenter()._round();\n\n        places = [c.x, c.y, Math.abs(c.x - min.x), c.x, c.y, 0];\n      } else {\n        if (places.length !== 6) {\n          throw new Error('A radial gradient\\'s places should have 6 numbers.');\n        }\n\n        places = [min.x + places[0] * width, min.y + places[1] * height, width * places[2], min.x + places[3] * width, min.y + places[4] * height, width * places[5]];\n      }\n\n      gradient = ctx.createRadialGradient.apply(ctx, places);\n    }\n\n    g['colorStops'].forEach(function (stop) {\n      gradient.addColorStop.apply(gradient, stop);\n    });\n    return gradient;\n  },\n  _setStrokePattern: function _setStrokePattern(ctx, strokePattern, strokeWidth, linePatternOffset, resources) {\n    var imgUrl = extractImageUrl(strokePattern);\n    var imageTexture;\n\n    if (IS_NODE) {\n      imageTexture = resources.getImage([imgUrl, null, strokeWidth]);\n    } else {\n      var key = imgUrl + '-texture-' + strokeWidth;\n      imageTexture = resources.getImage(key);\n\n      if (!imageTexture) {\n        var imageRes = resources.getImage([imgUrl, null, null]);\n\n        if (imageRes) {\n          var w;\n\n          if (!imageRes.width || !imageRes.height) {\n            w = strokeWidth;\n          } else {\n            w = Math.round(imageRes.width * strokeWidth / imageRes.height);\n          }\n\n          var patternCanvas = Canvas.createCanvas(w, strokeWidth, ctx.canvas.constructor);\n          Canvas.image(patternCanvas.getContext('2d'), imageRes, 0, 0, w, strokeWidth);\n          resources.addResource([key, null, strokeWidth], patternCanvas);\n          imageTexture = patternCanvas;\n        }\n      }\n    }\n\n    if (imageTexture) {\n      ctx.strokeStyle = ctx.createPattern(imageTexture, 'repeat');\n      ctx.strokeStyle['linePatternOffset'] = linePatternOffset;\n    } else if (typeof console !== 'undefined') {\n      console.warn('img not found for', imgUrl);\n    }\n  },\n  clearRect: function clearRect(ctx, x1, y1, x2, y2) {\n    ctx.canvas._drawn = false;\n    ctx.clearRect(x1, y1, x2, y2);\n  },\n  fillCanvas: function fillCanvas(ctx, fillOpacity, x, y) {\n    if (hitTesting) {\n      fillOpacity = 1;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (fillOpacity === 0) {\n      return;\n    }\n\n    var isPattern = Canvas._isPattern(ctx.fillStyle);\n\n    var offset = ctx.fillStyle && ctx.fillStyle['polygonPatternOffset'];\n    var dx = offset ? offset[0] : 0,\n        dy = offset ? offset[1] : 0;\n\n    if (isNil(fillOpacity)) {\n      fillOpacity = 1;\n    }\n\n    var alpha;\n\n    if (fillOpacity < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= fillOpacity;\n    }\n\n    if (isPattern) {\n      x = x || 0;\n      y = y || 0;\n      ctx.translate(x + dx, y + dy);\n    }\n\n    ctx.fill();\n\n    if (isPattern) {\n      ctx.translate(-x - dx, -y - dy);\n    }\n\n    if (fillOpacity < 1) {\n      ctx.globalAlpha = alpha;\n    }\n  },\n  getRgba: function getRgba(color, op) {\n    if (isNil(op)) {\n      op = 1;\n    }\n\n    if (color[0] !== '#') {\n      return color;\n    }\n\n    var r, g, b;\n\n    if (color.length === 7) {\n      r = parseInt(color.substring(1, 3), 16);\n      g = parseInt(color.substring(3, 5), 16);\n      b = parseInt(color.substring(5, 7), 16);\n    } else {\n      r = parseInt(color.substring(1, 2), 16) * 17;\n      g = parseInt(color.substring(2, 3), 16) * 17;\n      b = parseInt(color.substring(3, 4), 16) * 17;\n    }\n\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + op + ')';\n  },\n  image: function image(ctx, img, x, y, width, height) {\n    ctx.canvas._drawn = true;\n\n    try {\n      if (isNumber(width) && isNumber(height)) {\n        ctx.drawImage(img, x, y, width, height);\n      } else {\n        ctx.drawImage(img, x, y);\n      }\n    } catch (error) {\n      if (console) {\n        console.warn('error when drawing image on canvas:', error);\n        console.warn(img);\n      }\n    }\n  },\n  text: function text(ctx, _text, pt, style, textDesc) {\n    Canvas._textOnMultiRow(ctx, textDesc['rows'], style, pt, textDesc['size'], textDesc['rawSize']);\n  },\n  _textOnMultiRow: function _textOnMultiRow(ctx, texts, style, point, splitTextSize, textSize) {\n    var ptAlign = getAlignPoint(splitTextSize, style['textHorizontalAlignment'], style['textVerticalAlignment']),\n        lineHeight = textSize['height'] + style['textLineSpacing'],\n        basePoint = point.add(0, ptAlign.y),\n        maxHeight = style['textMaxHeight'];\n    var text,\n        rowAlign,\n        height = 0;\n\n    for (var i = 0, len = texts.length; i < len; i++) {\n      text = texts[i]['text'];\n      rowAlign = getAlignPoint(texts[i]['size'], style['textHorizontalAlignment'], style['textVerticalAlignment']);\n\n      Canvas._textOnLine(ctx, text, basePoint.add(rowAlign.x, i * lineHeight), style['textHaloRadius'], style['textHaloFill'], style['textHaloOpacity']);\n\n      if (maxHeight > 0) {\n        height += lineHeight;\n\n        if (height + textSize['height'] >= maxHeight) {\n          break;\n        }\n      }\n    }\n  },\n  _textOnLine: function _textOnLine(ctx, text, pt, textHaloRadius, textHaloFill, textHaloAlpha) {\n    if (hitTesting) {\n      textHaloAlpha = 1;\n    }\n\n    var drawHalo = textHaloAlpha !== 0 && textHaloRadius !== 0;\n    ctx.textBaseline = 'top';\n    var gco, fill;\n    var shadowBlur = ctx.shadowBlur,\n        shadowOffsetX = ctx.shadowOffsetX,\n        shadowOffsetY = ctx.shadowOffsetY;\n\n    if (drawHalo) {\n      var alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= textHaloAlpha;\n      ctx.miterLimit = 2;\n      ctx.lineJoin = 'round';\n      ctx.lineCap = 'round';\n      ctx.lineWidth = textHaloRadius * 2;\n      ctx.strokeStyle = textHaloFill;\n      ctx.strokeText(text, Math.round(pt.x), Math.round(pt.y + textOffsetY));\n      ctx.miterLimit = 10;\n      ctx.globalAlpha = alpha;\n      gco = ctx.globalCompositeOperation;\n      ctx.globalCompositeOperation = 'destination-out';\n      fill = ctx.fillStyle;\n      ctx.fillStyle = '#000';\n    }\n\n    if (shadowBlur && drawHalo) {\n      ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n    }\n\n    Canvas.fillText(ctx, text, pt);\n\n    if (gco) {\n      ctx.globalCompositeOperation = gco;\n      Canvas.fillText(ctx, text, pt, fill);\n\n      if (shadowBlur) {\n        ctx.shadowBlur = shadowBlur;\n        ctx.shadowOffsetX = shadowOffsetX;\n        ctx.shadowOffsetY = shadowOffsetY;\n      }\n    }\n  },\n  fillText: function fillText(ctx, text, pt, rgba) {\n    ctx.canvas._drawn = true;\n\n    if (rgba) {\n      ctx.fillStyle = rgba;\n    }\n\n    ctx.fillText(text, Math.round(pt.x), Math.round(pt.y + textOffsetY));\n  },\n  _stroke: function _stroke(ctx, strokeOpacity, x, y) {\n    if (hitTesting) {\n      strokeOpacity = 1;\n    }\n\n    ctx.canvas._drawn = true;\n\n    if (strokeOpacity === 0) {\n      return;\n    }\n\n    var offset = ctx.strokeStyle && ctx.strokeStyle['linePatternOffset'];\n    var dx = offset ? offset[0] : 0,\n        dy = offset ? offset[1] : 0;\n    var isPattern = Canvas._isPattern(ctx.strokeStyle) && (!isNil(x) && !isNil(y) || !isNil(dx) && !isNil(dy));\n\n    if (isNil(strokeOpacity)) {\n      strokeOpacity = 1;\n    }\n\n    var alpha;\n\n    if (strokeOpacity < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= strokeOpacity;\n    }\n\n    if (isPattern) {\n      x = x || 0;\n      y = y || 0;\n      ctx.translate(x + dx, y + dy);\n    }\n\n    ctx.stroke();\n\n    if (isPattern) {\n      ctx.translate(-x - dx, -y - dy);\n    }\n\n    if (strokeOpacity < 1) {\n      ctx.globalAlpha = alpha;\n    }\n  },\n  _path: function _path(ctx, points, lineDashArray, lineOpacity, ignoreStrokePattern) {\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    function fillWithPattern(p1, p2) {\n      var degree = computeDegree(p1.x, p1.y, p2.x, p2.y);\n      ctx.save();\n      var cosd = Math.cos(degree);\n\n      if (Math.abs(cosd) < 1E-7) {\n        ctx.translate(p1.x - ctx.lineWidth / 2, p1.y);\n      } else {\n        ctx.translate(p1.x, p1.y - ctx.lineWidth / 2 / cosd);\n      }\n\n      ctx.rotate(degree);\n\n      Canvas._stroke(ctx, lineOpacity);\n\n      ctx.restore();\n    }\n\n    var isDashed = isArrayHasData(lineDashArray);\n    var isPatternLine = ignoreStrokePattern === true ? false : Canvas._isPattern(ctx.strokeStyle);\n    var point, prePoint, nextPoint;\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      point = points[i];\n\n      if (!isDashed || ctx.setLineDash) {\n        ctx.lineTo(point.x, point.y);\n\n        if (isPatternLine && i > 0) {\n          prePoint = points[i - 1];\n          fillWithPattern(prePoint, point);\n          ctx.beginPath();\n          ctx.moveTo(point.x, point.y);\n        }\n      } else if (isDashed) {\n        if (i === len - 1) {\n          break;\n        }\n\n        nextPoint = points[i + 1];\n        drawDashLine(ctx, point, nextPoint, lineDashArray, isPatternLine);\n      }\n    }\n  },\n  path: function path(ctx, points, lineOpacity, fillOpacity, lineDashArray) {\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    Canvas._path(ctx, points, lineDashArray, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _multiClip: function _multiClip(ctx, points) {\n    if (!points || points.length === 0) return;\n    points = points[0];\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      var point = points[i];\n      var x = point.x,\n          y = point.y;\n\n      if (i === 0) {\n        ctx.moveTo(x, y);\n      } else {\n        ctx.lineTo(x, y);\n      }\n\n      if (i === len - 1) {\n        x = points[0].x;\n        y = points[0].y;\n        ctx.lineTo(x, y);\n      }\n    }\n  },\n  polygon: function polygon(ctx, points, lineOpacity, fillOpacity, lineDashArray, smoothness) {\n    if (ctx.isMultiClip) {\n      Canvas._multiClip(ctx, points);\n\n      return;\n    }\n\n    if (!isArrayHasData(points)) {\n      return;\n    }\n\n    var isPatternLine = Canvas._isPattern(ctx.strokeStyle),\n        fillFirst = isArrayHasData(lineDashArray) && !ctx.setLineDash || isPatternLine && !smoothness;\n\n    if (!isArrayHasData(points[0])) {\n      points = [points];\n    }\n\n    var savedCtx = ctx;\n\n    if (points.length > 1 && !IS_NODE) {\n      if (!TEMP_CANVAS) {\n        TEMP_CANVAS = Canvas.createCanvas(1, 1);\n      }\n\n      ctx.canvas._drawn = false;\n      TEMP_CANVAS.width = ctx.canvas.width;\n      TEMP_CANVAS.height = ctx.canvas.height;\n      ctx = TEMP_CANVAS.getContext('2d');\n      copyProperties(ctx, savedCtx);\n    }\n\n    var op, i, len;\n\n    if (fillFirst) {\n      ctx.save();\n\n      for (i = 0, len = points.length; i < len; i++) {\n        if (!isArrayHasData(points[i])) {\n          continue;\n        }\n\n        Canvas._ring(ctx, points[i], null, 0, true);\n\n        op = fillOpacity;\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'destination-out';\n          op = 1;\n        }\n\n        Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'source-over';\n        } else if (len > 1) {\n          ctx.fillStyle = '#fff';\n        }\n\n        Canvas._stroke(ctx, 0);\n      }\n\n      ctx.restore();\n    }\n\n    for (i = 0, len = points.length; i < len; i++) {\n      if (!isArrayHasData(points[i])) {\n        continue;\n      }\n\n      if (smoothness) {\n        Canvas.paintSmoothLine(ctx, points[i], lineOpacity, smoothness, true);\n        ctx.closePath();\n      } else {\n        Canvas._ring(ctx, points[i], lineDashArray, lineOpacity);\n      }\n\n      if (!fillFirst) {\n        op = fillOpacity;\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'destination-out';\n          op = 1;\n        }\n\n        Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n\n        if (i > 0) {\n          ctx.globalCompositeOperation = 'source-over';\n        } else if (len > 1) {\n          ctx.fillStyle = '#fff';\n        }\n      }\n\n      Canvas._stroke(ctx, lineOpacity);\n    }\n\n    if (points.length > 1 && !IS_NODE) {\n      savedCtx.drawImage(TEMP_CANVAS, 0, 0);\n      savedCtx.canvas._drawn = ctx.canvas._drawn;\n      copyProperties(savedCtx, ctx);\n    }\n  },\n  _ring: function _ring(ctx, ring, lineDashArray, lineOpacity, ignorePattern) {\n    var isPattern = Canvas._isPattern(ctx.strokeStyle);\n\n    if (!ignorePattern && isPattern && !ring[0].equals(ring[ring.length - 1])) {\n      ring = ring.concat([ring[0]]);\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(ring[0].x, ring[0].y);\n\n    Canvas._path(ctx, ring, lineDashArray, lineOpacity, ignorePattern);\n\n    if (!isPattern) {\n      ctx.closePath();\n    }\n  },\n  paintSmoothLine: function paintSmoothLine(ctx, points, lineOpacity, smoothValue, close, tailIdx, tailRatio) {\n    if (!points) {\n      return;\n    }\n\n    if (points.length <= 2 || !smoothValue) {\n      Canvas.path(ctx, points, lineOpacity);\n      return;\n    }\n\n    function interpolate$$1(t0, t1, x1, y1, bx1, by1, bx2, by2, x2, y2) {\n      var u0 = 1.0 - t0;\n      var u1 = 1.0 - t1;\n      var qxa = x1 * u0 * u0 + bx1 * 2 * t0 * u0 + bx2 * t0 * t0;\n      var qxb = x1 * u1 * u1 + bx1 * 2 * t1 * u1 + bx2 * t1 * t1;\n      var qxc = bx1 * u0 * u0 + bx2 * 2 * t0 * u0 + x2 * t0 * t0;\n      var qxd = bx1 * u1 * u1 + bx2 * 2 * t1 * u1 + x2 * t1 * t1;\n      var qya = y1 * u0 * u0 + by1 * 2 * t0 * u0 + by2 * t0 * t0;\n      var qyb = y1 * u1 * u1 + by1 * 2 * t1 * u1 + by2 * t1 * t1;\n      var qyc = by1 * u0 * u0 + by2 * 2 * t0 * u0 + y2 * t0 * t0;\n      var qyd = by1 * u1 * u1 + by2 * 2 * t1 * u1 + y2 * t1 * t1;\n      var xb = qxa * u1 + qxc * t1;\n      var xc = qxb * u0 + qxd * t0;\n      var xd = qxb * u1 + qxd * t1;\n      var yb = qya * u1 + qyc * t1;\n      var yc = qyb * u0 + qyd * t0;\n      var yd = qyb * u1 + qyd * t1;\n      return [xb, yb, xc, yc, xd, yd];\n    }\n\n    function getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, t) {\n      var xc1 = (x0 + x1) / 2.0,\n          yc1 = (y0 + y1) / 2.0;\n      var xc2 = (x1 + x2) / 2.0,\n          yc2 = (y1 + y2) / 2.0;\n      var xc3 = (x2 + x3) / 2.0,\n          yc3 = (y2 + y3) / 2.0;\n      var len1 = Math.sqrt((x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0));\n      var len2 = Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n      var len3 = Math.sqrt((x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2));\n      var k1 = len1 / (len1 + len2);\n      var k2 = len2 / (len2 + len3);\n      var xm1 = xc1 + (xc2 - xc1) * k1,\n          ym1 = yc1 + (yc2 - yc1) * k1;\n      var xm2 = xc2 + (xc3 - xc2) * k2,\n          ym2 = yc2 + (yc3 - yc2) * k2;\n      var ctrl1X = xm1 + (xc2 - xm1) * smoothValue + x1 - xm1,\n          ctrl1Y = ym1 + (yc2 - ym1) * smoothValue + y1 - ym1,\n          ctrl2X = xm2 + (xc2 - xm2) * smoothValue + x2 - xm2,\n          ctrl2Y = ym2 + (yc2 - ym2) * smoothValue + y2 - ym2;\n      var ctrlPoints = [ctrl1X, ctrl1Y, ctrl2X, ctrl2Y];\n\n      if (t < 1) {\n        return interpolate$$1(0, t, x1, y1, ctrl1X, ctrl1Y, ctrl2X, ctrl2Y, x2, y2);\n      } else {\n        return ctrlPoints;\n      }\n    }\n\n    var count = points.length;\n    var l = close ? count : count - 1;\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n    if (tailRatio !== undefined) l -= Math.max(l - tailIdx - 1, 0);\n    var preCtrlPoints;\n\n    for (var i = 0; i < l; i++) {\n      var x1 = points[i].x,\n          y1 = points[i].y;\n      var x0 = void 0,\n          y0 = void 0,\n          x2 = void 0,\n          y2 = void 0,\n          x3 = void 0,\n          y3 = void 0;\n\n      if (i - 1 < 0) {\n        if (!close) {\n          x0 = points[i + 1].x;\n          y0 = points[i + 1].y;\n        } else {\n          x0 = points[l - 1].x;\n          y0 = points[l - 1].y;\n        }\n      } else {\n        x0 = points[i - 1].x;\n        y0 = points[i - 1].y;\n      }\n\n      if (i + 1 < count) {\n        x2 = points[i + 1].x;\n        y2 = points[i + 1].y;\n      } else {\n        x2 = points[i + 1 - count].x;\n        y2 = points[i + 1 - count].y;\n      }\n\n      if (i + 2 < count) {\n        x3 = points[i + 2].x;\n        y3 = points[i + 2].y;\n      } else if (!close) {\n        x3 = points[i].x;\n        y3 = points[i].y;\n      } else {\n        x3 = points[i + 2 - count].x;\n        y3 = points[i + 2 - count].y;\n      }\n\n      var ctrlPoints = getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, i === l - 1 ? tailRatio : 1);\n\n      if (i === l - 1 && tailRatio >= 0 && tailRatio < 1) {\n        ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], ctrlPoints[4], ctrlPoints[5]);\n        points.splice(l - 1, count - (l - 1) - 1);\n        var lastPoint = new Point(ctrlPoints[4], ctrlPoints[5]);\n        lastPoint.prevCtrlPoint = new Point(ctrlPoints[2], ctrlPoints[3]);\n        points.push(lastPoint);\n        count = points.length;\n      } else {\n        ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], x2, y2);\n      }\n\n      points[i].nextCtrlPoint = ctrlPoints.slice(0, 2);\n      points[i].prevCtrlPoint = preCtrlPoints ? preCtrlPoints.slice(2) : null;\n      preCtrlPoints = ctrlPoints;\n    }\n\n    if (!close && points[1].prevCtrlPoint) {\n      points[0].nextCtrlPoint = points[1].prevCtrlPoint;\n      delete points[0].prevCtrlPoint;\n    }\n\n    if (!points[count - 1].prevCtrlPoint) {\n      points[count - 1].prevCtrlPoint = points[count - 2].nextCtrlPoint;\n    }\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _arcBetween: function _arcBetween(ctx, p1, p2, degree) {\n    var a = degree,\n        dist = p1.distanceTo(p2),\n        r = dist / 2 / Math.sin(a / 2);\n    var p1p2 = Math.asin((p2.y - p1.y) / dist);\n\n    if (p1.x > p2.x) {\n      p1p2 = Math.PI - p1p2;\n    }\n\n    var cp2 = 90 * RADIAN - a / 2,\n        da = p1p2 - cp2;\n    var dx = Math.cos(da) * r,\n        dy = Math.sin(da) * r,\n        cx = p1.x + dx,\n        cy = p1.y + dy;\n    var startAngle = Math.asin((p2.y - cy) / r);\n\n    if (cx > p2.x) {\n      startAngle = Math.PI - startAngle;\n    }\n\n    var endAngle = startAngle + a;\n    ctx.beginPath();\n    ctx.arc(cx, cy, r, startAngle, endAngle);\n    return [cx, cy];\n  },\n  _lineTo: function _lineTo(ctx, p) {\n    ctx.lineTo(p.x, p.y);\n  },\n  bezierCurveAndFill: function bezierCurveAndFill(ctx, points, lineOpacity, fillOpacity) {\n    ctx.beginPath();\n    var start = points[0];\n    ctx.moveTo(start.x, start.y);\n    var args = [ctx];\n    args.push.apply(args, points.splice(1));\n\n    Canvas._bezierCurveTo.apply(Canvas, args);\n\n    Canvas.fillCanvas(ctx, fillOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n  },\n  _bezierCurveTo: function _bezierCurveTo(ctx, p1, p2, p3) {\n    ctx.bezierCurveTo(p1.x, p1.y, p2.x, p2.y, p3.x, p3.y);\n  },\n  ellipse: function ellipse(ctx, pt, width, heightTop, heightBottom, lineOpacity, fillOpacity) {\n    function bezierEllipse(x, y, a, b, b1) {\n      var k = 0.5522848,\n          ox = a * k,\n          oy = b * k,\n          oy1 = b1 * k;\n      ctx.moveTo(x - a, y);\n      ctx.bezierCurveTo(x - a, y - oy, x - ox, y - b, x, y - b);\n      ctx.bezierCurveTo(x + ox, y - b, x + a, y - oy, x + a, y);\n      ctx.bezierCurveTo(x + a, y + oy1, x + ox, y + b1, x, y + b1);\n      ctx.bezierCurveTo(x - ox, y + b1, x - a, y + oy1, x - a, y);\n      ctx.closePath();\n    }\n\n    ctx.beginPath();\n\n    if (width === heightTop && width === heightBottom) {\n      ctx.arc(pt.x, pt.y, width, 0, 2 * Math.PI);\n    } else if (ctx.ellipse) {\n      if (heightTop !== heightBottom) {\n        ctx.ellipse(pt.x, pt.y, width, heightTop, 0, RADIAN * 180, RADIAN * 360, false);\n        ctx.ellipse(pt.x, pt.y, width, heightBottom, 0, 0, RADIAN * 180, false);\n      } else {\n        ctx.ellipse(pt.x, pt.y, width, heightTop, 0, 0, RADIAN * 360, false);\n      }\n    } else {\n      bezierEllipse(pt.x, pt.y, width, heightTop, heightBottom);\n    }\n\n    Canvas.fillCanvas(ctx, fillOpacity, pt.x - width, pt.y - heightTop);\n\n    Canvas._stroke(ctx, lineOpacity, pt.x - width, pt.y - heightTop);\n  },\n  rectangle: function rectangle(ctx, pt, size, lineOpacity, fillOpacity) {\n    var x = pt.x,\n        y = pt.y;\n    ctx.beginPath();\n    ctx.rect(x, y, size['width'], size['height']);\n    Canvas.fillCanvas(ctx, fillOpacity, x, y);\n\n    Canvas._stroke(ctx, lineOpacity, x, y);\n  },\n  sector: function sector(ctx, pt, size, angles, lineOpacity, fillOpacity) {\n    var rad = RADIAN;\n    var startAngle = angles[0],\n        endAngle = angles[1];\n\n    function sector(ctx, x, y, radius, startAngle, endAngle) {\n      var sDeg = rad * -endAngle;\n      var eDeg = rad * -startAngle;\n      ctx.beginPath();\n      ctx.moveTo(x, y);\n      ctx.arc(x, y, radius, sDeg, eDeg);\n      ctx.lineTo(x, y);\n      Canvas.fillCanvas(ctx, fillOpacity, x - radius, y - radius);\n\n      Canvas._stroke(ctx, lineOpacity, x - radius, y - radius);\n    }\n\n    sector(ctx, pt.x, pt.y, size, startAngle, endAngle);\n  },\n  _isPattern: function _isPattern(style) {\n    return !isString(style) && !('addColorStop' in style);\n  },\n  drawCross: function drawCross(ctx, x, y, lineWidth, color) {\n    ctx.canvas._drawn = true;\n    ctx.strokeStyle = color;\n    ctx.lineWidth = lineWidth;\n    ctx.beginPath();\n    ctx.moveTo(x - 5, y);\n    ctx.lineTo(x + 5, y);\n    ctx.moveTo(x, y - 5);\n    ctx.lineTo(x, y + 5);\n    ctx.stroke();\n  },\n  copy: function copy(canvas, c) {\n    var target = c || createEl('canvas');\n    target.width = canvas.width;\n    target.height = canvas.height;\n    target.getContext('2d').drawImage(canvas, 0, 0);\n    return target;\n  }\n};\n\nfunction drawDashLine(ctx, startPoint, endPoint, dashArray) {\n  var fromX = startPoint.x,\n      fromY = startPoint.y,\n      toX = endPoint.x,\n      toY = endPoint.y;\n  var pattern = dashArray;\n\n  var lt = function lt(a, b) {\n    return a <= b;\n  };\n\n  var gt = function gt(a, b) {\n    return a >= b;\n  };\n\n  var capmin = function capmin(a, b) {\n    return Math.min(a, b);\n  };\n\n  var capmax = function capmax(a, b) {\n    return Math.max(a, b);\n  };\n\n  var checkX = {\n    thereYet: gt,\n    cap: capmin\n  };\n  var checkY = {\n    thereYet: gt,\n    cap: capmin\n  };\n\n  if (fromY - toY > 0) {\n    checkY.thereYet = lt;\n    checkY.cap = capmax;\n  }\n\n  if (fromX - toX > 0) {\n    checkX.thereYet = lt;\n    checkX.cap = capmax;\n  }\n\n  ctx.moveTo(fromX, fromY);\n  var offsetX = fromX;\n  var offsetY = fromY;\n  var idx = 0,\n      dash = true;\n  var ang, len;\n\n  while (!(checkX.thereYet(offsetX, toX) && checkY.thereYet(offsetY, toY))) {\n    ang = Math.atan2(toY - fromY, toX - fromX);\n    len = pattern[idx];\n    offsetX = checkX.cap(toX, offsetX + Math.cos(ang) * len);\n    offsetY = checkY.cap(toY, offsetY + Math.sin(ang) * len);\n\n    if (dash) {\n      ctx.lineTo(offsetX, offsetY);\n    } else {\n      ctx.moveTo(offsetX, offsetY);\n    }\n\n    idx = (idx + 1) % pattern.length;\n    dash = !dash;\n  }\n}\n\nvar prefix = 'data:image/';\n\nfunction extractImageUrl(url) {\n  if (url.substring(0, prefix.length) === prefix) {\n    return url;\n  }\n\n  return extractCssUrl(url);\n}\n\nfunction copyProperties(ctx, savedCtx) {\n  ctx.filter = savedCtx.filter;\n  ctx.fillStyle = savedCtx.fillStyle;\n  ctx.globalAlpha = savedCtx.globalAlpha;\n  ctx.lineCap = savedCtx.lineCap;\n  ctx.lineDashOffset = savedCtx.lineDashOffset;\n  ctx.lineJoin = savedCtx.lineJoin;\n  ctx.lineWidth = savedCtx.lineWidth;\n  ctx.shadowBlur = savedCtx.shadowBlur;\n  ctx.shadowColor = savedCtx.shadowColor;\n  ctx.shadowOffsetX = savedCtx.shadowOffsetX;\n  ctx.shadowOffsetY = savedCtx.shadowOffsetY;\n  ctx.strokeStyle = savedCtx.strokeStyle;\n}\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar zousanMin = createCommonjsModule(function (module) {\n  !function (t) {\n\n    function e(t) {\n      if (t) {\n        var e = this;\n        t(function (t) {\n          e.resolve(t);\n        }, function (t) {\n          e.reject(t);\n        });\n      }\n    }\n\n    function n(t, e) {\n      if (\"function\" == typeof t.y) try {\n        var n = t.y.call(i, e);\n        t.p.resolve(n);\n      } catch (o) {\n        t.p.reject(o);\n      } else t.p.resolve(e);\n    }\n\n    function o(t, e) {\n      if (\"function\" == typeof t.n) try {\n        var n = t.n.call(i, e);\n        t.p.resolve(n);\n      } catch (o) {\n        t.p.reject(o);\n      } else t.p.reject(e);\n    }\n\n    var r,\n        i,\n        c = \"fulfilled\",\n        u = \"rejected\",\n        s = \"undefined\",\n        f = function () {\n      function e() {\n        for (; n.length - o;) {\n          try {\n            n[o]();\n          } catch (e) {\n            t.console && t.console.error(e);\n          }\n\n          n[o++] = i, o == r && (n.splice(0, r), o = 0);\n        }\n      }\n\n      var n = [],\n          o = 0,\n          r = 1024,\n          c = function () {\n        if (typeof MutationObserver !== s) {\n          var t = document.createElement(\"div\"),\n              n = new MutationObserver(e);\n          return n.observe(t, {\n            attributes: !0\n          }), function () {\n            t.setAttribute(\"a\", 0);\n          };\n        }\n\n        return typeof setImmediate !== s ? function () {\n          setImmediate(e);\n        } : function () {\n          setTimeout(e, 0);\n        };\n      }();\n\n      return function (t) {\n        n.push(t), n.length - o == 1 && c();\n      };\n    }();\n\n    e.prototype = {\n      resolve: function resolve(t) {\n        if (this.state === r) {\n          if (t === this) return this.reject(new TypeError(\"Attempt to resolve promise with self\"));\n          var e = this;\n          if (t && (\"function\" == typeof t || \"object\" == typeof t)) try {\n            var o = !0,\n                i = t.then;\n            if (\"function\" == typeof i) return void i.call(t, function (t) {\n              o && (o = !1, e.resolve(t));\n            }, function (t) {\n              o && (o = !1, e.reject(t));\n            });\n          } catch (u) {\n            return void (o && this.reject(u));\n          }\n          this.state = c, this.v = t, e.c && f(function () {\n            for (var o = 0, r = e.c.length; r > o; o++) {\n              n(e.c[o], t);\n            }\n          });\n        }\n      },\n      reject: function reject(n) {\n        if (this.state === r) {\n          this.state = u, this.v = n;\n          var i = this.c;\n          i ? f(function () {\n            for (var t = 0, e = i.length; e > t; t++) {\n              o(i[t], n);\n            }\n          }) : !e.suppressUncaughtRejectionError && t.console && t.console.log(\"You upset Zousan. Please catch rejections: \", n, n ? n.stack : null);\n        }\n      },\n      then: function then(t, i) {\n        var u = new e(),\n            s = {\n          y: t,\n          n: i,\n          p: u\n        };\n        if (this.state === r) this.c ? this.c.push(s) : this.c = [s];else {\n          var l = this.state,\n              a = this.v;\n          f(function () {\n            l === c ? n(s, a) : o(s, a);\n          });\n        }\n        return u;\n      },\n      \"catch\": function _catch(t) {\n        return this.then(null, t);\n      },\n      \"finally\": function _finally(t) {\n        return this.then(t, t);\n      },\n      timeout: function timeout(t, n) {\n        n = n || \"Timeout\";\n        var o = this;\n        return new e(function (e, r) {\n          setTimeout(function () {\n            r(Error(n));\n          }, t), o.then(function (t) {\n            e(t);\n          }, function (t) {\n            r(t);\n          });\n        });\n      }\n    }, e.resolve = function (t) {\n      var n = new e();\n      return n.resolve(t), n;\n    }, e.reject = function (t) {\n      var n = new e();\n      return n.reject(t), n;\n    }, e.all = function (t) {\n      function n(n, c) {\n        n && \"function\" == typeof n.then || (n = e.resolve(n)), n.then(function (e) {\n          o[c] = e, r++, r == t.length && i.resolve(o);\n        }, function (t) {\n          i.reject(t);\n        });\n      }\n\n      for (var o = [], r = 0, i = new e(), c = 0; c < t.length; c++) {\n        n(t[c], c);\n      }\n\n      return t.length || i.resolve(o), i;\n    }, module.exports && (module.exports = e), t.define && t.define.amd && t.define([], function () {\n      return e;\n    }), t.Zousan = e, e.soon = f;\n  }(\"undefined\" != typeof commonjsGlobal ? commonjsGlobal : commonjsGlobal);\n});\n\nvar promise;\n\nif (typeof Promise !== 'undefined') {\n  promise = Promise;\n} else {\n  promise = zousanMin;\n}\n\nvar Promise$1 = promise;\n\nvar Eventable = function Eventable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.on = function on$$1(eventsOn, handler, context) {\n      if (!eventsOn) {\n        return this;\n      }\n\n      if (!isString(eventsOn)) {\n        return this._switch('on', eventsOn, handler);\n      }\n\n      if (!handler) {\n        return this;\n      }\n\n      if (!this._eventMap) {\n        this._eventMap = {};\n      }\n\n      var eventTypes = eventsOn.toLowerCase().split(' ');\n      var evtType;\n\n      if (!context) {\n        context = this;\n      }\n\n      var handlerChain;\n\n      for (var ii = 0, ll = eventTypes.length; ii < ll; ii++) {\n        evtType = eventTypes[ii];\n        handlerChain = this._eventMap[evtType];\n\n        if (!handlerChain) {\n          handlerChain = [];\n          this._eventMap[evtType] = handlerChain;\n        }\n\n        var l = handlerChain.length;\n\n        if (l > 0) {\n          for (var i = 0; i < l; i++) {\n            if (handler === handlerChain[i].handler && handlerChain[i].context === context) {\n              return this;\n            }\n          }\n        }\n\n        handlerChain.push({\n          handler: handler,\n          context: context\n        });\n      }\n\n      return this;\n    };\n\n    _proto.addEventListener = function addEventListener() {\n      return this.on.apply(this, arguments);\n    };\n\n    _proto.once = function once(eventTypes, handler, context) {\n      if (!isString(eventTypes)) {\n        var once = {};\n\n        for (var p in eventTypes) {\n          if (eventTypes.hasOwnProperty(p)) {\n            once[p] = this._wrapOnceHandler(p, eventTypes[p], context);\n          }\n        }\n\n        return this._switch('on', once);\n      }\n\n      var evetTypes = eventTypes.split(' ');\n\n      for (var i = 0, l = evetTypes.length; i < l; i++) {\n        this.on(evetTypes[i], this._wrapOnceHandler(evetTypes[i], handler, context));\n      }\n\n      return this;\n    };\n\n    _proto.off = function off$$1(eventsOff, handler, context) {\n      if (!this._eventMap || !eventsOff) {\n        return this;\n      }\n\n      if (!isString(eventsOff)) {\n        return this._switch('off', eventsOff, handler);\n      }\n\n      if (!handler) {\n        return this;\n      }\n\n      var eventTypes = eventsOff.split(' ');\n      var eventType, listeners, wrapKey;\n\n      if (!context) {\n        context = this;\n      }\n\n      for (var j = 0, jl = eventTypes.length; j < jl; j++) {\n        eventType = eventTypes[j].toLowerCase();\n        wrapKey = 'Z__' + eventType;\n        listeners = this._eventMap[eventType];\n\n        if (!listeners) {\n          return this;\n        }\n\n        for (var i = listeners.length - 1; i >= 0; i--) {\n          var listener = listeners[i];\n\n          if ((handler === listener.handler || handler === listener.handler[wrapKey]) && listener.context === context) {\n            delete listener.handler[wrapKey];\n            listeners.splice(i, 1);\n          }\n        }\n\n        if (!listeners.length) {\n          delete this._eventMap[eventType];\n        }\n      }\n\n      return this;\n    };\n\n    _proto.removeEventListener = function removeEventListener() {\n      return this.off.apply(this, arguments);\n    };\n\n    _proto.listens = function listens(eventType, handler, context) {\n      if (!this._eventMap || !isString(eventType)) {\n        return 0;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain || !handlerChain.length) {\n        return 0;\n      }\n\n      if (!handler) {\n        return handlerChain.length;\n      }\n\n      for (var i = 0, len = handlerChain.length; i < len; i++) {\n        if (handler === handlerChain[i].handler && (isNil(context) || handlerChain[i].context === context)) {\n          return 1;\n        }\n      }\n\n      return 0;\n    };\n\n    _proto.getListeningEvents = function getListeningEvents() {\n      if (!this._eventMap) {\n        return [];\n      }\n\n      return Object.keys(this._eventMap);\n    };\n\n    _proto.copyEventListeners = function copyEventListeners(target) {\n      var eventMap = target._eventMap;\n\n      if (!eventMap) {\n        return this;\n      }\n\n      var handlerChain;\n\n      for (var eventType in eventMap) {\n        handlerChain = eventMap[eventType];\n\n        for (var i = 0, len = handlerChain.length; i < len; i++) {\n          this.on(eventType, handlerChain[i].handler, handlerChain[i].context);\n        }\n      }\n\n      return this;\n    };\n\n    _proto.fire = function fire() {\n      if (this._eventParent) {\n        return this._eventParent.fire.apply(this._eventParent, arguments);\n      }\n\n      return this._fire.apply(this, arguments);\n    };\n\n    _proto._wrapOnceHandler = function _wrapOnceHandler(evtType, handler, context) {\n      var me = this;\n      var key = 'Z__' + evtType;\n      var called = false;\n\n      var fn = function onceHandler() {\n        if (called) {\n          return;\n        }\n\n        delete fn[key];\n        called = true;\n\n        if (context) {\n          handler.apply(context, arguments);\n        } else {\n          handler.apply(this, arguments);\n        }\n\n        me.off(evtType, onceHandler, this);\n      };\n\n      fn[key] = handler;\n      return fn;\n    };\n\n    _proto._switch = function _switch(to, eventKeys, context) {\n      for (var p in eventKeys) {\n        if (eventKeys.hasOwnProperty(p)) {\n          this[to](p, eventKeys[p], context);\n        }\n      }\n\n      return this;\n    };\n\n    _proto._clearListeners = function _clearListeners(eventType) {\n      if (!this._eventMap || !isString(eventType)) {\n        return;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain) {\n        return;\n      }\n\n      this._eventMap[eventType] = null;\n    };\n\n    _proto._clearAllListeners = function _clearAllListeners() {\n      this._eventMap = null;\n    };\n\n    _proto._setEventParent = function _setEventParent(parent) {\n      this._eventParent = parent;\n      return this;\n    };\n\n    _proto._setEventTarget = function _setEventTarget(target) {\n      this._eventTarget = target;\n      return this;\n    };\n\n    _proto._fire = function _fire(eventType, param) {\n      if (!this._eventMap) {\n        return this;\n      }\n\n      var handlerChain = this._eventMap[eventType.toLowerCase()];\n\n      if (!handlerChain) {\n        return this;\n      }\n\n      if (!param) {\n        param = {};\n      }\n\n      param['type'] = eventType;\n      param['target'] = this._eventTarget || this;\n      var queue = handlerChain.slice(0);\n      var context, bubble, passed;\n\n      for (var i = 0, len = queue.length; i < len; i++) {\n        if (!queue[i]) {\n          continue;\n        }\n\n        context = queue[i].context;\n        bubble = true;\n        passed = extend({}, param);\n\n        if (context) {\n          bubble = queue[i].handler.call(context, passed);\n        } else {\n          bubble = queue[i].handler(passed);\n        }\n\n        if (bubble === false) {\n          if (param['domEvent']) {\n            stopPropagation(param['domEvent']);\n          }\n        }\n      }\n\n      return this;\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar Handler = function () {\n  function Handler(target) {\n    this.target = target;\n  }\n\n  var _proto = Handler.prototype;\n\n  _proto.enable = function enable() {\n    if (this._enabled) {\n      return this;\n    }\n\n    this._enabled = true;\n    this.addHooks();\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this._enabled) {\n      return this;\n    }\n\n    this._enabled = false;\n    this.removeHooks();\n    return this;\n  };\n\n  _proto.enabled = function enabled() {\n    return !!this._enabled;\n  };\n\n  _proto.remove = function remove() {\n    this.disable();\n    delete this.target;\n    delete this.dom;\n  };\n\n  return Handler;\n}();\n\nvar Handler$1 = Eventable(Handler);\n\nvar Class = function () {\n  function Class(options) {\n    if (!this || !this.setOptions) {\n      throw new Error('Class instance is being created without \"new\" operator.');\n    }\n\n    this.setOptions(options);\n    this.callInitHooks();\n  }\n\n  var _proto = Class.prototype;\n\n  _proto.callInitHooks = function callInitHooks() {\n    var proto = Object.getPrototypeOf(this);\n\n    this._visitInitHooks(proto);\n\n    return this;\n  };\n\n  _proto.setOptions = function setOptions(options) {\n    if (!this.hasOwnProperty('options')) {\n      this.options = this.options ? Object.create(this.options) : {};\n    }\n\n    if (!options) {\n      return this;\n    }\n\n    for (var i in options) {\n      this.options[i] = options[i];\n    }\n\n    return this;\n  };\n\n  _proto.config = function config(conf) {\n    if (!conf) {\n      var config = {};\n\n      for (var p in this.options) {\n        if (this.options.hasOwnProperty(p)) {\n          config[p] = this.options[p];\n        }\n      }\n\n      return config;\n    } else {\n      if (arguments.length === 2) {\n        var t = {};\n        t[conf] = arguments[1];\n        conf = t;\n      }\n\n      for (var i in conf) {\n        this.options[i] = conf[i];\n\n        if (this[i] && this[i] instanceof Handler$1) {\n          if (conf[i]) {\n            this[i].enable();\n          } else {\n            this[i].disable();\n          }\n        }\n      }\n\n      this.onConfig(conf);\n    }\n\n    return this;\n  };\n\n  _proto.onConfig = function onConfig() {};\n\n  _proto._visitInitHooks = function _visitInitHooks(proto) {\n    if (this._initHooksCalled) {\n      return;\n    }\n\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (parentProto._visitInitHooks) {\n      parentProto._visitInitHooks.call(this, parentProto);\n    }\n\n    this._initHooksCalled = true;\n    var hooks = proto._initHooks;\n\n    if (hooks && hooks !== parentProto._initHooks) {\n      for (var i = 0; i < hooks.length; i++) {\n        hooks[i].call(this);\n      }\n    }\n  };\n\n  Class.addInitHook = function addInitHook(fn) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    var init = typeof fn === 'function' ? fn : function () {\n      this[fn].apply(this, args);\n    };\n    var proto = this.prototype;\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (!proto._initHooks || proto._initHooks === parentProto._initHooks) {\n      proto._initHooks = [];\n    }\n\n    proto._initHooks.push(init);\n\n    return this;\n  };\n\n  Class.include = function include() {\n    for (var i = 0; i < arguments.length; i++) {\n      extend(this.prototype, i < 0 || arguments.length <= i ? undefined : arguments[i]);\n    }\n\n    return this;\n  };\n\n  Class.mergeOptions = function mergeOptions(options) {\n    var proto = this.prototype;\n    var parentProto = Object.getPrototypeOf(proto);\n\n    if (!proto.options || proto.options === parentProto.options) {\n      proto.options = proto.options ? Object.create(proto.options) : {};\n    }\n\n    extend(proto.options, options);\n    return this;\n  };\n\n  return Class;\n}();\n\nvar registeredTypes = {};\nvar JSONAble = (function (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class.registerJSONType = function registerJSONType(type) {\n      if (!type) {\n        return this;\n      }\n\n      registeredTypes[type] = this;\n      return this;\n    };\n\n    _class.getJSONClass = function getJSONClass(type) {\n      if (!type) {\n        return null;\n      }\n\n      return registeredTypes[type];\n    };\n\n    var _proto = _class.prototype;\n\n    _proto.getJSONType = function getJSONType() {\n      if (this._jsonType === undefined) {\n        var clazz = Object.getPrototypeOf(this).constructor;\n\n        for (var p in registeredTypes) {\n          if (registeredTypes[p] === clazz) {\n            this._jsonType = p;\n            break;\n          }\n        }\n      }\n\n      if (!this._jsonType) {\n        throw new Error('Found an unregistered geometry class!');\n      }\n\n      return this._jsonType;\n    };\n\n    return _class;\n  }(Base);\n});\n\nfunction Handlerable (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.addHandler = function addHandler(name, handlerClass) {\n      if (!handlerClass) {\n        return this;\n      }\n\n      if (!this._handlers) {\n        this._handlers = [];\n      }\n\n      if (this[name]) {\n        this[name].enable();\n        return this;\n      }\n\n      var handler = this[name] = new handlerClass(this);\n\n      this._handlers.push(handler);\n\n      if (this.options[name]) {\n        handler.enable();\n      }\n\n      return this;\n    };\n\n    _proto.removeHandler = function removeHandler(name) {\n      if (!name) {\n        return this;\n      }\n\n      var handler = this[name];\n\n      if (handler) {\n        var hit = this._handlers.indexOf(handler);\n\n        if (hit >= 0) {\n          this._handlers.splice(hit, 1);\n        }\n\n        this[name].remove();\n        delete this[name];\n      }\n\n      return this;\n    };\n\n    _proto._clearHandlers = function _clearHandlers() {\n      for (var i = 0, len = this._handlers.length; i < len; i++) {\n        this._handlers[i].remove();\n      }\n\n      this._handlers = [];\n    };\n\n    return _class;\n  }(Base);\n}\n\nvar START_EVENTS = 'touchstart mousedown';\nvar MOVE_EVENTS = {\n  mousedown: 'mousemove',\n  touchstart: 'touchmove',\n  pointerdown: 'touchmove',\n  MSPointerDown: 'touchmove'\n};\nvar END_EVENTS = {\n  mousedown: 'mouseup',\n  touchstart: 'touchend',\n  pointerdown: 'touchend',\n  MSPointerDown: 'touchend'\n};\n\nvar DragHandler = function (_Handler) {\n  _inheritsLoose(DragHandler, _Handler);\n\n  function DragHandler(dom, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _Handler.call(this, null) || this;\n    _this.dom = dom;\n    _this.options = options;\n    return _this;\n  }\n\n  var _proto = DragHandler.prototype;\n\n  _proto.enable = function enable() {\n    if (!this.dom) {\n      return this;\n    }\n\n    this._onMouseDown = function (e) {\n      return this.onMouseDown(e);\n    };\n\n    on(this.dom, START_EVENTS, this._onMouseDown, this);\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this.dom) {\n      return this;\n    }\n\n    this._offEvents();\n\n    off(this.dom, START_EVENTS, this._onMouseDown);\n    delete this._onMouseDown;\n    return this;\n  };\n\n  _proto.onMouseDown = function onMouseDown(event) {\n    if (!this.options['rightclick'] && event.button === 2) {\n      return;\n    }\n\n    if (event.touches && event.touches.length > 1) {\n      return;\n    }\n\n    if (this.options['cancelOn'] && this.options['cancelOn'](event) === true) {\n      return;\n    }\n\n    var dom = this.dom;\n\n    if (dom.setCapture) {\n      dom.setCapture();\n    } else if (window.captureEvents) {\n      window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n    }\n\n    dom['ondragstart'] = function () {\n      return false;\n    };\n\n    delete this.moved;\n    var actual = event.touches ? event.touches[0] : event;\n    this.startPos = new Point(actual.clientX, actual.clientY);\n    on(document, MOVE_EVENTS[event.type], this.onMouseMove, this);\n    on(document, END_EVENTS[event.type], this.onMouseUp, this);\n\n    if (!this.options['ignoreMouseleave']) {\n      on(this.dom, 'mouseleave', this.onMouseUp, this);\n    }\n\n    this.fire('mousedown', {\n      'domEvent': event,\n      'mousePos': new Point(actual.clientX, actual.clientY)\n    });\n  };\n\n  _proto.onMouseMove = function onMouseMove(event) {\n    if (event.touches && event.touches.length > 1) {\n      if (this.moved) {\n        this.interupted = true;\n        this.onMouseUp(event);\n      }\n\n      return;\n    }\n\n    var actual = event.touches ? event.touches[0] : event;\n    var newPos = new Point(actual.clientX, actual.clientY),\n        offset = newPos.sub(this.startPos);\n\n    if (!offset.x && !offset.y) {\n      return;\n    }\n\n    if (!this.moved) {\n      this.fire('dragstart', {\n        'domEvent': event,\n        'mousePos': this.startPos.copy()\n      });\n      this.moved = true;\n    } else {\n      this.fire('dragging', {\n        'domEvent': event,\n        'mousePos': new Point(actual.clientX, actual.clientY)\n      });\n    }\n  };\n\n  _proto.onMouseUp = function onMouseUp(event) {\n    var actual = event.changedTouches ? event.changedTouches[0] : event;\n\n    this._offEvents();\n\n    var param = {\n      'domEvent': event\n    };\n\n    if (isNumber(actual.clientX)) {\n      param['mousePos'] = new Point(parseInt(actual.clientX, 0), parseInt(actual.clientY, 0));\n    }\n\n    if (this.moved) {\n        param.interupted = this.interupted;\n        this.fire('dragend', param);\n        delete this.interupted;\n        delete this.moved;\n      }\n\n    this.fire('mouseup', param);\n  };\n\n  _proto._offEvents = function _offEvents() {\n    var dom = this.dom;\n    off(dom, 'mouseleave', this.onMouseUp, this);\n\n    if (typeof document === 'undefined' || typeof window === 'undefined') {\n      return;\n    }\n\n    for (var i in MOVE_EVENTS) {\n      off(document, MOVE_EVENTS[i], this.onMouseMove, this);\n      off(document, END_EVENTS[i], this.onMouseUp, this);\n    }\n\n    if (dom['releaseCapture']) {\n      dom['releaseCapture']();\n    } else if (window.captureEvents) {\n      window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n    }\n  };\n\n  return DragHandler;\n}(Handler$1);\n\nvar Coordinate = function (_Position) {\n  _inheritsLoose(Coordinate, _Position);\n\n  function Coordinate() {\n    return _Position.apply(this, arguments) || this;\n  }\n\n  Coordinate.toNumberArrays = function toNumberArrays(coordinates) {\n    if (!Array.isArray(coordinates)) {\n      return [coordinates.x, coordinates.y];\n    }\n\n    return forEachCoord(coordinates, function (coord) {\n      return [coord.x, coord.y];\n    });\n  };\n\n  Coordinate.toCoordinates = function toCoordinates(coordinates) {\n    if (isNumber(coordinates[0]) && isNumber(coordinates[1])) {\n      return new Coordinate(coordinates);\n    }\n\n    var result = [];\n\n    for (var i = 0, len = coordinates.length; i < len; i++) {\n      var child = coordinates[i];\n\n      if (Array.isArray(child)) {\n        if (isNumber(child[0])) {\n          result.push(new Coordinate(child));\n        } else {\n          result.push(Coordinate.toCoordinates(child));\n        }\n      } else {\n        result.push(new Coordinate(child));\n      }\n    }\n\n    return result;\n  };\n\n  return Coordinate;\n}(Position);\n\nvar CRS = function () {\n  function CRS(type, properties) {\n    this.type = type;\n    this.properties = properties;\n  }\n\n  CRS.createProj4 = function createProj4(proj) {\n    return new CRS('proj4', {\n      'proj': proj\n    });\n  };\n\n  CRS.fromProjectionCode = function fromProjectionCode(code) {\n    if (!code) {\n      return null;\n    }\n\n    code = code.toUpperCase().replace(':', '');\n    return CRS[code] || null;\n  };\n\n  return CRS;\n}();\n\nCRS.WGS84 = CRS.createProj4('+proj=longlat +datum=WGS84 +no_defs');\nCRS.EPSG4326 = CRS.WGS84;\nCRS.EPSG3857 = CRS.createProj4('+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs');\nCRS.IDENTITY = CRS.createProj4('+proj=identity +no_defs');\nCRS.CGCS2000 = CRS.createProj4('+proj=longlat +datum=CGCS2000');\nCRS.EPSG4490 = CRS.CGCS2000;\nCRS.BD09LL = CRS.createProj4('+proj=longlat +datum=BD09');\nCRS.GCJ02 = CRS.createProj4('+proj=longlat +datum=GCJ02');\n\nvar TEMP_POINT0 = new Point(0, 0);\nvar TEMP_COORD0 = new Coordinate(0, 0);\nvar TEMP_COORD1 = new Coordinate(0, 0);\nvar TEMP_COORD2 = new Coordinate(0, 0);\nvar TEMP_COORD3 = new Coordinate(0, 0);\nvar TEMP_COORD4 = new Coordinate(0, 0);\nvar TEMP_COORD5 = new Coordinate(0, 0);\nvar TEMP_COORD6 = new Coordinate(0, 0);\nvar TEMP_COORD7 = new Coordinate(0, 0);\nvar MINMAX = [];\nvar TEMP_EXTENT;\nvar TEMP_COMBINE = [];\n\nvar Extent = function () {\n  function Extent(p1, p2, p3, p4) {\n    this._clazz = Coordinate;\n    var l = arguments.length;\n    var proj = l > 0 ? arguments[l - 1] : null;\n\n    if (proj && proj.unproject) {\n      this.projection = arguments[l - 1];\n    }\n\n    this._dirty = true;\n\n    this._initialize(p1, p2, p3, p4);\n  }\n\n  var _proto = Extent.prototype;\n\n  _proto._initialize = function _initialize(p1, p2, p3, p4) {\n    this.xmin = null;\n    this.xmax = null;\n    this.ymin = null;\n    this.ymax = null;\n\n    if (isNil(p1)) {\n      return;\n    }\n\n    var projection = this.projection;\n\n    if (isNumber(p1) && isNumber(p2) && isNumber(p3) && isNumber(p4)) {\n      if (projection) {\n        this.set(p1, p2, p3, p4);\n      } else {\n        this.set(Math.min(p1, p3), Math.min(p2, p4), Math.max(p1, p3), Math.max(p2, p4));\n      }\n\n      return;\n    } else if (Array.isArray(p1)) {\n      if (projection) {\n        this.set(p1[0], p1[1], p1[2], p1[3]);\n      } else {\n        this.set(Math.min(p1[0], p1[2]), Math.min(p1[1], p1[3]), Math.max(p1[0], p1[2]), Math.max(p1[1], p1[3]));\n      }\n    } else if (isNumber(p1.x) && isNumber(p2.x) && isNumber(p1.y) && isNumber(p2.y)) {\n      if (projection) {\n        this.set(p1.x, p1.y, p2.x, p2.y);\n      } else {\n        if (p1.x > p2.x) {\n          this['xmin'] = p2.x;\n          this['xmax'] = p1.x;\n        } else {\n          this['xmin'] = p1.x;\n          this['xmax'] = p2.x;\n        }\n\n        if (p1.y > p2.y) {\n          this['ymin'] = p2.y;\n          this['ymax'] = p1.y;\n        } else {\n          this['ymin'] = p1.y;\n          this['ymax'] = p2.y;\n        }\n      }\n    } else if (isNumber(p1['xmin']) && isNumber(p1['xmax']) && isNumber(p1['ymin']) && isNumber(p1['ymax'])) {\n      this.set(p1['xmin'], p1['ymin'], p1['xmax'], p1['ymax']);\n    }\n  };\n\n  _proto._add = function _add(p) {\n    this._dirty = true;\n\n    if (!isNil(p.x)) {\n      this['xmin'] += p.x;\n      this['ymin'] += p.y;\n      this['xmax'] += p.x;\n      this['ymax'] += p.y;\n    } else if (!isNil(p.xmin)) {\n      this['xmin'] += p.xmin;\n      this['ymin'] += p.ymin;\n      this['xmax'] += p.xmax;\n      this['ymax'] += p.ymax;\n    } else if (!isNil(p[0])) {\n      this['xmin'] += p[0];\n      this['ymin'] += p[1];\n      this['xmax'] += p[0];\n      this['ymax'] += p[1];\n    }\n\n    return this;\n  };\n\n  _proto.add = function add() {\n    var e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    return e._add.apply(e, arguments);\n  };\n\n  _proto._scale = function _scale(s) {\n    this._dirty = true;\n    this['xmin'] *= s;\n    this['ymin'] *= s;\n    this['xmax'] *= s;\n    this['ymax'] *= s;\n    return this;\n  };\n\n  _proto._sub = function _sub(p) {\n    this._dirty = true;\n\n    if (!isNil(p.x)) {\n      this['xmin'] -= p.x;\n      this['ymin'] -= p.y;\n      this['xmax'] -= p.x;\n      this['ymax'] -= p.y;\n    } else if (!isNil(p.xmin)) {\n      this['xmin'] -= p.xmin;\n      this['ymin'] -= p.ymin;\n      this['xmax'] -= p.xmax;\n      this['ymax'] -= p.ymax;\n    } else if (!isNil(p[0])) {\n      this['xmin'] -= p[0];\n      this['ymin'] -= p[1];\n      this['xmax'] -= p[0];\n      this['ymax'] -= p[1];\n    }\n\n    return this;\n  };\n\n  _proto._substract = function _substract() {\n    return this._sub.apply(this, arguments);\n  };\n\n  _proto.sub = function sub() {\n    var e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    return e._sub.apply(e, arguments);\n  };\n\n  _proto.substract = function substract() {\n    return this.sub.apply(this, arguments);\n  };\n\n  _proto.round = function round() {\n    return new this.constructor(Math.round(this['xmin']), Math.round(this['ymin']), Math.round(this['xmax']), Math.round(this['ymax']), this.projection);\n  };\n\n  _proto._round = function _round() {\n    this._dirty = true;\n    this['xmin'] = Math.round(this['xmin']);\n    this['ymin'] = Math.round(this['ymin']);\n    this['xmax'] = Math.round(this['xmax']);\n    this['ymax'] = Math.round(this['ymax']);\n    return this;\n  };\n\n  _proto.getMin = function getMin(out) {\n    if (out) {\n      out.set(this['xmin'], this['ymin']);\n      return out;\n    }\n\n    return new this._clazz(this['xmin'], this['ymin']);\n  };\n\n  _proto.getMax = function getMax(out) {\n    if (out) {\n      out.set(this['xmax'], this['ymax']);\n      return out;\n    }\n\n    return new this._clazz(this['xmax'], this['ymax']);\n  };\n\n  _proto.getCenter = function getCenter(out) {\n    var x = (this['xmin'] + this['xmax']) / 2;\n    var y = (this['ymin'] + this['ymax']) / 2;\n\n    if (out) {\n      out.set(x, y);\n      return out;\n    }\n\n    return new this._clazz(x, y);\n  };\n\n  _proto.isValid = function isValid() {\n    return !isNil(this['xmin']) && !isNil(this['ymin']) && !isNil(this['xmax']) && !isNil(this['ymax']);\n  };\n\n  _proto.equals = function equals(ext2) {\n    return this['xmin'] === ext2['xmin'] && this['xmax'] === ext2['xmax'] && this['ymin'] === ext2['ymin'] && this['ymax'] === ext2['ymax'];\n  };\n\n  _proto.intersects = function intersects(ext2) {\n    this._project(this);\n\n    this._project(ext2);\n\n    var rxmin = Math.max(this['pxmin'], ext2['pxmin']);\n    var rymin = Math.max(this['pymin'], ext2['pymin']);\n    var rxmax = Math.min(this['pxmax'], ext2['pxmax']);\n    var rymax = Math.min(this['pymax'], ext2['pymax']);\n    var intersects = !(rxmin > rxmax || rymin > rymax);\n    return intersects;\n  };\n\n  _proto.within = function within(extent) {\n    this._project(this);\n\n    this._project(extent);\n\n    return this.pxmin >= extent.pxmin && this.pxmax <= extent.pxmax && this.pymin >= extent.pymin && this.pymax <= extent.pymax;\n  };\n\n  _proto.contains = function contains(c) {\n    if (!c) {\n      return false;\n    }\n\n    this._project(this);\n\n    var proj = this.projection;\n\n    if (proj) {\n      if (c.x !== undefined) {\n        var coord = TEMP_COORD0;\n\n        if (Array.isArray(c)) {\n          coord.x = c[0];\n          coord.y = c[1];\n        } else {\n          coord.x = c.x;\n          coord.y = c.y;\n        }\n\n        c = proj.project(coord, coord);\n      } else if (c.xmin !== undefined) {\n        this._project(c);\n      }\n    }\n\n    return (c.x || c.pxmin || 0) >= this.pxmin && (c.x || c.pxmax || 0) <= this.pxmax && (c.y || c.pymin || 0) >= this.pymin && (c.y || c.pymax || 0) <= this.pymax;\n  };\n\n  _proto.getWidth = function getWidth() {\n    return Math.abs(this['xmax'] - this['xmin']);\n  };\n\n  _proto.getHeight = function getHeight() {\n    return Math.abs(this['ymax'] - this['ymin']);\n  };\n\n  _proto.getSize = function getSize() {\n    return new Size(this.getWidth(), this.getHeight());\n  };\n\n  _proto.set = function set(xmin, ymin, xmax, ymax) {\n    this.xmin = xmin;\n    this.ymin = ymin;\n    this.xmax = xmax;\n    this.ymax = ymax;\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.__combine = function __combine(extent) {\n    if (extent.x !== undefined) {\n      TEMP_EXTENT.xmin = TEMP_EXTENT.xmax = extent.x;\n      TEMP_EXTENT.ymin = TEMP_EXTENT.ymax = extent.y;\n      extent = TEMP_EXTENT;\n    }\n\n    this._project(extent);\n\n    this._project(this);\n\n    var inited = isNumber(this.pxmin);\n    var xmin, ymin, xmax, ymax;\n\n    if (!inited) {\n      xmin = extent['pxmin'];\n      ymin = extent['pymin'];\n      xmax = extent['pxmax'];\n      ymax = extent['pymax'];\n    } else {\n      xmin = Math.min(this['pxmin'], extent['pxmin']);\n      ymin = Math.min(this['pymin'], extent['pymin']);\n      xmax = Math.max(this['pxmax'], extent['pxmax']);\n      ymax = Math.max(this['pymax'], extent['pymax']);\n    }\n\n    var proj = this.projection;\n\n    if (proj) {\n      TEMP_COORD1.set(xmin, ymin);\n      TEMP_COORD2.set(xmax, ymax);\n      var min = proj.unproject(TEMP_COORD1, TEMP_COORD1),\n          max = proj.unproject(TEMP_COORD2, TEMP_COORD2);\n      xmin = min.x;\n      ymin = min.y;\n      xmax = max.x;\n      ymax = max.y;\n    }\n\n    TEMP_COMBINE[0] = xmin;\n    TEMP_COMBINE[1] = ymin;\n    TEMP_COMBINE[2] = xmax;\n    TEMP_COMBINE[3] = ymax;\n    return TEMP_COMBINE;\n  };\n\n  _proto._combine = function _combine(extent) {\n    if (!extent || extent.isValid && !extent.isValid()) {\n      return this;\n    }\n\n    var ext = this.__combine(extent);\n\n    this.set(ext[0], ext[1], ext[2], ext[3]);\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.combine = function combine(extent) {\n    if (!extent || extent.isValid && !extent.isValid()) {\n      return this;\n    }\n\n    var ext = this.__combine(extent);\n\n    return new this.constructor(ext[0], ext[1], ext[2], ext[3], this.projection);\n  };\n\n  _proto.intersection = function intersection(extent) {\n    if (!this.intersects(extent)) {\n      return null;\n    }\n\n    TEMP_COORD3.x = Math.max(this['pxmin'], extent['pxmin']);\n    TEMP_COORD3.y = Math.max(this['pymin'], extent['pymin']);\n    TEMP_COORD4.x = Math.min(this['pxmax'], extent['pxmax']);\n    TEMP_COORD4.y = Math.min(this['pymax'], extent['pymax']);\n    var min = TEMP_COORD3,\n        max = TEMP_COORD4;\n    var proj = this.projection;\n\n    if (proj) {\n      min = proj.unproject(min, min);\n      max = proj.unproject(max, max);\n    }\n\n    return new this.constructor(min, max, proj);\n  };\n\n  _proto.expand = function expand(distance) {\n    var w, h;\n\n    if (!isNumber(distance)) {\n      w = distance['width'] || distance['x'] || distance[0] || 0;\n      h = distance['height'] || distance['y'] || distance[1] || 0;\n    } else {\n      w = h = distance;\n    }\n\n    return new this.constructor(this['xmin'] - w, this['ymin'] - h, this['xmax'] + w, this['ymax'] + h, this.projection);\n  };\n\n  _proto._expand = function _expand(distance) {\n    var w, h;\n\n    if (!isNumber(distance)) {\n      w = distance['width'] || distance['x'] || distance[0] || 0;\n      h = distance['height'] || distance['y'] || distance[1] || 0;\n    } else {\n      w = h = distance;\n    }\n\n    this['xmin'] -= w;\n    this['ymin'] -= h;\n    this['xmax'] += w;\n    this['ymax'] += h;\n    this._dirty = true;\n    return this;\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'xmin': this['xmin'],\n      'ymin': this['ymin'],\n      'xmax': this['xmax'],\n      'ymax': this['ymax']\n    };\n  };\n\n  _proto.toArray = function toArray() {\n    var xmin = this['xmin'],\n        ymin = this['ymin'],\n        xmax = this['xmax'],\n        ymax = this['ymax'];\n    return [new this._clazz([xmin, ymax]), new this._clazz([xmax, ymax]), new this._clazz([xmax, ymin]), new this._clazz([xmin, ymin]), new this._clazz([xmin, ymax])];\n  };\n\n  _proto.toString = function toString() {\n    return this.xmin + \",\" + this.ymin + \",\" + this.xmax + \",\" + this.ymax;\n  };\n\n  _proto.copy = function copy() {\n    return new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n  };\n\n  _proto.convertTo = function convertTo(fn, out) {\n    if (!this.isValid()) {\n      return null;\n    }\n\n    var e = out || new this.constructor();\n\n    if (out) {\n      e.set(null, null, null, null);\n    }\n\n    var coord;\n\n    if (this._clazz === Coordinate) {\n      coord = TEMP_COORD5;\n    } else if (this._clazz === Point) {\n      coord = TEMP_POINT0;\n    }\n\n    coord.x = this.xmin;\n    coord.y = this.ymax;\n\n    e._combine(fn(coord));\n\n    coord.x = this.xmax;\n\n    e._combine(fn(coord));\n\n    coord.y = this.ymin;\n\n    e._combine(fn(coord));\n\n    coord.x = this.xmin;\n\n    e._combine(fn(coord));\n\n    return e;\n  };\n\n  _proto._project = function _project(ext) {\n    if (!ext || !ext.isValid()) {\n      if (ext) {\n        ext.pxmin = ext.pxmax = ext.pymin = ext.pymax = null;\n      }\n\n      return;\n    }\n\n    var proj = this.projection;\n\n    if (proj) {\n      if (ext._dirty) {\n        TEMP_COORD6.set(ext.xmax, ext.ymin);\n        TEMP_COORD7.set(ext.xmin, ext.ymax);\n        MINMAX[0] = TEMP_COORD6;\n        MINMAX[1] = TEMP_COORD7;\n        var minmax = proj.projectCoords(MINMAX);\n        var min = minmax[0],\n            max = minmax[1];\n        ext.pxmin = Math.min(min.x, max.x);\n        ext.pymin = Math.min(min.y, max.y);\n        ext.pxmax = Math.max(min.x, max.x);\n        ext.pymax = Math.max(min.y, max.y);\n      }\n\n      delete ext._dirty;\n    } else {\n      ext.pxmin = ext.xmin;\n      ext.pxmax = ext.xmax;\n      ext.pymin = ext.ymin;\n      ext.pymax = ext.ymax;\n    }\n  };\n\n  return Extent;\n}();\n\nTEMP_EXTENT = new Extent(0, 0, 0, 0);\n\nvar PointExtent = function (_Extent) {\n  _inheritsLoose(PointExtent, _Extent);\n\n  function PointExtent(p1, p2, p3, p4) {\n    var _this;\n\n    _this = _Extent.call(this, p1, p2, p3, p4) || this;\n    _this._clazz = Point;\n    return _this;\n  }\n\n  return PointExtent;\n}(Extent);\n\nvar Transformation = function () {\n  function Transformation(matrix) {\n    this.matrix = matrix;\n  }\n\n  var _proto = Transformation.prototype;\n\n  _proto.transform = function transform(coordinates, scale, out) {\n    var x = this.matrix[0] * (coordinates.x - this.matrix[2]) / scale;\n    var y = -this.matrix[1] * (coordinates.y - this.matrix[3]) / scale;\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Point(x, y);\n  };\n\n  _proto.untransform = function untransform(point, scale, out) {\n    var x = point.x * scale / this.matrix[0] + this.matrix[2];\n    var y = point.y * scale / -this.matrix[1] + this.matrix[3];\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Coordinate(x, y);\n  };\n\n  return Transformation;\n}();\n\nvar Common = {\n  project: function project() {},\n  unproject: function unproject() {},\n  projectCoords: function projectCoords(coordinates) {\n    var _this = this;\n\n    if (!coordinates) {\n      return [];\n    }\n\n    if (!Array.isArray(coordinates)) {\n      return this.project(coordinates);\n    }\n\n    if (coordinates.length === 0) {\n      return [];\n    }\n\n    if (!this.isSphere()) {\n      return forEachCoord(coordinates, this.project, this);\n    }\n\n    if (Array.isArray(coordinates[0])) {\n      return coordinates.map(function (coords) {\n        return _this.projectCoords(coords);\n      });\n    } else {\n      var circum = this.getCircum();\n      var extent = this.getSphereExtent(),\n          sx = extent.sx,\n          sy = extent.sy;\n      var wrapX, wrapY;\n      var pre = coordinates[0],\n          current,\n          dx,\n          dy,\n          p;\n      var prj = [this.project(pre)];\n\n      for (var i = 1, l = coordinates.length; i < l; i++) {\n        current = coordinates[i];\n        dx = current.x - pre.x;\n        dy = current.y - pre.y;\n        p = this.project(current);\n\n        if (Math.abs(dx) > 180) {\n          if (wrapX === undefined) {\n            wrapX = current.x > pre.x;\n          }\n\n          if (wrapX) {\n            p._add(-circum.x * sign(dx) * sx, 0);\n\n            current._add(-360 * sign(dx), 0);\n          }\n        }\n\n        if (Math.abs(dy) > 90) {\n          if (wrapY === undefined) {\n            wrapY = current.y < pre.y;\n          }\n\n          if (wrapY) {\n            p._add(0, -circum.y * sign(dy) * sy);\n\n            current._add(0, -180 * sign(dy));\n          }\n        }\n\n        pre = current;\n        prj.push(p);\n      }\n\n      return prj;\n    }\n  },\n  unprojectCoords: function unprojectCoords(projCoords) {\n    if (!projCoords) {\n      return [];\n    }\n\n    if (!Array.isArray(projCoords)) {\n      return this.unproject(projCoords);\n    }\n\n    return forEachCoord(projCoords, this.unproject, this);\n  },\n  isSphere: function isSphere() {\n    return !!this.sphere;\n  },\n  isOutSphere: function isOutSphere(pcoord) {\n    if (!this.isSphere()) {\n      return false;\n    }\n\n    var extent = this.getSphereExtent();\n    return !extent.contains(pcoord);\n  },\n  wrapCoord: function wrapCoord(pcoord) {\n    if (!this.isSphere()) {\n      return pcoord;\n    }\n\n    var extent = this.getSphereExtent();\n    var wrapped = new Coordinate(pcoord);\n\n    if (!extent.contains(wrapped)) {\n      wrapped.x = wrap(pcoord.x, extent.xmin, extent.xmax);\n      wrapped.y = wrap(pcoord.y, extent.ymin, extent.ymax);\n    }\n\n    return wrapped;\n  },\n  getCircum: function getCircum() {\n    if (!this.circum && this.isSphere()) {\n      var extent = this.getSphereExtent();\n      this.circum = {\n        x: extent.getWidth(),\n        y: extent.getHeight()\n      };\n    }\n\n    return this.circum;\n  },\n  getSphereExtent: function getSphereExtent() {\n    if (!this.extent && this.isSphere()) {\n      var max = this.project(new Coordinate(180, 90)),\n          min = this.project(new Coordinate(-180, -90));\n      this.extent = new Extent(min, max, this);\n      this.extent.sx = max.x > min.x ? 1 : -1;\n      this.extent.sy = max.y > min.y ? 1 : -1;\n    }\n\n    return this.extent;\n  }\n};\n\nvar Common$1 = {\n  measureLength: function measureLength(c1, c2) {\n    if (!Array.isArray(c1)) {\n      return this.measureLenBetween(c1, c2);\n    }\n\n    var len = 0;\n\n    for (var i = 0, l = c1.length; i < l - 1; i++) {\n      len += this.measureLenBetween(c1[i], c1[i + 1]);\n    }\n\n    return len;\n  }\n};\n\nvar Identity = extend({\n  'measure': 'IDENTITY',\n  measureLenBetween: function measureLenBetween(c1, c2) {\n    if (!c1 || !c2) {\n      return 0;\n    }\n\n    try {\n      return Math.sqrt(Math.pow(c1.x - c2.x, 2) + Math.pow(c1.y - c2.y, 2));\n    } catch (err) {\n      return 0;\n    }\n  },\n  measureArea: function measureArea(coordinates) {\n    if (!Array.isArray(coordinates)) {\n      return 0;\n    }\n\n    var area = 0;\n\n    for (var i = 0, len = coordinates.length; i < len; i++) {\n      var c1 = coordinates[i];\n      var c2 = null;\n\n      if (i === len - 1) {\n        c2 = coordinates[0];\n      } else {\n        c2 = coordinates[i + 1];\n      }\n\n      area += c1.x * c2.y - c1.y * c2.x;\n    }\n\n    return Math.abs(area / 2);\n  },\n  locate: function locate(c, xDist, yDist) {\n    c = new Coordinate(c.x, c.y);\n    return this._locate(c, xDist, yDist);\n  },\n  _locate: function _locate(c, xDist, yDist) {\n    if (!c) {\n      return null;\n    }\n\n    if (!xDist) {\n      xDist = 0;\n    }\n\n    if (!yDist) {\n      yDist = 0;\n    }\n\n    if (!xDist && !yDist) {\n      return c;\n    }\n\n    c.x = c.x + xDist;\n    c.y = c.y + yDist;\n    return c;\n  },\n  rotate: function rotate(c, pivot, angle) {\n    c = new Coordinate(c.x, c.y);\n    return this._rotate(c, pivot, angle);\n  },\n  _rotate: function () {\n    var tmp = new Point(0, 0);\n    return function (c, pivot, angle) {\n      tmp.x = c.x - pivot.x;\n      tmp.y = c.y - pivot.y;\n\n      tmp._rotate(angle * Math.PI / 180);\n\n      c.x = pivot.x + tmp.x;\n      c.y = pivot.y + tmp.y;\n      return c;\n    };\n  }()\n}, Common$1);\n\nvar Sphere = function () {\n  function Sphere(radius) {\n    this.radius = radius;\n  }\n\n  var _proto = Sphere.prototype;\n\n  _proto.measureLenBetween = function measureLenBetween(c1, c2) {\n    if (!c1 || !c2) {\n      return 0;\n    }\n\n    var b = toRadian(c1.y);\n    var d = toRadian(c2.y),\n        e = b - d,\n        f = toRadian(c1.x) - toRadian(c2.x);\n    b = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(e / 2), 2) + Math.cos(b) * Math.cos(d) * Math.pow(Math.sin(f / 2), 2)));\n    b *= this.radius;\n    return Math.round(b * 1E5) / 1E5;\n  };\n\n  _proto.measureArea = function measureArea(coordinates) {\n    var a = toRadian(this.radius);\n    var b = 0,\n        c = coordinates,\n        d = c.length;\n\n    if (d < 3) {\n      return 0;\n    }\n\n    var i;\n\n    for (i = 0; i < d - 1; i++) {\n      var e = c[i],\n          f = c[i + 1];\n      b += e.x * a * Math.cos(toRadian(e.y)) * f.y * a - f.x * a * Math.cos(toRadian(f.y)) * e.y * a;\n    }\n\n    d = c[i];\n    c = c[0];\n    b += d.x * a * Math.cos(toRadian(d.y)) * c.y * a - c.x * a * Math.cos(toRadian(c.y)) * d.y * a;\n    return 0.5 * Math.abs(b);\n  };\n\n  _proto.locate = function locate(c, xDist, yDist) {\n    c = new Coordinate(c.x, c.y);\n    return this._locate(c, xDist, yDist);\n  };\n\n  _proto._locate = function _locate(c, xDist, yDist) {\n    if (!c) {\n      return null;\n    }\n\n    if (!xDist) {\n      xDist = 0;\n    }\n\n    if (!yDist) {\n      yDist = 0;\n    }\n\n    if (!xDist && !yDist) {\n      return c;\n    }\n\n    var x, y;\n    var ry = toRadian(c.y);\n\n    if (yDist !== 0) {\n      var dy = Math.abs(yDist);\n      var sy = Math.sin(dy / (2 * this.radius)) * 2;\n      ry = ry + sy * (yDist > 0 ? 1 : -1);\n      y = wrap(ry * 180 / Math.PI, -90, 90);\n    } else {\n      y = c.y;\n    }\n\n    if (xDist !== 0) {\n      var dx = Math.abs(xDist);\n      var rx = toRadian(c.x);\n      var sx = 2 * Math.sqrt(Math.pow(Math.sin(dx / (2 * this.radius)), 2) / Math.pow(Math.cos(ry), 2));\n      rx = rx + sx * (xDist > 0 ? 1 : -1);\n      x = wrap(rx * 180 / Math.PI, -180, 180);\n    } else {\n      x = c.x;\n    }\n\n    c.x = x;\n    c.y = y;\n    return c;\n  };\n\n  _proto.rotate = function rotate(c, pivot, angle) {\n    c = new Coordinate(c);\n    return this._rotate(c, pivot, angle);\n  };\n\n  _proto._rotate = function _rotate(c, pivot, angle) {\n    var initialAngle = rhumbBearing(pivot, c);\n    var finalAngle = initialAngle - angle;\n    var distance = this.measureLenBetween(pivot, c);\n    c.x = pivot.x;\n    c.y = pivot.y;\n    return calculateRhumbDestination(c, distance, finalAngle, this.radius);\n  };\n\n  return Sphere;\n}();\n\nfunction rhumbBearing(start, end, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var bear360;\n  if (options.final) bear360 = calculateRhumbBearing(end, start);else bear360 = calculateRhumbBearing(start, end);\n  var bear180 = bear360 > 180 ? -(360 - bear360) : bear360;\n  return bear180;\n}\n\nfunction calculateRhumbBearing(from, to) {\n  var phi1 = toRadian(from.y);\n  var phi2 = toRadian(to.y);\n  var deltaLambda = toRadian(to.x - from.x);\n  if (deltaLambda > Math.PI) deltaLambda -= 2 * Math.PI;\n  if (deltaLambda < -Math.PI) deltaLambda += 2 * Math.PI;\n  var deltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n  var theta = Math.atan2(deltaLambda, deltaPsi);\n  return (toDegree(theta) + 360) % 360;\n}\n\nfunction calculateRhumbDestination(origin, distance, bearing, radius) {\n  var delta = distance / radius;\n  var lambda1 = origin.x * Math.PI / 180;\n  var phi1 = toRadian(origin.y);\n  var theta = toRadian(bearing);\n  var DeltaPhi = delta * Math.cos(theta);\n  var phi2 = phi1 + DeltaPhi;\n  if (Math.abs(phi2) > Math.PI / 2) phi2 = phi2 > 0 ? Math.PI - phi2 : -Math.PI - phi2;\n  var DeltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n  var q = Math.abs(DeltaPsi) > 10e-12 ? DeltaPhi / DeltaPsi : Math.cos(phi1);\n  var DeltaLambda = delta * Math.sin(theta) / q;\n  var lambda2 = lambda1 + DeltaLambda;\n  origin.x = (lambda2 * 180 / Math.PI + 540) % 360 - 180;\n  origin.y = phi2 * 180 / Math.PI;\n  return origin;\n}\n\nvar WGS84Sphere = extend({\n  'measure': 'EPSG:4326',\n  sphere: new Sphere(6378137),\n  measureLenBetween: function measureLenBetween() {\n    return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n  },\n  measureArea: function measureArea() {\n    return this.sphere.measureArea.apply(this.sphere, arguments);\n  },\n  _locate: function _locate() {\n    return this.sphere._locate.apply(this.sphere, arguments);\n  },\n  locate: function locate() {\n    return this.sphere.locate.apply(this.sphere, arguments);\n  },\n  _rotate: function _rotate() {\n    return this.sphere._rotate.apply(this.sphere, arguments);\n  },\n  rotate: function rotate() {\n    return this.sphere.rotate.apply(this.sphere, arguments);\n  }\n}, Common$1);\nvar BaiduSphere = extend({\n  'measure': 'BAIDU',\n  sphere: new Sphere(6370996.81),\n  measureLenBetween: function measureLenBetween() {\n    return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n  },\n  measureArea: function measureArea() {\n    return this.sphere.measureArea.apply(this.sphere, arguments);\n  },\n  _locate: function _locate() {\n    return this.sphere._locate.apply(this.sphere, arguments);\n  },\n  locate: function locate() {\n    return this.sphere.locate.apply(this.sphere, arguments);\n  },\n  _rotate: function _rotate() {\n    return this.sphere._rotate.apply(this.sphere, arguments);\n  },\n  rotate: function rotate() {\n    return this.sphere.rotate.apply(this.sphere, arguments);\n  }\n}, Common$1);\n\nvar DEFAULT = WGS84Sphere;\nvar measurers = {};\n\nfunction registerMeasurer(m) {\n  measurers[m.measure] = m;\n}\n\nregisterMeasurer(Identity);\nregisterMeasurer(WGS84Sphere);\nregisterMeasurer(BaiduSphere);\nvar Measurer = {\n  getInstance: function getInstance(name) {\n    if (!name) {\n      return DEFAULT;\n    }\n\n    for (var p in measurers) {\n      if (hasOwn(measurers, p)) {\n        var mName = measurers[p]['measure'];\n\n        if (!mName) {\n          continue;\n        }\n\n        if (name.toLowerCase() === mName.toLowerCase()) {\n          return measurers[p];\n        }\n      }\n    }\n\n    return null;\n  }\n};\n\nvar index$2 = /*#__PURE__*/Object.freeze({\n  Identity: Identity,\n  DEFAULT: DEFAULT,\n  Measurer: Measurer,\n  WGS84Sphere: WGS84Sphere,\n  BaiduSphere: BaiduSphere\n});\n\nvar delta = 1E-7;\nvar EPSG3857 = extend({}, Common, {\n  code: 'EPSG:3857',\n  rad: Math.PI / 180,\n  metersPerDegree: 6378137 * Math.PI / 180,\n  maxLatitude: 85.0511287798,\n  project: function project(lnglat, out) {\n    var rad = this.rad,\n        metersPerDegree = this.metersPerDegree,\n        max = this.maxLatitude;\n    var lng = lnglat.x,\n        lat = Math.max(Math.min(max, lnglat.y), -max);\n    var c;\n\n    if (lat === 0) {\n      c = 0;\n    } else {\n      c = Math.log(Math.tan((90 + lat) * rad / 2)) / rad;\n    }\n\n    var x = lng * metersPerDegree;\n    var y = c * metersPerDegree;\n\n    if (out) {\n      out.x = x;\n      out.y = y;\n      return out;\n    }\n\n    return new Coordinate(x, y);\n  },\n  unproject: function unproject(pLnglat, out) {\n    var rad = this.rad;\n    var metersPerDegree = this.metersPerDegree;\n    var x = pLnglat.x / metersPerDegree;\n    var y = pLnglat.y;\n    var c;\n\n    if (y === 0) {\n      c = 0;\n    } else {\n      c = y / metersPerDegree;\n      c = (2 * Math.atan(Math.exp(c * rad)) - Math.PI / 2) / rad;\n    }\n\n    if (Math.abs(Math.abs(x) - 180) < delta) {\n      x = sign(x) * 180;\n    }\n\n    if (Math.abs(Math.abs(c) - this.maxLatitude) < delta) {\n      c = sign(c) * this.maxLatitude;\n    }\n\n    var rx = wrap(x, -180, 180);\n    var ry = wrap(c, -this.maxLatitude, this.maxLatitude);\n\n    if (out) {\n      out.x = rx;\n      out.y = ry;\n      return out;\n    }\n\n    return new Coordinate(rx, ry);\n  }\n}, WGS84Sphere);\n\nvar PROJ4326 = extend({}, Common, {\n  code: 'EPSG:4326',\n  project: function project(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return new Coordinate(p);\n  },\n  unproject: function unproject(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return new Coordinate(p);\n  }\n}, WGS84Sphere);\n\nvar Projection_EPSG4490 = extend({}, PROJ4326, {\n  code: 'EPSG:4490'\n});\n\nvar Projection_Baidu = extend({}, Common, {\n  code: 'BAIDU',\n  project: function project(p, out) {\n    return this.convertLL2MC(p, out);\n  },\n  unproject: function unproject(p, out) {\n    return this.convertMC2LL(p, out);\n  }\n}, BaiduSphere, {\n  EARTHRADIUS: 6370996.81,\n  MCBAND: [12890594.86, 8362377.87, 5591021, 3481989.83, 1678043.12, 0],\n  LLBAND: [75, 60, 45, 30, 15, 0],\n  MC2LL: [[1.410526172116255e-8, 0.00000898305509648872, -1.9939833816331, 200.9824383106796, -187.2403703815547, 91.6087516669843, -23.38765649603339, 2.57121317296198, -0.03801003308653, 17337981.2], [-7.435856389565537e-9, 0.000008983055097726239, -0.78625201886289, 96.32687599759846, -1.85204757529826, -59.36935905485877, 47.40033549296737, -16.50741931063887, 2.28786674699375, 10260144.86], [-3.030883460898826e-8, 0.00000898305509983578, 0.30071316287616, 59.74293618442277, 7.357984074871, -25.38371002664745, 13.45380521110908, -3.29883767235584, 0.32710905363475, 6856817.37], [-1.981981304930552e-8, 0.000008983055099779535, 0.03278182852591, 40.31678527705744, 0.65659298677277, -4.44255534477492, 0.85341911805263, 0.12923347998204, -0.04625736007561, 4482777.06], [3.09191371068437e-9, 0.000008983055096812155, 0.00006995724062, 23.10934304144901, -0.00023663490511, -0.6321817810242, -0.00663494467273, 0.03430082397953, -0.00466043876332, 2555164.4], [2.890871144776878e-9, 0.000008983055095805407, -3.068298e-8, 7.47137025468032, -0.00000353937994, -0.02145144861037, -0.00001234426596, 0.00010322952773, -0.00000323890364, 826088.5]],\n  LL2MC: [[-0.0015702102444, 111320.7020616939, 1704480524535203, -10338987376042340, 26112667856603880, -35149669176653700, 26595700718403920, -10725012454188240, 1800819912950474, 82.5], [0.0008277824516172526, 111320.7020463578, 647795574.6671607, -4082003173.641316, 10774905663.51142, -15171875531.51559, 12053065338.62167, -5124939663.577472, 913311935.9512032, 67.5], [0.00337398766765, 111320.7020202162, 4481351.045890365, -23393751.19931662, 79682215.47186455, -115964993.2797253, 97236711.15602145, -43661946.33752821, 8477230.501135234, 52.5], [0.00220636496208, 111320.7020209128, 51751.86112841131, 3796837.749470245, 992013.7397791013, -1221952.21711287, 1340652.697009075, -620943.6990984312, 144416.9293806241, 37.5], [-0.0003441963504368392, 111320.7020576856, 278.2353980772752, 2485758.690035394, 6070.750963243378, 54821.18345352118, 9540.606633304236, -2710.55326746645, 1405.483844121726, 22.5], [-0.0003218135878613132, 111320.7020701615, 0.00369383431289, 823725.6402795718, 0.46104986909093, 2351.343141331292, 1.58060784298199, 8.77738589078284, 0.37238884252424, 7.45]],\n  convertMC2LL: function convertMC2LL(cB, out) {\n    var cE;\n\n    for (var cD = 0, len = this.MCBAND.length; cD < len; cD++) {\n      if (Math.abs(cB.y) >= this.MCBAND[cD]) {\n        cE = this.MC2LL[cD];\n        break;\n      }\n    }\n\n    var T = this.convertor(cB, cE, out);\n    return T;\n  },\n  convertLL2MC: function convertLL2MC(T, out) {\n    var cD, cC, len;\n    T.x = this.getLoop(T.x, -180, 180);\n    T.y = this.getRange(T.y, -74, 74);\n    var cB = new Coordinate(T.x, T.y);\n\n    for (cC = 0, len = this.LLBAND.length; cC < len; cC++) {\n      if (cB.y >= this.LLBAND[cC]) {\n        cD = this.LL2MC[cC];\n        break;\n      }\n    }\n\n    if (!cD) {\n      for (cC = this.LLBAND.length - 1; cC >= 0; cC--) {\n        if (cB.y <= -this.LLBAND[cC]) {\n          cD = this.LL2MC[cC];\n          break;\n        }\n      }\n    }\n\n    var cE = this.convertor(T, cD, out);\n    return cE;\n  },\n  convertor: function convertor(cC, cD, out) {\n    if (!cC || !cD) {\n      return null;\n    }\n\n    var T = cD[0] + cD[1] * Math.abs(cC.x);\n    var cB = Math.abs(cC.y) / cD[9];\n    var cE = cD[2] + cD[3] * cB + cD[4] * cB * cB + cD[5] * cB * cB * cB + cD[6] * cB * cB * cB * cB + cD[7] * cB * cB * cB * cB * cB + cD[8] * cB * cB * cB * cB * cB * cB;\n    T *= cC.x < 0 ? -1 : 1;\n    cE *= cC.y < 0 ? -1 : 1;\n\n    if (out) {\n      out.x = T;\n      out.y = cE;\n      return out;\n    }\n\n    return new Coordinate(T, cE);\n  },\n  toRadians: function toRadians(T) {\n    return Math.PI * T / 180;\n  },\n  toDegrees: function toDegrees(T) {\n    return 180 * T / Math.PI;\n  },\n  getRange: function getRange(cC, cB, T) {\n    if (cB != null) {\n      cC = Math.max(cC, cB);\n    }\n\n    if (T != null) {\n      cC = Math.min(cC, T);\n    }\n\n    return cC;\n  },\n  getLoop: function getLoop(cC, cB, T) {\n    if (cC === Infinity) {\n      return T;\n    } else if (cC === -Infinity) {\n      return cB;\n    }\n\n    while (cC > T) {\n      cC -= T - cB;\n    }\n\n    while (cC < cB) {\n      cC += T - cB;\n    }\n\n    return cC;\n  }\n});\n\nvar Projection_IDENTITY = extend({}, Common, {\n  code: 'IDENTITY',\n  project: function project(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return p.copy();\n  },\n  unproject: function unproject(p, out) {\n    if (out) {\n      out.x = p.x;\n      out.y = p.y;\n      return out;\n    }\n\n    return p.copy();\n  }\n}, Identity);\n\nvar DEFAULT$1 = EPSG3857;\n\nvar projections = /*#__PURE__*/Object.freeze({\n  EPSG3857: EPSG3857,\n  DEFAULT: DEFAULT$1,\n  EPSG4326: PROJ4326,\n  EPSG4490: Projection_EPSG4490,\n  BAIDU: Projection_Baidu,\n  IDENTITY: Projection_IDENTITY,\n  Common: Common\n});\n\nvar Renderable = (function (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class.registerRenderer = function registerRenderer(name, clazz) {\n      var proto = this.prototype;\n      var parentProto = Object.getPrototypeOf(proto);\n\n      if (!proto._rendererClasses || proto._rendererClasses === parentProto._rendererClasses) {\n        proto._rendererClasses = proto._rendererClasses ? Object.create(proto._rendererClasses) : {};\n      }\n\n      proto._rendererClasses[name.toLowerCase()] = clazz;\n      return this;\n    };\n\n    _class.getRendererClass = function getRendererClass(name) {\n      var proto = this.prototype;\n\n      if (!proto._rendererClasses) {\n        return null;\n      }\n\n      return proto._rendererClasses[name.toLowerCase()];\n    };\n\n    return _class;\n  }(Base);\n});\n\nvar CanvasRenderer = function (_Class) {\n  _inheritsLoose(CanvasRenderer, _Class);\n\n  function CanvasRenderer(layer) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.layer = layer;\n    _this._painted = false;\n    _this._drawTime = 0;\n\n    _this.setToRedraw();\n\n    return _this;\n  }\n\n  var _proto = CanvasRenderer.prototype;\n\n  _proto.render = function render(framestamp) {\n    this.prepareRender();\n\n    if (!this.getMap() || !this.layer.isVisible()) {\n      return;\n    }\n\n    if (!this.resources) {\n      this.resources = new ResourceCache();\n    }\n\n    this.checkAndDraw(this._tryToDraw, framestamp);\n  };\n\n  _proto.checkAndDraw = function checkAndDraw(drawFn) {\n    var _this2 = this;\n\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (this.checkResources) {\n      var resources = this.checkResources();\n\n      if (resources.length > 0) {\n        this._loadingResource = true;\n        this.loadResources(resources).then(function () {\n          _this2._loadingResource = false;\n\n          if (_this2.layer) {\n            _this2.layer.fire('resourceload');\n\n            _this2.setToRedraw();\n          }\n        });\n      } else {\n        drawFn.call.apply(drawFn, [this].concat(args));\n      }\n    } else {\n      drawFn.call.apply(drawFn, [this].concat(args));\n    }\n  };\n\n  _proto.testIfNeedRedraw = function testIfNeedRedraw() {\n    var map = this.getMap();\n\n    if (this._loadingResource) {\n      return false;\n    }\n\n    if (this._toRedraw) {\n      return true;\n    }\n\n    if (map.isInteracting() && !this.drawOnInteracting) {\n      return false;\n    }\n\n    if (this.needToRedraw()) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isInteracting() || map.getRenderer().isViewChanged()) {\n      return !(!map.getPitch() && map.isMoving() && !map.isZooming() && !map.isRotating() && !this.layer.options['forceRenderOnMoving']);\n    }\n\n    return false;\n  };\n\n  _proto.onSkipDrawOnInteracting = function onSkipDrawOnInteracting() {};\n\n  _proto.isLoadingResource = function isLoadingResource() {\n    return this._loadingResource;\n  };\n\n  _proto.isRenderComplete = function isRenderComplete() {\n    return !!this._renderComplete;\n  };\n\n  _proto.mustRenderOnInteracting = function mustRenderOnInteracting() {\n    return !this._painted;\n  };\n\n  _proto.setToRedraw = function setToRedraw() {\n    this._toRedraw = true;\n    return this;\n  };\n\n  _proto.setCanvasUpdated = function setCanvasUpdated() {\n    this._canvasUpdated = true;\n    return this;\n  };\n\n  _proto.isCanvasUpdated = function isCanvasUpdated() {\n    return !!this._canvasUpdated;\n  };\n\n  _proto.remove = function remove() {\n    this.onRemove();\n    delete this._loadingResource;\n    delete this.southWest;\n    delete this.canvas;\n    delete this.context;\n    delete this.canvasExtent2D;\n    delete this._extent2D;\n    delete this.resources;\n    delete this.layer;\n  };\n\n  _proto.onRemove = function onRemove() {};\n\n  _proto.onAdd = function onAdd() {};\n\n  _proto.getMap = function getMap() {\n    if (!this.layer) {\n      return null;\n    }\n\n    return this.layer.getMap();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    var map = this.getMap();\n    this._canvasUpdated = false;\n\n    if (this._renderZoom !== map.getZoom() || !this.canvas || !this._extent2D) {\n      return null;\n    }\n\n    if (this.isBlank()) {\n      return null;\n    }\n\n    if (this.layer.isEmpty && this.layer.isEmpty()) {\n      return null;\n    }\n\n    var containerPoint = map._pointToContainerPoint(this.southWest)._add(0, -map.height);\n\n    return {\n      'image': this.canvas,\n      'layer': this.layer,\n      'point': containerPoint\n    };\n  };\n\n  _proto.clear = function clear() {\n    this.clearCanvas();\n  };\n\n  _proto.isBlank = function isBlank() {\n    if (!this._painted) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.show = function show() {\n    this.setToRedraw();\n  };\n\n  _proto.hide = function hide() {\n    this.clear();\n    this.setToRedraw();\n  };\n\n  _proto.setZIndex = function setZIndex() {\n    this.setToRedraw();\n  };\n\n  _proto.hitDetect = function hitDetect(point) {\n    if (!this.context || this.layer.isEmpty && this.layer.isEmpty() || this.isBlank() || this._errorThrown) {\n      return false;\n    }\n\n    var map = this.getMap();\n    var r = map.getDevicePixelRatio();\n    var size = map.getSize();\n\n    if (point.x < 0 || point.x > size['width'] * r || point.y < 0 || point.y > size['height'] * r) {\n      return false;\n    }\n\n    try {\n      var imgData = this.context.getImageData(r * point.x, r * point.y, 1, 1).data;\n\n      if (imgData[3] > 0) {\n        return true;\n      }\n    } catch (error) {\n      if (!this._errorThrown) {\n        if (console) {\n          console.warn('hit detect failed with tainted canvas, some geometries have external resources in another domain:\\n', error);\n        }\n\n        this._errorThrown = true;\n      }\n\n      return false;\n    }\n\n    return false;\n  };\n\n  _proto.loadResources = function loadResources(resourceUrls) {\n    if (!this.resources) {\n      this.resources = new ResourceCache();\n    }\n\n    var resources = this.resources,\n        promises = [];\n\n    if (isArrayHasData(resourceUrls)) {\n      var cache = {};\n\n      for (var i = resourceUrls.length - 1; i >= 0; i--) {\n        var url = resourceUrls[i];\n\n        if (!url || !url.length || cache[url.join('-')]) {\n          continue;\n        }\n\n        cache[url.join('-')] = 1;\n\n        if (!resources.isResourceLoaded(url, true)) {\n          promises.push(new Promise$1(this._promiseResource(url)));\n        }\n      }\n    }\n\n    return Promise$1.all(promises);\n  };\n\n  _proto.prepareRender = function prepareRender() {\n    delete this._renderComplete;\n    var map = this.getMap();\n    this._renderZoom = map.getZoom();\n    this.canvasExtent2D = this._extent2D = map._get2DExtent();\n    this.southWest = map._containerPointToPoint(new Point(0, map.height));\n  };\n\n  _proto.createCanvas = function createCanvas() {\n    if (this.canvas) {\n      return;\n    }\n\n    var map = this.getMap();\n    var size = map.getSize();\n    var r = map.getDevicePixelRatio(),\n        w = r * size.width,\n        h = r * size.height;\n\n    if (this.layer._canvas) {\n      var canvas = this.layer._canvas;\n      canvas.width = w;\n      canvas.height = h;\n\n      if (canvas.style) {\n        canvas.style.width = size.width + 'px';\n        canvas.style.height = size.height + 'px';\n      }\n\n      this.canvas = this.layer._canvas;\n    } else {\n      this.canvas = Canvas.createCanvas(w, h, map.CanvasClass);\n    }\n\n    this.onCanvasCreate();\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {};\n\n  _proto.createContext = function createContext() {\n    if (this.gl && this.gl.canvas === this.canvas || this.context) {\n      return;\n    }\n\n    this.context = this.canvas.getContext('2d');\n\n    if (!this.context) {\n      return;\n    }\n\n    if (this.layer.options['globalCompositeOperation']) {\n      this.context.globalCompositeOperation = this.layer.options['globalCompositeOperation'];\n    }\n\n    var dpr = this.getMap().getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      this.context.scale(dpr, dpr);\n    }\n  };\n\n  _proto.resetCanvasTransform = function resetCanvasTransform() {\n    if (!this.context) {\n      return;\n    }\n\n    var dpr = this.getMap().getDevicePixelRatio();\n    this.context.setTransform(dpr, 0, 0, dpr, 0, 0);\n  };\n\n  _proto.resizeCanvas = function resizeCanvas(canvasSize) {\n    var canvas = this.canvas;\n\n    if (!canvas) {\n      return;\n    }\n\n    var size = canvasSize || this.getMap().getSize();\n    var r = this.getMap().getDevicePixelRatio();\n\n    if (canvas.width === r * size.width && canvas.height === r * size.height) {\n      return;\n    }\n\n    canvas.height = r * size.height;\n    canvas.width = r * size.width;\n\n    if (r !== 1 && this.context) {\n      this.context.scale(r, r);\n    }\n\n    if (this.layer._canvas && canvas.style) {\n      canvas.style.width = size.width + 'px';\n      canvas.style.height = size.height + 'px';\n    }\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.context) {\n      return;\n    }\n\n    Canvas.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  _proto.prepareCanvas = function prepareCanvas() {\n    if (!this.canvas) {\n      this.createCanvas();\n      this.createContext();\n      this.layer.onCanvasCreate();\n      this.layer.fire('canvascreate', {\n        'context': this.context,\n        'gl': this.gl\n      });\n    } else {\n      this.resetCanvasTransform();\n      this.clearCanvas();\n      this.resizeCanvas();\n    }\n\n    delete this._maskExtent;\n    var mask = this.layer.getMask();\n\n    if (!mask) {\n      this.layer.fire('renderstart', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      return null;\n    }\n\n    var maskExtent2D = this._maskExtent = mask._getPainter().get2DExtent();\n\n    if (!maskExtent2D.intersects(this._extent2D)) {\n      this.layer.fire('renderstart', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      return maskExtent2D;\n    }\n\n    this.layer.fire('renderstart', {\n      'context': this.context,\n      'gl': this.gl\n    });\n    return maskExtent2D;\n  };\n\n  _proto.clipCanvas = function clipCanvas(context) {\n    var mask = this.layer.getMask();\n\n    if (!mask) {\n      return false;\n    }\n\n    var old = this.southWest;\n    var map = this.getMap();\n    this.southWest = map._containerPointToPoint(new Point(0, map.height));\n    context.save();\n    var dpr = map.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      context.save();\n      context.scale(dpr, dpr);\n    }\n\n    if (mask.getGeometries) {\n      context.isMultiClip = true;\n      var masks = mask.getGeometries() || [];\n      context.beginPath();\n      masks.forEach(function (_mask) {\n        var painter = _mask._getPainter();\n\n        painter.paint(null, context);\n      });\n      context.stroke();\n      delete context.isMultiClip;\n    } else {\n      var painter = mask._getPainter();\n\n      painter.paint(null, context);\n    }\n\n    if (dpr !== 1) {\n      context.restore();\n    }\n\n    context.clip();\n    this.southWest = old;\n    return true;\n  };\n\n  _proto.getViewExtent = function getViewExtent() {\n    return {\n      'extent': this._extent2D,\n      'maskExtent': this._maskExtent,\n      'zoom': this._renderZoom,\n      'southWest': this.southWest\n    };\n  };\n\n  _proto.completeRender = function completeRender() {\n    if (this.getMap()) {\n      this._renderComplete = true;\n      this.layer.fire('renderend', {\n        'context': this.context,\n        'gl': this.gl\n      });\n      this.setCanvasUpdated();\n    }\n  };\n\n  _proto.getEvents = function getEvents() {\n    return {\n      '_zoomstart': this.onZoomStart,\n      '_zooming': this.onZooming,\n      '_zoomend': this.onZoomEnd,\n      '_resize': this.onResize,\n      '_movestart': this.onMoveStart,\n      '_moving': this.onMoving,\n      '_moveend': this.onMoveEnd,\n      '_dragrotatestart': this.onDragRotateStart,\n      '_dragrotating': this.onDragRotating,\n      '_dragrotateend': this.onDragRotateEnd,\n      '_spatialreferencechange': this.onSpatialReferenceChange\n    };\n  };\n\n  _proto.onZoomStart = function onZoomStart() {};\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onZooming = function onZooming() {};\n\n  _proto.onMoveStart = function onMoveStart() {};\n\n  _proto.onMoving = function onMoving() {};\n\n  _proto.onMoveEnd = function onMoveEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onResize = function onResize() {\n    delete this._extent2D;\n    this.resizeCanvas();\n    this.setToRedraw();\n  };\n\n  _proto.onDragRotateStart = function onDragRotateStart() {};\n\n  _proto.onDragRotating = function onDragRotating() {};\n\n  _proto.onDragRotateEnd = function onDragRotateEnd() {\n    this.setToRedraw();\n  };\n\n  _proto.onSpatialReferenceChange = function onSpatialReferenceChange() {};\n\n  _proto.getDrawTime = function getDrawTime() {\n    return this._drawTime;\n  };\n\n  _proto._tryToDraw = function _tryToDraw(framestamp) {\n    this._toRedraw = false;\n\n    if (!this.canvas && this.layer.isEmpty && this.layer.isEmpty()) {\n      this._renderComplete = true;\n      return;\n    }\n\n    this._drawAndRecord(framestamp);\n  };\n\n  _proto._drawAndRecord = function _drawAndRecord(framestamp) {\n    if (!this.getMap()) {\n      return;\n    }\n\n    var painted = this._painted;\n    this._painted = true;\n    var t = now();\n    this.draw(framestamp);\n    t = now() - t;\n    this._drawTime = painted ? t : t / 2;\n\n    if (painted && this.layer && this.layer.options['logDrawTime']) {\n      console.log(this.layer.getId(), 'frameTimeStamp:', framestamp, 'drawTime:', this._drawTime);\n    }\n  };\n\n  _proto._promiseResource = function _promiseResource(url) {\n    var me = this,\n        resources = this.resources,\n        crossOrigin = this.layer.options['crossOrigin'];\n    return function (resolve) {\n      if (resources.isResourceLoaded(url, true)) {\n        resolve(url);\n        return;\n      }\n\n      var img = new Image();\n\n      if (!isNil(crossOrigin)) {\n        img['crossOrigin'] = crossOrigin;\n      }\n\n      if (isSVG(url[0]) && !IS_NODE) {\n        if (url[1]) {\n          url[1] *= 2;\n        }\n\n        if (url[2]) {\n          url[2] *= 2;\n        }\n      }\n\n      img.onload = function () {\n        me._cacheResource(url, img);\n\n        resolve(url);\n      };\n\n      img.onabort = function (err) {\n        if (console) {\n          console.warn('image loading aborted: ' + url[0]);\n        }\n\n        if (err) {\n          if (console) {\n            console.warn(err);\n          }\n        }\n\n        resolve(url);\n      };\n\n      img.onerror = function (err) {\n        if (err && typeof console !== 'undefined') {\n          console.warn(err);\n        }\n\n        resources.markErrorResource(url);\n        resolve(url);\n      };\n\n      loadImage(img, url);\n    };\n  };\n\n  _proto._cacheResource = function _cacheResource(url, img) {\n    if (!this.layer || !this.resources) {\n      return;\n    }\n\n    var w = url[1],\n        h = url[2];\n\n    if (this.layer.options['cacheSvgOnCanvas'] && isSVG(url[0]) === 1 && (Browser$1.edge || Browser$1.ie)) {\n      if (isNil(w)) {\n        w = img.width || this.layer.options['defaultIconSize'][0];\n      }\n\n      if (isNil(h)) {\n        h = img.height || this.layer.options['defaultIconSize'][1];\n      }\n\n      var canvas = Canvas.createCanvas(w, h);\n      Canvas.image(canvas.getContext('2d'), img, 0, 0, w, h);\n      img = canvas;\n    }\n\n    this.resources.addResource(url, img);\n  };\n\n  return CanvasRenderer;\n}(Class);\nvar ResourceCache = function () {\n  function ResourceCache() {\n    this.resources = {};\n    this._errors = {};\n  }\n\n  var _proto2 = ResourceCache.prototype;\n\n  _proto2.addResource = function addResource(url, img) {\n    this.resources[url[0]] = {\n      image: img,\n      width: +url[1],\n      height: +url[2]\n    };\n  };\n\n  _proto2.isResourceLoaded = function isResourceLoaded(url, checkSVG) {\n    if (!url) {\n      return false;\n    }\n\n    var imgUrl = this._getImgUrl(url);\n\n    if (this._errors[imgUrl]) {\n      return true;\n    }\n\n    var img = this.resources[imgUrl];\n\n    if (!img) {\n      return false;\n    }\n\n    if (checkSVG && isSVG(url[0]) && (+url[1] > img.width || +url[2] > img.height)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto2.getImage = function getImage(url) {\n    var imgUrl = this._getImgUrl(url);\n\n    if (!this.isResourceLoaded(url) || this._errors[imgUrl]) {\n      return null;\n    }\n\n    return this.resources[imgUrl].image;\n  };\n\n  _proto2.markErrorResource = function markErrorResource(url) {\n    this._errors[this._getImgUrl(url)] = 1;\n  };\n\n  _proto2.merge = function merge(res) {\n    if (!res) {\n      return this;\n    }\n\n    for (var p in res.resources) {\n      var img = res.resources[p];\n      this.addResource([p, img.width, img.height], img.image);\n    }\n\n    return this;\n  };\n\n  _proto2.forEach = function forEach(fn) {\n    if (!this.resources) {\n      return this;\n    }\n\n    for (var p in this.resources) {\n      if (hasOwn(this.resources, p)) {\n        fn(p, this.resources[p]);\n      }\n    }\n\n    return this;\n  };\n\n  _proto2._getImgUrl = function _getImgUrl(url) {\n    if (!Array.isArray(url)) {\n      return url;\n    }\n\n    return url[0];\n  };\n\n  return ResourceCache;\n}();\n\nfunction clipLine(points, bounds, round, noCut) {\n  var parts = [];\n  var k = 0,\n      segment;\n\n  for (var j = 0, l = points.length; j < l - 1; j++) {\n    segment = clipSegment(points[j], points[j + 1], bounds, j, round, noCut);\n\n    if (!segment) {\n      continue;\n    }\n\n    parts[k] = parts[k] || [];\n    parts[k].push({\n      'point': segment[0],\n      'index': j\n    });\n\n    if (segment[1] !== points[j + 1] || j === l - 2) {\n      parts[k].push({\n        'point': segment[1],\n        'index': j + 1\n      });\n      k++;\n    }\n  }\n\n  return parts;\n}\n\nvar _lastCode;\n\nfunction clipSegment(a, b, bounds, useLastCode, round, noCut) {\n  var codeA = useLastCode ? _lastCode : _getBitCode(a, bounds),\n      codeB = _getBitCode(b, bounds),\n      codeOut,\n      p,\n      newCode;\n\n  _lastCode = codeB;\n\n  while (true) {\n    if (!(codeA | codeB)) {\n      return [a, b];\n    }\n\n    if (codeA & codeB) {\n      return false;\n    }\n\n    if (noCut) {\n      return [a, b];\n    }\n\n    codeOut = codeA || codeB;\n    p = _getEdgeIntersection(a, b, codeOut, bounds, round);\n    newCode = _getBitCode(p, bounds);\n\n    if (codeOut === codeA) {\n      a = p;\n      codeA = newCode;\n    } else {\n      b = p;\n      codeB = newCode;\n    }\n  }\n}\nfunction clipPolygon(points, bounds, round) {\n  var edges = [1, 4, 2, 8];\n  var clippedPoints, i, j, k, a, b, len, edge, p;\n\n  for (i = 0, len = points.length; i < len; i++) {\n    points[i]._code = _getBitCode(points[i], bounds);\n  }\n\n  for (k = 0; k < 4; k++) {\n    edge = edges[k];\n    clippedPoints = [];\n\n    for (i = 0, len = points.length, j = len - 1; i < len; j = i++) {\n      a = points[i];\n      b = points[j];\n\n      if (!(a._code & edge)) {\n        if (b._code & edge) {\n          p = _getEdgeIntersection(b, a, edge, bounds, round);\n          p._code = _getBitCode(p, bounds);\n          clippedPoints.push(p);\n        }\n\n        clippedPoints.push(a);\n      } else if (!(b._code & edge)) {\n        p = _getEdgeIntersection(b, a, edge, bounds, round);\n        p._code = _getBitCode(p, bounds);\n        clippedPoints.push(p);\n      }\n    }\n\n    points = clippedPoints;\n  }\n\n  return points;\n}\n\nfunction _getEdgeIntersection(a, b, code, bounds, round) {\n  var dx = b.x - a.x,\n      dy = b.y - a.y,\n      min = bounds.getMin(),\n      max = bounds.getMax();\n  var x, y;\n\n  if (code & 8) {\n    x = a.x + dx * (max.y - a.y) / dy;\n    y = max.y;\n  } else if (code & 4) {\n    x = a.x + dx * (min.y - a.y) / dy;\n    y = min.y;\n  } else if (code & 2) {\n    x = max.x;\n    y = a.y + dy * (max.x - a.x) / dx;\n  } else if (code & 1) {\n    x = min.x;\n    y = a.y + dy * (min.x - a.x) / dx;\n  }\n\n  var p = new Point(x, y);\n\n  if (round) {\n    p._round();\n  }\n\n  return p;\n}\n\nfunction _getBitCode(p, bounds) {\n  var code = 0;\n\n  if (p.x < bounds.getMin().x) {\n    code |= 1;\n  } else if (p.x > bounds.getMax().x) {\n    code |= 2;\n  }\n\n  if (p.y < bounds.getMin().y) {\n    code |= 4;\n  } else if (p.y > bounds.getMax().y) {\n    code |= 8;\n  }\n\n  return code;\n}\n\nfunction withInEllipse(point, center, southeast, tolerance) {\n  point = new Point(point);\n  var a = Math.abs(southeast.x - center.x),\n      b = Math.abs(southeast.y - center.y),\n      c = Math.sqrt(Math.abs(a * a - b * b)),\n      xfocus = a >= b;\n  var f1, f2, d;\n\n  if (xfocus) {\n    f1 = new Point(center.x - c, center.y);\n    f2 = new Point(center.x + c, center.y);\n    d = a * 2;\n  } else {\n    f1 = new Point(center.x, center.y - c);\n    f2 = new Point(center.x, center.y + c);\n    d = b * 2;\n  }\n\n  return point.distanceTo(f1) + point.distanceTo(f2) <= d + 2 * tolerance;\n}\n\nvar Symbolizer = function () {\n  function Symbolizer() {}\n\n  var _proto = Symbolizer.prototype;\n\n  _proto.getMap = function getMap() {\n    return this.geometry.getMap();\n  };\n\n  _proto.getPainter = function getPainter() {\n    return this.painter;\n  };\n\n  _proto.isDynamicSize = function isDynamicSize() {\n    return false;\n  };\n\n  Symbolizer.testColor = function testColor(prop) {\n    if (!prop || !isString(prop)) {\n      return false;\n    }\n\n    if (COLOR_PROPERTIES.indexOf(prop) >= 0) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return Symbolizer;\n}();\n\nvar CanvasSymbolizer = function (_Symbolizer) {\n  _inheritsLoose(CanvasSymbolizer, _Symbolizer);\n\n  function CanvasSymbolizer() {\n    return _Symbolizer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasSymbolizer.prototype;\n\n  _proto._prepareContext = function _prepareContext(ctx) {\n    if (isNumber(this.symbol['opacity'])) {\n      if (ctx.globalAlpha !== this.symbol['opacity']) {\n        ctx.globalAlpha = this.symbol['opacity'];\n      }\n    } else if (ctx.globalAlpha !== 1) {\n      ctx.globalAlpha = 1;\n    }\n  };\n\n  _proto.prepareCanvas = function prepareCanvas(ctx, style, resources) {\n    Canvas.prepareCanvas(ctx, style, resources, this.getPainter().isHitTesting());\n  };\n\n  _proto.remove = function remove() {};\n\n  _proto.setZIndex = function setZIndex() {};\n\n  _proto.show = function show() {};\n\n  _proto.hide = function hide() {};\n\n  _proto._defineStyle = function _defineStyle(style) {\n    return function () {\n      var _this = this;\n\n      var arr = [],\n          prop = {};\n      return loadFunctionTypes(style, function () {\n        var map = _this.getMap();\n\n        return set$1(arr, map.getZoom(), extend({}, _this.geometry.getProperties(), setProp(prop, map.getBearing(), map.getPitch(), map.getZoom())));\n      });\n    }.bind(this)();\n  };\n\n  return CanvasSymbolizer;\n}(Symbolizer);\n\nfunction set$1(arr, a0, a1) {\n  arr[0] = a0;\n  arr[1] = a1;\n  return arr;\n}\n\nfunction setProp(prop, b, p, z) {\n  prop['{bearing}'] = b;\n  prop['{pitch}'] = p;\n  prop['{zoom}'] = z;\n  return prop;\n}\n\nvar TEMP_POINT0$1 = new Point(0, 0);\nvar TEMP_POINT1 = new Point(0, 0);\n\nvar PointSymbolizer = function (_CanvasSymbolizer) {\n  _inheritsLoose(PointSymbolizer, _CanvasSymbolizer);\n\n  function PointSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _CanvasSymbolizer.call(this) || this;\n    _this.symbol = symbol;\n    _this.geometry = geometry;\n    _this.painter = painter;\n    return _this;\n  }\n\n  var _proto = PointSymbolizer.prototype;\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n    var glZoom = map.getGLZoom();\n    var extent = new PointExtent();\n\n    var renderPoints = this._getRenderPoints()[0];\n\n    for (var i = renderPoints.length - 1; i >= 0; i--) {\n      if (renderPoints[i]) {\n        extent._combine(map._pointToPoint(renderPoints[i], glZoom));\n      }\n    }\n\n    return extent;\n  };\n\n  _proto.isDynamicSize = function isDynamicSize() {\n    var symbol = this.symbol;\n    return isFunctionDefinition(symbol['markerWidth']) || isFunctionDefinition(symbol['markerHeight']) || isFunctionDefinition(symbol['textSize']);\n  };\n\n  _proto._rotateExtent = function _rotateExtent(fixedExtent, angle) {\n    return fixedExtent.convertTo(function (p) {\n      return p._rotate(angle);\n    });\n  };\n\n  _proto._getRenderPoints = function _getRenderPoints() {\n    var painter = this.getPainter();\n    var placement = painter.isSpriting() ? 'center' : this.getPlacement();\n    return this.getPainter().getRenderPoints(placement);\n  };\n\n  _proto._getRenderContainerPoints = function _getRenderContainerPoints(ignoreAltitude) {\n    var painter = this.getPainter(),\n        points = this._getRenderPoints()[0];\n\n    if (painter.isSpriting()) {\n      return points;\n    }\n\n    var dxdy = this.getDxDy();\n\n    var cpoints = this.painter._pointContainerPoints(points, dxdy.x, dxdy.y, ignoreAltitude, true, this.getPlacement());\n\n    if (!cpoints || !Array.isArray(cpoints[0])) {\n      return cpoints;\n    }\n\n    var flat = [];\n\n    for (var i = 0, l = cpoints.length; i < l; i++) {\n      for (var ii = 0, ll = cpoints[i].length; ii < ll; ii++) {\n        flat.push(cpoints[i][ii]);\n      }\n    }\n\n    return flat;\n  };\n\n  _proto._getRotationAt = function _getRotationAt(i) {\n    var r = this.getRotation();\n\n    if (!r) {\n      r = 0;\n    }\n\n    var rotations = this._getRenderPoints()[1];\n\n    if (!rotations || !rotations[i]) {\n      return r;\n    }\n\n    var map = this.getMap();\n    var p0 = rotations[i][0],\n        p1 = rotations[i][1];\n\n    if (map.isTransforming()) {\n      var maxZoom = map.getGLZoom();\n      p0 = map._pointToContainerPoint(rotations[i][0], maxZoom, 0, TEMP_POINT0$1);\n      p1 = map._pointToContainerPoint(rotations[i][1], maxZoom, 0, TEMP_POINT1);\n      return r + computeDegree(p0.x, p0.y, p1.x, p1.y);\n    } else {\n      return r + -computeDegree(p0.x, p0.y, p1.x, p1.y);\n    }\n  };\n\n  _proto._rotate = function _rotate(ctx, origin, rotation) {\n    if (rotation) {\n      var dxdy = this.getDxDy();\n      var p = origin.sub(dxdy);\n      ctx.save();\n      ctx.translate(p.x, p.y);\n      ctx.rotate(rotation);\n      return this.getDxDy();\n    }\n\n    return null;\n  };\n\n  return PointSymbolizer;\n}(CanvasSymbolizer);\n\nvar VectorMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(VectorMarkerSymbolizer, _PointSymbolizer);\n\n  VectorMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (isNil(symbol['markerFile']) && !isNil(symbol['markerType']) && symbol['markerType'] !== 'path') {\n      return true;\n    }\n\n    return false;\n  };\n\n  function VectorMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this._dynamic = hasFunctionDefinition(symbol);\n    _this.style = _this._defineStyle(_this.translate());\n    _this.strokeAndFill = _this._defineStyle(VectorMarkerSymbolizer.translateLineAndFill(_this.style));\n    var lineWidth = _this.strokeAndFill['lineWidth'];\n\n    if (lineWidth % 2 === 0) {\n      _this.padding = 2;\n    } else {\n      _this.padding = 1.5;\n    }\n\n    return _this;\n  }\n\n  var _proto = VectorMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['polygonOpacity'] === 0 && style['lineOpacity'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    if (this.getPainter().isSpriting() || this.geometry.getLayer().getMask() === this.geometry || this._dynamic || this.geometry.getLayer().options['cacheVectorOnCanvas'] === false) {\n      this._drawMarkers(ctx, cookedPoints, resources);\n    } else {\n      this._drawMarkersWithCache(ctx, cookedPoints, resources);\n    }\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    var dx = s['markerDx'],\n        dy = s['markerDy'];\n    return new Point(dx, dy);\n  };\n\n  _proto._drawMarkers = function _drawMarkers(ctx, cookedPoints, resources) {\n    var strokeAndFill = this.strokeAndFill;\n    var gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n\n    if (!gradient) {\n      this.prepareCanvas(ctx, strokeAndFill, resources);\n    }\n\n    for (var i = cookedPoints.length - 1; i >= 0; i--) {\n      var point = cookedPoints[i];\n\n      var origin = this._rotate(ctx, point, this._getRotationAt(i));\n\n      if (origin) {\n        point = origin;\n      }\n\n      this._drawVectorMarker(ctx, point, resources);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto._drawMarkersWithCache = function _drawMarkersWithCache(ctx, cookedPoints, resources) {\n    var stamp = this._stampSymbol();\n\n    var image = resources.getImage(stamp);\n\n    if (!image) {\n      image = this._createMarkerImage(ctx, resources);\n      resources.addResource([stamp, image.width, image.height], image);\n    }\n\n    var anchor = this._getAnchor(image.width, image.height);\n\n    for (var i = cookedPoints.length - 1; i >= 0; i--) {\n      var point = cookedPoints[i];\n\n      var origin = this._rotate(ctx, point, this._getRotationAt(i));\n\n      if (origin) {\n        point = origin;\n      }\n\n      Canvas.image(ctx, image, point.x + anchor.x, point.y + anchor.y);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto._calMarkerSize = function _calMarkerSize() {\n    if (!this._size) {\n      var lineWidth = this.strokeAndFill['lineWidth'],\n          shadow = 2 * (this.symbol['shadowBlur'] || 0),\n          w = Math.round(this.style['markerWidth'] + lineWidth + 2 * shadow + this.padding * 2),\n          h = Math.round(this.style['markerHeight'] + lineWidth + 2 * shadow + this.padding * 2);\n\n      if (isFunctionDefinition(this.symbol['markerWidth']) || isFunctionDefinition(this.symbol['markerHeight'])) {\n        return [w, h];\n      }\n\n      this._size = [w, h];\n    }\n\n    return this._size;\n  };\n\n  _proto._createMarkerImage = function _createMarkerImage(ctx, resources) {\n    var canvasClass = ctx.canvas.constructor,\n        size = this._calMarkerSize(),\n        canvas = Canvas.createCanvas(size[0], size[1], canvasClass),\n        point = this._getCacheImageAnchor(size[0], size[1]);\n\n    var context = canvas.getContext('2d');\n    var gradient = isGradient(this.strokeAndFill['lineColor']) || isGradient(this.strokeAndFill['polygonFill']);\n\n    if (!gradient) {\n      this.prepareCanvas(context, this.strokeAndFill, resources);\n    }\n\n    this._drawVectorMarker(context, point, resources);\n\n    return canvas;\n  };\n\n  _proto._stampSymbol = function _stampSymbol() {\n    if (!this._stamp) {\n      this._stamp = [this.style['markerType'], isGradient(this.style['markerFill']) ? getGradientStamp(this.style['markerFill']) : this.style['markerFill'], this.style['markerFillOpacity'], this.style['markerFillPatternFile'], isGradient(this.style['markerLineColor']) ? getGradientStamp(this.style['markerLineColor']) : this.style['markerLineColor'], this.style['markerLineWidth'], this.style['markerLineOpacity'], this.style['markerLineDasharray'] ? this.style['markerLineDasharray'].join(',') : '', this.style['markerLinePatternFile'], this.style['markerWidth'], this.style['markerHeight'], this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']].join('_');\n    }\n\n    return this._stamp;\n  };\n\n  _proto._getAnchor = function _getAnchor(w, h) {\n    var shadow = 2 * (this.symbol['shadowBlur'] || 0),\n        margin = shadow + this.padding;\n    var p = getAlignPoint(new Size(w, h), this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']);\n\n    if (p.x !== -w / 2) {\n      p.x -= sign(p.x + w / 2) * margin;\n    }\n\n    if (p.y !== -h / 2) {\n      p.y -= sign(p.y + h / 2) * margin;\n    }\n\n    return p;\n  };\n\n  _proto._getCacheImageAnchor = function _getCacheImageAnchor(w, h) {\n    var shadow = 2 * (this.symbol['shadowBlur'] || 0),\n        margin = shadow + this.padding;\n    var markerType = this.style['markerType'];\n\n    if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n      return new Point(w / 2, h - margin);\n    } else if (markerType === 'rectangle') {\n      return new Point(margin, margin);\n    } else {\n      return new Point(w / 2, h / 2);\n    }\n  };\n\n  _proto._getGraidentExtent = function _getGraidentExtent(points) {\n    var e = new PointExtent(),\n        dxdy = this.getDxDy(),\n        m = this.getFixedExtent();\n\n    if (Array.isArray(points)) {\n      for (var i = points.length - 1; i >= 0; i--) {\n        e._combine(points[i]);\n      }\n    } else {\n      e._combine(points);\n    }\n\n    e['xmin'] += m['xmin'] - dxdy.x;\n    e['ymin'] += m['ymin'] - dxdy.y;\n    e['xmax'] += m['xmax'] - dxdy.x;\n    e['ymax'] += m['ymax'] - dxdy.y;\n    return e;\n  };\n\n  _proto._drawVectorMarker = function _drawVectorMarker(ctx, point, resources) {\n    var style = this.style,\n        strokeAndFill = this.strokeAndFill,\n        markerType = style['markerType'].toLowerCase(),\n        vectorArray = VectorMarkerSymbolizer._getVectorPoints(markerType, style['markerWidth'], style['markerHeight']),\n        lineOpacity = strokeAndFill['lineOpacity'],\n        fillOpacity = strokeAndFill['polygonOpacity'];\n\n    var gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n\n    if (gradient) {\n      var gradientExtent;\n\n      if (isGradient(strokeAndFill['lineColor'])) {\n        gradientExtent = this._getGraidentExtent(point);\n        strokeAndFill['lineGradientExtent'] = gradientExtent.expand(strokeAndFill['lineWidth']);\n      }\n\n      if (isGradient(strokeAndFill['polygonFill'])) {\n        if (!gradientExtent) {\n          gradientExtent = this._getGraidentExtent(point);\n        }\n\n        strokeAndFill['polygonGradientExtent'] = gradientExtent;\n      }\n\n      this.prepareCanvas(ctx, strokeAndFill, resources);\n    }\n\n    var width = style['markerWidth'],\n        height = style['markerHeight'],\n        hLineWidth = style['markerLineWidth'] / 2;\n\n    if (markerType === 'ellipse') {\n      Canvas.ellipse(ctx, point, width / 2, height / 2, height / 2, lineOpacity, fillOpacity);\n    } else if (markerType === 'cross' || markerType === 'x') {\n      for (var j = vectorArray.length - 1; j >= 0; j--) {\n        vectorArray[j]._add(point);\n      }\n\n      Canvas.path(ctx, vectorArray.slice(0, 2), lineOpacity);\n      Canvas.path(ctx, vectorArray.slice(2, 4), lineOpacity);\n    } else if (markerType === 'diamond' || markerType === 'bar' || markerType === 'square' || markerType === 'rectangle' || markerType === 'triangle') {\n      if (markerType === 'bar') {\n        point = point.add(0, -hLineWidth);\n      } else if (markerType === 'rectangle') {\n        point = point.add(hLineWidth, hLineWidth);\n      }\n\n      for (var _j = vectorArray.length - 1; _j >= 0; _j--) {\n        vectorArray[_j]._add(point);\n      }\n\n      Canvas.polygon(ctx, vectorArray, lineOpacity, fillOpacity);\n    } else if (markerType === 'pin') {\n      point = point.add(0, -hLineWidth);\n\n      for (var _j2 = vectorArray.length - 1; _j2 >= 0; _j2--) {\n        vectorArray[_j2]._add(point);\n      }\n\n      var lineCap = ctx.lineCap;\n      ctx.lineCap = 'round';\n      Canvas.bezierCurveAndFill(ctx, vectorArray, lineOpacity, fillOpacity);\n      ctx.lineCap = lineCap;\n    } else if (markerType === 'pie') {\n      point = point.add(0, hLineWidth);\n      var angle = Math.atan(width / 2 / height) * 180 / Math.PI;\n      var _lineCap = ctx.lineCap;\n      ctx.lineCap = 'round';\n      Canvas.sector(ctx, point, height, [90 - angle, 90 + angle], lineOpacity, fillOpacity);\n      ctx.lineCap = _lineCap;\n    } else {\n      throw new Error('unsupported markerType: ' + markerType);\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['markerPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['markerRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var dxdy = this.getDxDy(),\n        padding = this.padding * 2;\n\n    var size = this._calMarkerSize().map(function (d) {\n      return d - padding;\n    });\n\n    var alignPoint = this._getAnchor(size[0], size[1]);\n\n    var result = new PointExtent(dxdy.add(0, 0), dxdy.add(size[0], size[1]));\n\n    result._add(alignPoint);\n\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'markerType': getValueOrDefault(s['markerType'], 'ellipse'),\n      'markerFill': getValueOrDefault(s['markerFill'], '#00f'),\n      'markerFillOpacity': getValueOrDefault(s['markerFillOpacity'], 1),\n      'markerFillPatternFile': getValueOrDefault(s['markerFillPatternFile'], null),\n      'markerLineColor': getValueOrDefault(s['markerLineColor'], '#000'),\n      'markerLineWidth': getValueOrDefault(s['markerLineWidth'], 1),\n      'markerLineOpacity': getValueOrDefault(s['markerLineOpacity'], 1),\n      'markerLineDasharray': getValueOrDefault(s['markerLineDasharray'], []),\n      'markerLinePatternFile': getValueOrDefault(s['markerLinePatternFile'], null),\n      'markerDx': getValueOrDefault(s['markerDx'], 0),\n      'markerDy': getValueOrDefault(s['markerDy'], 0),\n      'markerWidth': getValueOrDefault(s['markerWidth'], 10),\n      'markerHeight': getValueOrDefault(s['markerHeight'], 10),\n      'markerRotation': getValueOrDefault(s['markerRotation'], 0)\n    };\n    var markerType = result['markerType'];\n    var ha, va;\n\n    if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n      ha = 'middle';\n      va = 'top';\n    } else if (markerType === 'rectangle') {\n      ha = 'right';\n      va = 'bottom';\n    } else {\n      ha = 'middle';\n      va = 'middle';\n    }\n\n    result['markerHorizontalAlignment'] = getValueOrDefault(s['markerHorizontalAlignment'], ha);\n    result['markerVerticalAlignment'] = getValueOrDefault(s['markerVerticalAlignment'], va);\n\n    if (isNumber(s['markerOpacity'])) {\n      if (isNumber(s['markerFillOpacity'])) {\n        result['markerFillOpacity'] *= s['markerOpacity'];\n      }\n\n      if (isNumber(s['markerLineOpacity'])) {\n        result['markerLineOpacity'] *= s['markerOpacity'];\n      }\n    }\n\n    return result;\n  };\n\n  VectorMarkerSymbolizer.translateLineAndFill = function translateLineAndFill(s) {\n    var result = {\n      'lineColor': s['markerLineColor'],\n      'linePatternFile': s['markerLinePatternFile'],\n      'lineWidth': s['markerLineWidth'],\n      'lineOpacity': s['markerLineOpacity'],\n      'lineDasharray': s['markerLineDasharray'],\n      'lineCap': 'butt',\n      'lineJoin': 'round',\n      'polygonFill': s['markerFill'],\n      'polygonPatternFile': s['markerFillPatternFile'],\n      'polygonOpacity': s['markerFillOpacity']\n    };\n\n    if (result['lineWidth'] === 0) {\n      result['lineOpacity'] = 0;\n    }\n\n    return result;\n  };\n\n  VectorMarkerSymbolizer._getVectorPoints = function _getVectorPoints(markerType, width, height) {\n    var hh = height / 2,\n        hw = width / 2;\n    var left = 0,\n        top = 0;\n    var v0, v1, v2, v3;\n\n    if (markerType === 'triangle') {\n      v0 = new Point(left, top - hh);\n      v1 = new Point(left - hw, top + hh);\n      v2 = new Point(left + hw, top + hh);\n      return [v0, v1, v2];\n    } else if (markerType === 'cross') {\n      v0 = new Point(left - hw, top);\n      v1 = new Point(left + hw, top);\n      v2 = new Point(left, top - hh);\n      v3 = new Point(left, top + hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'diamond') {\n      v0 = new Point(left - hw, top);\n      v1 = new Point(left, top - hh);\n      v2 = new Point(left + hw, top);\n      v3 = new Point(left, top + hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'square') {\n      v0 = new Point(left - hw, top + hh);\n      v1 = new Point(left + hw, top + hh);\n      v2 = new Point(left + hw, top - hh);\n      v3 = new Point(left - hw, top - hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'rectangle') {\n      v0 = new Point(left, top);\n      v1 = v0.add(width, 0);\n      v2 = v0.add(width, height);\n      v3 = v0.add(0, height);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'x') {\n      v0 = new Point(left - hw, top + hh);\n      v1 = new Point(left + hw, top - hh);\n      v2 = new Point(left + hw, top + hh);\n      v3 = new Point(left - hw, top - hh);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'bar') {\n      v0 = new Point(left - hw, top - height);\n      v1 = new Point(left + hw, top - height);\n      v2 = new Point(left + hw, top);\n      v3 = new Point(left - hw, top);\n      return [v0, v1, v2, v3];\n    } else if (markerType === 'pin') {\n      var extWidth = height * Math.atan(hw / hh);\n      v0 = new Point(left, top);\n      v1 = new Point(left - extWidth, top - height);\n      v2 = new Point(left + extWidth, top - height);\n      v3 = new Point(left, top);\n      return [v0, v1, v2, v3];\n    }\n\n    return [];\n  };\n\n  return VectorMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar DebugSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(DebugSymbolizer, _PointSymbolizer);\n\n  function DebugSymbolizer() {\n    return _PointSymbolizer.apply(this, arguments) || this;\n  }\n\n  var _proto = DebugSymbolizer.prototype;\n\n  _proto.getPlacement = function getPlacement() {\n    return 'point';\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    return new Point(0, 0);\n  };\n\n  _proto.symbolize = function symbolize(ctx) {\n    var geometry = this.geometry,\n        layer = geometry.getLayer();\n\n    if (!geometry.options['debug'] && layer && !layer.options['debug']) {\n      return;\n    }\n\n    var map = this.getMap();\n\n    if (!map || map.isZooming()) {\n      return;\n    }\n\n    var color = layer.options['debugOutline'],\n        op = 1;\n    ctx.strokeStyle = color;\n    ctx.fillStyle = color;\n    var outline = this.getPainter().getContainerExtent().toArray();\n    Canvas.polygon(ctx, [outline], op, 0);\n\n    var points = this._getRenderContainerPoints(),\n        id = this.geometry.getId(),\n        cross = VectorMarkerSymbolizer._getVectorPoints('cross', 10, 10);\n\n    for (var i = 0; i < points.length; i++) {\n      var p = points[i];\n\n      if (!isNil(id)) {\n        Canvas.fillText(ctx, id, p.add(8, -4), color);\n      }\n\n      var c = [];\n\n      for (var ii = 0; ii < cross.length; ii++) {\n        c.push(cross[ii].add(p));\n      }\n\n      Canvas.path(ctx, c.slice(0, 2), op);\n      Canvas.path(ctx, c.slice(2, 4), op);\n    }\n  };\n\n  return DebugSymbolizer;\n}(PointSymbolizer);\n\nvar ImageMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(ImageMarkerSymbolizer, _PointSymbolizer);\n\n  ImageMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (!isNil(symbol['markerFile'])) {\n      return true;\n    }\n\n    return false;\n  };\n\n  function ImageMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this.style = _this._defineStyle(_this.translate());\n    return _this;\n  }\n\n  var _proto = ImageMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['markerOpacity'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    var img = this._getImage(resources);\n\n    if (!img) {\n      if (typeof console !== 'undefined') {\n        console.warn('no img found for ' + (this.style['markerFile'] || this._url[0]));\n      }\n\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    var width = style['markerWidth'];\n    var height = style['markerHeight'];\n\n    if (!isNumber(width) || !isNumber(height)) {\n      width = img.width;\n      height = img.height;\n      style['markerWidth'] = width;\n      style['markerHeight'] = height;\n      var imgURL = [style['markerFile'], style['markerWidth'], style['markerHeight']];\n\n      if (!resources.isResourceLoaded(imgURL)) {\n        resources.addResource(imgURL, img);\n      }\n\n      var painter = this.getPainter();\n\n      if (!painter.isSpriting()) {\n        painter.removeCache();\n      }\n    }\n\n    var alpha;\n\n    if (this.symbol['markerType'] !== 'path' && isNumber(style['markerOpacity']) && style['markerOpacity'] < 1) {\n      alpha = ctx.globalAlpha;\n      ctx.globalAlpha *= style['markerOpacity'];\n    }\n\n    var alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n\n    for (var i = 0, len = cookedPoints.length; i < len; i++) {\n      var p = cookedPoints[i];\n\n      var origin = this._rotate(ctx, p, this._getRotationAt(i));\n\n      if (origin) {\n        p = origin;\n      }\n\n      Canvas.image(ctx, img, p.x + alignPoint.x, p.y + alignPoint.y, width, height);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n\n    if (alpha !== undefined) {\n      ctx.globalAlpha = alpha;\n    }\n  };\n\n  _proto._getImage = function _getImage(resources) {\n    var img = !resources ? null : resources.getImage([this.style['markerFile'], this.style['markerWidth'], this.style['markerHeight']]);\n    return img;\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['markerPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['markerRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    var dx = s['markerDx'],\n        dy = s['markerDy'];\n    return new Point(dx, dy);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent(resources) {\n    var style = this.style;\n    var url = style['markerFile'],\n        img = resources ? resources.getImage(url) : null;\n    var width = style['markerWidth'] || (img ? img.width : 0),\n        height = style['markerHeight'] || (img ? img.height : 0);\n    var dxdy = this.getDxDy();\n    var alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n    var result = new PointExtent(dxdy.add(0, 0), dxdy.add(width, height));\n\n    result._add(alignPoint);\n\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    return {\n      'markerFile': s['markerFile'],\n      'markerOpacity': getValueOrDefault(s['markerOpacity'], 1),\n      'markerWidth': getValueOrDefault(s['markerWidth'], null),\n      'markerHeight': getValueOrDefault(s['markerHeight'], null),\n      'markerRotation': getValueOrDefault(s['markerRotation'], 0),\n      'markerDx': getValueOrDefault(s['markerDx'], 0),\n      'markerDy': getValueOrDefault(s['markerDy'], 0),\n      'markerHorizontalAlignment': getValueOrDefault(s['markerHorizontalAlignment'], 'middle'),\n      'markerVerticalAlignment': getValueOrDefault(s['markerVerticalAlignment'], 'top')\n    };\n  };\n\n  return ImageMarkerSymbolizer;\n}(PointSymbolizer);\n\nvar TEMP_COORD0$1 = new Coordinate(0, 0);\nvar TEMP_COORD1$1 = new Coordinate(0, 0);\n\nvar StrokeAndFillSymbolizer = function (_CanvasSymbolizer) {\n  _inheritsLoose(StrokeAndFillSymbolizer, _CanvasSymbolizer);\n\n  StrokeAndFillSymbolizer.test = function test(symbol, geometry) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (geometry && geometry.type === 'Point') {\n      return false;\n    }\n\n    for (var p in symbol) {\n      var f = p.slice(0, 4);\n\n      if (f === 'line' || f === 'poly') {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  function StrokeAndFillSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _CanvasSymbolizer.call(this) || this;\n    _this.symbol = symbol;\n    _this.geometry = geometry;\n    _this.painter = painter;\n\n    if (geometry.type === 'Point') {\n      return _assertThisInitialized(_this);\n    }\n\n    _this.style = _this._defineStyle(_this.translate());\n    return _this;\n  }\n\n  var _proto = StrokeAndFillSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    var style = this.style;\n\n    if (style['polygonOpacity'] === 0 && style['lineOpacity'] === 0 && !this.painter.isHitTesting()) {\n      return;\n    }\n\n    var paintParams = this._getPaintParams();\n\n    if (!paintParams) {\n      return;\n    }\n\n    this._prepareContext(ctx);\n\n    var isGradient$$1 = isGradient(style['lineColor']),\n        isPath = this.geometry.getJSONType() === 'Polygon' || this.geometry.type === 'LineString';\n\n    if (isGradient$$1 && (style['lineColor']['places'] || !isPath)) {\n      style['lineGradientExtent'] = this.getPainter().getContainerExtent()._expand(style['lineWidth']);\n    }\n\n    if (isGradient(style['polygonFill'])) {\n      style['polygonGradientExtent'] = this.getPainter().getContainerExtent();\n    }\n\n    var points = paintParams[0],\n        isSplitted = this.geometry.getJSONType() === 'Polygon' && points.length > 0 && Array.isArray(points[0][0]) || this.geometry.type === 'LineString' && points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      for (var i = 0; i < points.length; i++) {\n        this.prepareCanvas(ctx, style, resources);\n\n        if (isGradient$$1 && isPath && !style['lineColor']['places']) {\n          this._createGradient(ctx, points[i], style['lineColor']);\n        }\n\n        var params = [ctx, points[i]];\n\n        if (paintParams.length > 1) {\n          params.push.apply(params, paintParams.slice(1));\n        }\n\n        params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n\n        this.geometry._paintOn.apply(this.geometry, params);\n      }\n    } else {\n      this.prepareCanvas(ctx, style, resources);\n\n      if (isGradient$$1 && isPath && !style['lineColor']['places']) {\n        this._createGradient(ctx, points, style['lineColor']);\n      }\n\n      var _params = [ctx];\n\n      _params.push.apply(_params, paintParams);\n\n      _params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n\n      this.geometry._paintOn.apply(this.geometry, _params);\n    }\n\n    if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n      ctx.setLineDash([]);\n    }\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    var map = this.getMap();\n\n    var extent = this.geometry._getPrjExtent();\n\n    if (!extent) {\n      return null;\n    }\n\n    if (!this._extMin || !this._extMax) {\n      this._extMin = new Coordinate(0, 0);\n      this._extMax = new Coordinate(0, 0);\n    }\n\n    this._extMin.x = extent['xmin'];\n    this._extMin.y = extent['ymin'];\n    this._extMax.x = extent['xmax'];\n    this._extMax.y = extent['ymax'];\n\n    var min = map._prjToPoint(this._extMin, undefined, TEMP_COORD0$1),\n        max = map._prjToPoint(this._extMax, undefined, TEMP_COORD1$1);\n\n    if (!this._pxExtent) {\n      this._pxExtent = new PointExtent(min, max);\n    } else {\n      this._pxExtent.set(Math.min(min.x, max.x), Math.min(min.y, max.y), Math.max(min.x, max.x), Math.max(min.y, max.y));\n    }\n\n    return this._pxExtent;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var t = this.style['lineWidth'] / 2;\n    return new PointExtent(-t, -t, t, t);\n  };\n\n  _proto._getPaintParams = function _getPaintParams() {\n    return this.getPainter().getPaintParams(this.style['lineDx'], this.style['lineDy']);\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'lineColor': getValueOrDefault(s['lineColor'], '#000'),\n      'lineWidth': getValueOrDefault(s['lineWidth'], 2),\n      'lineOpacity': getValueOrDefault(s['lineOpacity'], 1),\n      'lineDasharray': getValueOrDefault(s['lineDasharray'], []),\n      'lineCap': getValueOrDefault(s['lineCap'], 'butt'),\n      'lineJoin': getValueOrDefault(s['lineJoin'], 'miter'),\n      'linePatternFile': getValueOrDefault(s['linePatternFile'], null),\n      'lineDx': getValueOrDefault(s['lineDx'], 0),\n      'lineDy': getValueOrDefault(s['lineDy'], 0),\n      'polygonFill': getValueOrDefault(s['polygonFill'], null),\n      'polygonOpacity': getValueOrDefault(s['polygonOpacity'], 1),\n      'polygonPatternFile': getValueOrDefault(s['polygonPatternFile'], null),\n      'polygonPatternDx': getValueOrDefault(s['polygonPatternDx'], 0),\n      'polygonPatternDy': getValueOrDefault(s['polygonPatternDy'], 0),\n      'linePatternDx': getValueOrDefault(s['linePatternDx'], 0),\n      'linePatternDy': getValueOrDefault(s['linePatternDy'], 0)\n    };\n\n    if (result['lineWidth'] === 0) {\n      result['lineOpacity'] = 0;\n    }\n\n    if (this.geometry.type === 'LineString' && !result['polygonFill']) {\n      result['polygonFill'] = result['lineColor'];\n    }\n\n    return result;\n  };\n\n  _proto._createGradient = function _createGradient(ctx, points, lineColor) {\n    if (!Array.isArray(points) || !points.length) {\n      return;\n    }\n\n    var len = points.length;\n    var grad = ctx.createLinearGradient(points[0].x, points[0].y, points[len - 1].x, points[len - 1].y);\n    lineColor['colorStops'].forEach(function (stop) {\n      grad.addColorStop.apply(grad, stop);\n    });\n    ctx.strokeStyle = grad;\n  };\n\n  return StrokeAndFillSymbolizer;\n}(CanvasSymbolizer);\n\nvar CACHE_KEY = '___text_symbol_cache';\n\nvar TextMarkerSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(TextMarkerSymbolizer, _PointSymbolizer);\n\n  TextMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (!isNil(symbol['textName'])) {\n      return true;\n    }\n\n    return false;\n  };\n\n  function TextMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this._dynamic = hasFunctionDefinition(symbol);\n    _this.style = _this._defineStyle(_this.translate());\n\n    if (_this.style['textWrapWidth'] === 0) {\n      return _assertThisInitialized(_this);\n    }\n\n    _this.strokeAndFill = _this._defineStyle(_this.translateLineAndFill(_this.style));\n    var textContent = replaceVariable(_this.style['textName'], _this.geometry.getProperties());\n\n    if (!_this._dynamic) {\n      _this._cacheKey = genCacheKey(textContent, _this.style);\n    }\n\n    _this._descText(textContent);\n\n    return _this;\n  }\n\n  var _proto = TextMarkerSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx, resources) {\n    if (!this.painter.isHitTesting() && (this.style['textSize'] === 0 || !this.style['textOpacity'] && (!this.style['textHaloRadius'] || !this.style['textHaloOpacity']) || this.style['textWrapWidth'] === 0)) {\n      return;\n    }\n\n    var cookedPoints = this._getRenderContainerPoints();\n\n    if (!isArrayHasData(cookedPoints)) {\n      return;\n    }\n\n    var style = this.style,\n        strokeAndFill = this.strokeAndFill;\n    var textContent = replaceVariable(this.style['textName'], this.geometry.getProperties());\n\n    this._descText(textContent);\n\n    this._prepareContext(ctx);\n\n    this.prepareCanvas(ctx, strokeAndFill, resources);\n    Canvas.prepareCanvasFont(ctx, style);\n\n    for (var i = 0, len = cookedPoints.length; i < len; i++) {\n      var p = cookedPoints[i];\n\n      var origin = this._rotate(ctx, p, this._getRotationAt(i));\n\n      if (origin) {\n        p = origin;\n      }\n\n      Canvas.text(ctx, textContent, p, style, this.textDesc);\n\n      if (origin) {\n        ctx.restore();\n      }\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return this.symbol['textPlacement'];\n  };\n\n  _proto.getRotation = function getRotation() {\n    var r = this.style['textRotation'];\n\n    if (!isNumber(r)) {\n      return null;\n    }\n\n    return -r * Math.PI / 180;\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.style;\n    return new Point(s['textDx'], s['textDy']);\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var dxdy = this.getDxDy(),\n        style = this.style;\n    var size = this.textDesc['size'];\n    var alignPoint = getAlignPoint(size, style['textHorizontalAlignment'], style['textVerticalAlignment']);\n    var alignW = alignPoint.x,\n        alignH = alignPoint.y;\n\n    if (style['textHaloRadius']) {\n      var r = style['textHaloRadius'];\n      size = size.add(r * 2, r * 2);\n    }\n\n    var result = new PointExtent(dxdy.add(alignW, alignH), dxdy.add(alignW + size['width'], alignH + size['height']));\n    var rotation = this.getRotation();\n\n    if (rotation) {\n      result = this._rotateExtent(result, rotation);\n    }\n\n    return result;\n  };\n\n  _proto.translate = function translate() {\n    var s = this.symbol;\n    var result = {\n      'textName': s['textName'],\n      'textFaceName': getValueOrDefault(s['textFaceName'], 'monospace'),\n      'textWeight': getValueOrDefault(s['textWeight'], 'normal'),\n      'textStyle': getValueOrDefault(s['textStyle'], 'normal'),\n      'textSize': getValueOrDefault(s['textSize'], DEFAULT_TEXT_SIZE),\n      'textFont': getValueOrDefault(s['textFont'], null),\n      'textFill': getValueOrDefault(s['textFill'], '#000'),\n      'textOpacity': getValueOrDefault(s['textOpacity'], 1),\n      'textHaloFill': getValueOrDefault(s['textHaloFill'], '#ffffff'),\n      'textHaloRadius': getValueOrDefault(s['textHaloRadius'], 0),\n      'textHaloOpacity': getValueOrDefault(s['textHaloOpacity'], 1),\n      'textWrapWidth': getValueOrDefault(s['textWrapWidth'], null),\n      'textWrapCharacter': getValueOrDefault(s['textWrapCharacter'], '\\n'),\n      'textLineSpacing': getValueOrDefault(s['textLineSpacing'], 0),\n      'textDx': getValueOrDefault(s['textDx'], 0),\n      'textDy': getValueOrDefault(s['textDy'], 0),\n      'textHorizontalAlignment': getValueOrDefault(s['textHorizontalAlignment'], 'middle'),\n      'textVerticalAlignment': getValueOrDefault(s['textVerticalAlignment'], 'middle'),\n      'textAlign': getValueOrDefault(s['textAlign'], 'center'),\n      'textRotation': getValueOrDefault(s['textRotation'], 0),\n      'textMaxWidth': getValueOrDefault(s['textMaxWidth'], 0),\n      'textMaxHeight': getValueOrDefault(s['textMaxHeight'], 0)\n    };\n\n    if (result['textMaxWidth'] > 0 && (!result['textWrapWidth'] || result['textWrapWidth'] > result['textMaxWidth'])) {\n      if (!result['textWrapWidth']) {\n        result['textMaxHeight'] = 1;\n      }\n\n      result['textWrapWidth'] = result['textMaxWidth'];\n    }\n\n    return result;\n  };\n\n  _proto.translateLineAndFill = function translateLineAndFill(s) {\n    return {\n      'lineColor': s['textHaloRadius'] ? s['textHaloFill'] : s['textFill'],\n      'lineWidth': s['textHaloRadius'],\n      'lineOpacity': s['textOpacity'],\n      'lineDasharray': null,\n      'lineCap': 'butt',\n      'lineJoin': 'round',\n      'polygonFill': s['textFill'],\n      'polygonOpacity': s['textOpacity']\n    };\n  };\n\n  _proto._descText = function _descText(textContent) {\n    if (this._dynamic) {\n      this.textDesc = this._measureText(textContent);\n      return;\n    }\n\n    this.textDesc = this._loadFromCache();\n\n    if (!this.textDesc) {\n      this.textDesc = this._measureText(textContent);\n\n      this._storeToCache(this.textDesc);\n    }\n  };\n\n  _proto._measureText = function _measureText(textContent) {\n    var maxHeight = this.style['textMaxHeight'];\n    var textDesc = splitTextToRow(textContent, this.style);\n\n    if (maxHeight && maxHeight < textDesc.size.height) {\n      textDesc.size.height = maxHeight;\n    }\n\n    return textDesc;\n  };\n\n  _proto._storeToCache = function _storeToCache(textDesc) {\n    if (IS_NODE) {\n      return;\n    }\n\n    if (!this.geometry[CACHE_KEY]) {\n      this.geometry[CACHE_KEY] = {};\n    }\n\n    this.geometry[CACHE_KEY][this._cacheKey] = {\n      'desc': textDesc,\n      'active': true\n    };\n  };\n\n  _proto._loadFromCache = function _loadFromCache() {\n    if (!this.geometry[CACHE_KEY]) {\n      return null;\n    }\n\n    var cache = this.geometry[CACHE_KEY][this._cacheKey];\n\n    if (!cache) {\n      return null;\n    }\n\n    cache.active = true;\n    return cache.desc;\n  };\n\n  return TextMarkerSymbolizer;\n}(PointSymbolizer);\nTextMarkerSymbolizer.CACHE_KEY = CACHE_KEY;\n\nfunction genCacheKey(textContent, style) {\n  var key = [textContent];\n\n  for (var p in style) {\n    if (style.hasOwnProperty(p) && p.length > 4 && p.substring(0, 4) === 'text') {\n      key.push(p + '=' + style[p]);\n    }\n  }\n\n  return key.join('-');\n}\n\nvar VectorPathMarkerSymbolizer = function (_ImageMarkerSymbolize) {\n  _inheritsLoose(VectorPathMarkerSymbolizer, _ImageMarkerSymbolize);\n\n  VectorPathMarkerSymbolizer.test = function test(symbol) {\n    if (!symbol) {\n      return false;\n    }\n\n    if (isNil(symbol['markerFile']) && symbol['markerType'] === 'path') {\n      return true;\n    }\n\n    return false;\n  };\n\n  function VectorPathMarkerSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    if (isNil(symbol['markerWidth'])) {\n      symbol['markerWidth'] = 80;\n    }\n\n    if (isNil(symbol['markerHeight'])) {\n      symbol['markerHeight'] = 80;\n    }\n\n    _this = _ImageMarkerSymbolize.call(this, symbol, geometry, painter) || this;\n    symbol = extend(symbol, _this.translate());\n\n    var style = _this.style = _this._defineStyle(symbol);\n\n    if (Browser$1.gecko) {\n      _this._url = [getMarkerPathBase64(style, style['markerWidth'], style['markerHeight']), style['markerWidth'], style['markerHeight']];\n    } else {\n      _this._url = [getMarkerPathBase64(style), style['markerWidth'], style['markerHeight']];\n    }\n\n    return _this;\n  }\n\n  var _proto = VectorPathMarkerSymbolizer.prototype;\n\n  _proto._prepareContext = function _prepareContext() {};\n\n  _proto._getImage = function _getImage(resources) {\n    var _this2 = this;\n\n    if (resources && resources.isResourceLoaded(this._url)) {\n      return resources.getImage(this._url);\n    }\n\n    var painter = this.painter;\n    var image = new Image();\n\n    image.onload = function () {\n      var renderer = painter.getLayer() && painter.getLayer().getRenderer();\n\n      if (renderer) {\n        renderer.setToRedraw();\n      }\n    };\n\n    image.onerror = function (err) {\n      if (err && typeof console !== 'undefined') {\n        console.warn(err);\n      }\n\n      resources.markErrorResource(_this2._url);\n    };\n\n    image.src = this._url[0];\n\n    if (resources) {\n      resources.addResource(this._url, image);\n    }\n\n    return image;\n  };\n\n  return VectorPathMarkerSymbolizer;\n}(ImageMarkerSymbolizer);\n\nvar defaultSymbol = {\n  lineWidth: 1,\n  polygonFill: '#fff',\n  polygonOpacity: 0.5\n};\n\nvar DrawAltitudeSymbolizer = function (_PointSymbolizer) {\n  _inheritsLoose(DrawAltitudeSymbolizer, _PointSymbolizer);\n\n  DrawAltitudeSymbolizer.test = function test(symbol, geometry) {\n    var layer = geometry.getLayer();\n\n    if (!layer) {\n      return false;\n    }\n\n    var type = geometry.getJSONType();\n    return type === 'Marker' || type === 'LineString';\n  };\n\n  function DrawAltitudeSymbolizer(symbol, geometry, painter) {\n    var _this;\n\n    _this = _PointSymbolizer.call(this, symbol, geometry, painter) || this;\n    _this.style = geometry.getLayer().options['drawAltitude'];\n\n    if (!_this.style || !isObject(_this.style)) {\n      _this.style = {\n        'lineWidth': 2\n      };\n    }\n\n    if (!_this.style['lineWidth']) {\n      _this.style['lineWidth'] = 0;\n    }\n\n    _this.dxdy = _this._defineStyle({\n      'dx': symbol['textDx'] || symbol['markerDx'],\n      'dy': symbol['textDy'] || symbol['markerDy']\n    });\n    return _this;\n  }\n\n  var _proto = DrawAltitudeSymbolizer.prototype;\n\n  _proto.symbolize = function symbolize(ctx) {\n    var layer = this.geometry.getLayer();\n\n    if (!layer.options['drawAltitude']) {\n      return;\n    }\n\n    var properties = this.geometry.getProperties();\n\n    if (!properties || !properties[layer.options['altitudeProperty']]) {\n      return;\n    }\n\n    var style = this._getStyle();\n\n    this._prepareContext(ctx);\n\n    if (this.geometry.type === 'LineString') {\n      var paintParams = this._getPaintParams(style['lineDx'], style['lineDy']);\n\n      if (!paintParams) {\n        return;\n      }\n\n      var groundPoints = this.getPainter().getPaintParams(style['lineDx'], style['lineDy'], true)[0];\n\n      this._drawLineAltitude(ctx, paintParams[0], groundPoints);\n    } else {\n      var point = this._getRenderContainerPoints(),\n          groundPoint = this._getRenderContainerPoints(true);\n\n      if (!point || point.length === 0) {\n        return;\n      }\n\n      this._drawMarkerAltitude(ctx, point[0], groundPoint[0]);\n    }\n  };\n\n  _proto.getDxDy = function getDxDy() {\n    var s = this.dxdy;\n    return new Point(s['dx'] || 0, s['dy'] || 0);\n  };\n\n  _proto.get2DExtent = function get2DExtent() {\n    if (this.geometry.type === 'LineString') {\n      return StrokeAndFillSymbolizer.prototype.get2DExtent.apply(this);\n    } else {\n      return _PointSymbolizer.prototype.get2DExtent.call(this);\n    }\n  };\n\n  _proto.getPlacement = function getPlacement() {\n    return 'point';\n  };\n\n  _proto._getPaintParams = function _getPaintParams(dx, dy) {\n    return this.getPainter().getPaintParams(dx || 0, dy || 0);\n  };\n\n  _proto._drawMarkerAltitude = function _drawMarkerAltitude(ctx, point, groundPoint) {\n    var style = this._getStyle();\n\n    this.prepareCanvas(ctx, style);\n    Canvas.path(ctx, [point, groundPoint], style['lineOpacity'], null, style['lineDasharray']);\n  };\n\n  _proto._drawLineAltitude = function _drawLineAltitude(ctx, points, groundPoints) {\n    var style = this._getStyle();\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      for (var i = 0; i < points.length; i++) {\n        this._drawLine(ctx, points[i], groundPoints[i]);\n      }\n    } else {\n      this._drawLine(ctx, points, groundPoints);\n    }\n\n    if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n      ctx.setLineDash([]);\n    }\n  };\n\n  _proto._drawLine = function _drawLine(ctx, points, groundPoints) {\n    var style = this._getStyle();\n\n    this.prepareCanvas(ctx, style);\n\n    for (var i = 0, l = points.length - 1; i < l; i++) {\n      Canvas.polygon(ctx, [points[i], points[i + 1], groundPoints[i + 1], groundPoints[i]], style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n    }\n  };\n\n  _proto._getStyle = function _getStyle() {\n    var style = this.geometry.getLayer().options['drawAltitude'];\n\n    if (!isObject(style)) {\n      style = defaultSymbol;\n    }\n\n    if (!style['lineWidth']) {\n      style['lineWidth'] = 0;\n      style['lineOpacity'] = 0;\n    }\n\n    return style;\n  };\n\n  return DrawAltitudeSymbolizer;\n}(PointSymbolizer);\n\n\n\nvar index$3 = /*#__PURE__*/Object.freeze({\n  Symbolizer: Symbolizer,\n  CanvasSymbolizer: CanvasSymbolizer,\n  DebugSymbolizer: DebugSymbolizer,\n  ImageMarkerSymbolizer: ImageMarkerSymbolizer,\n  PointSymbolizer: PointSymbolizer,\n  StrokeAndFillSymbolizer: StrokeAndFillSymbolizer,\n  TextMarkerSymbolizer: TextMarkerSymbolizer,\n  VectorMarkerSymbolizer: VectorMarkerSymbolizer,\n  VectorPathMarkerSymbolizer: VectorPathMarkerSymbolizer,\n  DrawAltitudeSymbolizer: DrawAltitudeSymbolizer\n});\n\nvar registerSymbolizers = [DrawAltitudeSymbolizer, StrokeAndFillSymbolizer, ImageMarkerSymbolizer, VectorPathMarkerSymbolizer, VectorMarkerSymbolizer, TextMarkerSymbolizer];\nvar testCanvas;\nvar TEMP_POINT0$2 = new Point(0, 0);\nvar TEMP_PAINT_EXTENT = new PointExtent();\nvar TEMP_EXTENT$1 = new PointExtent();\nvar TEMP_FIXED_EXTENT = new PointExtent();\nvar TEMP_CLIP_EXTENT0 = new PointExtent();\nvar TEMP_CLIP_EXTENT1 = new PointExtent();\n\nvar Painter = function (_Class) {\n  _inheritsLoose(Painter, _Class);\n\n  function Painter(geometry) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.geometry = geometry;\n    _this.symbolizers = _this._createSymbolizers();\n    _this._altAtGLZoom = _this._getGeometryAltitude();\n    return _this;\n  }\n\n  var _proto = Painter.prototype;\n\n  _proto.getMap = function getMap() {\n    return this.geometry.getMap();\n  };\n\n  _proto.getLayer = function getLayer() {\n    return this.geometry.getLayer();\n  };\n\n  _proto._createSymbolizers = function _createSymbolizers() {\n    var geoSymbol = this.getSymbol(),\n        symbolizers = [],\n        regSymbolizers = registerSymbolizers;\n    var symbols = geoSymbol;\n\n    if (!Array.isArray(geoSymbol)) {\n      symbols = [geoSymbol];\n    }\n\n    for (var ii = symbols.length - 1; ii >= 0; ii--) {\n      var symbol = symbols[ii];\n\n      for (var i = regSymbolizers.length - 1; i >= 0; i--) {\n        if (regSymbolizers[i].test(symbol, this.geometry)) {\n          var symbolizer = new regSymbolizers[i](symbol, this.geometry, this);\n          symbolizers.push(symbolizer);\n\n          if (symbolizer instanceof PointSymbolizer) {\n            this._hasPoint = true;\n          }\n        }\n      }\n    }\n\n    if (!symbolizers.length) {\n      if (console) {\n        var id = this.geometry.getId();\n        console.warn('invalid symbol for geometry(' + (this.geometry ? this.geometry.getType() + (id ? ':' + id : '') : '') + ') to draw : ' + JSON.stringify(geoSymbol));\n      }\n    }\n\n    this._debugSymbolizer = new DebugSymbolizer(geoSymbol, this.geometry, this);\n    return symbolizers;\n  };\n\n  _proto.hasPoint = function hasPoint() {\n    return !!this._hasPoint;\n  };\n\n  _proto.getRenderPoints = function getRenderPoints(placement) {\n    if (!this._renderPoints) {\n      this._renderPoints = {};\n    }\n\n    if (!placement) {\n      placement = 'center';\n    }\n\n    if (!this._renderPoints[placement]) {\n      this._renderPoints[placement] = this.geometry._getRenderPoints(placement);\n    }\n\n    return this._renderPoints[placement];\n  };\n\n  _proto.getPaintParams = function getPaintParams(dx, dy, ignoreAltitude) {\n    var map = this.getMap(),\n        geometry = this.geometry,\n        res = map.getResolution(),\n        pitched = map.getPitch() !== 0,\n        rotated = map.getBearing() !== 0;\n    var params = this._cachedParams;\n\n    var paintAsPath = geometry._paintAsPath && geometry._paintAsPath();\n\n    if (paintAsPath && this._unsimpledParams && res <= this._unsimpledParams._res) {\n      params = this._unsimpledParams;\n    } else if (!params || params._res !== map.getResolution() || this._pitched !== pitched && geometry._redrawWhenPitch() || this._rotated !== rotated && geometry._redrawWhenRotate()) {\n      params = geometry._getPaintParams();\n\n      if (!params) {\n        return null;\n      }\n\n      params._res = res;\n\n      if (!geometry._simplified && paintAsPath) {\n        if (!this._unsimpledParams) {\n          this._unsimpledParams = params;\n        }\n\n        if (res > this._unsimpledParams._res) {\n          this._unsimpledParams._res = res;\n        }\n      }\n\n      this._cachedParams = params;\n    }\n\n    if (!params) {\n      return null;\n    }\n\n    this._pitched = pitched;\n    this._rotated = rotated;\n    var zoomScale = map.getGLScale(),\n        tr = [],\n        points = params[0];\n    var mapExtent = map.getContainerExtent();\n\n    var cPoints = this._pointContainerPoints(points, dx, dy, ignoreAltitude, this._hitPoint && !mapExtent.contains(this._hitPoint));\n\n    if (!cPoints) {\n      return null;\n    }\n\n    tr.push(cPoints);\n\n    for (var i = 1, l = params.length; i < l; i++) {\n      if (isNumber(params[i]) || params[i] instanceof Size) {\n        if (isNumber(params[i])) {\n          tr.push(params[i] / zoomScale);\n        } else {\n          tr.push(params[i].multi(1 / zoomScale));\n        }\n      } else {\n        tr.push(params[i]);\n      }\n    }\n\n    return tr;\n  };\n\n  _proto._pointContainerPoints = function _pointContainerPoints(points, dx, dy, ignoreAltitude, disableClip, pointPlacement) {\n    if (this._aboveCamera()) {\n      return null;\n    }\n\n    var map = this.getMap(),\n        glZoom = map.getGLZoom(),\n        containerOffset = this.containerOffset;\n    var cPoints;\n\n    function pointContainerPoint(point, alt) {\n      var p = map._pointToContainerPoint(point, glZoom, alt)._sub(containerOffset);\n\n      if (dx || dy) {\n        p._add(dx || 0, dy || 0);\n      }\n\n      return p;\n    }\n\n    var altitude = this.getAltitude();\n\n    if (Array.isArray(points)) {\n      var geometry = this.geometry;\n      var clipped;\n\n      if (!disableClip && geometry.options['enableClip']) {\n        clipped = this._clip(points, altitude);\n      } else {\n        clipped = {\n          points: points,\n          altitude: altitude\n        };\n      }\n\n      var clipPoints = clipped.points;\n      altitude = clipped.altitude;\n\n      if (ignoreAltitude) {\n        altitude = 0;\n      }\n\n      var alt = altitude;\n      cPoints = [];\n\n      for (var i = 0, l = clipPoints.length; i < l; i++) {\n        var c = clipPoints[i];\n\n        if (Array.isArray(c)) {\n          var cring = [];\n\n          for (var ii = 0, ll = c.length; ii < ll; ii++) {\n            var cc = c[ii];\n\n            if (Array.isArray(altitude)) {\n              if (altitude[i]) {\n                alt = altitude[i][ii];\n              } else {\n                alt = 0;\n              }\n            }\n\n            cring.push(pointContainerPoint(cc, alt));\n          }\n\n          cPoints.push(cring);\n        } else {\n          if (Array.isArray(altitude)) {\n            if (pointPlacement === 'vertex-last') {\n              alt = altitude[altitude.length - 1 - i];\n            } else if (pointPlacement === 'line') {\n              alt = (altitude[i] + altitude[i + 1]) / 2;\n            } else {\n              alt = altitude[i];\n            }\n          }\n\n          cPoints.push(pointContainerPoint(c, alt));\n        }\n      }\n    } else if (points instanceof Point) {\n      if (ignoreAltitude) {\n        altitude = 0;\n      }\n\n      cPoints = map._pointToContainerPoint(points, glZoom, altitude)._sub(containerOffset);\n\n      if (dx || dy) {\n        cPoints._add(dx, dy);\n      }\n    }\n\n    return cPoints;\n  };\n\n  _proto._clip = function _clip(points, altitude) {\n    var map = this.getMap(),\n        geometry = this.geometry;\n    var lineWidth = this.getSymbol()['lineWidth'];\n\n    if (!isNumber(lineWidth)) {\n      lineWidth = 4;\n    }\n\n    var extent2D = map._get2DExtent(undefined, TEMP_CLIP_EXTENT0)._expand(lineWidth);\n\n    if (map.getPitch() > 0 && altitude) {\n      var c = map.cameraLookAt;\n      var pos = map.cameraPosition;\n      TEMP_POINT0$2.set(pos.x, pos.y);\n      extent2D = extent2D._combine(TEMP_POINT0$2._add(sign(c[0] - pos[0]), sign(c[1] - pos[1])));\n    }\n\n    var e = this.get2DExtent(null, TEMP_CLIP_EXTENT1);\n    var clipPoints = points;\n\n    if (e.within(extent2D)) {\n      return {\n        points: clipPoints,\n        altitude: altitude\n      };\n    }\n\n    var glExtent2D = map._get2DExtent(map.getGLZoom(), TEMP_CLIP_EXTENT0)._expand(lineWidth * map._glScale);\n\n    var smoothness = geometry.options['smoothness'];\n\n    if (geometry.getShell && this.geometry.getHoles && !smoothness) {\n      if (!Array.isArray(points[0])) {\n        clipPoints = clipPolygon(points, glExtent2D);\n      } else {\n        clipPoints = [];\n\n        for (var i = 0; i < points.length; i++) {\n          var part = clipPolygon(points[i], glExtent2D);\n\n          if (part.length) {\n            clipPoints.push(part);\n          }\n        }\n      }\n    } else if (geometry.getJSONType() === 'LineString' && !smoothness) {\n      if (!Array.isArray(points[0])) {\n        clipPoints = clipLine(points, glExtent2D, false, !!smoothness);\n      } else {\n        clipPoints = [];\n\n        for (var _i = 0; _i < points.length; _i++) {\n          pushIn(clipPoints, clipLine(points[_i], glExtent2D, false, !!smoothness));\n        }\n      }\n\n      return this._interpolateSegAlt(clipPoints, points, altitude);\n    }\n\n    return {\n      points: clipPoints,\n      altitude: altitude\n    };\n  };\n\n  _proto._interpolateSegAlt = function _interpolateSegAlt(clipSegs, orig, altitude) {\n    if (!Array.isArray(altitude)) {\n      var fn = function fn(cc) {\n        return cc.point;\n      };\n\n      return {\n        points: clipSegs.map(function (c) {\n          if (Array.isArray(c)) {\n            return c.map(fn);\n          }\n\n          return c.point;\n        }),\n        altitude: altitude\n      };\n    }\n\n    var segsWithAlt = interpolateAlt(clipSegs, orig, altitude);\n    altitude = [];\n    var points = segsWithAlt.map(function (p) {\n      if (Array.isArray(p)) {\n        var alt = [];\n        var cp = p.map(function (pp) {\n          alt.push(pp.altitude);\n          return pp.point;\n        });\n        altitude.push(alt);\n        return cp;\n      }\n\n      altitude.push(p.altitude);\n      return p.point;\n    });\n    return {\n      points: points,\n      altitude: altitude\n    };\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    return this.geometry._getInternalSymbol();\n  };\n\n  _proto.paint = function paint(extent, context, offset) {\n    if (!this.symbolizers) {\n      return;\n    }\n\n    var renderer = this.getLayer()._getRenderer();\n\n    if (!renderer || !renderer.context && !context) {\n      return;\n    }\n\n    if (extent && !extent.intersects(this.get2DExtent(renderer.resources, TEMP_PAINT_EXTENT))) {\n      return;\n    }\n\n    var map = this.getMap();\n    var minAltitude = this.getMinAltitude();\n    var frustumAlt = map.getFrustumAltitude();\n\n    if (minAltitude && frustumAlt && frustumAlt < minAltitude) {\n      return;\n    }\n\n    this.containerOffset = offset || map._pointToContainerPoint(renderer.southWest)._add(0, -map.height);\n\n    this._beforePaint();\n\n    var ctx = context || renderer.context;\n    var contexts = [ctx, renderer.resources];\n\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      this._prepareShadow(ctx, this.symbolizers[i].symbol);\n\n      this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n    }\n\n    this._afterPaint();\n\n    this._painted = true;\n\n    this._debugSymbolizer.symbolize.apply(this._debugSymbolizer, contexts);\n  };\n\n  _proto.getSprite = function getSprite(resources, canvasClass) {\n    if (this.geometry.type !== 'Point') {\n      return null;\n    }\n\n    this._spriting = true;\n\n    if (!this._sprite && this.symbolizers.length > 0) {\n      var extent = new PointExtent();\n      this.symbolizers.forEach(function (s) {\n        var markerExtent = s.getFixedExtent(resources);\n\n        extent._combine(markerExtent);\n      });\n      var origin = extent.getMin().multi(-1);\n      var clazz = canvasClass || (this.getMap() ? this.getMap().CanvasClass : null);\n      var canvas = Canvas.createCanvas(extent.getWidth(), extent.getHeight(), clazz);\n      var bak;\n\n      if (this._renderPoints) {\n        bak = this._renderPoints;\n      }\n\n      var ctx = canvas.getContext('2d');\n      var contexts = [ctx, resources];\n\n      for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n        var dxdy = this.symbolizers[i].getDxDy();\n        this._renderPoints = {\n          'center': [[origin.add(dxdy)]]\n        };\n\n        this._prepareShadow(ctx, this.symbolizers[i].symbol);\n\n        this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n      }\n\n      if (bak) {\n        this._renderPoints = bak;\n      }\n\n      this._sprite = {\n        'canvas': canvas,\n        'offset': extent.getCenter()\n      };\n    }\n\n    this._spriting = false;\n    return this._sprite;\n  };\n\n  _proto.isSpriting = function isSpriting() {\n    return !!this._spriting;\n  };\n\n  _proto.hitTest = function hitTest(cp, tolerance) {\n    if (!tolerance || tolerance < 0.5) {\n      tolerance = 0.5;\n    }\n\n    if (!testCanvas) {\n      testCanvas = Canvas.createCanvas(1, 1);\n    }\n\n    Canvas.setHitTesting(true);\n    testCanvas.width = testCanvas.height = 2 * tolerance;\n    var ctx = testCanvas.getContext('2d');\n    this._hitPoint = cp.sub(tolerance, tolerance);\n\n    try {\n      this.paint(null, ctx, this._hitPoint);\n    } catch (e) {\n      throw e;\n    } finally {\n      Canvas.setHitTesting(false);\n    }\n\n    delete this._hitPoint;\n    var imgData = ctx.getImageData(0, 0, testCanvas.width, testCanvas.height).data;\n\n    for (var i = 3, l = imgData.length; i < l; i += 4) {\n      if (imgData[i] > 0) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.isHitTesting = function isHitTesting() {\n    return !!this._hitPoint;\n  };\n\n  _proto._prepareShadow = function _prepareShadow(ctx, symbol) {\n    if (symbol['shadowBlur']) {\n      ctx.shadowBlur = this.isHitTesting() ? 0 : symbol['shadowBlur'];\n      ctx.shadowColor = symbol['shadowColor'] || '#000';\n      ctx.shadowOffsetX = symbol['shadowOffsetX'] || 0;\n      ctx.shadowOffsetY = symbol['shadowOffsetY'] || 0;\n    } else if (ctx.shadowBlur) {\n      ctx.shadowBlur = null;\n      ctx.shadowColor = null;\n      ctx.shadowOffsetX = null;\n      ctx.shadowOffsetY = null;\n    }\n  };\n\n  _proto._eachSymbolizer = function _eachSymbolizer(fn, context) {\n    if (!this.symbolizers) {\n      return;\n    }\n\n    if (!context) {\n      context = this;\n    }\n\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      fn.apply(context, [this.symbolizers[i]]);\n    }\n  };\n\n  _proto.get2DExtent = function get2DExtent(resources, out) {\n    this._verifyProjection();\n\n    var map = this.getMap();\n    resources = resources || this.getLayer()._getRenderer().resources;\n    var zoom = map.getZoom();\n\n    var isDynamicSize = this._isDynamicSize();\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom || !this._fixedExtent) {\n      if (this._extent2D && this._extent2D._zoom !== zoom) {\n        delete this._extent2D;\n      }\n\n      if (this.symbolizers) {\n        if (!this._extent2D) {\n          this._extent2D = this._computeExtent2D(new PointExtent());\n          this._extent2D._zoom = zoom;\n        }\n\n        if (!this._fixedExtent) {\n          this._fixedExtent = this._computeFixedExtent(resources, new PointExtent());\n        }\n      }\n    }\n\n    if (!this._extent2D) {\n      if (isDynamicSize) {\n        delete this._fixedExtent;\n      }\n\n      return null;\n    }\n\n    var _this$_fixedExtent = this._fixedExtent,\n        xmin = _this$_fixedExtent.xmin,\n        ymin = _this$_fixedExtent.ymin,\n        xmax = _this$_fixedExtent.xmax,\n        ymax = _this$_fixedExtent.ymax;\n\n    if (isDynamicSize) {\n      delete this._fixedExtent;\n    }\n\n    TEMP_FIXED_EXTENT.set(xmin, -ymax, xmax, -ymin);\n\n    if (out) {\n      out.set(this._extent2D['xmin'], this._extent2D['ymin'], this._extent2D['xmax'], this._extent2D['ymax']);\n\n      out._add(TEMP_FIXED_EXTENT);\n\n      return out;\n    }\n\n    return this._extent2D.add(TEMP_FIXED_EXTENT);\n  };\n\n  _proto._computeExtent2D = function _computeExtent2D(extent) {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      extent._combine(symbolizer.get2DExtent());\n    }\n\n    return extent;\n  };\n\n  _proto._computeFixedExtent = function _computeFixedExtent(resources, extent) {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      if (symbolizer.getFixedExtent) {\n        extent._combine(symbolizer.getFixedExtent(resources));\n      }\n    }\n\n    return extent;\n  };\n\n  _proto._isDynamicSize = function _isDynamicSize() {\n    for (var i = this.symbolizers.length - 1; i >= 0; i--) {\n      var symbolizer = this.symbolizers[i];\n\n      if (symbolizer.isDynamicSize()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.getContainerExtent = function getContainerExtent(out) {\n    if (this._aboveCamera()) {\n      return null;\n    }\n\n    this._verifyProjection();\n\n    var map = this.getMap();\n    var zoom = map.getZoom();\n    var glScale = map._glScale;\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom) {\n      this.get2DExtent(null, TEMP_EXTENT$1);\n    }\n\n    var altitude = this.getMinAltitude();\n\n    var extent = this._extent2D.convertTo(function (c) {\n      return map._pointToContainerPoint(c, zoom, altitude / glScale, TEMP_POINT0$2);\n    }, out);\n\n    var maxAltitude = this.getMaxAltitude();\n\n    if (maxAltitude !== altitude) {\n      var extent2 = this._extent2D.convertTo(function (c) {\n        return map._pointToContainerPoint(c, zoom, maxAltitude / glScale, TEMP_POINT0$2);\n      }, TEMP_EXTENT$1);\n\n      extent._combine(extent2);\n    }\n\n    var layer = this.geometry.getLayer();\n\n    if (this.geometry.type === 'LineString' && maxAltitude && layer.options['drawAltitude']) {\n      var groundExtent = this._extent2D.convertTo(function (c) {\n        return map._pointToContainerPoint(c, zoom, 0, TEMP_POINT0$2);\n      }, TEMP_EXTENT$1);\n\n      extent._combine(groundExtent);\n    }\n\n    if (extent) {\n      extent._add(this._fixedExtent || this._computeFixedExtent(null, new PointExtent()));\n    }\n\n    var smoothness = this.geometry.options['smoothness'];\n\n    if (smoothness) {\n      extent._expand(extent.getWidth() * 0.15);\n    }\n\n    return extent;\n  };\n\n  _proto._aboveCamera = function _aboveCamera() {\n    var altitude = this.getMinAltitude();\n    var map = this.getMap();\n    var frustumAlt = map.getFrustumAltitude();\n    return altitude && frustumAlt && frustumAlt < altitude;\n  };\n\n  _proto.getFixedExtent = function getFixedExtent() {\n    var map = this.getMap();\n    var zoom = map.getZoom();\n\n    if (this._isDynamicSize()) {\n      return this._computeFixedExtent(null, new PointExtent());\n    }\n\n    if (!this._extent2D || this._extent2D._zoom !== zoom) {\n      this.get2DExtent(null, TEMP_FIXED_EXTENT);\n    }\n\n    return this._fixedExtent;\n  };\n\n  _proto.setZIndex = function setZIndex(change) {\n    this._eachSymbolizer(function (symbolizer) {\n      symbolizer.setZIndex(change);\n    });\n  };\n\n  _proto.show = function show() {\n    if (!this._painted) {\n      var layer = this.getLayer();\n\n      if (!layer.isCanvasRender()) {\n        this.paint();\n      }\n    } else {\n      this.removeCache();\n\n      this._eachSymbolizer(function (symbolizer) {\n        symbolizer.show();\n      });\n    }\n  };\n\n  _proto.hide = function hide() {\n    this._eachSymbolizer(function (symbolizer) {\n      symbolizer.hide();\n    });\n  };\n\n  _proto.repaint = function repaint() {\n    this._altAtGLZoom = this._getGeometryAltitude();\n    this.removeCache();\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return;\n    }\n\n    var renderer = layer.getRenderer();\n\n    if (!renderer || !renderer.setToRedraw()) {\n      return;\n    }\n\n    renderer.setToRedraw();\n  };\n\n  _proto.refreshSymbol = function refreshSymbol() {\n    this.removeCache();\n\n    this._removeSymbolizers();\n\n    this.symbolizers = this._createSymbolizers();\n  };\n\n  _proto.remove = function remove() {\n    this.removeCache();\n\n    this._removeSymbolizers();\n  };\n\n  _proto._removeSymbolizers = function _removeSymbolizers() {\n    this._eachSymbolizer(function (symbolizer) {\n      delete symbolizer.painter;\n      symbolizer.remove();\n    });\n\n    delete this.symbolizers;\n  };\n\n  _proto.removeCache = function removeCache() {\n    delete this._renderPoints;\n    delete this._paintParams;\n    delete this._sprite;\n    delete this._extent2D;\n    delete this._fixedExtent;\n    delete this._cachedParams;\n    delete this._unsimpledParams;\n\n    if (this.geometry) {\n      delete this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n    }\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    var propAlt = this.geometry.getAltitude();\n\n    if (propAlt !== this._propAlt) {\n      this._altAtGLZoom = this._getGeometryAltitude();\n    }\n\n    if (!this._altAtGLZoom) {\n      return 0;\n    }\n\n    return this._altAtGLZoom;\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    if (!this.minAltitude) {\n      return 0;\n    }\n\n    return this.minAltitude;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    if (!this.maxAltitude) {\n      return 0;\n    }\n\n    return this.maxAltitude;\n  };\n\n  _proto._getGeometryAltitude = function _getGeometryAltitude() {\n    var _this2 = this;\n\n    var map = this.getMap();\n\n    if (!map) {\n      return 0;\n    }\n\n    var altitude = this.geometry.getAltitude();\n    this._propAlt = altitude;\n\n    if (!altitude) {\n      this.minAltitude = this.maxAltitude = 0;\n      return 0;\n    }\n\n    var center = this.geometry.getCenter();\n\n    if (!center) {\n      return 0;\n    }\n\n    if (Array.isArray(altitude)) {\n      this.minAltitude = Number.MAX_VALUE;\n      this.maxAltitude = Number.MIN_VALUE;\n      return altitude.map(function (alt) {\n        var a = _this2._meterToPoint(center, alt);\n\n        if (a < _this2.minAltitude) {\n          _this2.minAltitude = a;\n        }\n\n        if (a > _this2.maxAltitude) {\n          _this2.maxAltitude = a;\n        }\n\n        return a;\n      });\n    } else {\n      this.minAltitude = this.maxAltitude = this._meterToPoint(center, altitude);\n      return this.minAltitude;\n    }\n  };\n\n  _proto._meterToPoint = function _meterToPoint(center, altitude) {\n    var map = this.getMap();\n    var z = map.getGLZoom();\n    return map.distanceToPoint(altitude, 0, z, center).x * sign(altitude);\n  };\n\n  _proto._verifyProjection = function _verifyProjection() {\n    var projection = this.geometry._getProjection();\n\n    if (this._projCode && this._projCode !== projection.code) {\n      this.removeCache();\n    }\n\n    this._projCode = projection.code;\n  };\n\n  _proto._beforePaint = function _beforePaint() {\n    var textcache = this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n\n    if (!textcache) {\n      return;\n    }\n\n    for (var p in textcache) {\n      if (hasOwn(textcache, p)) {\n        textcache[p].active = false;\n      }\n    }\n  };\n\n  _proto._afterPaint = function _afterPaint() {\n    var textcache = this.geometry[TextMarkerSymbolizer.CACHE_KEY];\n\n    if (!textcache) {\n      return;\n    }\n\n    for (var p in textcache) {\n      if (hasOwn(textcache, p)) {\n        if (!textcache[p].active) {\n          delete textcache[p];\n        }\n      }\n    }\n  };\n\n  return Painter;\n}(Class);\n\nfunction interpolateAlt(points, orig, altitude) {\n  if (!Array.isArray(altitude)) {\n    return points;\n  }\n\n  var parts = [];\n\n  for (var i = 0, l = points.length; i < l; i++) {\n    if (Array.isArray(points[i])) {\n      parts.push(interpolateAlt(points[i], orig, altitude));\n    } else {\n      var p = points[i];\n\n      if (!p.point.equals(orig[p.index])) {\n        var w0 = void 0,\n            w1 = void 0;\n\n        if (p.index === 0) {\n          w0 = p.index;\n          w1 = p.index + 1;\n        } else {\n          w0 = p.index - 1;\n          w1 = p.index;\n        }\n\n        var t0 = p.point.distanceTo(orig[w1]);\n        var t = t0 / (t0 + orig[w0].distanceTo(p.point));\n        var alt = interpolate(altitude[w0], altitude[w1], 1 - t);\n        p.altitude = alt;\n        parts.push(p);\n      } else {\n        p.altitude = altitude[p.index];\n        parts.push(p);\n      }\n    }\n  }\n\n  return parts;\n}\n\nvar TEMP_EXTENT$2 = new PointExtent();\n\nvar CollectionPainter = function (_Class) {\n  _inheritsLoose(CollectionPainter, _Class);\n\n  function CollectionPainter(geometry) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.geometry = geometry;\n    return _this;\n  }\n\n  var _proto = CollectionPainter.prototype;\n\n  _proto._eachPainter = function _eachPainter(fn) {\n    var geometries = this.geometry.getGeometries();\n    var painter;\n\n    for (var i = 0, len = geometries.length; i < len; i++) {\n      painter = geometries[i]._getPainter();\n\n      if (!painter) {\n        continue;\n      }\n\n      if (painter) {\n        if (fn.call(this, painter) === false) {\n          break;\n        }\n      }\n    }\n  };\n\n  _proto.paint = function paint(extent) {\n    if (!this.geometry) {\n      return;\n    }\n\n    this._eachPainter(function (painter) {\n      painter.paint(extent);\n    });\n  };\n\n  _proto.get2DExtent = function get2DExtent(resources, out) {\n    if (out) {\n      out.set(null, null, null, null);\n    }\n\n    var extent = out || new PointExtent();\n\n    this._eachPainter(function (painter) {\n      extent = extent._combine(painter.get2DExtent(resources, TEMP_EXTENT$2));\n    });\n\n    return extent;\n  };\n\n  _proto.getContainerExtent = function getContainerExtent() {\n    var extent = new PointExtent();\n\n    this._eachPainter(function (painter) {\n      extent = extent.combine(painter.getContainerExtent());\n    });\n\n    return extent;\n  };\n\n  _proto.remove = function remove() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.remove.apply(painter, args);\n    });\n  };\n\n  _proto.setZIndex = function setZIndex() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.setZIndex.apply(painter, args);\n    });\n  };\n\n  _proto.show = function show() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.show.apply(painter, args);\n    });\n  };\n\n  _proto.hide = function hide() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.hide.apply(painter, args);\n    });\n  };\n\n  _proto.repaint = function repaint() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.repaint.apply(painter, args);\n    });\n  };\n\n  _proto.refreshSymbol = function refreshSymbol() {\n    var args = arguments;\n\n    this._eachPainter(function (painter) {\n      painter.refreshSymbol.apply(painter, args);\n    });\n  };\n\n  _proto.hasPoint = function hasPoint() {\n    var result = false;\n\n    this._eachPainter(function (painter) {\n      if (painter.hasPoint()) {\n        result = true;\n        return false;\n      }\n\n      return true;\n    });\n\n    return result;\n  };\n\n  _proto.getMinAltitude = function getMinAltitude() {\n    var first = true;\n    var result = 0;\n\n    this._eachPainter(function (painter) {\n      var alt = painter.getMinAltitude();\n\n      if (first || alt < result) {\n        first = false;\n        result = alt;\n      }\n    });\n\n    return result;\n  };\n\n  _proto.getMaxAltitude = function getMaxAltitude() {\n    var result = 0;\n\n    this._eachPainter(function (painter) {\n      var alt = painter.getMaxAltitude();\n\n      if (alt > result) {\n        result = alt;\n      }\n    });\n\n    return result;\n  };\n\n  return CollectionPainter;\n}(Class);\n\nvar DefaultSpatialReference = {\n  'EPSG:3857': {\n    'resolutions': function () {\n      var resolutions = [];\n      var d = 2 * 6378137 * Math.PI;\n\n      for (var i = 0; i < 21; i++) {\n        resolutions[i] = d / (256 * Math.pow(2, i));\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 6378137 * Math.PI,\n      'left': -6378137 * Math.PI,\n      'bottom': -6378137 * Math.PI,\n      'right': 6378137 * Math.PI\n    }\n  },\n  'EPSG:4326': {\n    'fullExtent': {\n      'top': 90,\n      'left': -180,\n      'bottom': -90,\n      'right': 180\n    },\n    'resolutions': function () {\n      var resolutions = [];\n\n      for (var i = 0; i < 20; i++) {\n        resolutions[i] = 180 / (Math.pow(2, i) * 128);\n      }\n\n      return resolutions;\n    }()\n  },\n  'BAIDU': {\n    'resolutions': function () {\n      var res = Math.pow(2, 18);\n      var resolutions = [];\n\n      for (var i = 0; i < 20; i++) {\n        resolutions[i] = res;\n        res *= 0.5;\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 33554432,\n      'left': -33554432,\n      'bottom': -33554432,\n      'right': 33554432\n    }\n  },\n  'IDENTITY': {\n    'resolutions': function () {\n      var res = Math.pow(2, 8);\n      var resolutions = [];\n\n      for (var i = 0; i < 18; i++) {\n        resolutions[i] = res;\n        res *= 0.5;\n      }\n\n      return resolutions;\n    }(),\n    'fullExtent': {\n      'top': 200000,\n      'left': -200000,\n      'bottom': -200000,\n      'right': 200000\n    }\n  }\n};\nDefaultSpatialReference['EPSG:4490'] = DefaultSpatialReference['EPSG:4326'];\n\nvar SpatialReference = function () {\n  function SpatialReference(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.options = options;\n\n    this._initSpatialRef();\n  }\n\n  SpatialReference.getProjectionInstance = function getProjectionInstance(prjName) {\n    if (!prjName) {\n      return null;\n    }\n\n    if (isObject(prjName)) {\n      return prjName;\n    }\n\n    prjName = (prjName + '').toLowerCase();\n\n    for (var p in projections) {\n      if (hasOwn(projections, p)) {\n        var code = projections[p]['code'];\n\n        if (code && code.toLowerCase() === prjName) {\n          return projections[p];\n        }\n      }\n    }\n\n    return null;\n  };\n\n  SpatialReference.equals = function equals(sp1, sp2) {\n    if (!sp1 && !sp2) {\n      return true;\n    } else if (!sp1 || !sp2) {\n      return false;\n    }\n\n    if (sp1.projection !== sp2.projection) {\n      return false;\n    }\n\n    var f1 = sp1.fullExtent,\n        f2 = sp2.fullExtent;\n\n    if (f1 && !f2 || !f1 && f2) {\n      return false;\n    }\n\n    if (f1 && f2) {\n      if (f1.top !== f2.top || f1.bottom !== f2.bottom || f1.left !== f2.left || f1.right !== f2.right) {\n        return false;\n      }\n    }\n\n    var r1 = sp1.resolutions,\n        r2 = sp2.resolutions;\n\n    if (r1 && r2) {\n      if (r1.length !== r2.length) {\n        return false;\n      }\n\n      for (var i = 0; i < r1.length; i++) {\n        if (r1[i] !== r2[i]) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  };\n\n  var _proto = SpatialReference.prototype;\n\n  _proto._initSpatialRef = function _initSpatialRef() {\n    var projection = this.options['projection'];\n\n    if (projection) {\n      projection = SpatialReference.getProjectionInstance(projection);\n    } else {\n      projection = DEFAULT$1;\n    }\n\n    if (!projection) {\n      throw new Error('must provide a valid projection in map\\'s spatial reference.');\n    }\n\n    projection = extend({}, Common, projection);\n\n    if (!projection.measureLength) {\n      extend(projection, Measurer.DEFAULT);\n    }\n\n    this._projection = projection;\n    var defaultSpatialRef,\n        resolutions = this.options['resolutions'];\n\n    if (!resolutions) {\n      if (projection['code']) {\n        defaultSpatialRef = DefaultSpatialReference[projection['code']];\n\n        if (defaultSpatialRef) {\n          resolutions = defaultSpatialRef['resolutions'];\n          this.isEPSG = projection['code'] !== 'IDENTITY';\n        }\n      }\n\n      if (!resolutions) {\n        throw new Error('must provide valid resolutions in map\\'s spatial reference.');\n      }\n    }\n\n    this._resolutions = resolutions;\n    var fullExtent = this.options['fullExtent'];\n\n    if (!fullExtent) {\n      if (projection['code']) {\n        defaultSpatialRef = DefaultSpatialReference[projection['code']];\n\n        if (defaultSpatialRef) {\n          fullExtent = defaultSpatialRef['fullExtent'];\n        }\n      }\n\n      if (!fullExtent) {\n        throw new Error('must provide a valid fullExtent in map\\'s spatial reference.');\n      }\n    }\n\n    if (!isNil(fullExtent['left'])) {\n      this._fullExtent = new Extent(new Coordinate(fullExtent['left'], fullExtent['top']), new Coordinate(fullExtent['right'], fullExtent['bottom']));\n    } else {\n      this._fullExtent = new Extent(fullExtent);\n      fullExtent['left'] = fullExtent['xmin'];\n      fullExtent['right'] = fullExtent['xmax'];\n      fullExtent['top'] = fullExtent['ymax'];\n      fullExtent['bottom'] = fullExtent['ymin'];\n    }\n\n    if (isNil(fullExtent['top']) || isNil(fullExtent['bottom']) || isNil(fullExtent['left']) || isNil(fullExtent['right'])) {\n      throw new Error('must provide valid top/bottom/left/right in fullExtent.');\n    }\n\n    extend(this._fullExtent, fullExtent);\n    this._projection.fullExtent = fullExtent;\n    var a = fullExtent['right'] >= fullExtent['left'] ? 1 : -1,\n        b = fullExtent['top'] >= fullExtent['bottom'] ? -1 : 1;\n    this._transformation = new Transformation([a, b, 0, 0]);\n  };\n\n  _proto.getResolutions = function getResolutions() {\n    return this._resolutions || [];\n  };\n\n  _proto.getResolution = function getResolution(zoom) {\n    var z = zoom | 0;\n\n    if (z < 0) {\n      z = 0;\n    } else if (z > this._resolutions.length - 1) {\n      z = this._resolutions.length - 1;\n    }\n\n    var res = this._resolutions[z];\n\n    if (z !== zoom && zoom > 0 && z < this._resolutions.length - 1) {\n      var next = this._resolutions[z + 1];\n      return res + (next - res) * (zoom - z);\n    }\n\n    return res;\n  };\n\n  _proto.getProjection = function getProjection() {\n    return this._projection;\n  };\n\n  _proto.getFullExtent = function getFullExtent() {\n    return this._fullExtent;\n  };\n\n  _proto.getTransformation = function getTransformation() {\n    return this._transformation;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    for (var i = 0; i < this._resolutions.length; i++) {\n      if (!isNil(this._resolutions[i])) {\n        return i;\n      }\n    }\n\n    return 0;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    for (var i = this._resolutions.length - 1; i >= 0; i--) {\n      if (!isNil(this._resolutions[i])) {\n        return i;\n      }\n    }\n\n    return this._resolutions.length - 1;\n  };\n\n  _proto.getZoomDirection = function getZoomDirection() {\n    return sign(this._resolutions[this.getMinZoom()] - this._resolutions[this.getMaxZoom()]);\n  };\n\n  _proto.toJSON = function toJSON() {\n    if (!this.json) {\n      this.json = {\n        'resolutions': this._resolutions,\n        'fullExtent': {\n          'top': this._fullExtent.top,\n          'left': this._fullExtent.left,\n          'bottom': this._fullExtent.bottom,\n          'right': this._fullExtent.right\n        },\n        'projection': this._projection.code\n      };\n    }\n\n    return this.json;\n  };\n\n  return SpatialReference;\n}();\n\nvar options = {\n  'id': null,\n  'visible': true,\n  'interactive': true,\n  'editable': true,\n  'cursor': null,\n  'defaultProjection': 'EPSG:4326'\n};\n\nvar Geometry = function (_JSONAble) {\n  _inheritsLoose(Geometry, _JSONAble);\n\n  function Geometry(options) {\n    var _this;\n\n    var opts = extend({}, options);\n    var symbol = opts['symbol'];\n    var properties = opts['properties'];\n    var id = opts['id'];\n    delete opts['symbol'];\n    delete opts['id'];\n    delete opts['properties'];\n    _this = _JSONAble.call(this, opts) || this;\n\n    if (symbol) {\n      _this.setSymbol(symbol);\n    }\n\n    if (properties) {\n      _this.setProperties(properties);\n    }\n\n    if (!isNil(id)) {\n      _this.setId(id);\n    }\n\n    return _this;\n  }\n\n  var _proto = Geometry.prototype;\n\n  _proto.getFirstCoordinate = function getFirstCoordinate() {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n\n      if (!geometries.length) {\n        return null;\n      }\n\n      return geometries[0].getFirstCoordinate();\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      return coordinates;\n    }\n\n    do {\n      coordinates = coordinates[0];\n    } while (Array.isArray(coordinates) && coordinates.length > 0);\n\n    return coordinates;\n  };\n\n  _proto.getLastCoordinate = function getLastCoordinate() {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n\n      if (!geometries.length) {\n        return null;\n      }\n\n      return geometries[geometries.length - 1].getLastCoordinate();\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      return coordinates;\n    }\n\n    do {\n      coordinates = coordinates[coordinates.length - 1];\n    } while (Array.isArray(coordinates) && coordinates.length > 0);\n\n    return coordinates;\n  };\n\n  _proto.addTo = function addTo(layer, fitview) {\n    layer.addGeometry(this, fitview);\n    return this;\n  };\n\n  _proto.getLayer = function getLayer() {\n    if (!this._layer) {\n      return null;\n    }\n\n    return this._layer;\n  };\n\n  _proto.getMap = function getMap() {\n    if (!this._layer) {\n      return null;\n    }\n\n    return this._layer.getMap();\n  };\n\n  _proto.getId = function getId() {\n    return this._id;\n  };\n\n  _proto.setId = function setId(id) {\n    var oldId = this.getId();\n    this._id = id;\n\n    this._fireEvent('idchange', {\n      'old': oldId,\n      'new': id\n    });\n\n    return this;\n  };\n\n  _proto.getProperties = function getProperties() {\n    if (!this.properties) {\n      if (this._getParent()) {\n        return this._getParent().getProperties();\n      }\n\n      return null;\n    }\n\n    return this.properties;\n  };\n\n  _proto.setProperties = function setProperties(properties) {\n    var old = this.properties;\n    this.properties = isObject(properties) ? extend({}, properties) : properties;\n\n    this._repaint();\n\n    this._fireEvent('propertieschange', {\n      'old': old,\n      'new': properties\n    });\n\n    return this;\n  };\n\n  _proto.getType = function getType() {\n    return this.type;\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var s = this._symbol;\n\n    if (s) {\n      if (!Array.isArray(s)) {\n        return extend({}, s);\n      } else {\n        return extendSymbol(s);\n      }\n    }\n\n    return null;\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    this._symbol = this._prepareSymbol(symbol);\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto.updateSymbol = function updateSymbol(props) {\n    if (!props) {\n      return this;\n    }\n\n    var s = this._getSymbol();\n\n    if (s) {\n      s = extendSymbol(s, props);\n    } else {\n      s = extendSymbol(this._getInternalSymbol(), props);\n    }\n\n    this._eventSymbolProperties = props;\n    return this.setSymbol(s);\n  };\n\n  _proto.getCenter = function getCenter() {\n    return this._computeCenter(this._getMeasurer());\n  };\n\n  _proto.getExtent = function getExtent() {\n    var prjExt = this._getPrjExtent();\n\n    var projection = this._getProjection();\n\n    if (prjExt && projection) {\n      var min = projection.unproject(new Coordinate(prjExt['xmin'], prjExt['ymin'])),\n          max = projection.unproject(new Coordinate(prjExt['xmax'], prjExt['ymax']));\n      return new Extent(min, max, projection);\n    } else {\n      return this._computeExtent(this._getMeasurer());\n    }\n  };\n\n  _proto.getContainerExtent = function getContainerExtent(out) {\n    var painter = this._getPainter();\n\n    return painter ? painter.getContainerExtent(out) : null;\n  };\n\n  _proto.getSize = function getSize() {\n    var extent = this.getContainerExtent();\n    return extent ? extent.getSize() : null;\n  };\n\n  _proto.containsPoint = function containsPoint(containerPoint, t) {\n    if (!this.getMap()) {\n      throw new Error('The geometry is required to be added on a map to perform \"containsPoint\".');\n    }\n\n    if (containerPoint instanceof Coordinate) {\n      containerPoint = this.getMap().coordToContainerPoint(containerPoint);\n    }\n\n    return this._containsPoint(containerPoint, t);\n  };\n\n  _proto._containsPoint = function _containsPoint(containerPoint, t) {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return false;\n    }\n\n    if (isNil(t) && this._hitTestTolerance) {\n      t = this._hitTestTolerance();\n    }\n\n    return painter.hitTest(containerPoint, t);\n  };\n\n  _proto.show = function show() {\n    this.options['visible'] = true;\n\n    if (this.getMap()) {\n      var painter = this._getPainter();\n\n      if (painter) {\n        painter.show();\n      }\n\n      this._fireEvent('show');\n    }\n\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.options['visible'] = false;\n\n    if (this.getMap()) {\n      this.onHide();\n\n      var painter = this._getPainter();\n\n      if (painter) {\n        painter.hide();\n      }\n\n      this._fireEvent('hide');\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!this.options['visible']) {\n      return false;\n    }\n\n    var symbol = this._getInternalSymbol();\n\n    if (!symbol) {\n      return true;\n    }\n\n    if (Array.isArray(symbol)) {\n      if (!symbol.length) {\n        return true;\n      }\n\n      for (var i = 0, l = symbol.length; i < l; i++) {\n        if (isNil(symbol[i]['opacity']) || symbol[i]['opacity'] > 0) {\n          return true;\n        }\n      }\n\n      return false;\n    } else {\n      return isNil(symbol['opacity']) || isNumber(symbol['opacity']) && symbol['opacity'] > 0;\n    }\n  };\n\n  _proto.getZIndex = function getZIndex() {\n    return this.options['zIndex'] || 0;\n  };\n\n  _proto.setZIndex = function setZIndex(zIndex) {\n    var old = this.options['zIndex'];\n    this.options['zIndex'] = zIndex;\n\n    this._fireEvent('zindexchange', {\n      'old': old,\n      'new': zIndex\n    });\n\n    return this;\n  };\n\n  _proto.setZIndexSilently = function setZIndexSilently(zIndex) {\n    this.options['zIndex'] = zIndex;\n    return this;\n  };\n\n  _proto.bringToFront = function bringToFront() {\n    var layer = this.getLayer();\n\n    if (!layer || !layer.getGeoMaxZIndex) {\n      return this;\n    }\n\n    var topZ = layer.getGeoMaxZIndex();\n    this.setZIndex(topZ + 1);\n    return this;\n  };\n\n  _proto.bringToBack = function bringToBack() {\n    var layer = this.getLayer();\n\n    if (!layer || !layer.getGeoMinZIndex) {\n      return this;\n    }\n\n    var bottomZ = layer.getGeoMinZIndex();\n    this.setZIndex(bottomZ - 1);\n    return this;\n  };\n\n  _proto.translate = function translate(x, y) {\n    if (isNil(x)) {\n      return this;\n    }\n\n    var offset = new Coordinate(x, y);\n\n    if (offset.x === 0 && offset.y === 0) {\n      return this;\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (coordinates) {\n      if (Array.isArray(coordinates)) {\n        var translated = forEachCoord(coordinates, function (coord) {\n          return coord.add(offset);\n        });\n        this.setCoordinates(translated);\n      } else {\n        this.setCoordinates(coordinates.add(offset));\n      }\n    }\n\n    return this;\n  };\n\n  _proto.flash = function flash$$1(interval, count, cb, context) {\n    return flash.call(this, interval, count, cb, context);\n  };\n\n  _proto.copy = function copy() {\n    var json = this.toJSON();\n    var ret = Geometry.fromJSON(json);\n    ret.options['visible'] = true;\n    return ret;\n  };\n\n  _proto.remove = function remove() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return this;\n    }\n\n    this._fireEvent('removestart');\n\n    this._unbind();\n\n    this._fireEvent('removeend');\n\n    this._fireEvent('remove');\n\n    return this;\n  };\n\n  _proto.toGeoJSONGeometry = function toGeoJSONGeometry() {\n    var gJson = this._exportGeoJSONGeometry();\n\n    return gJson;\n  };\n\n  _proto.toGeoJSON = function toGeoJSON(opts) {\n    if (!opts) {\n      opts = {};\n    }\n\n    var feature = {\n      'type': 'Feature',\n      'geometry': null\n    };\n\n    if (isNil(opts['geometry']) || opts['geometry']) {\n      var geoJSON = this._exportGeoJSONGeometry();\n\n      feature['geometry'] = geoJSON;\n    }\n\n    var id = this.getId();\n\n    if (!isNil(id)) {\n      feature['id'] = id;\n    }\n\n    var properties;\n\n    if (isNil(opts['properties']) || opts['properties']) {\n      properties = this._exportProperties();\n    }\n\n    feature['properties'] = properties;\n    return feature;\n  };\n\n  _proto.toJSON = function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var json = this._toJSON(options);\n\n    var other = this._exportGraphicOptions(options);\n\n    extend(json, other);\n    return json;\n  };\n\n  _proto.getLength = function getLength() {\n    return this._computeGeodesicLength(this._getMeasurer());\n  };\n\n  _proto.getArea = function getArea() {\n    return this._computeGeodesicArea(this._getMeasurer());\n  };\n\n  _proto.rotate = function rotate(angle, pivot) {\n    if (this.type === 'GeometryCollection') {\n      var geometries = this.getGeometries();\n      geometries.forEach(function (g) {\n        return g.rotate(angle, pivot);\n      });\n      return this;\n    }\n\n    if (!pivot) {\n      pivot = this.getCenter();\n    } else {\n      pivot = new Coordinate(pivot);\n    }\n\n    var measurer = this._getMeasurer();\n\n    var coordinates = this.getCoordinates();\n\n    if (!Array.isArray(coordinates)) {\n      if (pivot.x !== coordinates.x || pivot.y !== coordinates.y) {\n        var c = measurer._rotate(coordinates, pivot, angle);\n\n        this.setCoordinates(c);\n      }\n\n      return this;\n    }\n\n    forEachCoord(coordinates, function (c) {\n      return measurer._rotate(c, pivot, angle);\n    });\n    this.setCoordinates(coordinates);\n    return this;\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    return [this.getCenter()];\n  };\n\n  _proto._initOptions = function _initOptions(options) {\n    var opts = extend({}, options);\n    var symbol = opts['symbol'];\n    var properties = opts['properties'];\n    var id = opts['id'];\n    delete opts['symbol'];\n    delete opts['id'];\n    delete opts['properties'];\n    this.setOptions(opts);\n\n    if (symbol) {\n      this.setSymbol(symbol);\n    }\n\n    if (properties) {\n      this.setProperties(properties);\n    }\n\n    if (!isNil(id)) {\n      this.setId(id);\n    }\n  };\n\n  _proto._bindLayer = function _bindLayer(layer) {\n    if (this.getLayer()) {\n      throw new Error('Geometry cannot be added to two or more layers at the same time.');\n    }\n\n    this._layer = layer;\n\n    this._clearCache();\n  };\n\n  _proto._prepareSymbol = function _prepareSymbol(symbol) {\n    if (Array.isArray(symbol)) {\n      var cookedSymbols = [];\n\n      for (var i = 0; i < symbol.length; i++) {\n        cookedSymbols.push(convertResourceUrl(this._checkAndCopySymbol(symbol[i])));\n      }\n\n      return cookedSymbols;\n    } else if (symbol) {\n      symbol = this._checkAndCopySymbol(symbol);\n      return convertResourceUrl(symbol);\n    }\n\n    return null;\n  };\n\n  _proto._checkAndCopySymbol = function _checkAndCopySymbol(symbol) {\n    var s = {};\n\n    for (var i in symbol) {\n      if (NUMERICAL_PROPERTIES[i] && isString(symbol[i])) {\n        s[i] = +symbol[i];\n      } else {\n        s[i] = symbol[i];\n      }\n    }\n\n    return s;\n  };\n\n  _proto._getSymbol = function _getSymbol() {\n    return this._symbol;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    this._externSymbol = this._prepareSymbol(symbol);\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._getInternalSymbol = function _getInternalSymbol() {\n    if (this._symbol) {\n      return this._symbol;\n    } else if (this._externSymbol) {\n      return this._externSymbol;\n    } else if (this.options['symbol']) {\n      return this.options['symbol'];\n    }\n\n    return null;\n  };\n\n  _proto._getPrjExtent = function _getPrjExtent() {\n    var p = this._getProjection();\n\n    this._verifyProjection();\n\n    if (!this._extent && p) {\n      this._extent = this._computePrjExtent(p);\n    }\n\n    return this._extent;\n  };\n\n  _proto._unbind = function _unbind() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return;\n    }\n\n    if (this._animPlayer) {\n      this._animPlayer.finish();\n    }\n\n    this._clearHandlers();\n\n    this._unbindMenu();\n\n    this._unbindInfoWindow();\n\n    if (this.isEditing()) {\n      this.endEdit();\n    }\n\n    this._removePainter();\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    if (layer.onRemoveGeometry) {\n      layer.onRemoveGeometry(this);\n    }\n\n    delete this._layer;\n    delete this._internalId;\n    delete this._extent;\n  };\n\n  _proto._getInternalId = function _getInternalId() {\n    return this._internalId;\n  };\n\n  _proto._setInternalId = function _setInternalId(id) {\n    this._internalId = id;\n  };\n\n  _proto._getMeasurer = function _getMeasurer() {\n    if (this._getProjection()) {\n      return this._getProjection();\n    }\n\n    return SpatialReference.getProjectionInstance(this.options['defaultProjection']);\n  };\n\n  _proto._getProjection = function _getProjection() {\n    var map = this.getMap();\n\n    if (map) {\n      return map.getProjection();\n    }\n\n    return null;\n  };\n\n  _proto._verifyProjection = function _verifyProjection() {\n    var projection = this._getProjection();\n\n    if (this._projCode && projection && this._projCode !== projection.code) {\n      this._clearProjection();\n    }\n\n    this._projCode = projection ? projection.code : this._projCode;\n  };\n\n  _proto._getExternalResources = function _getExternalResources() {\n    var symbol = this._getInternalSymbol();\n\n    return getExternalResources(symbol);\n  };\n\n  _proto._getPainter = function _getPainter() {\n    if (!this._painter && this.getMap()) {\n      if (GEOMETRY_COLLECTION_TYPES.indexOf(this.type) !== -1) {\n        this._painter = new CollectionPainter(this);\n      } else {\n        this._painter = new Painter(this);\n      }\n    }\n\n    return this._painter;\n  };\n\n  _proto._removePainter = function _removePainter() {\n    if (this._painter) {\n      this._painter.remove();\n    }\n\n    delete this._painter;\n  };\n\n  _proto._paint = function _paint(extent) {\n    if (this._painter) {\n      this._painter.paint(extent);\n    }\n  };\n\n  _proto._clearCache = function _clearCache() {\n    delete this._extent;\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    delete this._extent;\n  };\n\n  _proto._repaint = function _repaint() {\n    if (this._painter) {\n      this._painter.repaint();\n    }\n  };\n\n  _proto.onHide = function onHide() {\n    this.closeMenu();\n    this.closeInfoWindow();\n  };\n\n  _proto.onShapeChanged = function onShapeChanged() {\n    this._clearCache();\n\n    this._repaint();\n\n    this._fireEvent('shapechange');\n  };\n\n  _proto.onPositionChanged = function onPositionChanged() {\n    this._clearCache();\n\n    this._repaint();\n\n    this._fireEvent('positionchange');\n  };\n\n  _proto.onSymbolChanged = function onSymbolChanged() {\n    if (this._painter) {\n      this._painter.refreshSymbol();\n    }\n\n    var e = {};\n\n    if (this._eventSymbolProperties) {\n      e.properties = this._eventSymbolProperties;\n      delete this._eventSymbolProperties;\n    }\n\n    this._fireEvent('symbolchange', e);\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    var properties;\n\n    if (conf['properties']) {\n      properties = conf['properties'];\n      delete conf['properties'];\n    }\n\n    var needRepaint = false;\n\n    for (var p in conf) {\n      if (conf.hasOwnProperty(p)) {\n        var prefix = p.slice(0, 5);\n\n        if (prefix === 'arrow' || prefix === 'smoot') {\n          needRepaint = true;\n          break;\n        }\n      }\n    }\n\n    if (properties) {\n      this.setProperties(properties);\n\n      this._repaint();\n    } else if (needRepaint) {\n      this._repaint();\n    }\n  };\n\n  _proto._setParent = function _setParent(geometry) {\n    if (geometry) {\n      this._parent = geometry;\n    }\n  };\n\n  _proto._getParent = function _getParent() {\n    return this._parent;\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (this.getLayer() && this.getLayer()._onGeometryEvent) {\n      if (!param) {\n        param = {};\n      }\n\n      param['type'] = eventName;\n      param['target'] = this;\n\n      this.getLayer()._onGeometryEvent(param);\n    }\n\n    this.fire(eventName, param);\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options)\n    };\n  };\n\n  _proto._exportGraphicOptions = function _exportGraphicOptions(options) {\n    var json = {};\n\n    if (isNil(options['options']) || options['options']) {\n      json['options'] = this.config();\n    }\n\n    if (isNil(options['symbol']) || options['symbol']) {\n      json['symbol'] = this.getSymbol();\n    }\n\n    if (isNil(options['infoWindow']) || options['infoWindow']) {\n      if (this._infoWinOptions) {\n        json['infoWindow'] = this._infoWinOptions;\n      }\n    }\n\n    return json;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var points = this.getCoordinates();\n    var coordinates = Coordinate.toNumberArrays(points);\n    return {\n      'type': this.getType(),\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._exportProperties = function _exportProperties() {\n    var properties = null;\n    var geoProperties = this.getProperties();\n\n    if (!isNil(geoProperties)) {\n      if (isObject(geoProperties)) {\n        properties = extend({}, geoProperties);\n      } else {\n        properties = geoProperties;\n      }\n    }\n\n    return properties;\n  };\n\n  _proto.getAltitude = function getAltitude() {\n    var layer = this.getLayer();\n\n    if (!layer) {\n      return 0;\n    }\n\n    var layerOpts = layer.options,\n        properties = this.getProperties();\n    var altitude = layerOpts['enableAltitude'] ? properties ? properties[layerOpts['altitudeProperty']] : 0 : 0;\n    return altitude;\n  };\n\n  return Geometry;\n}(JSONAble(Eventable(Handlerable(Class))));\n\nGeometry.mergeOptions(options);\n\nvar options$1 = {\n  'attribution': null,\n  'minZoom': null,\n  'maxZoom': null,\n  'visible': true,\n  'opacity': 1,\n  'globalCompositeOperation': null,\n  'renderer': 'canvas',\n  'debugOutline': '#0f0',\n  'cssFilter': null,\n  'forceRenderOnMoving': false,\n  'forceRenderOnZooming': false,\n  'forceRenderOnRotating': false,\n  'hitDetect': function () {\n    return !Browser$1.mobile;\n  }()\n};\n\nvar Layer = function (_JSONAble) {\n  _inheritsLoose(Layer, _JSONAble);\n\n  function Layer(id, options) {\n    var _this;\n\n    var canvas;\n\n    if (options) {\n      canvas = options.canvas;\n      delete options.canvas;\n    }\n\n    _this = _JSONAble.call(this, options) || this;\n    _this._canvas = canvas;\n\n    _this.setId(id);\n\n    if (options) {\n      _this.setZIndex(options.zIndex);\n\n      if (options.mask) {\n        _this.setMask(Geometry.fromJSON(options.mask));\n      }\n    }\n\n    return _this;\n  }\n\n  var _proto = Layer.prototype;\n\n  _proto.load = function load() {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (this.onLoad()) {\n      this._initRenderer();\n\n      var zIndex = this.getZIndex();\n\n      if (!isNil(zIndex)) {\n        this._renderer.setZIndex(zIndex);\n\n        if (!this.isCanvasRender()) {\n          this._renderer.render();\n        }\n      }\n\n      this.onLoadEnd();\n    }\n\n    return this;\n  };\n\n  _proto.getId = function getId() {\n    return this._id;\n  };\n\n  _proto.setId = function setId(id) {\n    var old = this._id;\n\n    if (!isNil(id)) {\n      id = id + '';\n    }\n\n    this._id = id;\n    this.fire('idchange', {\n      'old': old,\n      'new': id\n    });\n    return this;\n  };\n\n  _proto.addTo = function addTo(map) {\n    map.addLayer(this);\n    return this;\n  };\n\n  _proto.setZIndex = function setZIndex(zIndex) {\n    this._zIndex = zIndex;\n\n    if (isNil(zIndex)) {\n      delete this.options['zIndex'];\n    } else {\n      this.options.zIndex = zIndex;\n    }\n\n    if (this.map) {\n      this.map._sortLayersByZIndex();\n    }\n\n    if (this._renderer) {\n      this._renderer.setZIndex(zIndex);\n    }\n\n    return this;\n  };\n\n  _proto.getZIndex = function getZIndex() {\n    return this._zIndex || 0;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    var map = this.getMap();\n    var minZoom = this.options['minZoom'];\n    return map ? Math.max(map.getMinZoom(), minZoom || 0) : minZoom;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    var map = this.getMap();\n    var maxZoom = this.options['maxZoom'];\n    return map ? Math.min(map.getMaxZoom(), isNil(maxZoom) ? Infinity : maxZoom) : maxZoom;\n  };\n\n  _proto.getOpacity = function getOpacity() {\n    return this.options['opacity'];\n  };\n\n  _proto.setOpacity = function setOpacity(op) {\n    this.config('opacity', op);\n    return this;\n  };\n\n  _proto.isCanvasRender = function isCanvasRender() {\n    var renderer = this._getRenderer();\n\n    return renderer && renderer instanceof CanvasRenderer;\n  };\n\n  _proto.getMap = function getMap() {\n    if (this.map) {\n      return this.map;\n    }\n\n    return null;\n  };\n\n  _proto.getProjection = function getProjection() {\n    var map = this.getMap();\n    return map ? map.getProjection() : null;\n  };\n\n  _proto.bringToFront = function bringToFront() {\n    var layers = this._getLayerList();\n\n    if (!layers.length) {\n      return this;\n    }\n\n    var topLayer = layers[layers.length - 1];\n\n    if (layers.length === 1 || topLayer === this) {\n      return this;\n    }\n\n    var max = topLayer.getZIndex();\n    this.setZIndex(max + 1);\n    return this;\n  };\n\n  _proto.bringToBack = function bringToBack() {\n    var layers = this._getLayerList();\n\n    if (!layers.length) {\n      return this;\n    }\n\n    var bottomLayer = layers[0];\n\n    if (layers.length === 1 || bottomLayer === this) {\n      return this;\n    }\n\n    var min = bottomLayer.getZIndex();\n    this.setZIndex(min - 1);\n    return this;\n  };\n\n  _proto.show = function show() {\n    var _this2 = this;\n\n    if (!this.options['visible']) {\n      this.options['visible'] = true;\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.show();\n      }\n\n      var map = this.getMap();\n\n      if (renderer && map) {\n        map.once('renderend', function () {\n          _this2.fire('show');\n        });\n      } else {\n        this.fire('show');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    var _this3 = this;\n\n    if (this.options['visible']) {\n      this.options['visible'] = false;\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.hide();\n      }\n\n      var map = this.getMap();\n\n      if (renderer && map) {\n        map.once('renderend', function () {\n          _this3.fire('hide');\n        });\n      } else {\n        this.fire('hide');\n      }\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (isNumber(this.options['opacity']) && this.options['opacity'] <= 0) {\n      return false;\n    }\n\n    var map = this.getMap();\n\n    if (map) {\n      var zoom = map.getZoom();\n\n      if (!isNil(this.options['maxZoom']) && this.options['maxZoom'] < zoom || !isNil(this.options['minZoom']) && this.options['minZoom'] > zoom) {\n        return false;\n      }\n    }\n\n    if (isNil(this.options['visible'])) {\n      this.options['visible'] = true;\n    }\n\n    return this.options['visible'];\n  };\n\n  _proto.remove = function remove() {\n    if (this.map) {\n      this.map.removeLayer(this);\n    }\n\n    return this;\n  };\n\n  _proto.getMask = function getMask() {\n    return this._mask;\n  };\n\n  _proto.setMask = function setMask(mask) {\n    if (!(mask.type === 'Point' && mask._isVectorMarker() || mask.type === 'Polygon' || mask.type === 'MultiPolygon')) {\n      throw new Error('Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).');\n    }\n\n    mask._bindLayer(this);\n\n    if (mask.type === 'Point') {\n      mask.updateSymbol({\n        'markerLineColor': 'rgba(0, 0, 0, 0)',\n        'markerFillOpacity': 0\n      });\n    } else {\n      mask.setSymbol({\n        'lineColor': 'rgba(0, 0, 0, 0)',\n        'polygonOpacity': 0\n      });\n    }\n\n    this._mask = mask;\n    this.options.mask = mask.toJSON();\n\n    if (!this.getMap() || this.getMap().isZooming()) {\n      return this;\n    }\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.setToRedraw) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.removeMask = function removeMask() {\n    delete this._mask;\n    delete this.options.mask;\n\n    if (!this.getMap() || this.getMap().isZooming()) {\n      return this;\n    }\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.setToRedraw) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.onLoad = function onLoad() {\n    return true;\n  };\n\n  _proto.onLoadEnd = function onLoadEnd() {};\n\n  _proto.isLoaded = function isLoaded() {\n    return !!this._loaded;\n  };\n\n  _proto.getRenderer = function getRenderer() {\n    return this._getRenderer();\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    if (isNumber(conf['opacity']) || conf['cssFilter']) {\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.onAdd = function onAdd() {};\n\n  _proto.onRendererCreate = function onRendererCreate() {};\n\n  _proto.onCanvasCreate = function onCanvasCreate() {};\n\n  _proto.onRemove = function onRemove() {};\n\n  _proto._bindMap = function _bindMap(map, zIndex) {\n    if (!map) {\n      return;\n    }\n\n    this.map = map;\n\n    if (!isNil(zIndex)) {\n      this.setZIndex(zIndex);\n    }\n\n    this._switchEvents('on', this);\n\n    this.onAdd();\n    this.fire('add');\n  };\n\n  _proto._initRenderer = function _initRenderer() {\n    var renderer = this.options['renderer'];\n\n    if (!this.constructor.getRendererClass) {\n      return;\n    }\n\n    var clazz = this.constructor.getRendererClass(renderer);\n\n    if (!clazz) {\n      throw new Error('Invalid renderer for Layer(' + this.getId() + '):' + renderer);\n    }\n\n    this._renderer = new clazz(this);\n    this._renderer.layer = this;\n\n    this._renderer.setZIndex(this.getZIndex());\n\n    this._switchEvents('on', this._renderer);\n\n    if (this._renderer.onAdd) {\n      this._renderer.onAdd();\n    }\n\n    this.onRendererCreate();\n    this.fire('renderercreate', {\n      'renderer': this._renderer\n    });\n  };\n\n  _proto._doRemove = function _doRemove() {\n    this._loaded = false;\n    this.onRemove();\n\n    this._switchEvents('off', this);\n\n    if (this._renderer) {\n      this._switchEvents('off', this._renderer);\n\n      this._renderer.remove();\n\n      delete this._renderer;\n    }\n\n    delete this.map;\n  };\n\n  _proto._switchEvents = function _switchEvents(to, emitter) {\n    if (emitter && emitter.getEvents) {\n      this.getMap()[to](emitter.getEvents(), emitter);\n    }\n  };\n\n  _proto._getRenderer = function _getRenderer() {\n    return this._renderer;\n  };\n\n  _proto._getLayerList = function _getLayerList() {\n    if (!this.map) {\n      return [];\n    }\n\n    return this.map._layers;\n  };\n\n  _proto._getMask2DExtent = function _getMask2DExtent() {\n    if (!this._mask || !this.getMap()) {\n      return null;\n    }\n\n    var painter = this._mask._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    return painter.get2DExtent();\n  };\n\n  return Layer;\n}(JSONAble(Eventable(Renderable(Class))));\n\nLayer.mergeOptions(options$1);\nvar fire = Layer.prototype.fire;\n\nLayer.prototype.fire = function (eventType, param) {\n  if (eventType === 'layerload') {\n    this._loaded = true;\n  }\n\n  if (this.map) {\n    if (!param) {\n      param = {};\n    }\n\n    param['type'] = eventType;\n    param['target'] = this;\n\n    this.map._onLayerEvent(param);\n  }\n\n  return fire.apply(this, arguments);\n};\n\nvar options$2 = {\n  'maxVisualPitch': 70,\n  'maxPitch': 80,\n  'centerCross': false,\n  'zoomInCenter': false,\n  'zoomOrigin': null,\n  'zoomAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'zoomAnimationDuration': 330,\n  'panAnimation': function () {\n    return !IS_NODE;\n  }(),\n  'panAnimationDuration': 600,\n  'zoomable': true,\n  'enableInfoWindow': true,\n  'hitDetect': function () {\n    return !Browser$1.mobile;\n  }(),\n  'hitDetectLimit': 5,\n  'fpsOnInteracting': 25,\n  'layerCanvasLimitOnInteracting': -1,\n  'maxZoom': null,\n  'minZoom': null,\n  'maxExtent': null,\n  'fixCenterOnResize': false,\n  'checkSize': true,\n  'checkSizeInterval': 1000,\n  'renderer': 'canvas',\n  'cascadePitches': [10, 60]\n};\n\nvar Map$1 = function (_Handlerable) {\n  _inheritsLoose(Map, _Handlerable);\n\n  function Map(container, options) {\n    var _this;\n\n    if (!options) {\n      throw new Error('Invalid options when creating map.');\n    }\n\n    if (!options['center']) {\n      throw new Error('Invalid center when creating map.');\n    }\n\n    var opts = extend({}, options);\n    var zoom = opts['zoom'];\n    delete opts['zoom'];\n    var center = new Coordinate(opts['center']);\n    delete opts['center'];\n    var baseLayer = opts['baseLayer'];\n    delete opts['baseLayer'];\n    var layers = opts['layers'];\n    delete opts['layers'];\n    _this = _Handlerable.call(this, opts) || this;\n    _this.VERSION = Map.VERSION;\n    Object.defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), 'id', {\n      value: UID(),\n      writable: false\n    });\n    _this._loaded = false;\n\n    _this._initContainer(container);\n\n    _this._panels = {};\n    _this._baseLayer = null;\n    _this._layers = [];\n    _this._zoomLevel = zoom;\n    _this._center = center;\n\n    _this.setSpatialReference(opts['spatialReference'] || opts['view']);\n\n    _this.setMaxExtent(opts['maxExtent']);\n\n    _this._mapViewPoint = new Point(0, 0);\n\n    _this._initRenderer();\n\n    _this._updateMapSize(_this._getContainerDomSize());\n\n    if (baseLayer) {\n      _this.setBaseLayer(baseLayer);\n    }\n\n    if (layers) {\n      _this.addLayer(layers);\n    }\n\n    _this._Load();\n\n    return _this;\n  }\n\n  Map.addOnLoadHook = function addOnLoadHook(fn) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    var onload = typeof fn === 'function' ? fn : function () {\n      this[fn].apply(this, args);\n    };\n    this.prototype._onLoadHooks = this.prototype._onLoadHooks || [];\n\n    this.prototype._onLoadHooks.push(onload);\n\n    return this;\n  };\n\n  var _proto = Map.prototype;\n\n  _proto.isLoaded = function isLoaded() {\n    return !!this._loaded;\n  };\n\n  _proto.getContainer = function getContainer() {\n    return this._containerDOM;\n  };\n\n  _proto.getSpatialReference = function getSpatialReference() {\n    return this._spatialReference;\n  };\n\n  _proto.setSpatialReference = function setSpatialReference(ref) {\n    var oldRef = this.options['spatialReference'];\n\n    if (this._loaded && SpatialReference.equals(oldRef, ref)) {\n      return this;\n    }\n\n    this._updateSpatialReference(ref, oldRef);\n\n    return this;\n  };\n\n  _proto._updateSpatialReference = function _updateSpatialReference(ref, oldRef) {\n    ref = extend({}, ref);\n    this._center = this.getCenter();\n    this.options['spatialReference'] = ref;\n    this._spatialReference = new SpatialReference(ref);\n\n    if (this.options['spatialReference'] && isFunction(this.options['spatialReference']['projection'])) {\n      var projection = this._spatialReference.getProjection();\n\n      this.options['spatialReference']['projection'] = projection['code'];\n    }\n\n    this._resetMapStatus();\n\n    this._fireEvent('spatialreferencechange', {\n      'old': oldRef,\n      'new': extend({}, this.options['spatialReference'])\n    });\n\n    return this;\n  };\n\n  _proto.onConfig = function onConfig(conf) {\n    var ref = conf['spatialReference'] || conf['view'];\n\n    if (!isNil(ref)) {\n      this._updateSpatialReference(ref, null);\n    }\n\n    return this;\n  };\n\n  _proto.getProjection = function getProjection() {\n    if (!this._spatialReference) {\n      return null;\n    }\n\n    return this._spatialReference.getProjection();\n  };\n\n  _proto.getFullExtent = function getFullExtent() {\n    if (!this._spatialReference) {\n      return null;\n    }\n\n    return this._spatialReference.getFullExtent();\n  };\n\n  _proto.setCursor = function setCursor(cursor) {\n    delete this._cursor;\n\n    this._trySetCursor(cursor);\n\n    this._cursor = cursor;\n    return this;\n  };\n\n  _proto.resetCursor = function resetCursor() {\n    return this.setCursor(null);\n  };\n\n  _proto.getCenter = function getCenter() {\n    if (!this._loaded || !this._prjCenter) {\n      return this._center;\n    }\n\n    var projection = this.getProjection();\n    return projection.unproject(this._prjCenter);\n  };\n\n  _proto.setCenter = function setCenter(center) {\n    if (!center) {\n      return this;\n    }\n\n    center = new Coordinate(center);\n    var projection = this.getProjection();\n    var pcenter = projection.project(center);\n\n    if (!this._verifyExtent(pcenter)) {\n      return this;\n    }\n\n    if (!this._loaded) {\n      this._center = center;\n      return this;\n    }\n\n    this.onMoveStart();\n\n    this._setPrjCenter(pcenter);\n\n    this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n    return this;\n  };\n\n  _proto.getSize = function getSize() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return this._getContainerDomSize();\n    }\n\n    return new Size(this.width, this.height);\n  };\n\n  _proto.getContainerExtent = function getContainerExtent() {\n    var visualHeight = this.height;\n    var pitch = this.getPitch(),\n        maxVisualPitch = this.options['maxVisualPitch'];\n\n    if (maxVisualPitch && pitch > maxVisualPitch) {\n      visualHeight = this._getVisualHeight(maxVisualPitch);\n    }\n\n    return new PointExtent(0, this.height - visualHeight, this.width, this.height);\n  };\n\n  _proto._getVisualHeight = function _getVisualHeight(visualPitch) {\n    var pitch = (90 - this.getPitch()) * Math.PI / 180;\n    var fov = this.getFov() * Math.PI / 180;\n    visualPitch *= Math.PI / 180;\n    var cameraToCenter = this.cameraCenterDistance / this.getGLScale();\n    var tanB = Math.tan(fov / 2);\n    var tanP = Math.tan(visualPitch);\n    var visualDistance = cameraToCenter * tanB / (1 / tanP - tanB) / Math.sin(visualPitch);\n    var x = cameraToCenter * (Math.sin(pitch) * visualDistance / (cameraToCenter + Math.cos(pitch) * visualDistance));\n    return this.height / 2 + x;\n  };\n\n  _proto.getExtent = function getExtent() {\n    return this._pointToExtent(this._get2DExtent());\n  };\n\n  _proto.getProjExtent = function getProjExtent() {\n    var extent2D = this._get2DExtent();\n\n    return new Extent(this._pointToPrj(extent2D.getMin()), this._pointToPrj(extent2D.getMax()));\n  };\n\n  _proto.getPrjExtent = function getPrjExtent() {\n    return this.getProjExtent();\n  };\n\n  _proto.getMaxExtent = function getMaxExtent() {\n    if (!this.options['maxExtent']) {\n      return null;\n    }\n\n    return new Extent(this.options['maxExtent'], this.getProjection());\n  };\n\n  _proto.setMaxExtent = function setMaxExtent(extent) {\n    if (extent) {\n      var maxExt = new Extent(extent, this.getProjection());\n      this.options['maxExtent'] = maxExt;\n\n      if (!this._verifyExtent(this._getPrjCenter())) {\n        this._panTo(this._prjMaxExtent().getCenter());\n      }\n\n      var projection = this.getProjection();\n      this._prjMaxExtent = maxExt.convertTo(function (c) {\n        return projection.project(c);\n      });\n    } else {\n      delete this.options['maxExtent'];\n      delete this._prjMaxExtent;\n    }\n\n    return this;\n  };\n\n  _proto.getZoom = function getZoom() {\n    return this._zoomLevel;\n  };\n\n  _proto.getZoomForScale = function getZoomForScale(scale, fromZoom, isFraction) {\n    var zoom = this.getZoom();\n\n    if (isNil(fromZoom)) {\n      fromZoom = zoom;\n    }\n\n    if (scale === 1 && fromZoom === zoom) {\n      return zoom;\n    }\n\n    var res = this._getResolution(fromZoom),\n        targetRes = res / scale;\n\n    var scaleZoom = this.getZoomFromRes(targetRes);\n\n    if (isFraction) {\n      return scaleZoom;\n    } else {\n      var delta = 1E-6;\n      return this.getSpatialReference().getZoomDirection() < 0 ? Math.ceil(scaleZoom - delta) : Math.floor(scaleZoom + delta);\n    }\n  };\n\n  _proto.getZoomFromRes = function getZoomFromRes(res) {\n    var resolutions = this._getResolutions(),\n        minRes = this._getResolution(this.getMinZoom()),\n        maxRes = this._getResolution(this.getMaxZoom());\n\n    if (minRes <= maxRes) {\n      if (res <= minRes) {\n        return this.getMinZoom();\n      } else if (res >= maxRes) {\n        return this.getMaxZoom();\n      }\n    } else if (res >= minRes) {\n      return this.getMinZoom();\n    } else if (res <= maxRes) {\n      return this.getMaxZoom();\n    }\n\n    var l = resolutions.length;\n\n    for (var i = 0; i < l - 1; i++) {\n      if (!resolutions[i]) {\n        continue;\n      }\n\n      var gap = resolutions[i + 1] - resolutions[i];\n      var test = res - resolutions[i];\n\n      if (sign(gap) === sign(test) && Math.abs(gap) >= Math.abs(test)) {\n        return i + test / gap;\n      }\n    }\n\n    return l - 1;\n  };\n\n  _proto.setZoom = function setZoom(zoom, options) {\n    if (options === void 0) {\n      options = {\n        'animation': true\n      };\n    }\n\n    if (isNaN(zoom) || isNil(zoom)) {\n      return this;\n    }\n\n    zoom = +zoom;\n\n    if (this._loaded && this.options['zoomAnimation'] && options['animation']) {\n      this._zoomAnimation(zoom);\n    } else {\n      this._zoom(zoom);\n    }\n\n    return this;\n  };\n\n  _proto.getMaxZoom = function getMaxZoom() {\n    if (!isNil(this.options['maxZoom'])) {\n      return this.options['maxZoom'];\n    }\n\n    return this.getMaxNativeZoom();\n  };\n\n  _proto.setMaxZoom = function setMaxZoom(maxZoom) {\n    var viewMaxZoom = this.getMaxNativeZoom();\n\n    if (maxZoom > viewMaxZoom) {\n      maxZoom = viewMaxZoom;\n    }\n\n    if (maxZoom !== null && maxZoom < this._zoomLevel) {\n      this.setZoom(maxZoom);\n      maxZoom = +maxZoom;\n    }\n\n    this.options['maxZoom'] = maxZoom;\n    return this;\n  };\n\n  _proto.getMinZoom = function getMinZoom() {\n    if (!isNil(this.options['minZoom'])) {\n      return this.options['minZoom'];\n    }\n\n    return this._spatialReference.getMinZoom();\n  };\n\n  _proto.setMinZoom = function setMinZoom(minZoom) {\n    if (minZoom !== null) {\n      minZoom = +minZoom;\n\n      var viewMinZoom = this._spatialReference.getMinZoom();\n\n      if (minZoom < viewMinZoom) {\n        minZoom = viewMinZoom;\n      }\n\n      if (minZoom > this._zoomLevel) {\n        this.setZoom(minZoom);\n      }\n    }\n\n    this.options['minZoom'] = minZoom;\n    return this;\n  };\n\n  _proto.getMaxNativeZoom = function getMaxNativeZoom() {\n    var ref = this.getSpatialReference();\n\n    if (!ref) {\n      return null;\n    }\n\n    return ref.getMaxZoom();\n  };\n\n  _proto.getGLZoom = function getGLZoom() {\n    return this.getMaxNativeZoom() / 2;\n  };\n\n  _proto.getGLScale = function getGLScale(zoom) {\n    if (isNil(zoom)) {\n      zoom = this.getZoom();\n    }\n\n    return this._getResolution(zoom) / this._getResolution(this.getGLZoom());\n  };\n\n  _proto.zoomIn = function zoomIn() {\n    return this.setZoom(this.getZoom() + 1);\n  };\n\n  _proto.zoomOut = function zoomOut() {\n    return this.setZoom(this.getZoom() - 1);\n  };\n\n  _proto.isZooming = function isZooming() {\n    return !!this._zooming;\n  };\n\n  _proto.isInteracting = function isInteracting() {\n    return this.isZooming() || this.isMoving() || this.isRotating();\n  };\n\n  _proto.setCenterAndZoom = function setCenterAndZoom(center, zoom) {\n    if (!isNil(zoom) && this._zoomLevel !== zoom) {\n      this.setCenter(center);\n      this.setZoom(zoom, {\n        animation: false\n      });\n    } else {\n      this.setCenter(center);\n    }\n\n    return this;\n  };\n\n  _proto.getFitZoom = function getFitZoom(extent, isFraction) {\n    var _this2 = this;\n\n    if (!extent || !(extent instanceof Extent)) {\n      return this._zoomLevel;\n    }\n\n    if (extent['xmin'] === extent['xmax'] && extent['ymin'] === extent['ymax']) {\n      return this.getMaxZoom();\n    }\n\n    var size = this.getSize();\n    var containerExtent = extent.convertTo(function (p) {\n      return _this2.coordToContainerPoint(p);\n    });\n    var w = containerExtent.getWidth(),\n        h = containerExtent.getHeight();\n    var scaleX = size['width'] / w,\n        scaleY = size['height'] / h;\n    var scale = this.getSpatialReference().getZoomDirection() < 0 ? Math.max(scaleX, scaleY) : Math.min(scaleX, scaleY);\n    var zoom = this.getZoomForScale(scale, null, isFraction);\n    return zoom;\n  };\n\n  _proto.getView = function getView() {\n    return {\n      'center': this.getCenter().toArray(),\n      'zoom': this.getZoom(),\n      'pitch': this.getPitch(),\n      'bearing': this.getBearing()\n    };\n  };\n\n  _proto.setView = function setView(view) {\n    if (!view) {\n      return this;\n    }\n\n    if (view['center']) {\n      this.setCenter(view['center']);\n    }\n\n    if (view['zoom'] !== null && !isNaN(+view['zoom'])) {\n      this.setZoom(+view['zoom'], {\n        'animation': false\n      });\n    }\n\n    if (view['pitch'] !== null && !isNaN(+view['pitch'])) {\n      this.setPitch(+view['pitch']);\n    }\n\n    if (view['pitch'] !== null && !isNaN(+view['bearing'])) {\n      this.setBearing(+view['bearing']);\n    }\n\n    return this;\n  };\n\n  _proto.getResolution = function getResolution(zoom) {\n    return this._getResolution(zoom);\n  };\n\n  _proto.getScale = function getScale(zoom) {\n    var z = isNil(zoom) ? this.getZoom() : zoom;\n\n    var max = this._getResolution(this.getMaxNativeZoom()),\n        res = this._getResolution(z);\n\n    return res / max;\n  };\n\n  _proto.fitExtent = function fitExtent(extent, zoomOffset, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!extent) {\n      return this;\n    }\n\n    extent = new Extent(extent, this.getProjection());\n    var zoom = this.getFitZoom(extent) + (zoomOffset || 0);\n    var center = extent.getCenter();\n    if (typeof options['animation'] === 'undefined' || options['animation']) return this._animateTo({\n      center: center,\n      zoom: zoom\n    }, {\n      'duration': options['duration'] || this.options['zoomAnimationDuration'],\n      'easing': options['easing'] || 'out'\n    }, step);else return this.setCenterAndZoom(center, zoom);\n  };\n\n  _proto.getBaseLayer = function getBaseLayer() {\n    return this._baseLayer;\n  };\n\n  _proto.setBaseLayer = function setBaseLayer(baseLayer) {\n    var isChange = false;\n\n    if (this._baseLayer) {\n      isChange = true;\n\n      this._fireEvent('baselayerchangestart');\n\n      this._baseLayer.remove();\n    }\n\n    if (!baseLayer) {\n      delete this._baseLayer;\n\n      this._fireEvent('baselayerchangeend');\n\n      this._fireEvent('setbaselayer');\n\n      return this;\n    }\n\n    this._baseLayer = baseLayer;\n\n    baseLayer._bindMap(this, -1);\n\n    function onbaseLayerload() {\n      this._fireEvent('baselayerload');\n\n      if (isChange) {\n        isChange = false;\n\n        this._fireEvent('baselayerchangeend');\n      }\n    }\n\n    this._baseLayer.on('layerload', onbaseLayerload, this);\n\n    if (this._loaded) {\n      this._baseLayer.load();\n    }\n\n    this._fireEvent('setbaselayer');\n\n    return this;\n  };\n\n  _proto.removeBaseLayer = function removeBaseLayer() {\n    if (this._baseLayer) {\n      this._baseLayer.remove();\n\n      delete this._baseLayer;\n\n      this._fireEvent('baselayerremove');\n    }\n\n    return this;\n  };\n\n  _proto.getLayers = function getLayers(filter) {\n    return this._getLayers(function (layer) {\n      if (layer === this._baseLayer || layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n        return false;\n      }\n\n      if (filter) {\n        return filter(layer);\n      }\n\n      return true;\n    });\n  };\n\n  _proto.getLayer = function getLayer(id) {\n    if (!id) {\n      return null;\n    }\n\n    var layer = this._layerCache ? this._layerCache[id] : null;\n\n    if (layer) {\n      return layer;\n    }\n\n    var baseLayer = this.getBaseLayer();\n\n    if (baseLayer && baseLayer.getId() === id) {\n      return baseLayer;\n    }\n\n    return null;\n  };\n\n  _proto.addLayer = function addLayer(layers) {\n    if (!layers) {\n      return this;\n    }\n\n    if (!Array.isArray(layers)) {\n      layers = Array.prototype.slice.call(arguments, 0);\n      return this.addLayer(layers);\n    }\n\n    if (!this._layerCache) {\n      this._layerCache = {};\n    }\n\n    var mapLayers = this._layers;\n\n    for (var i = 0, len = layers.length; i < len; i++) {\n      var layer = layers[i];\n      var id = layer.getId();\n\n      if (isNil(id)) {\n        throw new Error('Invalid id for the layer: ' + id);\n      }\n\n      if (layer.getMap() === this) {\n        continue;\n      }\n\n      if (this._layerCache[id]) {\n        throw new Error('Duplicate layer id in the map: ' + id);\n      }\n\n      this._layerCache[id] = layer;\n\n      layer._bindMap(this);\n\n      mapLayers.push(layer);\n\n      if (this._loaded) {\n        layer.load();\n      }\n    }\n\n    this._sortLayersByZIndex();\n\n    this._fireEvent('addlayer', {\n      'layers': layers\n    });\n\n    return this;\n  };\n\n  _proto.removeLayer = function removeLayer(layers) {\n    if (!layers) {\n      return this;\n    }\n\n    if (!Array.isArray(layers)) {\n      return this.removeLayer([layers]);\n    }\n\n    var removed = [];\n\n    for (var i = 0, len = layers.length; i < len; i++) {\n      var layer = layers[i];\n\n      if (!(layer instanceof Layer)) {\n        layer = this.getLayer(layer);\n      }\n\n      if (!layer) {\n        continue;\n      }\n\n      var map = layer.getMap();\n\n      if (!map || map !== this) {\n        continue;\n      }\n\n      removed.push(layer);\n\n      this._removeLayer(layer, this._layers);\n\n      if (this._loaded) {\n        layer._doRemove();\n      }\n\n      var id = layer.getId();\n\n      if (this._layerCache) {\n        delete this._layerCache[id];\n      }\n    }\n\n    if (removed.length > 0) {\n      var renderer = this.getRenderer();\n\n      if (renderer) {\n        renderer.setLayerCanvasUpdated();\n      }\n\n      this.once('frameend', function () {\n        removed.forEach(function (layer) {\n          layer.fire('remove');\n        });\n      });\n    }\n\n    this._fireEvent('removelayer', {\n      'layers': layers\n    });\n\n    return this;\n  };\n\n  _proto.sortLayers = function sortLayers(layers) {\n    if (!layers || !Array.isArray(layers)) {\n      return this;\n    }\n\n    var layersToOrder = [];\n    var minZ = Number.MAX_VALUE;\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var layer = layers[i];\n\n      if (isString(layers[i])) {\n        layer = this.getLayer(layer);\n      }\n\n      if (!(layer instanceof Layer) || !layer.getMap() || layer.getMap() !== this) {\n        throw new Error('It must be a layer added to this map to order.');\n      }\n\n      if (layer.getZIndex() < minZ) {\n        minZ = layer.getZIndex();\n      }\n\n      layersToOrder.push(layer);\n    }\n\n    for (var _i = 0, _l = layersToOrder.length; _i < _l; _i++) {\n      layersToOrder[_i].setZIndex(minZ + _i);\n    }\n\n    return this;\n  };\n\n  _proto.toDataURL = function toDataURL(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var mimeType = options['mimeType'];\n\n    if (!mimeType) {\n      mimeType = 'image/png';\n    }\n\n    var save = options['save'];\n\n    var renderer = this._getRenderer();\n\n    if (renderer && renderer.toDataURL) {\n      var file = options['fileName'];\n\n      if (!file) {\n        file = 'export';\n      }\n\n      var dataURL = renderer.toDataURL(mimeType);\n\n      if (save && dataURL) {\n        var imgURL;\n\n        if (typeof Blob !== 'undefined' && typeof atob !== 'undefined') {\n          var blob = b64toBlob(dataURL.replace(/^data:image\\/(png|jpeg|jpg);base64,/, ''), mimeType);\n          imgURL = URL.createObjectURL(blob);\n        } else {\n          imgURL = dataURL;\n        }\n\n        var dlLink = document.createElement('a');\n        dlLink.download = file;\n        dlLink.href = imgURL;\n        document.body.appendChild(dlLink);\n        dlLink.click();\n        document.body.removeChild(dlLink);\n      }\n\n      return dataURL;\n    }\n\n    return null;\n  };\n\n  _proto.coordToPoint = function coordToPoint(coordinate, zoom, out) {\n    return this.coordinateToPoint(coordinate, zoom, out);\n  };\n\n  _proto.pointToCoord = function pointToCoord(point, zoom, out) {\n    return this.pointToCoordinate(point, zoom, out);\n  };\n\n  _proto.coordToViewPoint = function coordToViewPoint(coordinate, out, altitude) {\n    return this.coordinateToViewPoint(coordinate, out, altitude);\n  };\n\n  _proto.viewPointToCoord = function viewPointToCoord(viewPoint, out) {\n    return this.viewPointToCoordinate(viewPoint, out);\n  };\n\n  _proto.coordToContainerPoint = function coordToContainerPoint(coordinate, zoom, out) {\n    return this.coordinateToContainerPoint(coordinate, zoom, out);\n  };\n\n  _proto.containerPointToCoord = function containerPointToCoord(containerPoint, out) {\n    return this.containerPointToCoordinate(containerPoint, out);\n  };\n\n  _proto.containerPointToViewPoint = function containerPointToViewPoint(containerPoint, out) {\n    if (out) {\n      out.set(containerPoint.x, containerPoint.y);\n    } else {\n      out = containerPoint.copy();\n    }\n\n    return out._sub(this.getViewPoint());\n  };\n\n  _proto.viewPointToContainerPoint = function viewPointToContainerPoint(viewPoint, out) {\n    if (out) {\n      out.set(viewPoint.x, viewPoint.y);\n    } else {\n      out = viewPoint.copy();\n    }\n\n    return out._add(this.getViewPoint());\n  };\n\n  _proto.checkSize = function checkSize() {\n    var justStart = now() - this._initTime < 1500 && this.width === 0 || this.height === 0;\n\n    var watched = this._getContainerDomSize(),\n        oldHeight = this.height,\n        oldWidth = this.width;\n\n    if (watched['width'] === oldWidth && watched['height'] === oldHeight) {\n      return this;\n    }\n\n    var center = this.getCenter();\n\n    this._updateMapSize(watched);\n\n    if (!this.options['fixCenterOnResize']) {\n      var resizeOffset = new Point((oldWidth - watched.width) / 2, (oldHeight - watched.height) / 2);\n\n      this._offsetCenterByPixel(resizeOffset);\n\n      this._mapViewCoord = this._getPrjCenter();\n    }\n\n    var hided = watched['width'] === 0 || watched['height'] === 0 || oldWidth === 0 || oldHeight === 0;\n\n    if (justStart || hided) {\n      this._noEvent = true;\n      this.setCenter(center);\n      delete this._noEvent;\n    }\n\n    this._fireEvent('resize');\n\n    return this;\n  };\n\n  _proto.locate = function locate(coordinate, dx, dy) {\n    return this.getProjection()._locate(new Coordinate(coordinate), dx, dy);\n  };\n\n  _proto.getMainPanel = function getMainPanel() {\n    return this._getRenderer().getMainPanel();\n  };\n\n  _proto.getPanels = function getPanels() {\n    return this._panels;\n  };\n\n  _proto.remove = function remove() {\n    if (this.isRemoved()) {\n      return this;\n    }\n\n    this._fireEvent('removestart');\n\n    this._removeDomEvents();\n\n    this._clearHandlers();\n\n    this.removeBaseLayer();\n    var layers = this.getLayers();\n\n    for (var i = 0; i < layers.length; i++) {\n      layers[i].remove();\n    }\n\n    if (this._getRenderer()) {\n      this._getRenderer().remove();\n    }\n\n    if (this._containerDOM.innerHTML) {\n      this._containerDOM.innerHTML = '';\n    }\n\n    delete this._panels;\n    delete this._containerDOM;\n    delete this.renderer;\n\n    this._fireEvent('removeend');\n\n    this._clearAllListeners();\n\n    return this;\n  };\n\n  _proto.isRemoved = function isRemoved() {\n    return !this._containerDOM;\n  };\n\n  _proto.isMoving = function isMoving() {\n    return !!this._moving;\n  };\n\n  _proto.onMoveStart = function onMoveStart(param) {\n    var prjCenter = this._getPrjCenter();\n\n    if (!this._originCenter || this._verifyExtent(prjCenter)) {\n      this._originCenter = prjCenter;\n    }\n\n    this._moving = true;\n\n    this._trySetCursor('move');\n\n    this._fireEvent('movestart', this._parseEvent(param ? param['domEvent'] : null, 'movestart'));\n  };\n\n  _proto.onMoving = function onMoving(param) {\n    this._fireEvent('moving', this._parseEvent(param ? param['domEvent'] : null, 'moving'));\n  };\n\n  _proto.onMoveEnd = function onMoveEnd(param) {\n    this._moving = false;\n\n    this._trySetCursor('default');\n\n    this._fireEvent('moveend', param && param['domEvent'] ? this._parseEvent(param['domEvent'], 'moveend') : param);\n\n    if (!this._verifyExtent(this._getPrjCenter()) && this._originCenter) {\n      var moveTo = this._originCenter;\n\n      this._panTo(moveTo);\n    }\n  };\n\n  _proto.onDragRotateStart = function onDragRotateStart(param) {\n    this._dragRotating = true;\n\n    this._fireEvent('dragrotatestart', this._parseEvent(param ? param['domEvent'] : null, 'dragrotatestart'));\n  };\n\n  _proto.onDragRotating = function onDragRotating(param) {\n    this._fireEvent('dragrotating', this._parseEvent(param ? param['domEvent'] : null, 'dragrotating'));\n  };\n\n  _proto.onDragRotateEnd = function onDragRotateEnd(param) {\n    this._dragRotating = false;\n\n    this._fireEvent('dragrotateend', this._parseEvent(param ? param['domEvent'] : null, 'dragrotateend'));\n  };\n\n  _proto.isDragRotating = function isDragRotating() {\n    return !!this._dragRotating;\n  };\n\n  _proto.getRenderer = function getRenderer() {\n    return this._getRenderer();\n  };\n\n  _proto.getDevicePixelRatio = function getDevicePixelRatio() {\n    return this.options['devicePixelRatio'] || Browser$1.devicePixelRatio || 1;\n  };\n\n  _proto._initContainer = function _initContainer(container) {\n    if (isString(container)) {\n      this._containerDOM = document.getElementById(container);\n\n      if (!this._containerDOM) {\n        throw new Error('Invalid container when creating map: \\'' + container + '\\'');\n      }\n    } else {\n      this._containerDOM = container;\n\n      if (IS_NODE) {\n        this.CanvasClass = this._containerDOM.constructor;\n      }\n    }\n\n    if (this._containerDOM.childNodes && this._containerDOM.childNodes.length > 0) {\n      if (this._containerDOM.childNodes[0].className === 'maptalks-wrapper') {\n        throw new Error('Container is already loaded with another map instance, use map.remove() to clear it.');\n      }\n    }\n  };\n\n  _proto._trySetCursor = function _trySetCursor(cursor) {\n    if (!this._cursor && !this._priorityCursor) {\n      if (!cursor) {\n        cursor = 'default';\n      }\n\n      this._setCursorToPanel(cursor);\n    }\n\n    return this;\n  };\n\n  _proto._setPriorityCursor = function _setPriorityCursor(cursor) {\n    if (!cursor) {\n      var hasCursor = false;\n\n      if (this._priorityCursor) {\n        hasCursor = true;\n      }\n\n      delete this._priorityCursor;\n\n      if (hasCursor) {\n        this.setCursor(this._cursor);\n      }\n    } else {\n      this._priorityCursor = cursor;\n\n      this._setCursorToPanel(cursor);\n    }\n\n    return this;\n  };\n\n  _proto._setCursorToPanel = function _setCursorToPanel(cursor) {\n    var panel = this.getMainPanel();\n\n    if (panel && panel.style && panel.style.cursor !== cursor) {\n      panel.style.cursor = cursor;\n    }\n  };\n\n  _proto._removeLayer = function _removeLayer(layer, layerList) {\n    if (!layer || !layerList) {\n      return;\n    }\n\n    var index = layerList.indexOf(layer);\n\n    if (index > -1) {\n      layerList.splice(index, 1);\n    }\n  };\n\n  _proto._sortLayersByZIndex = function _sortLayersByZIndex() {\n    if (!this._layers) {\n      return;\n    }\n\n    for (var i = 0, l = this._layers.length; i < l; i++) {\n      this._layers[i]._order = i;\n    }\n\n    this._layers.sort(function (a, b) {\n      var c = a.getZIndex() - b.getZIndex();\n\n      if (c === 0) {\n        return a._order - b._order;\n      }\n\n      return c;\n    });\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (this._noEvent) {\n      return;\n    }\n\n    this.fire('_' + eventName, param);\n    this.fire(eventName, param);\n  };\n\n  _proto._Load = function _Load() {\n    this._resetMapStatus();\n\n    if (this.options['pitch']) {\n      this.setPitch(this.options['pitch']);\n      delete this.options['pitch'];\n    }\n\n    if (this.options['bearing']) {\n      this.setBearing(this.options['bearing']);\n      delete this.options['bearing'];\n    }\n\n    this._loadAllLayers();\n\n    this._getRenderer().onLoad();\n\n    this._loaded = true;\n\n    this._callOnLoadHooks();\n\n    this._initTime = now();\n  };\n\n  _proto._initRenderer = function _initRenderer() {\n    var renderer = this.options['renderer'];\n    var clazz = Map.getRendererClass(renderer);\n    this._renderer = new clazz(this);\n\n    this._renderer.load();\n  };\n\n  _proto._getRenderer = function _getRenderer() {\n    return this._renderer;\n  };\n\n  _proto._loadAllLayers = function _loadAllLayers() {\n    function loadLayer(layer) {\n      if (layer) {\n        layer.load();\n      }\n    }\n\n    if (this._baseLayer) {\n      this._baseLayer.load();\n    }\n\n    this._eachLayer(loadLayer, this.getLayers());\n  };\n\n  _proto._getLayers = function _getLayers(filter) {\n    var layers = this._baseLayer ? [this._baseLayer].concat(this._layers) : this._layers;\n    var result = [];\n\n    for (var i = 0; i < layers.length; i++) {\n      if (!filter || filter.call(this, layers[i])) {\n        result.push(layers[i]);\n      }\n    }\n\n    return result;\n  };\n\n  _proto._eachLayer = function _eachLayer(fn) {\n    if (arguments.length < 2) {\n      return;\n    }\n\n    var layerLists = Array.prototype.slice.call(arguments, 1);\n\n    if (layerLists && !Array.isArray(layerLists)) {\n      layerLists = [layerLists];\n    }\n\n    var layers = [];\n\n    for (var i = 0, len = layerLists.length; i < len; i++) {\n      layers = layers.concat(layerLists[i]);\n    }\n\n    for (var j = 0, jlen = layers.length; j < jlen; j++) {\n      fn.call(fn, layers[j]);\n    }\n  };\n\n  _proto._onLayerEvent = function _onLayerEvent(param) {\n    if (!param) {\n      return;\n    }\n\n    if (param['type'] === 'idchange') {\n      delete this._layerCache[param['old']];\n      this._layerCache[param['new']] = param['target'];\n    }\n  };\n\n  _proto._resetMapStatus = function _resetMapStatus() {\n    var maxZoom = this.getMaxZoom(),\n        minZoom = this.getMinZoom();\n\n    var viewMaxZoom = this._spatialReference.getMaxZoom(),\n        viewMinZoom = this._spatialReference.getMinZoom();\n\n    if (isNil(maxZoom) || maxZoom === -1 || maxZoom > viewMaxZoom) {\n      this.setMaxZoom(viewMaxZoom);\n    }\n\n    if (isNil(minZoom) || minZoom === -1 || minZoom < viewMinZoom) {\n      this.setMinZoom(viewMinZoom);\n    }\n\n    maxZoom = this.getMaxZoom();\n    minZoom = this.getMinZoom();\n\n    if (maxZoom < minZoom) {\n      this.setMaxZoom(minZoom);\n    }\n\n    if (isNil(this._zoomLevel) || this._zoomLevel > maxZoom) {\n      this._zoomLevel = maxZoom;\n    }\n\n    if (this._zoomLevel < minZoom) {\n      this._zoomLevel = minZoom;\n    }\n\n    delete this._prjCenter;\n    var projection = this.getProjection();\n    this._prjCenter = projection.project(this._center);\n\n    this._calcMatrices();\n\n    var renderer = this._getRenderer();\n\n    if (renderer) {\n      renderer.resetContainer();\n    }\n  };\n\n  _proto._getContainerDomSize = function _getContainerDomSize() {\n    if (!this._containerDOM) {\n      return null;\n    }\n\n    var containerDOM = this._containerDOM;\n    var width, height;\n\n    if (!isNil(containerDOM.width) && !isNil(containerDOM.height)) {\n      width = containerDOM.width;\n      height = containerDOM.height;\n      var dpr = this.getDevicePixelRatio();\n\n      if (dpr !== 1 && containerDOM['layer']) {\n        width /= dpr;\n        height /= dpr;\n      }\n    } else if (!isNil(containerDOM.clientWidth) && !isNil(containerDOM.clientHeight)) {\n      width = parseInt(containerDOM.clientWidth, 0);\n      height = parseInt(containerDOM.clientHeight, 0);\n    } else {\n      throw new Error('can not get size of container');\n    }\n\n    return new Size(width, height);\n  };\n\n  _proto._updateMapSize = function _updateMapSize(mSize) {\n    this.width = mSize['width'];\n    this.height = mSize['height'];\n\n    this._getRenderer().updateMapSize(mSize);\n\n    this._calcMatrices();\n\n    return this;\n  };\n\n  _proto._getPrjCenter = function _getPrjCenter() {\n    return this._prjCenter;\n  };\n\n  _proto._setPrjCenter = function _setPrjCenter(pcenter) {\n    this._prjCenter = pcenter;\n\n    if (this.isInteracting() && !this.isMoving()) {\n      this._mapViewCoord = pcenter;\n    }\n\n    this._calcMatrices();\n  };\n\n  _proto._setPrjCoordAtContainerPoint = function _setPrjCoordAtContainerPoint(coordinate, point) {\n    if (point.x === this.width / 2 && point.y === this.height / 2) {\n      return this;\n    }\n\n    var t = this._containerPointToPoint(point)._sub(this._prjToPoint(this._getPrjCenter()));\n\n    var pcenter = this._pointToPrj(this._prjToPoint(coordinate).sub(t));\n\n    this._setPrjCenter(pcenter);\n\n    return this;\n  };\n\n  _proto._verifyExtent = function _verifyExtent(prjCenter) {\n    if (!prjCenter) {\n      return false;\n    }\n\n    var maxExt = this._prjMaxExtent;\n\n    if (!maxExt) {\n      return true;\n    }\n\n    return maxExt.contains(prjCenter);\n  };\n\n  _proto._offsetCenterByPixel = function _offsetCenterByPixel(pixel) {\n    var pos = new Point(this.width / 2 - pixel.x, this.height / 2 - pixel.y);\n\n    var pCenter = this._containerPointToPrj(pos);\n\n    this._setPrjCenter(pCenter);\n\n    return pCenter;\n  };\n\n  _proto.offsetPlatform = function offsetPlatform(offset) {\n    if (!offset) {\n      return this._mapViewPoint;\n    } else {\n      this._getRenderer().offsetPlatform(offset);\n\n      this._mapViewCoord = this._getPrjCenter();\n      this._mapViewPoint = this._mapViewPoint.add(offset);\n      return this;\n    }\n  };\n\n  _proto.getViewPoint = function getViewPoint() {\n    var offset = this._getViewPointFrameOffset();\n\n    var panelOffset = this.offsetPlatform();\n\n    if (offset) {\n      panelOffset = panelOffset.add(offset);\n    }\n\n    return panelOffset;\n  };\n\n  _proto._resetMapViewPoint = function _resetMapViewPoint() {\n    this._mapViewPoint = new Point(0, 0);\n    this._mapViewCoord = this._getPrjCenter();\n  };\n\n  _proto._getResolution = function _getResolution(zoom) {\n    if ((zoom === undefined || zoom === this._zoomLevel) && this._mapRes !== undefined) {\n      return this._mapRes;\n    } else if (zoom === this.getGLZoom() && this._mapGlRes !== undefined) {\n      return this._mapGlRes;\n    }\n\n    if (isNil(zoom)) {\n      zoom = this._zoomLevel;\n    }\n\n    return this._spatialReference.getResolution(zoom);\n  };\n\n  _proto._getResolutions = function _getResolutions() {\n    return this._spatialReference.getResolutions();\n  };\n\n  _proto._prjToPoint = function _prjToPoint(pCoord, zoom, out) {\n    zoom = isNil(zoom) ? this.getZoom() : zoom;\n    return this._spatialReference.getTransformation().transform(pCoord, this._getResolution(zoom), out);\n  };\n\n  _proto._pointToPrj = function _pointToPrj(point, zoom, out) {\n    zoom = isNil(zoom) ? this.getZoom() : zoom;\n    return this._spatialReference.getTransformation().untransform(point, this._getResolution(zoom), out);\n  };\n\n  _proto._pointToPoint = function _pointToPoint(point, zoom, out) {\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    if (!isNil(zoom)) {\n      return out._multi(this._getResolution(zoom) / this._getResolution());\n    }\n\n    return out;\n  };\n\n  _proto._pointToPointAtZoom = function _pointToPointAtZoom(point, zoom, out) {\n    if (out) {\n      out.x = point.x;\n      out.y = point.y;\n    } else {\n      out = point.copy();\n    }\n\n    if (!isNil(zoom)) {\n      return out._multi(this._getResolution() / this._getResolution(zoom));\n    }\n\n    return out;\n  };\n\n  _proto._containerPointToPrj = function _containerPointToPrj(containerPoint, out) {\n    return this._pointToPrj(this._containerPointToPoint(containerPoint, undefined, out), undefined, out);\n  };\n\n  _proto._callOnLoadHooks = function _callOnLoadHooks() {\n    var proto = Map.prototype;\n\n    if (!proto._onLoadHooks) {\n      return;\n    }\n\n    for (var i = 0, l = proto._onLoadHooks.length; i < l; i++) {\n      proto._onLoadHooks[i].call(this);\n    }\n  };\n\n  return Map;\n}(Handlerable(Eventable(Renderable(Class))));\n\nMap$1.include({\n  coordinateToPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, zoom, out) {\n      var prjCoord = this.getProjection().project(coordinate, COORD);\n      return this._prjToPoint(prjCoord, zoom, out);\n    };\n  }(),\n  pointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, zoom, out) {\n      var prjCoord = this._pointToPrj(point, zoom, COORD);\n\n      return this.getProjection().unproject(prjCoord, out);\n    };\n  }(),\n  coordinateToViewPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, out, altitude) {\n      return this._prjToViewPoint(this.getProjection().project(coordinate, COORD), out, altitude);\n    };\n  }(),\n  viewPointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (viewPoint, out) {\n      return this.getProjection().unproject(this._viewPointToPrj(viewPoint, COORD), out);\n    };\n  }(),\n  coordinateToContainerPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (coordinate, zoom, out) {\n      var pCoordinate = this.getProjection().project(coordinate, COORD);\n      return this._prjToContainerPoint(pCoordinate, zoom, out);\n    };\n  }(),\n  containerPointToCoordinate: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (containerPoint, out) {\n      var pCoordinate = this._containerPointToPrj(containerPoint, COORD);\n\n      return this.getProjection().unproject(pCoordinate, out);\n    };\n  }(),\n  containerToExtent: function () {\n    var POINT0 = new Point(0, 0);\n    var POINT1 = new Point(0, 0);\n    return function (containerExtent) {\n      var extent2D = new PointExtent(this._containerPointToPoint(containerExtent.getMin(POINT0), undefined, POINT0), this._containerPointToPoint(containerExtent.getMax(POINT1), undefined, POINT1));\n      return this._pointToExtent(extent2D);\n    };\n  }(),\n  distanceToPixel: function () {\n    var POINT0 = new Point(0, 0);\n    var POINT1 = new Point(0, 0);\n    return function (xDist, yDist, zoom) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var scale = this.getScale() / this.getScale(zoom);\n      var center = this.getCenter(),\n          target = projection.locate(center, xDist, yDist);\n      var p0 = this.coordToContainerPoint(center, undefined, POINT0),\n          p1 = this.coordToContainerPoint(target, undefined, POINT1);\n\n      p1._sub(p0)._multi(scale)._abs();\n\n      return new Size(p1.x, p1.y);\n    };\n  }(),\n  distanceToPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (xDist, yDist, zoom, paramCenter) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var center = paramCenter || this.getCenter(),\n          target = projection.locate(center, xDist, yDist);\n      var p0 = this.coordToPoint(center, zoom, POINT),\n          p1 = this.coordToPoint(target, zoom);\n\n      p1._sub(p0)._abs();\n\n      return p1;\n    };\n  }(),\n  pixelToDistance: function () {\n    var COORD0 = new Coordinate(0, 0);\n    var COORD1 = new Coordinate(0, 0);\n    return function (width, height) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var fullExt = this.getFullExtent();\n      var d = fullExt['top'] > fullExt['bottom'] ? -1 : 1;\n      var target = COORD0.set(this.width / 2 + width, this.height / 2 + d * height);\n      var coord = this.containerPointToCoord(target, COORD1);\n      return projection.measureLength(this.getCenter(), coord);\n    };\n  }(),\n  pointToDistance: function () {\n    var POINT = new Point(0, 0);\n    var COORD = new Coordinate(0, 0);\n    return function (dx, dy, zoom) {\n      var projection = this.getProjection();\n\n      if (!projection) {\n        return null;\n      }\n\n      var c = this._prjToPoint(this._getPrjCenter(), zoom, POINT);\n\n      c._add(dx, dy);\n\n      var target = this.pointToCoord(c, zoom, COORD);\n      return projection.measureLength(this.getCenter(), target);\n    };\n  }(),\n  locateByPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (coordinate, px, py) {\n      var point = this.coordToContainerPoint(coordinate, undefined, POINT);\n      return this.containerPointToCoord(point._add(px, py));\n    };\n  }(),\n  _get2DExtent: function () {\n    var POINT = new Point(0, 0);\n    return function (zoom, out) {\n      var _this3 = this;\n\n      var cached;\n\n      if ((zoom === undefined || zoom === this._zoomLevel) && this._mapExtent2D) {\n        cached = this._mapExtent2D;\n      } else if (zoom === this.getGLZoom() && this._mapGlExtent2D) {\n        cached = this._mapGlExtent2D;\n      }\n\n      if (cached) {\n        if (out) {\n          out.set(cached['xmin'], cached['ymin'], cached['xmax'], cached['ymax']);\n          return out;\n        }\n\n        return cached.copy();\n      }\n\n      var cExtent = this.getContainerExtent();\n      return cExtent.convertTo(function (c) {\n        return _this3._containerPointToPoint(c, zoom, POINT);\n      }, out);\n    };\n  }(),\n  _pointToExtent: function () {\n    var COORD0 = new Coordinate(0, 0);\n    var COORD1 = new Coordinate(0, 0);\n    return function (extent2D) {\n      var min2d = extent2D.getMin(),\n          max2d = extent2D.getMax();\n      var fullExtent = this.getFullExtent();\n\n      var _ref = !fullExtent || fullExtent.left <= fullExtent.right ? [min2d.x, max2d.x] : [max2d.x, min2d.x],\n          minx = _ref[0],\n          maxx = _ref[1];\n\n      var _ref2 = !fullExtent || fullExtent.top > fullExtent.bottom ? [max2d.y, min2d.y] : [min2d.y, max2d.y],\n          miny = _ref2[0],\n          maxy = _ref2[1];\n\n      var min = min2d.set(minx, maxy);\n      var max = max2d.set(maxx, miny);\n      return new Extent(this.pointToCoord(min, undefined, COORD0), this.pointToCoord(max, undefined, COORD1), this.getProjection());\n    };\n  }(),\n  _getViewPointFrameOffset: function () {\n    var POINT = new Point(0, 0);\n    return function () {\n      if (this.isZooming()) {\n        return null;\n      }\n\n      var pcenter = this._getPrjCenter();\n\n      if (this._mapViewCoord && !this._mapViewCoord.equals(pcenter)) {\n        return this._prjToContainerPoint(this._mapViewCoord)._sub(this._prjToContainerPoint(pcenter, undefined, POINT));\n      }\n\n      return null;\n    };\n  }(),\n  _viewPointToPrj: function () {\n    var POINT = new Point(0, 0);\n    return function (viewPoint, out) {\n      return this._containerPointToPrj(this.viewPointToContainerPoint(viewPoint, POINT), out);\n    };\n  }(),\n  _prjToContainerPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (pCoordinate, zoom, out, altitude) {\n      return this._pointToContainerPoint(this._prjToPoint(pCoordinate, zoom, POINT), zoom, altitude || 0, out);\n    };\n  }(),\n  _prjToViewPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (pCoordinate, out, altitude) {\n      var containerPoint = this._prjToContainerPoint(pCoordinate, undefined, POINT, altitude);\n\n      return this.containerPointToViewPoint(containerPoint, out);\n    };\n  }(),\n  _viewPointToPoint: function () {\n    var POINT = new Point(0, 0);\n    return function (viewPoint, zoom, out) {\n      return this._containerPointToPoint(this.viewPointToContainerPoint(viewPoint, POINT), zoom, out);\n    };\n  }(),\n  _pointToViewPoint: function () {\n    var COORD = new Coordinate(0, 0);\n    return function (point, zoom, out) {\n      return this._prjToViewPoint(this._pointToPrj(point, zoom, COORD), out);\n    };\n  }()\n});\nMap$1.mergeOptions(options$2);\n\nvar MapDoubleClickZoomHandler = function (_Handler) {\n  _inheritsLoose(MapDoubleClickZoomHandler, _Handler);\n\n  function MapDoubleClickZoomHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapDoubleClickZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.on('_dblclick', this._onDoubleClick, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.off('_dblclick', this._onDoubleClick, this);\n  };\n\n  _proto._onDoubleClick = function _onDoubleClick(param) {\n    var map = this.target;\n\n    if (map.options['doubleClickZoom']) {\n      var oldZoom = map.getZoom(),\n          zoom = param['domEvent']['shiftKey'] ? Math.ceil(oldZoom) - 1 : Math.floor(oldZoom) + 1;\n\n      map._zoomAnimation(zoom, param['containerPoint']);\n    }\n  };\n\n  return MapDoubleClickZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'doubleClickZoom': true\n});\nMap$1.addOnLoadHook('addHandler', 'doubleClickZoom', MapDoubleClickZoomHandler);\n\nvar MapDragHandler = function (_Handler) {\n  _inheritsLoose(MapDragHandler, _Handler);\n\n  function MapDragHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapDragHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    var map = this.target;\n\n    if (!map) {\n      return;\n    }\n\n    var dom = map._panels.mapWrapper || map._containerDOM;\n    this._dragHandler = new DragHandler(dom, {\n      'cancelOn': this._cancelOn.bind(this),\n      'rightclick': true\n    });\n\n    this._dragHandler.on('mousedown', this._onMouseDown, this).on('dragstart', this._onDragStart, this).on('dragging', this._onDragging, this).on('dragend', this._onDragEnd, this).enable();\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this._dragHandler.off('mousedown', this._onMouseDown, this).off('dragstart', this._onDragStart, this).off('dragging', this._onDragging, this).off('dragend', this._onDragEnd, this);\n\n    this._dragHandler.remove();\n\n    delete this._dragHandler;\n  };\n\n  _proto._cancelOn = function _cancelOn(domEvent) {\n    if (this.target.isZooming() || this._ignore(domEvent)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto._ignore = function _ignore(param) {\n    if (!param) {\n      return false;\n    }\n\n    if (param.domEvent) {\n      param = param.domEvent;\n    }\n\n    return this.target._ignoreEvent(param);\n  };\n\n  _proto._onMouseDown = function _onMouseDown(param) {\n    delete this.startDragTime;\n    delete this._mode;\n\n    if (param.domEvent.button === 2 || param.domEvent.ctrlKey) {\n      if (this.target.options['dragRotate'] || this.target.options['dragPitch']) {\n        this._mode = 'rotatePitch';\n      }\n    } else if (this.target.options['dragPan']) {\n      this._mode = 'move';\n    }\n\n    this.target._stopAnim(this.target._mapAnimPlayer);\n\n    preventDefault(param['domEvent']);\n  };\n\n  _proto._onDragStart = function _onDragStart(param) {\n    this.startDragTime = now();\n\n    if (this._mode === 'move') {\n      this._moveStart(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotateStart(param);\n    }\n  };\n\n  _proto._onDragging = function _onDragging(param) {\n    var map = this.target;\n\n    if (map._isEventOutMap(param['domEvent'])) {\n      return;\n    }\n\n    if (this._mode === 'move') {\n      this._moving(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotating(param);\n    }\n  };\n\n  _proto._onDragEnd = function _onDragEnd(param) {\n    if (this._mode === 'move') {\n      this._moveEnd(param);\n    } else if (this._mode === 'rotatePitch') {\n      this._rotateEnd(param);\n    }\n\n    delete this.startDragTime;\n    delete this.startBearing;\n  };\n\n  _proto._start = function _start(param) {\n    this.preX = param['mousePos'].x;\n    this.preY = param['mousePos'].y;\n    this.startX = this.preX;\n    this.startY = this.preY;\n  };\n\n  _proto._moveStart = function _moveStart(param) {\n    this._start(param);\n\n    var map = this.target;\n    map.onMoveStart(param);\n    var p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n    this.startPrjCoord = map._containerPointToPrj(p);\n  };\n\n  _proto._moving = function _moving(param) {\n    if (!this.startDragTime) {\n      return;\n    }\n\n    var map = this.target;\n    var p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n\n    map._setPrjCoordAtContainerPoint(this.startPrjCoord, p);\n\n    map.onMoving(param);\n  };\n\n  _proto._moveEnd = function _moveEnd(param) {\n    if (!this.startDragTime) {\n      return;\n    }\n\n    var map = this.target;\n    var t = now() - this.startDragTime;\n    var mx = param['mousePos'].x,\n        my = param['mousePos'].y;\n    var dx = mx - this.startX;\n    var dy = my - this.startY;\n\n    this._clear();\n\n    if (map.options['panAnimation'] && !param.interupted && map._verifyExtent(map._getPrjCenter()) && t < 280 && Math.abs(dy) + Math.abs(dx) > 5) {\n      t = 5 * t * (Math.abs(dx) + Math.abs(dy)) / 500;\n      map.panBy(new Point(dx, dy), {\n        'duration': t\n      });\n    } else {\n      map.onMoveEnd(param);\n    }\n  };\n\n  _proto._rotateStart = function _rotateStart(param) {\n    this._start(param);\n\n    delete this._rotateMode;\n    this.startBearing = this.target.getBearing();\n    this.target.onDragRotateStart(param);\n    this._db = 0;\n  };\n\n  _proto._rotating = function _rotating(param) {\n    var map = this.target;\n    var mx = param['mousePos'].x,\n        my = param['mousePos'].y;\n    var prePitch = map.getPitch(),\n        preBearing = map.getBearing();\n    var dx = Math.abs(mx - this.preX),\n        dy = Math.abs(my - this.preY);\n\n    if (!this._rotateMode) {\n      if (map.options['dragRotatePitch']) {\n        this._rotateMode = 'rotate_pitch';\n      } else if (dx > dy) {\n        this._rotateMode = 'rotate';\n      } else if (dx < dy) {\n        this._rotateMode = 'pitch';\n      } else {\n        this._rotateMode = 'rotate';\n      }\n    }\n\n    if (this._rotateMode === 'pitch' && prePitch === 0 && dy < 10) {\n      return;\n    }\n\n    if (this._rotateMode.indexOf('rotate') >= 0 && map.options['dragRotate']) {\n      var db = 0;\n\n      if (map.options['dragPitch'] || dx > dy) {\n        db = -0.6 * (this.preX - mx);\n      } else if (mx > map.width / 2) {\n        db = 0.6 * (this.preY - my);\n      } else {\n        db = -0.6 * (this.preY - my);\n      }\n\n      var bearing = map.getBearing() + db;\n      this._db = this._db || 0;\n      this._db += db;\n      map.setBearing(bearing);\n    }\n\n    if (this._rotateMode.indexOf('pitch') >= 0 && map.options['dragPitch']) {\n      map.setPitch(map.getPitch() + (this.preY - my) * 0.4);\n    }\n\n    this.preX = mx;\n    this.preY = my;\n\n    if (map.getBearing() !== preBearing || map.getPitch() !== prePitch) {\n      map.onDragRotating(param);\n    }\n  };\n\n  _proto._rotateEnd = function _rotateEnd(param) {\n    var map = this.target;\n    var bearing = map.getBearing();\n\n    this._clear();\n\n    var t = now() - this.startDragTime;\n    map.onDragRotateEnd(param);\n\n    if (Math.abs(bearing - this.startBearing) > 20 && (this._rotateMode === 'rotate' || this._rotateMode === 'rotate_pitch') && !param.interupted && t < 400) {\n      var _bearing = map.getBearing();\n\n      map._animateTo({\n        'bearing': _bearing + this._db / 2\n      }, {\n        'easing': 'out',\n        'duration': 800\n      });\n    }\n  };\n\n  _proto._clear = function _clear() {\n    delete this.startPrjCoord;\n    delete this.preX;\n    delete this.preY;\n    delete this.startX;\n    delete this.startY;\n  };\n\n  return MapDragHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'draggable': true,\n  'dragPan': true,\n  'dragRotatePitch': true,\n  'dragRotate': true,\n  'dragPitch': true\n});\nMap$1.addOnLoadHook('addHandler', 'draggable', MapDragHandler);\n\nvar EVENTS = 'mousedown ' + 'mouseup ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'touchstart ' + 'touchmove ' + 'touchend';\n\nvar MapGeometryEventsHandler = function (_Handler) {\n  _inheritsLoose(MapGeometryEventsHandler, _Handler);\n\n  function MapGeometryEventsHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapGeometryEventsHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    var map = this.target;\n    var dom = map._panels.allLayers || map._containerDOM;\n    on(dom, EVENTS, this._identifyGeometryEvents, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    var map = this.target;\n    var dom = map._panels.allLayers || map._containerDOM;\n    off(dom, EVENTS, this._identifyGeometryEvents, this);\n  };\n\n  _proto._identifyGeometryEvents = function _identifyGeometryEvents(domEvent, type) {\n    var map = this.target;\n\n    if (map.isInteracting() || map._ignoreEvent(domEvent)) {\n      return;\n    }\n\n    var layers = map._getLayers(function (layer) {\n      if (layer.identify && layer.options['geometryEvents']) {\n        return true;\n      }\n\n      return false;\n    });\n\n    if (!layers.length) {\n      return;\n    }\n\n    var oneMoreEvent = null;\n    var eventType = type || domEvent.type;\n\n    if (eventType === 'mousedown' || eventType === 'touchstart' && domEvent.touches.length === 1) {\n      this._mouseDownTime = now();\n    } else if ((eventType === 'click' || eventType === 'touchend') && this._mouseDownTime) {\n      var downTime = this._mouseDownTime;\n      delete this._mouseDownTime;\n      var time = now();\n\n      if (time - downTime > 300) {\n        if (eventType === 'click') {\n          return;\n        }\n      } else if (eventType === 'touchend') {\n        oneMoreEvent = 'click';\n      }\n    }\n\n    var actual = domEvent.touches && domEvent.touches.length > 0 ? domEvent.touches[0] : domEvent.changedTouches && domEvent.changedTouches.length > 0 ? domEvent.changedTouches[0] : domEvent;\n\n    if (!actual) {\n      return;\n    }\n\n    var containerPoint = getEventContainerPoint(actual, map._containerDOM),\n        coordinate = map.containerPointToCoordinate(containerPoint);\n\n    if (eventType === 'touchstart') {\n      preventDefault(domEvent);\n    }\n\n    var geometryCursorStyle = null;\n    var identifyOptions = {\n      'includeInternals': true,\n      'filter': function filter(geometry) {\n        if (!(geometry instanceof Geometry)) {\n          return false;\n        }\n\n        var eventToFire = geometry._getEventTypeToFire(domEvent);\n\n        if (eventType === 'mousemove') {\n          if (!geometryCursorStyle && geometry.options['cursor']) {\n            geometryCursorStyle = geometry.options['cursor'];\n          }\n\n          if (!geometry.listens('mousemove') && !geometry.listens('mouseover') && !geometry.listens('mouseenter')) {\n            return false;\n          }\n        } else if (!geometry.listens(eventToFire) && !geometry.listens(oneMoreEvent)) {\n          return false;\n        }\n\n        return true;\n      },\n      'count': 1,\n      'coordinate': coordinate,\n      'onlyVisible': map.options['onlyVisibleGeometryEvents'],\n      'layers': layers\n    };\n    var callback = fireGeometryEvent.bind(this);\n\n    if (eventType === 'mousemove' || eventType === 'touchmove') {\n      this._queryIdentifyTimeout = map.getRenderer().callInNextFrame(function () {\n        if (map.isInteracting()) {\n          return;\n        }\n\n        map.identify(identifyOptions, callback);\n      });\n    } else {\n      map.identify(identifyOptions, callback);\n    }\n\n    function fireGeometryEvent(geometries) {\n      var propagation = true;\n\n      if (eventType === 'mousemove') {\n        var geoMap = {};\n\n        if (geometries.length > 0) {\n          for (var i = geometries.length - 1; i >= 0; i--) {\n            var geo = geometries[i];\n\n            if (!(geo instanceof Geometry)) {\n              continue;\n            }\n\n            var iid = geo._getInternalId();\n\n            geoMap[iid] = geo;\n\n            geo._onEvent(domEvent);\n\n            if (!this._prevOverGeos || !this._prevOverGeos.geomap[iid]) {\n              geo._onEvent(domEvent, 'mouseenter');\n            }\n\n            propagation = geo._onEvent(domEvent, 'mouseover');\n          }\n        }\n\n        map._setPriorityCursor(geometryCursorStyle);\n\n        var oldTargets = this._prevOverGeos && this._prevOverGeos.geos;\n        this._prevOverGeos = {\n          'geos': geometries,\n          'geomap': geoMap\n        };\n\n        if (oldTargets && oldTargets.length > 0) {\n          for (var _i = oldTargets.length - 1; _i >= 0; _i--) {\n            var oldTarget = oldTargets[_i];\n\n            if (!(oldTarget instanceof Geometry)) {\n              continue;\n            }\n\n            var oldTargetId = oldTargets[_i]._getInternalId();\n\n            if (!geoMap[oldTargetId]) {\n              propagation = oldTarget._onEvent(domEvent, 'mouseout');\n            }\n          }\n        }\n      } else {\n        if (!geometries || !geometries.length) {\n          return;\n        }\n\n        for (var _i2 = geometries.length - 1; _i2 >= 0; _i2--) {\n          if (!(geometries[_i2] instanceof Geometry)) {\n            continue;\n          }\n\n          propagation = geometries[_i2]._onEvent(domEvent);\n\n          if (oneMoreEvent) {\n            geometries[_i2]._onEvent(domEvent, oneMoreEvent);\n          }\n\n          break;\n        }\n      }\n\n      if (propagation === false) {\n        stopPropagation(domEvent);\n      }\n    }\n  };\n\n  return MapGeometryEventsHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'geometryEvents': true,\n  'onlyVisibleGeometryEvents': true\n});\nMap$1.addOnLoadHook('addHandler', 'geometryEvents', MapGeometryEventsHandler);\n\nvar wheelZoomDelta = 4.000244140625;\nvar defaultZoomRate = 1 / 100;\nvar wheelZoomRate = 1 / 450;\nvar maxScalePerFrame = 2;\n\nvar MapScrollWheelZoomHandler = function (_Handler) {\n  _inheritsLoose(MapScrollWheelZoomHandler, _Handler);\n\n  function MapScrollWheelZoomHandler(target) {\n    var _this;\n\n    _this = _Handler.call(this, target) || this;\n    _this._thisScrollZoom = _this._scrollZoom.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this._wheelZoomRate = wheelZoomRate;\n    _this._defaultZoomRate = defaultZoomRate;\n    _this._delta = 0;\n    return _this;\n  }\n\n  var _proto = MapScrollWheelZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    addDomEvent(this.target._containerDOM, 'wheel', this._onWheelScroll, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    removeDomEvent(this.target._containerDOM, 'wheel', this._onWheelScroll);\n  };\n\n  _proto._onWheelScroll = function _onWheelScroll(evt) {\n    //preventDefault(evt);\n    //stopPropagation(evt);\n    var map = this.target;\n\n    if (map._ignoreEvent(evt) || !map.options['zoomable']) {\n      return false;\n    }\n\n    var container = map._containerDOM;\n\n    var origin = map._checkZoomOrigin(getEventContainerPoint(evt, container));\n\n    if (map.options['seamlessZoom']) {\n      if (!this._zooming) {\n        this._trackPadSuspect = 0;\n        this._ensureTrackpad = false;\n      }\n\n      return this._seamless(evt, origin);\n    } else {\n      return this._interval(evt, origin);\n    }\n  };\n\n  _proto._seamless = function _seamless(evt, origin) {\n    var value = evt.deltaMode === window.WheelEvent.DOM_DELTA_LINE ? evt.deltaY * 60 : evt.deltaY;\n\n    if (value % wheelZoomDelta !== 0) {\n      if (!this._ensureTrackpad) {\n        if (Math.abs(value) < 60) {\n          this._trackPadSuspect++;\n        } else {\n          this._trackPadSuspect = 0;\n        }\n\n        if (this._trackPadSuspect >= 2) {\n          this._ensureTrackpad = true;\n        }\n      }\n\n      if (this._ensureTrackpad) {\n        value *= 14;\n      }\n    }\n\n    if (evt.shiftKey && value) value = value / 4;\n    this._lastWheelEvent = evt;\n    this._delta -= value;\n\n    if (!this._zooming && this._delta) {\n      var map = this.target;\n      this._zoomOrigin = origin;\n      map.onZoomStart(null, origin);\n    }\n\n    this._start();\n  };\n\n  _proto._start = function _start() {\n    if (!this._delta) return;\n    this._zooming = true;\n    var map = this.target;\n\n    if (!this._active) {\n      map.getRenderer().callInNextFrame(this._thisScrollZoom);\n      this._active = true;\n    }\n  };\n\n  _proto._scrollZoom = function _scrollZoom() {\n    var _this2 = this;\n\n    this._active = false;\n\n    if (!this._delta) {\n      return;\n    }\n\n    var zoomRate = Math.abs(this._delta) > wheelZoomDelta ? this._wheelZoomRate : this._defaultZoomRate;\n    var scale = maxScalePerFrame / (1 + Math.exp(-Math.abs(this._delta * zoomRate)));\n\n    if (this._delta < 0 && scale !== 0) {\n      scale = 1 / scale;\n    }\n\n    var map = this.target;\n    var zoom = map.getZoom();\n    var targetZoom = map.getZoomForScale(scale, zoom, true);\n    this._delta = 0;\n    map.onZooming(targetZoom, this._zoomOrigin);\n\n    if (this._timeout) {\n      clearTimeout(this._timeout);\n    }\n\n    this._timeout = setTimeout(function () {\n      _this2._zooming = false;\n      delete _this2._timeout;\n      map.onZoomEnd(map.getZoom(), _this2._zoomOrigin);\n    }, 320);\n  };\n\n  _proto._interval = function _interval(evt, origin) {\n    var _this3 = this;\n\n    var map = this.target;\n\n    if (this._zooming) {\n      this._requesting++;\n      return false;\n    }\n\n    this._requesting = 0;\n    var levelValue = (evt.deltaY ? evt.deltaY * -1 : evt.wheelDelta ? evt.wheelDelta : evt.detail) > 0 ? 1 : -1;\n\n    if (evt.detail) {\n      levelValue *= -1;\n    }\n\n    var zoom = map.getZoom();\n    var nextZoom = zoom + levelValue;\n    nextZoom = map._checkZoom(levelValue > 0 ? Math.ceil(nextZoom) : Math.floor(nextZoom));\n\n    if (nextZoom === zoom) {\n      return false;\n    }\n\n    this._zooming = true;\n\n    if (!this._delta) {\n      map.onZoomStart(null, origin);\n      this._origin = origin;\n      this._delta = levelValue;\n      this._startZoom = map.getZoom();\n    }\n\n    var duration = 90;\n\n    map._animateTo({\n      'zoom': nextZoom - this._delta * 1 / 2,\n      'around': this._origin\n    }, {\n      'continueOnViewChanged': true,\n      'easing': 'linear',\n      'duration': duration,\n      'wheelZoom': true\n    }, function (frame) {\n      if (frame.state.playState !== 'finished') {\n        if (frame.state.playState !== 'running') {\n          delete _this3._zooming;\n          delete _this3._requesting;\n        }\n\n        return;\n      }\n\n      if (_this3._requesting < 1 || Math.abs(nextZoom - _this3._startZoom) > 2 || nextZoom === map.getMaxZoom() || nextZoom === map.getMinZoom()) {\n        map._animateTo({\n          'zoom': nextZoom,\n          'around': _this3._origin\n        }, {\n          'continueOnViewChanged': true,\n          'duration': 100\n        }, function (frame) {\n          if (frame.state.playState !== 'running') {\n            delete _this3._zooming;\n            delete _this3._requesting;\n          }\n        });\n\n        delete _this3._startZoom;\n        delete _this3._origin;\n        delete _this3._delta;\n        _this3._requesting = 0;\n      } else if (!isNil(_this3._requesting)) {\n        delete _this3._zooming;\n\n        _this3._onWheelScroll(evt);\n      }\n    });\n\n    return false;\n  };\n\n  return MapScrollWheelZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'scrollWheelZoom': true,\n  'seamlessZoom': false\n});\nMap$1.addOnLoadHook('addHandler', 'scrollWheelZoom', MapScrollWheelZoomHandler);\n\nvar MapTouchZoomHandler = function (_Handler) {\n  _inheritsLoose(MapTouchZoomHandler, _Handler);\n\n  function MapTouchZoomHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapTouchZoomHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    addDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    removeDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart);\n  };\n\n  _proto._onTouchStart = function _onTouchStart(event) {\n    var map = this.target;\n\n    if (!event.touches || event.touches.length < 2) {\n      return;\n    }\n\n    var container = map.getContainer();\n    var p1 = getEventContainerPoint(event.touches[0], container),\n        p2 = getEventContainerPoint(event.touches[1], container);\n    this.preY = p1.y;\n    this._startP1 = p1;\n    this._startP2 = p2;\n    this._startDist = p1.distanceTo(p2);\n    this._startVector = p1.sub(p2);\n    this._startZoom = map.getZoom();\n    this._startBearing = map.getBearing();\n    off(document, 'touchmove', this._onTouchMove, this);\n    off(document, 'touchend', this._onTouchEnd, this);\n    addDomEvent(document, 'touchmove', this._onTouchMove, this);\n    addDomEvent(document, 'touchend', this._onTouchEnd, this);\n    preventDefault(event);\n\n    map._fireEvent('touchactstart');\n  };\n\n  _proto._onTouchMove = function _onTouchMove(event) {\n    var map = this.target;\n\n    if (!event.touches || event.touches.length < 2) {\n      return;\n    }\n\n    var container = map.getContainer(),\n        p1 = getEventContainerPoint(event.touches[0], container),\n        p2 = getEventContainerPoint(event.touches[1], container),\n        d1 = p1.sub(this._startP1),\n        d2 = p2.sub(this._startP2),\n        vector = p1.sub(p2),\n        scale = p1.distanceTo(p2) / this._startDist,\n        bearing = vector.angleWith(this._startVector) * 180 / Math.PI,\n        preY = this.preY || p1.y,\n        pitch = (preY - p1.y) * 0.4;\n\n    this.preY = p1.y;\n    var param = {\n      'domEvent': event,\n      'mousePos': [p1, p2]\n    };\n\n    if (!this.mode) {\n      if (map.options['touchRotate'] && Math.abs(bearing) > 8) {\n        this.mode = map.options['touchZoomRotate'] ? 'rotate_zoom' : 'rotate';\n      } else if (map.options['touchPitch'] && d1.y * d2.y > 0 && Math.abs(d1.y) > 10 && Math.abs(d2.y) > 10) {\n        this.mode = 'pitch';\n      } else if (map.options['zoomable'] && map.options['touchZoom'] && Math.abs(1 - scale) > 0.15) {\n        this.mode = map.options['touchZoomRotate'] && map.options['touchRotate'] ? 'rotate_zoom' : 'zoom';\n      }\n\n      this._startTouching(param);\n    }\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      this._scale = scale;\n      var res = map._getResolution(this._startZoom) / scale;\n      var zoom = map.getZoomFromRes(res);\n      map.onZooming(zoom, this._Origin);\n    }\n\n    if (this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n      map.setBearing(this._startBearing + bearing);\n      map.onDragRotating(param);\n    } else if (this.mode === 'pitch') {\n      map.setPitch(map.getPitch() + pitch);\n      map.onDragRotating(param);\n    }\n\n    map._fireEvent('touchactinging');\n  };\n\n  _proto._startTouching = function _startTouching(param) {\n    var map = this.target;\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      var size = map.getSize();\n      this._Origin = new Point(size['width'] / 2, size['height'] / 2);\n      map.onZoomStart(null, this._Origin);\n    }\n\n    if (this.mode === 'rotate' || this.mode === 'pitch' || this.mode === 'rotate_zoom') {\n      map.onDragRotateStart(param);\n    }\n  };\n\n  _proto._onTouchEnd = function _onTouchEnd(event) {\n    delete this.preY;\n    var map = this.target;\n    off(document, 'touchmove', this._onTouchMove, this);\n    off(document, 'touchend', this._onTouchEnd, this);\n\n    if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n      var scale = this._scale;\n      var res = map._getResolution(this._startZoom) / scale;\n      var zoom = map.getZoomFromRes(res);\n      map.onZoomEnd(zoom, this._Origin);\n    }\n\n    if (this.mode === 'pitch' || this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n      map.onDragRotateEnd({\n        'domEvent': event\n      });\n    }\n\n    delete this.mode;\n\n    map._fireEvent('touchactend');\n  };\n\n  return MapTouchZoomHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'touchGesture': true,\n  'touchZoom': true,\n  'touchPitch': true,\n  'touchRotate': true,\n  'touchZoomRotate': false\n});\nMap$1.addOnLoadHook('addHandler', 'touchGesture', MapTouchZoomHandler);\n\nvar KEY = '__anim_player';\nvar Easing = {\n  in: function _in(t) {\n    return Math.pow(t, 2);\n  },\n  out: function out(t) {\n    return 1 - Easing.in(1 - t);\n  },\n  inAndOut: function inAndOut(t) {\n    return 3 * t * t - 2 * t * t * t;\n  },\n  linear: function linear(t) {\n    return t;\n  },\n  upAndDown: function upAndDown(t) {\n    if (t < 0.5) {\n      return Easing.inAndOut(2 * t);\n    } else {\n      return 1 - Easing.inAndOut(2 * (t - 0.5));\n    }\n  }\n};\n\nvar Frame = function Frame(state, styles) {\n  this.state = state;\n  this.styles = styles;\n};\n\nvar Player = function Player(animation, options, onFrame, target) {\n  this._animation = animation;\n  this.options = options;\n  this._onFrame = onFrame;\n  this.playState = 'idle';\n  this.ready = true;\n  this.finished = false;\n  this.target = target;\n};\n\nvar Animation = {\n  speed: {\n    'slow': 2000,\n    'normal': 1000,\n    'fast': 500\n  },\n  _resolveStyles: function _resolveStyles(styles) {\n    if (!styles) {\n      return null;\n    }\n\n    function resolveChild(child) {\n      if (!Array.isArray(child)) {\n        return Animation._resolveStyles(child);\n      }\n\n      var start = [],\n          d = [],\n          dest = [];\n\n      for (var i = 0; i < child.length; i++) {\n        var _styles = Animation._resolveStyles(child[i]);\n\n        if (_styles) {\n          start.push(_styles[0]);\n          d.push(_styles[1]);\n          dest.push(_styles[2]);\n        }\n      }\n\n      if (!start.length) {\n        return null;\n      } else {\n        return [start, d, dest];\n      }\n    }\n\n    function resolveVal(val) {\n      var values = val;\n      var clazz;\n\n      if (!Array.isArray(val)) {\n        if (isNumber(val)) {\n          values = [0, val];\n        } else if (val instanceof Point || val instanceof Coordinate) {\n          clazz = val.constructor;\n          values = [new clazz(0, 0), val];\n        } else {\n          values = [val, val];\n        }\n      }\n\n      var v1 = values[0],\n          v2 = values[1];\n\n      if (isNumber(v1) && isNumber(v2)) {\n        if (v1 === v2) {\n          return null;\n        }\n\n        return [v1, v2 - v1, v2];\n      } else if (Array.isArray(v1) || v1 instanceof Coordinate || v1 instanceof Point) {\n        if (Array.isArray(v1)) {\n          v1 = new Coordinate(v1);\n          v2 = new Coordinate(v2);\n        } else {\n          clazz = v1.constructor;\n          v1 = new clazz(v1);\n          v2 = new clazz(v2);\n        }\n\n        if (v1.equals(v2)) {\n          return null;\n        }\n\n        return [v1, v2.sub(v1), v2];\n      } else {\n        return [v1, 0, v2];\n      }\n    }\n\n    function isChild(val) {\n      if (!Array.isArray(val) && val.constructor === Object) {\n        return true;\n      } else if (Array.isArray(val) && val[0].constructor === Object) {\n        return true;\n      }\n\n      return false;\n    }\n\n    var d = {},\n        start = {},\n        dest = {};\n\n    for (var p in styles) {\n      if (styles.hasOwnProperty(p)) {\n        var values = styles[p];\n\n        if (!values) {\n          continue;\n        } else if (Array.isArray(values)) {\n          if (isNil(values[0]) || isNil(values[1])) {\n            continue;\n          }\n        }\n\n        var childStyles = void 0;\n\n        if (isChild(values)) {\n          childStyles = resolveChild(values);\n        } else {\n          childStyles = resolveVal(values);\n        }\n\n        if (childStyles) {\n          start[p] = childStyles[0];\n          d[p] = childStyles[1];\n          dest[p] = childStyles[2];\n        }\n      }\n    }\n\n    return [start, d, dest];\n  },\n  framing: function framing(styles, options) {\n    if (!options) {\n      options = {};\n    }\n\n    var easing = options['easing'] ? Easing[options['easing']] : Easing.linear;\n\n    if (!easing) {\n      easing = Easing.linear;\n    }\n\n    var dStyles, startStyles, destStyles;\n    styles = Animation._resolveStyles(styles);\n\n    if (styles) {\n      startStyles = styles[0];\n      dStyles = styles[1];\n      destStyles = styles[2];\n    }\n\n    var deltaStyles = function deltaStyles(delta, _startStyles, _dStyles) {\n      if (!_startStyles || !_dStyles) {\n        return null;\n      }\n\n      var result = {};\n\n      for (var p in _dStyles) {\n        if (_dStyles.hasOwnProperty(p)) {\n          if (_startStyles[p] === destStyles[p]) {\n            result[p] = _startStyles[p];\n            continue;\n          }\n\n          var s = _startStyles[p],\n              d = _dStyles[p];\n\n          if (isNumber(d)) {\n            result[p] = s + delta * d;\n          } else if (Array.isArray(d)) {\n            var children = [];\n\n            for (var i = 0; i < d.length; i++) {\n              children.push(deltaStyles(delta, s[i], d[i]));\n            }\n\n            result[p] = children;\n          } else {\n            var clazz = d.constructor;\n\n            if (clazz === Object) {\n              result[p] = deltaStyles(delta, s, d);\n            } else if (s instanceof Point || s instanceof Coordinate) {\n              result[p] = s.add(d.multi(delta));\n            }\n          }\n        }\n      }\n\n      return result;\n    };\n\n    return function (elapsed, duration) {\n      var state, d;\n\n      if (elapsed < 0) {\n        state = {\n          'playState': 'idle',\n          'delta': 0\n        };\n        d = startStyles;\n      } else if (elapsed < duration) {\n        var delta = easing(elapsed / duration);\n        state = {\n          'playState': 'running',\n          'delta': delta\n        };\n        d = deltaStyles(delta, startStyles, dStyles);\n      } else {\n        state = {\n          'playState': 'finished',\n          'delta': 1\n        };\n        d = destStyles;\n      }\n\n      state['startStyles'] = startStyles;\n      state['destStyles'] = destStyles;\n      state['progress'] = elapsed;\n      state['remainingMs'] = duration - elapsed;\n      return new Frame(state, d);\n    };\n  },\n  _requestAnimFrame: function _requestAnimFrame(fn) {\n    if (!this._frameQueue) {\n      this._frameQueue = [];\n    }\n\n    this._frameQueue.push(fn);\n\n    this._a();\n  },\n  _a: function _a() {\n    if (!this._animationFrameId) {\n      this._animationFrameId = requestAnimFrame(Animation._frameFn);\n    }\n  },\n  _run: function _run() {\n    if (this._frameQueue.length) {\n      var running = this._frameQueue;\n      this._frameQueue = [];\n\n      for (var i = 0, len = running.length; i < len; i++) {\n        running[i]();\n      }\n\n      if (this._frameQueue.length) {\n        this._animationFrameId = requestAnimFrame(Animation._frameFn);\n      } else {\n        delete this._animationFrameId;\n      }\n    }\n  },\n  animate: function animate(styles, options, step, target) {\n    if (!options) {\n      options = {};\n    }\n\n    var animation = Animation.framing(styles, options);\n    var player = new Player(animation, options, step, target);\n    return player;\n  }\n};\nAnimation._frameFn = Animation._run.bind(Animation);\nextend(Player.prototype, {\n  _prepare: function _prepare() {\n    var options = this.options;\n    var duration = options['speed'] || options['duration'];\n\n    if (isString(duration)) {\n      duration = Animation.speed[duration];\n\n      if (!duration) {\n        duration = +duration;\n      }\n    }\n\n    if (!duration) {\n      duration = Animation.speed['normal'];\n    }\n\n    this.duration = duration;\n    this._framer = options['framer'] || Animation._requestAnimFrame.bind(Animation);\n  },\n  play: function play() {\n    if (this.playState !== 'idle' && this.playState !== 'paused' || this.target && this.target[KEY]) {\n      return this;\n    }\n\n    if (this.target) {\n      this.target[KEY] = 1;\n    }\n\n    if (this.playState === 'idle') {\n      this.currentTime = 0;\n\n      this._prepare();\n    }\n\n    var t = now();\n\n    if (!this.startTime) {\n      var options = this.options;\n      this.startTime = options['startTime'] ? options['startTime'] : t;\n    }\n\n    this._playStartTime = Math.max(t, this.startTime);\n\n    if (this.playState === 'paused') {\n      this._playStartTime -= this.currentTime;\n    }\n\n    this.playState = 'running';\n\n    this._run();\n\n    return this;\n  },\n  pause: function pause() {\n    if (this.playState === 'paused') {\n      return this;\n    }\n\n    this.playState = 'paused';\n\n    this._run();\n\n    return this;\n  },\n  cancel: function cancel() {\n    if (this.playState === 'idle') {\n      return this;\n    }\n\n    this.playState = 'idle';\n    this.finished = false;\n\n    this._run();\n\n    return this;\n  },\n  finish: function finish() {\n    if (this.playState === 'finished') {\n      return this;\n    }\n\n    this.playState = 'finished';\n    this.finished = true;\n\n    this._run();\n\n    return this;\n  },\n  reverse: function reverse() {},\n  _run: function _run() {\n    var _this = this;\n\n    var onFrame = this._onFrame;\n    var t = now();\n    var elapsed = t - this._playStartTime;\n\n    if (this.options['repeat'] && elapsed >= this.duration) {\n      this._playStartTime = t;\n      elapsed = 0;\n    }\n\n    if (this.playState !== 'running') {\n      if (this.target) {\n        delete this.target[KEY];\n      }\n\n      if (onFrame) {\n        if (this.playState === 'finished') {\n          elapsed = this.duration;\n        } else if (this.playState === 'idle') {\n          elapsed = 0;\n        }\n\n        var _frame = this._animation(elapsed, this.duration);\n\n        _frame.state.playState = this.playState;\n        onFrame(_frame);\n      }\n\n      return;\n    }\n\n    var frame = this._animation(elapsed, this.duration);\n\n    this.playState = frame.state['playState'];\n\n    if (this.playState !== 'running' && this.target) {\n      delete this.target[KEY];\n    }\n\n    if (this.playState === 'idle') {\n      if (this.startTime > t) {\n        setTimeout(this._run.bind(this), this.startTime - t);\n      }\n    } else if (this.playState === 'running') {\n      this._framer(function () {\n        if (_this.playState !== 'running') {\n          return;\n        }\n\n        _this.currentTime = elapsed;\n\n        if (onFrame) {\n          onFrame(frame);\n        }\n\n        _this._run();\n      });\n    } else if (this.playState === 'finished') {\n      this.finished = true;\n\n      if (onFrame) {\n        onFrame(frame);\n      }\n    }\n  }\n});\n\nvar Animation$1 = /*#__PURE__*/Object.freeze({\n  Animation: Animation,\n  Easing: Easing,\n  Player: Player,\n  Frame: Frame\n});\n\nvar simplify = createCommonjsModule(function (module) {\n  (function () {\n\n    function getSqDist(p1, p2) {\n      var dx = p1.x - p2.x,\n          dy = p1.y - p2.y;\n      return dx * dx + dy * dy;\n    }\n\n    function getSqSegDist(p, p1, p2) {\n      var x = p1.x,\n          y = p1.y,\n          dx = p2.x - x,\n          dy = p2.y - y;\n\n      if (dx !== 0 || dy !== 0) {\n        var t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n          x = p2.x;\n          y = p2.y;\n        } else if (t > 0) {\n          x += dx * t;\n          y += dy * t;\n        }\n      }\n\n      dx = p.x - x;\n      dy = p.y - y;\n      return dx * dx + dy * dy;\n    }\n\n    function simplifyRadialDist(points, sqTolerance) {\n      var prevPoint = points[0],\n          newPoints = [prevPoint],\n          point;\n\n      for (var i = 1, len = points.length; i < len; i++) {\n        point = points[i];\n\n        if (getSqDist(point, prevPoint) > sqTolerance) {\n          newPoints.push(point);\n          prevPoint = point;\n        }\n      }\n\n      if (prevPoint !== point) newPoints.push(point);\n      return newPoints;\n    }\n\n    function simplifyDPStep(points, first, last, sqTolerance, simplified) {\n      var maxSqDist = sqTolerance,\n          index;\n\n      for (var i = first + 1; i < last; i++) {\n        var sqDist = getSqSegDist(points[i], points[first], points[last]);\n\n        if (sqDist > maxSqDist) {\n          index = i;\n          maxSqDist = sqDist;\n        }\n      }\n\n      if (maxSqDist > sqTolerance) {\n        if (index - first > 1) simplifyDPStep(points, first, index, sqTolerance, simplified);\n        simplified.push(points[index]);\n        if (last - index > 1) simplifyDPStep(points, index, last, sqTolerance, simplified);\n      }\n    }\n\n    function simplifyDouglasPeucker(points, sqTolerance) {\n      var last = points.length - 1;\n      var simplified = [points[0]];\n      simplifyDPStep(points, 0, last, sqTolerance, simplified);\n      simplified.push(points[last]);\n      return simplified;\n    }\n\n    function simplify(points, tolerance, highestQuality) {\n      if (points.length <= 2) return points;\n      var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\n      points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\n      points = simplifyDouglasPeucker(points, sqTolerance);\n      return points;\n    }\n\n    {\n      module.exports = simplify;\n      module.exports.default = simplify;\n    }\n  })();\n});\n\nvar options$3 = {\n  'smoothness': 0,\n  'enableClip': true,\n  'enableSimplify': true,\n  'simplifyTolerance': 2,\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'polygonFill': '#fff',\n    'polygonOpacity': 1,\n    'opacity': 1\n  }\n};\n\nvar Path = function (_Geometry) {\n  _inheritsLoose(Path, _Geometry);\n\n  function Path() {\n    return _Geometry.apply(this, arguments) || this;\n  }\n\n  var _proto = Path.prototype;\n\n  _proto.getOutline = function getOutline() {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    var map = this.getMap();\n    var extent = painter.getContainerExtent().convertTo(function (c) {\n      return map.containerPointToCoord(c);\n    });\n    return new Polygon(extent.toArray(), {\n      symbol: {\n        'lineWidth': 1,\n        'lineColor': '6b707b'\n      }\n    });\n  };\n\n  _proto.animateShow = function animateShow(options, cb) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._showPlayer) {\n      this._showPlayer.finish();\n    }\n\n    if (isFunction(options)) {\n      options = {};\n      cb = options;\n    }\n\n    var coordinates = this.getCoordinates();\n\n    if (coordinates.length === 0) {\n      return this;\n    }\n\n    this._animIdx = 0;\n    this._animLenSoFar = 0;\n    this.show();\n    var isPolygon = !!this.getShell;\n    var animCoords = isPolygon ? this.getShell().concat(this.getShell()[0]) : this.getCoordinates();\n\n    var projection = this._getProjection();\n\n    var prjAnimCoords = projection.projectCoords(animCoords);\n    this._prjAniShowCenter = this._getPrjExtent().getCenter();\n    this._aniShowCenter = projection.unproject(this._prjAniShowCenter);\n    var duration = options['duration'] || 1000,\n        easing = options['easing'] || 'out';\n    this.setCoordinates([]);\n    var length = 0;\n\n    for (var i = 1; i < prjAnimCoords.length; i++) {\n      length += prjAnimCoords[i].distanceTo(prjAnimCoords[i - 1]);\n    }\n\n    var player = this._showPlayer = Animation.animate({\n      't': duration\n    }, {\n      'duration': duration,\n      'easing': easing\n    }, function (frame) {\n      if (!_this.getMap()) {\n        if (player.playState !== 'finished') {\n          player.finish();\n\n          if (cb) {\n            var _coordinates = _this.getCoordinates();\n\n            cb(frame, _coordinates[_coordinates.length - 1]);\n          }\n        }\n\n        return;\n      }\n\n      var currentCoord = _this._drawAnimShowFrame(frame.styles.t, duration, length, animCoords, prjAnimCoords);\n\n      if (frame.state.playState === 'finished') {\n        delete _this._showPlayer;\n        delete _this._aniShowCenter;\n        delete _this._prjAniShowCenter;\n        delete _this._animIdx;\n        delete _this._animLenSoFar;\n        delete _this._animTailRatio;\n\n        _this.setCoordinates(coordinates);\n      }\n\n      if (cb) {\n        cb(frame, currentCoord);\n      }\n    }, this);\n    player.play();\n    return player;\n  };\n\n  _proto._drawAnimShowFrame = function _drawAnimShowFrame(t, duration, length, coordinates, prjCoords) {\n    if (t === 0) {\n      return coordinates[0];\n    }\n\n    var projection = this._getProjection();\n\n    var targetLength = t / duration * length;\n    var segLen = 0;\n    var i, l;\n\n    for (i = this._animIdx, l = prjCoords.length; i < l - 1; i++) {\n      segLen = prjCoords[i].distanceTo(prjCoords[i + 1]);\n\n      if (this._animLenSoFar + segLen > targetLength) {\n        break;\n      }\n\n      this._animLenSoFar += segLen;\n    }\n\n    this._animIdx = i;\n\n    if (this._animIdx >= l - 1) {\n      this.setCoordinates(coordinates);\n      return coordinates[coordinates.length - 1];\n    }\n\n    var idx = this._animIdx;\n    var p1 = prjCoords[idx],\n        p2 = prjCoords[idx + 1],\n        span = targetLength - this._animLenSoFar,\n        r = span / segLen;\n    this._animTailRatio = r;\n    var x = p1.x + (p2.x - p1.x) * r,\n        y = p1.y + (p2.y - p1.y) * r,\n        lastCoord = new Coordinate(x, y);\n    var targetCoord = projection.unproject(lastCoord);\n    var isPolygon = !!this.getShell;\n\n    if (!isPolygon && this.options['smoothness'] > 0) {\n      var animCoords = coordinates.slice(0, this._animIdx + 3);\n      this.setCoordinates(animCoords);\n      var prjAnimCoords = prjCoords.slice(0, this._animIdx + 3);\n\n      this._setPrjCoordinates(prjAnimCoords);\n    } else {\n      var _animCoords = coordinates.slice(0, this._animIdx + 1);\n\n      _animCoords.push(targetCoord);\n\n      var _prjAnimCoords = prjCoords.slice(0, this._animIdx + 1);\n\n      _prjAnimCoords.push(lastCoord);\n\n      if (isPolygon) {\n        this.setCoordinates([this._aniShowCenter].concat(_animCoords));\n\n        this._setPrjCoordinates([this._prjAniShowCenter].concat(_prjAnimCoords));\n      } else {\n        this.setCoordinates(_animCoords);\n\n        this._setPrjCoordinates(_prjAnimCoords);\n      }\n    }\n\n    return targetCoord;\n  };\n\n  _proto._getCenterInExtent = function _getCenterInExtent(extent, coordinates, clipFn) {\n    var meExtent = this.getExtent();\n\n    if (!extent.intersects(meExtent)) {\n      return null;\n    }\n\n    var clipped = clipFn(coordinates, extent);\n\n    if (clipped.length === 0) {\n      return null;\n    }\n\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    clipped.forEach(function (part) {\n      if (Array.isArray(part)) {\n        part.forEach(function (c) {\n          if (c.point) {\n            c = c.point;\n          }\n\n          sumx += c.x;\n          sumy += c.y;\n          counter++;\n        });\n      } else {\n        if (part.point) {\n          part = part.point;\n        }\n\n        sumx += part.x;\n        sumy += part.y;\n        counter++;\n      }\n    });\n\n    var c = new Coordinate(sumx, sumy)._multi(1 / counter);\n\n    c.count = counter;\n    return c;\n  };\n\n  _proto._getPath2DPoints = function _getPath2DPoints(prjCoords, disableSimplify, zoom) {\n    if (!isArrayHasData(prjCoords)) {\n      return [];\n    }\n\n    var map = this.getMap(),\n        isSimplify = !disableSimplify && this._shouldSimplify(),\n        tolerance = this.options['simplifyTolerance'] * map._getResolution(),\n        isMulti = Array.isArray(prjCoords[0]);\n\n    delete this._simplified;\n\n    if (isSimplify && !isMulti) {\n      var count = prjCoords.length;\n      prjCoords = simplify(prjCoords, tolerance, false);\n      this._simplified = prjCoords.length < count;\n    }\n\n    if (isNil(zoom)) {\n      zoom = map.getZoom();\n    }\n\n    return forEachCoord(prjCoords, function (c) {\n      return map._prjToPoint(c, zoom);\n    });\n  };\n\n  _proto._shouldSimplify = function _shouldSimplify() {\n    var layer = this.getLayer(),\n        properties = this.getProperties();\n    var hasAltitude = properties && layer.options['enableAltitude'] && !isNil(properties[layer.options['altitudeProperty']]);\n    return layer && layer.options['enableSimplify'] && !hasAltitude && this.options['enableSimplify'] && !this._showPlayer;\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(prjPoints) {\n    this._prjCoords = prjPoints;\n    this.onShapeChanged();\n  };\n\n  _proto._getPrjCoordinates = function _getPrjCoordinates() {\n    this._verifyProjection();\n\n    if (!this._prjCoords && this._getProjection()) {\n      this._prjCoords = this._projectCoords(this._coordinates);\n    }\n\n    return this._prjCoords;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    var projection = this._getProjection();\n\n    if (!projection) {\n      return;\n    }\n\n    if (this._prjCoords) {\n      this._coordinates = this._unprojectCoords(this._getPrjCoordinates());\n    }\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    this._prjCoords = null;\n\n    _Geometry.prototype._clearProjection.call(this);\n  };\n\n  _proto._projectCoords = function _projectCoords(points) {\n    var projection = this._getProjection();\n\n    if (projection) {\n      return projection.projectCoords(points);\n    }\n\n    return [];\n  };\n\n  _proto._unprojectCoords = function _unprojectCoords(prjPoints) {\n    var projection = this._getProjection();\n\n    if (projection) {\n      return projection.unprojectCoords(prjPoints);\n    }\n\n    return [];\n  };\n\n  _proto._computeCenter = function _computeCenter() {\n    var ring = this._coordinates;\n\n    if (!isArrayHasData(ring)) {\n      return null;\n    }\n\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    var size = ring.length;\n\n    for (var i = 0; i < size; i++) {\n      if (ring[i]) {\n        if (isNumber(ring[i].x) && isNumber(ring[i].y)) {\n          sumx += ring[i].x;\n          sumy += ring[i].y;\n          counter++;\n        }\n      }\n    }\n\n    return new Coordinate(sumx / counter, sumy / counter);\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    var shell = this._coordinates;\n\n    if (!isArrayHasData(shell)) {\n      return null;\n    }\n\n    var rings = [shell];\n\n    if (this.hasHoles && this.hasHoles()) {\n      rings.push.apply(rings, this.getHoles());\n    }\n\n    return this._coords2Extent(rings, this._getProjection());\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    var coords = [this._getPrjCoordinates()];\n\n    if (this.hasHoles && this.hasHoles()) {\n      coords.push.apply(coords, this._getPrjHoles());\n    }\n\n    return this._coords2Extent(coords);\n  };\n\n  _proto._get2DLength = function _get2DLength() {\n    var vertexes = this._getPath2DPoints(this._getPrjCoordinates(), true);\n\n    var len = 0;\n\n    for (var i = 1, l = vertexes.length; i < l; i++) {\n      len += vertexes[i].distanceTo(vertexes[i - 1]);\n    }\n\n    return len;\n  };\n\n  _proto._hitTestTolerance = function _hitTestTolerance() {\n    var symbol = this._getInternalSymbol();\n\n    var w;\n\n    if (Array.isArray(symbol)) {\n      w = 0;\n\n      for (var i = 0; i < symbol.length; i++) {\n        if (isNumber(symbol[i]['lineWidth'])) {\n          if (symbol[i]['lineWidth'] > w) {\n            w = symbol[i]['lineWidth'];\n          }\n        }\n      }\n    } else {\n      w = symbol['lineWidth'];\n    }\n\n    return isNumber(w) ? w / 2 : 1.5;\n  };\n\n  _proto._coords2Extent = function _coords2Extent(coords, proj) {\n    var result = new Extent(proj);\n\n    for (var i = 0, l = coords.length; i < l; i++) {\n      for (var j = 0, ll = coords[i].length; j < ll; j++) {\n        result._combine(coords[i][j]);\n      }\n    }\n\n    return result;\n  };\n\n  return Path;\n}(Geometry);\n\nPath.mergeOptions(options$3);\n\nvar JSON_TYPE = 'Polygon';\n\nvar Polygon = function (_Path) {\n  _inheritsLoose(Polygon, _Path);\n\n  function Polygon(coordinates, opts) {\n    var _this;\n\n    _this = _Path.call(this, opts) || this;\n    _this.type = 'Polygon';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = Polygon.prototype;\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    if (!coordinates) {\n      this._coordinates = null;\n      this._holes = null;\n\n      this._projectRings();\n\n      return this;\n    }\n\n    var rings = Coordinate.toCoordinates(coordinates);\n    var len = rings.length;\n\n    if (!Array.isArray(rings[0])) {\n      this._coordinates = this._trimRing(rings);\n    } else {\n      this._coordinates = this._trimRing(rings[0]);\n\n      if (len > 1) {\n        var holes = [];\n\n        for (var i = 1; i < len; i++) {\n          if (!rings[i]) {\n            continue;\n          }\n\n          holes.push(this._trimRing(rings[i]));\n        }\n\n        this._holes = holes;\n      }\n    }\n\n    this._projectRings();\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    if (!this._coordinates) {\n      return [];\n    }\n\n    var holes = this.getHoles();\n    var rings = [this._copyAndCloseRing(this._coordinates)];\n\n    for (var i = 0, l = holes.length; i < l; i++) {\n      rings.push(this._copyAndCloseRing(holes[i]));\n    }\n\n    return rings;\n  };\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    return this._getCenterInExtent(extent, this.getShell(), clipPolygon);\n  };\n\n  _proto.getShell = function getShell() {\n    return this._coordinates || [];\n  };\n\n  _proto.getHoles = function getHoles() {\n    return this._holes || [];\n  };\n\n  _proto.hasHoles = function hasHoles() {\n    return this.getHoles().length > 0;\n  };\n\n  _proto._projectRings = function _projectRings() {\n    if (!this.getMap()) {\n      this.onShapeChanged();\n      return;\n    }\n\n    this._prjCoords = this._projectCoords(this._coordinates);\n    this._prjHoles = this._projectCoords(this._holes);\n    this.onShapeChanged();\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(prjCoords) {\n    this._prjCoords = prjCoords;\n    this.onShapeChanged();\n  };\n\n  _proto._cleanRing = function _cleanRing(ring) {\n    for (var i = ring.length - 1; i >= 0; i--) {\n      if (!ring[i]) {\n        ring.splice(i, 1);\n      }\n    }\n  };\n\n  _proto._checkRing = function _checkRing(ring) {\n    this._cleanRing(ring);\n\n    if (!ring || !isArrayHasData(ring)) {\n      return false;\n    }\n\n    var lastPoint = ring[ring.length - 1];\n    var isClose = true;\n\n    if (ring[0].x !== lastPoint.x || ring[0].y !== lastPoint.y) {\n      isClose = false;\n    }\n\n    return isClose;\n  };\n\n  _proto._trimRing = function _trimRing(ring) {\n    var isClose = this._checkRing(ring);\n\n    if (isArrayHasData(ring) && isClose) {\n      ring.splice(ring.length - 1, 1);\n    }\n\n    return ring;\n  };\n\n  _proto._copyAndCloseRing = function _copyAndCloseRing(ring) {\n    ring = ring.slice(0);\n\n    var isClose = this._checkRing(ring);\n\n    if (isArrayHasData(ring) && !isClose) {\n      ring.push(ring[0].copy());\n      return ring;\n    } else {\n      return ring;\n    }\n  };\n\n  _proto._getPrjShell = function _getPrjShell() {\n    if (this.getJSONType() === JSON_TYPE) {\n      return this._getPrjCoordinates();\n    }\n\n    this._verifyProjection();\n\n    if (this._getProjection() && !this._prjShell) {\n      this._prjShell = this._projectCoords(this.getShell());\n    }\n\n    return this._prjShell;\n  };\n\n  _proto._getPrjHoles = function _getPrjHoles() {\n    var projection = this._getProjection();\n\n    this._verifyProjection();\n\n    if (projection && !this._prjHoles) {\n      this._prjHoles = this._projectCoords(this.getHoles());\n    }\n\n    return this._prjHoles;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(measurer) {\n    var rings = this.getCoordinates();\n\n    if (!isArrayHasData(rings)) {\n      return 0;\n    }\n\n    var result = 0;\n\n    for (var i = 0, len = rings.length; i < len; i++) {\n      result += measurer.measureLength(rings[i]);\n    }\n\n    return result;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea(measurer) {\n    var rings = this.getCoordinates();\n\n    if (!isArrayHasData(rings)) {\n      return 0;\n    }\n\n    var result = measurer.measureArea(rings[0]);\n\n    for (var i = 1, len = rings.length; i < len; i++) {\n      result -= measurer.measureArea(rings[i]);\n    }\n\n    return result;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    _Path.prototype._updateCache.call(this);\n\n    if (this._prjHoles) {\n      this._holes = this._unprojectCoords(this._getPrjHoles());\n    }\n  };\n\n  _proto._clearCache = function _clearCache() {\n    delete this._prjShell;\n    return _Path.prototype._clearCache.call(this);\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    if (this._prjHoles) {\n      this._prjHoles = null;\n    }\n\n    if (this._prjShell) {\n      this._prjShell = null;\n    }\n\n    _Path.prototype._clearProjection.call(this);\n  };\n\n  return Polygon;\n}(Path);\n\nPolygon.registerJSONType(JSON_TYPE);\n\nfunction CenterMixin (Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = _class.prototype;\n\n    _proto.getCoordinates = function getCoordinates() {\n      return this._coordinates;\n    };\n\n    _proto.setCoordinates = function setCoordinates(coordinates) {\n      var center = coordinates instanceof Coordinate ? coordinates : new Coordinate(coordinates);\n\n      if (center.equals(this._coordinates)) {\n        return this;\n      }\n\n      this._coordinates = center;\n\n      if (!this.getMap()) {\n        this.onPositionChanged();\n        return this;\n      }\n\n      var projection = this._getProjection();\n\n      this._setPrjCoordinates(projection.project(this._coordinates));\n\n      return this;\n    };\n\n    _proto._getCenter2DPoint = function _getCenter2DPoint(zoom) {\n      var map = this.getMap();\n\n      if (!map) {\n        return null;\n      }\n\n      var z = isNil(zoom) ? map.getZoom() : map.getGLZoom();\n\n      var pcenter = this._getPrjCoordinates();\n\n      if (!pcenter) {\n        return null;\n      }\n\n      return map._prjToPoint(pcenter, z);\n    };\n\n    _proto._getPrjCoordinates = function _getPrjCoordinates() {\n      var projection = this._getProjection();\n\n      this._verifyProjection();\n\n      if (!this._pcenter && projection) {\n        if (this._coordinates) {\n          this._pcenter = projection.project(this._coordinates);\n        }\n      }\n\n      return this._pcenter;\n    };\n\n    _proto._setPrjCoordinates = function _setPrjCoordinates(pcenter) {\n      this._pcenter = pcenter;\n      this.onPositionChanged();\n    };\n\n    _proto._updateCache = function _updateCache() {\n      this._clearCache();\n\n      var projection = this._getProjection();\n\n      if (this._pcenter && projection) {\n        this._coordinates = projection.unproject(this._pcenter);\n      }\n    };\n\n    _proto._clearProjection = function _clearProjection() {\n      this._pcenter = null;\n\n      _Base.prototype._clearProjection.call(this);\n    };\n\n    _proto._computeCenter = function _computeCenter() {\n      return this._coordinates ? this._coordinates.copy() : null;\n    };\n\n    return _class;\n  }(Base);\n}\n\nvar options$4 = {\n  'symbol': {\n    'markerType': 'path',\n    'markerPath': [{\n      'path': 'M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z',\n      'fill': '#DE3333'\n    }],\n    'markerPathWidth': 16,\n    'markerPathHeight': 23,\n    'markerWidth': 24,\n    'markerHeight': 34\n  },\n  'hitTestForEvent': false\n};\n\nvar Marker = function (_CenterMixin) {\n  _inheritsLoose(Marker, _CenterMixin);\n\n  function Marker(coordinates, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, opts) || this;\n    _this.type = 'Point';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = Marker.prototype;\n\n  _proto.getOutline = function getOutline() {\n    var painter = this._getPainter();\n\n    if (!painter) {\n      return null;\n    }\n\n    var coord = this.getCoordinates();\n    var extent = painter.getContainerExtent();\n    var anchor = this.getMap().coordToContainerPoint(coord);\n    return new Marker(coord, {\n      'symbol': {\n        'markerType': 'square',\n        'markerWidth': extent.getWidth(),\n        'markerHeight': extent.getHeight(),\n        'markerLineWidth': 1,\n        'markerLineColor': '6b707b',\n        'markerFill': 'rgba(0, 0, 0, 0)',\n        'markerDx': extent.xmin - (anchor.x - extent.getWidth() / 2),\n        'markerDy': extent.ymin - (anchor.y - extent.getHeight() / 2)\n      }\n    });\n  };\n\n  _proto._isVectorMarker = function _isVectorMarker() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      return false;\n    }\n\n    return VectorMarkerSymbolizer.test(symbol);\n  };\n\n  _proto._canEdit = function _canEdit() {\n    var symbol = this._getInternalSymbol();\n\n    if (Array.isArray(symbol)) {\n      return false;\n    }\n\n    return VectorMarkerSymbolizer.test(symbol) || VectorPathMarkerSymbolizer.test(symbol) || ImageMarkerSymbolizer.test(symbol);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, t) {\n    var extent = this.getContainerExtent();\n\n    if (t) {\n      extent = extent.expand(t);\n    }\n\n    if (extent.contains(point)) {\n      if (this.options['hitTestForEvent']) {\n        return _CenterMixin.prototype._containsPoint.call(this, point, t);\n      } else {\n        return true;\n      }\n    } else {\n      return false;\n    }\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    return computeExtent.call(this, 'getCenter');\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    return computeExtent.call(this, '_getPrjCoordinates');\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    return 0;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    return 0;\n  };\n\n  _proto._getSprite = function _getSprite(resources, canvasClass) {\n    if (this._getPainter()) {\n      return this._getPainter().getSprite(resources, canvasClass);\n    }\n\n    return new Painter(this).getSprite(resources, canvasClass);\n  };\n\n  return Marker;\n}(CenterMixin(Geometry));\n\nMarker.mergeOptions(options$4);\nMarker.registerJSONType('Marker');\n\nfunction computeExtent(fn) {\n  var coordinates = this[fn]();\n\n  if (!coordinates) {\n    return null;\n  }\n\n  return new Extent(coordinates, coordinates, this._getProjection());\n}\n\nvar options$5 = {\n  'arrowStyle': null,\n  'arrowPlacement': 'vertex-last'\n};\n\nvar LineString = function (_Path) {\n  _inheritsLoose(LineString, _Path);\n\n  function LineString(coordinates, options) {\n    var _this;\n\n    _this = _Path.call(this, options) || this;\n    _this.type = 'LineString';\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    return _this;\n  }\n\n  var _proto = LineString.prototype;\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    if (!coordinates) {\n      this._coordinates = null;\n\n      this._setPrjCoordinates(null);\n\n      return this;\n    }\n\n    this._coordinates = Coordinate.toCoordinates(coordinates);\n\n    if (this.getMap()) {\n      this._setPrjCoordinates(this._projectCoords(this._coordinates));\n    } else {\n      this.onShapeChanged();\n    }\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._coordinates || [];\n  };\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    return this._getCenterInExtent(extent, this.getCoordinates(), clipLine);\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(measurer) {\n    return measurer.measureLength(this.getCoordinates());\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    return 0;\n  };\n\n  return LineString;\n}(Path);\n\nLineString.mergeOptions(options$5);\nLineString.registerJSONType('LineString');\n\nvar GeometryCollection = function (_Geometry) {\n  _inheritsLoose(GeometryCollection, _Geometry);\n\n  function GeometryCollection(geometries, opts) {\n    var _this;\n\n    _this = _Geometry.call(this, opts) || this;\n    _this.type = 'GeometryCollection';\n\n    _this.setGeometries(geometries);\n\n    return _this;\n  }\n\n  var _proto = GeometryCollection.prototype;\n\n  _proto.setGeometries = function setGeometries(_geometries) {\n    var geometries = this._checkGeometries(_geometries || []);\n\n    var symbol = this._getSymbol();\n\n    var options = this.config();\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      geometries[i]._initOptions(options);\n\n      geometries[i]._setParent(this);\n\n      geometries[i]._setEventParent(this);\n\n      if (symbol) {\n        geometries[i].setSymbol(symbol);\n      }\n    }\n\n    this._geometries = geometries;\n\n    if (this.getLayer()) {\n      this._bindGeometriesToLayer();\n\n      this.onShapeChanged();\n    }\n\n    return this;\n  };\n\n  _proto.getGeometries = function getGeometries() {\n    return this._geometries || [];\n  };\n\n  _proto.forEach = function forEach(fn, context) {\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      if (!context) {\n        fn(geometries[i], i);\n      } else {\n        fn.call(context, geometries[i], i);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.filter = function filter(fn, context) {\n    if (!fn) {\n      return new GeometryCollection();\n    }\n\n    var selected = [];\n    var isFn = isFunction(fn);\n    var filter = isFn ? fn : createFilter(fn);\n    this.forEach(function (geometry) {\n      var g = isFn ? geometry : getFilterFeature(geometry);\n\n      if (context ? filter.call(context, g) : filter(g)) {\n        selected.push(geometry);\n      }\n    }, this);\n    return new GeometryCollection(selected);\n  };\n\n  _proto.translate = function translate(offset) {\n    if (!offset) {\n      return this;\n    }\n\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    var args = arguments;\n    this.forEach(function (geometry) {\n      if (geometry && geometry.translate) {\n        geometry.translate.apply(geometry, args);\n      }\n    });\n    return this;\n  };\n\n  _proto.isEmpty = function isEmpty$$1() {\n    return !isArrayHasData(this.getGeometries());\n  };\n\n  _proto.remove = function remove() {\n    this.forEach(function (geometry) {\n      geometry._unbind();\n    });\n    return Geometry.prototype.remove.apply(this, arguments);\n  };\n\n  _proto.show = function show() {\n    this.options['visible'] = true;\n    this.forEach(function (geometry) {\n      geometry.show();\n    });\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.options['visible'] = false;\n    this.forEach(function (geometry) {\n      geometry.hide();\n    });\n    return this;\n  };\n\n  _proto.onConfig = function onConfig(config) {\n    this.forEach(function (geometry) {\n      geometry.config(config);\n    });\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var s = _Geometry.prototype.getSymbol.call(this);\n\n    if (!s) {\n      var symbols = [];\n      var is = false;\n      this.forEach(function (g) {\n        var symbol = g.getSymbol();\n\n        if (symbol && !is) {\n          is = true;\n        }\n\n        symbols.push(g.getSymbol());\n      });\n\n      if (is) {\n        s = {\n          'children': symbols\n        };\n      }\n    }\n\n    return s;\n  };\n\n  _proto.setSymbol = function setSymbol(s) {\n    if (s && s['children']) {\n      this._symbol = null;\n      this.forEach(function (g, i) {\n        g.setSymbol(s['children'][i]);\n      });\n    } else {\n      var symbol = this._prepareSymbol(s);\n\n      this._symbol = symbol;\n      this.forEach(function (g) {\n        g.setSymbol(symbol);\n      });\n    }\n\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._setExternSymbol = function _setExternSymbol(symbol) {\n    symbol = this._prepareSymbol(symbol);\n    this._externSymbol = symbol;\n    this.forEach(function (geometry) {\n      geometry._setExternSymbol(symbol);\n    });\n    this.onSymbolChanged();\n    return this;\n  };\n\n  _proto._bindLayer = function _bindLayer() {\n    _Geometry.prototype._bindLayer.apply(this, arguments);\n\n    this._bindGeometriesToLayer();\n  };\n\n  _proto._bindGeometriesToLayer = function _bindGeometriesToLayer() {\n    var layer = this.getLayer();\n    this.forEach(function (geometry) {\n      geometry._bindLayer(layer);\n    });\n  };\n\n  _proto._checkGeometries = function _checkGeometries(geometries) {\n    var invalidGeoError = 'The geometry added to collection is invalid.';\n\n    if (geometries && !Array.isArray(geometries)) {\n      if (geometries instanceof Geometry) {\n        return [geometries];\n      } else {\n        throw new Error(invalidGeoError);\n      }\n    } else {\n      for (var i = 0, l = geometries.length; i < l; i++) {\n        if (!this._checkGeo(geometries[i])) {\n          throw new Error(invalidGeoError + ' Index: ' + i);\n        }\n      }\n\n      return geometries;\n    }\n  };\n\n  _proto._checkGeo = function _checkGeo(geo) {\n    return geo instanceof Geometry;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    if (this.isEmpty()) {\n      return;\n    }\n\n    this.forEach(function (geometry) {\n      if (geometry && geometry._updateCache) {\n        geometry._updateCache();\n      }\n    });\n  };\n\n  _proto._removePainter = function _removePainter() {\n    if (this._painter) {\n      this._painter.remove();\n    }\n\n    delete this._painter;\n    this.forEach(function (geometry) {\n      geometry._removePainter();\n    });\n  };\n\n  _proto._computeCenter = function _computeCenter(projection) {\n    if (!projection || this.isEmpty()) {\n      return null;\n    }\n\n    var sumX = 0,\n        sumY = 0,\n        counter = 0;\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      var center = geometries[i]._computeCenter(projection);\n\n      if (center) {\n        sumX += center.x;\n        sumY += center.y;\n        counter++;\n      }\n    }\n\n    if (counter === 0) {\n      return null;\n    }\n\n    return new Coordinate(sumX / counter, sumY / counter);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, t) {\n    if (this.isEmpty()) {\n      return false;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (geometries[i]._containsPoint(point, t)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._computeExtent = function _computeExtent(projection) {\n    return computeExtent$1.call(this, projection, '_computeExtent');\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    return computeExtent$1.call(this, projection, '_computePrjExtent');\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength(projection) {\n    if (!projection || this.isEmpty()) {\n      return 0;\n    }\n\n    var geometries = this.getGeometries();\n    var result = 0;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      result += geometries[i]._computeGeodesicLength(projection);\n    }\n\n    return result;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea(projection) {\n    if (!projection || this.isEmpty()) {\n      return 0;\n    }\n\n    var geometries = this.getGeometries();\n    var result = 0;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      result += geometries[i]._computeGeodesicArea(projection);\n    }\n\n    return result;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var children = [];\n\n    if (!this.isEmpty()) {\n      var geometries = this.getGeometries();\n\n      for (var i = 0, l = geometries.length; i < l; i++) {\n        if (!geometries[i]) {\n          continue;\n        }\n\n        children.push(geometries[i]._exportGeoJSONGeometry());\n      }\n    }\n\n    return {\n      'type': 'GeometryCollection',\n      'geometries': children\n    };\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    if (this.isEmpty()) {\n      return;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      geometries[i]._clearProjection();\n    }\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var extent = this.getExtent();\n    var anchors = [new Coordinate(extent.xmin, extent.ymax), new Coordinate(extent.xmax, extent.ymin), new Coordinate(extent.xmin, extent.ymin), new Coordinate(extent.xmax, extent.ymax)];\n    return anchors;\n  };\n\n  _proto._getExternalResources = function _getExternalResources() {\n    if (this.isEmpty()) {\n      return [];\n    }\n\n    var geometries = this.getGeometries(),\n        resources = [];\n    var cache = {};\n    var symbol, res, key;\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      if (!geometries[i]) {\n        continue;\n      }\n\n      symbol = geometries[i]._getInternalSymbol();\n      res = getExternalResources(symbol);\n\n      for (var ii = 0, ll = res.length; ii < ll; ii++) {\n        key = res[ii].join();\n\n        if (!cache[key]) {\n          resources.push(res[ii]);\n          cache[key] = 1;\n        }\n      }\n    }\n\n    return resources;\n  };\n\n  _proto.startEdit = function startEdit(opts) {\n    var _this2 = this;\n\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    if (!opts) {\n      opts = {};\n    }\n\n    if (opts['symbol']) {\n      this._originalSymbol = this.getSymbol();\n      this.setSymbol(opts['symbol']);\n    }\n\n    this._draggbleBeforeEdit = this.options['draggable'];\n    this.config('draggable', false);\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      geometries[i].startEdit(opts);\n    }\n\n    this._editing = true;\n    this.hide();\n    setTimeout(function () {\n      _this2.fire('editstart');\n    }, 1);\n    return this;\n  };\n\n  _proto.endEdit = function endEdit() {\n    if (this.isEmpty()) {\n      return this;\n    }\n\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      geometries[i].endEdit();\n    }\n\n    if (this._originalSymbol) {\n      this.setSymbol(this._originalSymbol);\n      delete this._originalSymbol;\n    }\n\n    this._editing = false;\n    this.show();\n    this.config('draggable', this._draggbleBeforeEdit);\n    this.fire('editend');\n    return this;\n  };\n\n  _proto.isEditing = function isEditing() {\n    if (!this._editing) {\n      return false;\n    }\n\n    return true;\n  };\n\n  return GeometryCollection;\n}(Geometry);\n\nGeometryCollection.registerJSONType('GeometryCollection');\n\nfunction computeExtent$1(projection, fn) {\n  if (this.isEmpty()) {\n    return null;\n  }\n\n  var geometries = this.getGeometries();\n  var result = null;\n\n  for (var i = 0, l = geometries.length; i < l; i++) {\n    var geo = geometries[i];\n\n    if (!geo) {\n      continue;\n    }\n\n    var geoExtent = geo[fn](projection);\n\n    if (geoExtent) {\n      result = geoExtent.combine(result);\n    }\n  }\n\n  return result;\n}\n\nvar MultiGeometry = function (_GeometryCollection) {\n  _inheritsLoose(MultiGeometry, _GeometryCollection);\n\n  function MultiGeometry(geoType, type, data, options) {\n    var _this;\n\n    _this = _GeometryCollection.call(this, null, options) || this;\n    _this.GeometryType = geoType;\n    _this.type = type;\n\n    _this._initData(data);\n\n    return _this;\n  }\n\n  var _proto = MultiGeometry.prototype;\n\n  _proto.getCoordinates = function getCoordinates() {\n    var coordinates = [];\n    var geometries = this.getGeometries();\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      var child = geometries[i];\n      coordinates.push(child.getShell && child.getJSONType() !== 'Polygon' ? [child.getShell()] : child.getCoordinates());\n    }\n\n    return coordinates;\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    coordinates = coordinates || [];\n    var geometries = [];\n\n    for (var i = 0, l = coordinates.length; i < l; i++) {\n      var g = new this.GeometryType(coordinates[i], this.config());\n      geometries.push(g);\n    }\n\n    this.setGeometries(geometries);\n    return this;\n  };\n\n  _proto._initData = function _initData(data) {\n    data = data || [];\n\n    if (data.length) {\n      if (data[0] instanceof this.GeometryType) {\n        this.setGeometries(data);\n      } else {\n        this.setCoordinates(data);\n      }\n    }\n  };\n\n  _proto._checkGeo = function _checkGeo(geo) {\n    return geo instanceof this.GeometryType;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var points = this.getCoordinates();\n    var coordinates = Coordinate.toNumberArrays(points);\n    return {\n      'type': this.getType(),\n      'coordinates': coordinates\n    };\n  };\n\n  return MultiGeometry;\n}(GeometryCollection);\n\nvar MultiPoint = function (_MultiGeometry) {\n  _inheritsLoose(MultiPoint, _MultiGeometry);\n\n  function MultiPoint(data, opts) {\n    return _MultiGeometry.call(this, Marker, 'MultiPoint', data, opts) || this;\n  }\n\n  var _proto = MultiPoint.prototype;\n\n  _proto.findClosest = function findClosest(coordinate) {\n    if (!coordinate) {\n      return null;\n    }\n\n    var coords = this.getCoordinates();\n    var hit = null;\n    var max = Infinity;\n    coords.forEach(function (c) {\n      var dist = distanceTo(c, coordinate);\n\n      if (dist < max) {\n        hit = c;\n        max = dist;\n      }\n    });\n    return hit;\n  };\n\n  return MultiPoint;\n}(MultiGeometry);\n\nMultiPoint.registerJSONType('MultiPoint');\n\nfunction distanceTo(p0, p1) {\n  var x = p1.x - p0.x,\n      y = p1.y - p0.y;\n  return Math.sqrt(x * x + y * y);\n}\n\nvar MultiPath = function (_MultiGeometry) {\n  _inheritsLoose(MultiPath, _MultiGeometry);\n\n  function MultiPath() {\n    return _MultiGeometry.apply(this, arguments) || this;\n  }\n\n  var _proto = MultiPath.prototype;\n\n  _proto.getCenterInExtent = function getCenterInExtent(extent) {\n    var children = this.getGeometries();\n    var sumx = 0,\n        sumy = 0,\n        counter = 0;\n    children.forEach(function (l) {\n      var c = l.getCenterInExtent(extent);\n\n      if (c) {\n        sumx += c.x * c.count;\n        sumy += c.y * c.count;\n        counter += c.count;\n      }\n    });\n\n    if (counter === 0) {\n      return null;\n    }\n\n    return new Coordinate(sumx, sumy)._multi(1 / counter);\n  };\n\n  return MultiPath;\n}(MultiGeometry);\n\nvar MultiLineString = function (_MultiPath) {\n  _inheritsLoose(MultiLineString, _MultiPath);\n\n  function MultiLineString(data, options) {\n    return _MultiPath.call(this, LineString, 'MultiLineString', data, options) || this;\n  }\n\n  return MultiLineString;\n}(MultiPath);\n\nMultiLineString.registerJSONType('MultiLineString');\n\nvar MultiPolygon = function (_MultiPath) {\n  _inheritsLoose(MultiPolygon, _MultiPath);\n\n  function MultiPolygon(data, opts) {\n    return _MultiPath.call(this, Polygon, 'MultiPolygon', data, opts) || this;\n  }\n\n  return MultiPolygon;\n}(MultiPath);\n\nMultiPolygon.registerJSONType('MultiPolygon');\n\nvar types$1 = {\n  'Marker': Marker,\n  'LineString': LineString,\n  'Polygon': Polygon,\n  'MultiPoint': MultiPoint,\n  'MultiLineString': MultiLineString,\n  'MultiPolygon': MultiPolygon\n};\nvar GeoJSON = {\n  toGeometry: function toGeometry(geoJSON, foreachFn) {\n    if (isString(geoJSON)) {\n      geoJSON = parseJSON(geoJSON);\n    }\n\n    if (Array.isArray(geoJSON)) {\n      var resultGeos = [];\n\n      for (var i = 0, len = geoJSON.length; i < len; i++) {\n        var geo = GeoJSON._convert(geoJSON[i], foreachFn);\n\n        if (Array.isArray(geo)) {\n          pushIn(resultGeos, geo);\n        } else {\n          resultGeos.push(geo);\n        }\n      }\n\n      return resultGeos;\n    } else {\n      var resultGeo = GeoJSON._convert(geoJSON, foreachFn);\n\n      return resultGeo;\n    }\n  },\n  _convert: function _convert(json, foreachFn) {\n    if (!json || isNil(json['type'])) {\n      return null;\n    }\n\n    var type = json['type'];\n\n    if (type === 'Feature') {\n      var g = json['geometry'];\n\n      var geometry = GeoJSON._convert(g);\n\n      if (!geometry) {\n        return null;\n      }\n\n      geometry.setId(json['id']);\n      geometry.setProperties(json['properties']);\n\n      if (foreachFn) {\n        foreachFn(geometry);\n      }\n\n      return geometry;\n    } else if (type === 'FeatureCollection') {\n      var features = json['features'];\n\n      if (!features) {\n        return null;\n      }\n\n      return GeoJSON.toGeometry(features, foreachFn);\n    } else if (['Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon'].indexOf(type) >= 0) {\n      var clazz = type === 'Point' ? 'Marker' : type;\n      var result = new types$1[clazz](json['coordinates']);\n\n      if (foreachFn) {\n        foreachFn(result);\n      }\n\n      return result;\n    } else if (type === 'GeometryCollection') {\n      var geometries = json['geometries'];\n\n      if (!isArrayHasData(geometries)) {\n        var _result2 = new GeometryCollection();\n\n        if (foreachFn) {\n          foreachFn(_result2);\n        }\n\n        return _result2;\n      }\n\n      var mGeos = [];\n      var size = geometries.length;\n\n      for (var i = 0; i < size; i++) {\n        mGeos.push(GeoJSON._convert(geometries[i]));\n      }\n\n      var _result = new GeometryCollection(mGeos);\n\n      if (foreachFn) {\n        foreachFn(_result);\n      }\n\n      return _result;\n    }\n\n    return null;\n  }\n};\n\nvar options$6 = {\n  'numberOfShellPoints': 60\n};\n\nvar Circle = function (_CenterMixin) {\n  _inheritsLoose(Circle, _CenterMixin);\n\n  Circle.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var circle = new Circle(json['coordinates'], json['radius'], json['options']);\n    circle.setProperties(feature['properties']);\n    return circle;\n  };\n\n  function Circle(coordinates, radius, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this._radius = radius;\n    return _this;\n  }\n\n  var _proto = Circle.prototype;\n\n  _proto.getRadius = function getRadius() {\n    return this._radius;\n  };\n\n  _proto.setRadius = function setRadius(radius) {\n    this._radius = radius;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'],\n        radius = this.getRadius();\n\n    var shell = [];\n    var rad, dx, dy;\n\n    for (var i = 0, len = numberOfPoints - 1; i < len; i++) {\n      rad = 360 * i / len * Math.PI / 180;\n      dx = radius * Math.cos(rad);\n      dy = radius * Math.sin(rad);\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    shell.push(shell[0]);\n    return shell;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.getPitch()) {\n      return _CenterMixin.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var center = map._pointToContainerPoint(this._getCenter2DPoint()),\n        size = this.getSize(),\n        t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        se = center.add(size.width / 2, size.height / 2);\n\n    return withInEllipse(point, center, se, t);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    var minmax = this._getMinMax(projection);\n\n    if (!minmax) {\n      return null;\n    }\n\n    var pcenter = this._getPrjCoordinates();\n\n    var pminmax = minmax.map(function (c) {\n      return projection.project(c);\n    });\n    var leftx = pminmax[0].x - pcenter.x;\n    var rightx = pminmax[1].x - pcenter.x;\n    var topy = pminmax[2].y - pcenter.y;\n    var bottomy = pminmax[3].y - pcenter.y;\n    return new Extent(pcenter.add(leftx, topy), pcenter.add(rightx, bottomy));\n  };\n\n  _proto._computeExtent = function _computeExtent(measurer) {\n    var minmax = this._getMinMax(measurer);\n\n    if (!minmax) {\n      return null;\n    }\n\n    return new Extent(minmax[0].x, minmax[2].y, minmax[1].x, minmax[3].y, this._getProjection());\n  };\n\n  _proto._getMinMax = function _getMinMax(measurer) {\n    if (!measurer || !this._coordinates || isNil(this._radius)) {\n      return null;\n    }\n\n    var radius = this._radius;\n    var p1 = measurer.locate(this._coordinates, -radius, 0),\n        p2 = measurer.locate(this._coordinates, radius, 0),\n        p3 = measurer.locate(this._coordinates, 0, radius),\n        p4 = measurer.locate(this._coordinates, 0, -radius);\n    return [p1, p2, p3, p4];\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * 2 * this._radius;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * Math.pow(this._radius, 2);\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var center = this.getCenter();\n    var opts = extend({}, options);\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Circle',\n      'coordinates': [center.x, center.y],\n      'radius': this.getRadius()\n    };\n  };\n\n  return Circle;\n}(CenterMixin(Polygon));\n\nCircle.mergeOptions(options$6);\nCircle.registerJSONType('Circle');\n\nvar options$7 = {\n  'numberOfShellPoints': 80\n};\n\nvar Ellipse = function (_CenterMixin) {\n  _inheritsLoose(Ellipse, _CenterMixin);\n\n  Ellipse.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var ellipse = new Ellipse(json['coordinates'], json['width'], json['height'], json['options']);\n    ellipse.setProperties(feature['properties']);\n    return ellipse;\n  };\n\n  function Ellipse(coordinates, width, height, opts) {\n    var _this;\n\n    _this = _CenterMixin.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this.width = width;\n    _this.height = height;\n    return _this;\n  }\n\n  var _proto = Ellipse.prototype;\n\n  _proto.getWidth = function getWidth() {\n    return this.width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this.width = width;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this.height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this.height = height;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'],\n        width = this.getWidth(),\n        height = this.getHeight();\n\n    var shell = [];\n    var s = Math.pow(width / 2, 2) * Math.pow(height / 2, 2),\n        sx = Math.pow(width / 2, 2),\n        sy = Math.pow(height / 2, 2);\n    var deg, rad, dx, dy;\n\n    for (var i = 0; i < numberOfPoints; i++) {\n      deg = 360 * i / numberOfPoints;\n      rad = deg * Math.PI / 180;\n      dx = Math.sqrt(s / (sx * Math.pow(Math.tan(rad), 2) + sy));\n      dy = Math.sqrt(s / (sy * Math.pow(1 / Math.tan(rad), 2) + sx));\n\n      if (deg > 90 && deg < 270) {\n        dx *= -1;\n      }\n\n      if (deg > 180 && deg < 360) {\n        dy *= -1;\n      }\n\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    return shell;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _CenterMixin.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var projection = map.getProjection();\n\n    var t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        pps = projection.projectCoords([this._coordinates, map.locate(this._coordinates, this.getWidth() / 2, this.getHeight() / 2)]),\n        p0 = map._prjToContainerPoint(pps[0]),\n        p1 = map._prjToContainerPoint(pps[1]);\n\n    return withInEllipse(point, p0, p1, t);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent() {\n    return Circle.prototype._computePrjExtent.apply(this, arguments);\n  };\n\n  _proto._computeExtent = function _computeExtent() {\n    return Circle.prototype._computeExtent.apply(this, arguments);\n  };\n\n  _proto._getMinMax = function _getMinMax(measurer) {\n    if (!measurer || !this._coordinates || isNil(this.width) || isNil(this.height)) {\n      return null;\n    }\n\n    var width = this.getWidth(),\n        height = this.getHeight();\n    var p1 = measurer.locate(this._coordinates, -width / 2, 0),\n        p2 = measurer.locate(this._coordinates, width / 2, 0),\n        p3 = measurer.locate(this._coordinates, 0, -height / 2),\n        p4 = measurer.locate(this._coordinates, 0, height / 2);\n    return [p1, p2, p3, p4];\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return 0;\n    }\n\n    var longer = this.width > this.height ? this.width : this.height;\n    return 2 * Math.PI * longer / 2 - 4 * Math.abs(this.width - this.height);\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this.width) || isNil(this.height)) {\n      return 0;\n    }\n\n    return Math.PI * this.width * this.height / 4;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var center = this.getCenter();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Ellipse',\n      'coordinates': [center.x, center.y],\n      'width': this.getWidth(),\n      'height': this.getHeight()\n    };\n  };\n\n  return Ellipse;\n}(CenterMixin(Polygon));\n\nEllipse.mergeOptions(options$7);\nEllipse.registerJSONType('Ellipse');\n\nvar Rectangle = function (_Polygon) {\n  _inheritsLoose(Rectangle, _Polygon);\n\n  Rectangle.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var rect = new Rectangle(json['coordinates'], json['width'], json['height'], json['options']);\n    rect.setProperties(feature['properties']);\n    return rect;\n  };\n\n  function Rectangle(coordinates, width, height, opts) {\n    var _this;\n\n    _this = _Polygon.call(this, null, opts) || this;\n\n    if (coordinates) {\n      _this.setCoordinates(coordinates);\n    }\n\n    _this._width = width;\n    _this._height = height;\n    return _this;\n  }\n\n  var _proto = Rectangle.prototype;\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._coordinates;\n  };\n\n  _proto.setCoordinates = function setCoordinates(nw) {\n    this._coordinates = nw instanceof Coordinate ? nw : new Coordinate(nw);\n\n    if (!this._coordinates || !this.getMap()) {\n      this.onPositionChanged();\n      return this;\n    }\n\n    var projection = this._getProjection();\n\n    this._setPrjCoordinates(projection.project(this._coordinates));\n\n    return this;\n  };\n\n  _proto.getWidth = function getWidth() {\n    return this._width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this._width = width;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this._height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this._height = height;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer();\n\n    var nw = this._coordinates;\n    var map = this.getMap();\n    var sx = 1,\n        sy = -1;\n\n    if (map) {\n      var fExt = map.getFullExtent();\n\n      if (fExt['left'] > fExt['right']) {\n        sx = -1;\n      }\n\n      if (fExt['bottom'] > fExt['top']) {\n        sy = 1;\n      }\n    }\n\n    var points = [];\n    points.push(nw);\n    points.push(measurer.locate(nw, sx * this._width, 0));\n    points.push(measurer.locate(nw, sx * this._width, sy * this._height));\n    points.push(measurer.locate(nw, 0, sy * this._height));\n    points.push(nw);\n    return points;\n  };\n\n  _proto.getHoles = function getHoles() {\n    return [];\n  };\n\n  _proto.animateShow = function animateShow() {\n    return this.show();\n  };\n\n  _proto._getPrjCoordinates = function _getPrjCoordinates() {\n    var projection = this._getProjection();\n\n    this._verifyProjection();\n\n    if (!this._pnw && projection) {\n      if (this._coordinates) {\n        this._pnw = projection.project(this._coordinates);\n      }\n    }\n\n    return this._pnw;\n  };\n\n  _proto._setPrjCoordinates = function _setPrjCoordinates(pnw) {\n    this._pnw = pnw;\n    this.onPositionChanged();\n  };\n\n  _proto._getPrjShell = function _getPrjShell() {\n    var shell = _Polygon.prototype._getPrjShell.call(this);\n\n    var projection = this._getProjection();\n\n    if (!projection.isSphere()) {\n      return shell;\n    }\n\n    var sphereExtent = projection.getSphereExtent(),\n        sx = sphereExtent.sx,\n        sy = sphereExtent.sy;\n\n    var circum = this._getProjection().getCircum();\n\n    var nw = shell[0];\n\n    for (var i = 1, l = shell.length; i < l; i++) {\n      var p = shell[i];\n      var dx = 0,\n          dy = 0;\n\n      if (sx * (nw.x - p.x) > 0) {\n        dx = circum.x * sx;\n      }\n\n      if (sy * (nw.y - p.y) < 0) {\n        dy = circum.y * sy;\n      }\n\n      shell[i]._add(dx, dy);\n    }\n\n    return shell;\n  };\n\n  _proto._updateCache = function _updateCache() {\n    this._clearCache();\n\n    var projection = this._getProjection();\n\n    if (this._pnw && projection) {\n      this._coordinates = projection.unproject(this._pnw);\n    }\n  };\n\n  _proto._clearProjection = function _clearProjection() {\n    this._pnw = null;\n\n    _Polygon.prototype._clearProjection.call(this);\n  };\n\n  _proto._computeCenter = function _computeCenter(measurer) {\n    return measurer.locate(this._coordinates, this._width / 2, -this._height / 2);\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _Polygon.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        r = map._getResolution() * t;\n\n    var extent = this._getPrjExtent().expand(r);\n\n    var p = map._containerPointToPrj(point);\n\n    return extent.contains(p);\n  };\n\n  _proto._computePrjExtent = function _computePrjExtent(projection) {\n    var se = this._getSouthEast(projection);\n\n    if (!se) {\n      return null;\n    }\n\n    var prjs = projection.projectCoords([new Coordinate(this._coordinates.x, se.y), new Coordinate(se.x, this._coordinates.y)]);\n    return new Extent(prjs[0], prjs[1]);\n  };\n\n  _proto._computeExtent = function _computeExtent(measurer) {\n    var se = this._getSouthEast(measurer);\n\n    if (!se) {\n      return null;\n    }\n\n    return new Extent(this._coordinates, se, this._getProjection());\n  };\n\n  _proto._getSouthEast = function _getSouthEast(measurer) {\n    if (!measurer || !this._coordinates || isNil(this._width) || isNil(this._height)) {\n      return null;\n    }\n\n    var width = this.getWidth(),\n        height = this.getHeight();\n    var w = width,\n        h = -height;\n\n    if (measurer.fullExtent) {\n      var fullExtent = measurer.fullExtent,\n          sx = fullExtent.right > fullExtent.left ? 1 : -1,\n          sy = fullExtent.top > fullExtent.bottom ? 1 : -1;\n      w *= sx;\n      h *= sy;\n    }\n\n    var se = measurer.locate(this._coordinates, w, h);\n    return se;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._width) || isNil(this._height)) {\n      return 0;\n    }\n\n    return 2 * (this._width + this._height);\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._width) || isNil(this._height)) {\n      return 0;\n    }\n\n    return this._width * this._height;\n  };\n\n  _proto._exportGeoJSONGeometry = function _exportGeoJSONGeometry() {\n    var coordinates = Coordinate.toNumberArrays([this.getShell()]);\n    return {\n      'type': 'Polygon',\n      'coordinates': coordinates\n    };\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var nw = this.getCoordinates();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Rectangle',\n      'coordinates': [nw.x, nw.y],\n      'width': this.getWidth(),\n      'height': this.getHeight()\n    };\n  };\n\n  return Rectangle;\n}(Polygon);\n\nRectangle.registerJSONType('Rectangle');\n\nvar options$8 = {\n  'numberOfShellPoints': 60\n};\n\nvar Sector = function (_Circle) {\n  _inheritsLoose(Sector, _Circle);\n\n  Sector.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var sector = new Sector(json['coordinates'], json['radius'], json['startAngle'], json['endAngle'], json['options']);\n    sector.setProperties(feature['properties']);\n    return sector;\n  };\n\n  function Sector(coordinates, radius, startAngle, endAngle, opts) {\n    var _this;\n\n    _this = _Circle.call(this, coordinates, radius, opts) || this;\n    _this.startAngle = startAngle;\n    _this.endAngle = endAngle;\n    return _this;\n  }\n\n  var _proto = Sector.prototype;\n\n  _proto.getStartAngle = function getStartAngle() {\n    return this.startAngle;\n  };\n\n  _proto.setStartAngle = function setStartAngle(startAngle) {\n    this.startAngle = startAngle;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getEndAngle = function getEndAngle() {\n    return this.endAngle;\n  };\n\n  _proto.setEndAngle = function setEndAngle(endAngle) {\n    this.endAngle = endAngle;\n    this.onShapeChanged();\n    return this;\n  };\n\n  _proto.getShell = function getShell() {\n    var measurer = this._getMeasurer(),\n        center = this.getCoordinates(),\n        numberOfPoints = this.options['numberOfShellPoints'] - 2,\n        radius = this.getRadius(),\n        shell = [center.copy()],\n        startAngle = this.getStartAngle(),\n        angle = this.getEndAngle() - startAngle;\n\n    var rad, dx, dy;\n\n    for (var i = 0; i < numberOfPoints; i++) {\n      rad = (angle * i / (numberOfPoints - 1) + startAngle) * Math.PI / 180;\n      dx = radius * Math.cos(rad);\n      dy = radius * Math.sin(rad);\n      var vertex = measurer.locate(center, dx, dy);\n      shell.push(vertex);\n    }\n\n    shell.push(center.copy());\n    return shell;\n  };\n\n  _proto._containsPoint = function _containsPoint(point, tolerance) {\n    var map = this.getMap();\n\n    if (map.isTransforming()) {\n      return _Circle.prototype._containsPoint.call(this, point, tolerance);\n    }\n\n    var center = map._pointToContainerPoint(this._getCenter2DPoint()),\n        t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n        size = this.getSize(),\n        pc = center,\n        pp = point,\n        x = pp.x - pc.x,\n        y = pc.y - pp.y,\n        atan2 = Math.atan2(y, x),\n        angle = atan2 < 0 ? (atan2 + 2 * Math.PI) * 360 / (2 * Math.PI) : atan2 * 360 / (2 * Math.PI);\n\n    var sAngle = this.startAngle % 360,\n        eAngle = this.endAngle % 360;\n    var between = false;\n\n    if (sAngle > eAngle) {\n      between = !(angle > eAngle && angle < sAngle);\n    } else {\n      between = angle >= sAngle && angle <= eAngle;\n    }\n\n    return pp.distanceTo(pc) <= size.width / 2 + t && between;\n  };\n\n  _proto._computeGeodesicLength = function _computeGeodesicLength() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * 2 * this._radius * Math.abs(this.startAngle - this.endAngle) / 360 + 2 * this._radius;\n  };\n\n  _proto._computeGeodesicArea = function _computeGeodesicArea() {\n    if (isNil(this._radius)) {\n      return 0;\n    }\n\n    return Math.PI * Math.pow(this._radius, 2) * Math.abs(this.startAngle - this.endAngle) / 360;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    var opts = extend({}, options);\n    var center = this.getCenter();\n    opts.geometry = false;\n    var feature = this.toGeoJSON(opts);\n    feature['geometry'] = {\n      'type': 'Polygon'\n    };\n    return {\n      'feature': feature,\n      'subType': 'Sector',\n      'coordinates': [center.x, center.y],\n      'radius': this.getRadius(),\n      'startAngle': this.getStartAngle(),\n      'endAngle': this.getEndAngle()\n    };\n  };\n\n  return Sector;\n}(Circle);\n\nSector.mergeOptions(options$8);\nSector.registerJSONType('Sector');\n\nvar options$9 = {\n  'enableSimplify': false,\n  'enableClip': false\n};\n\nvar Curve = function (_LineString) {\n  _inheritsLoose(Curve, _LineString);\n\n  function Curve() {\n    return _LineString.apply(this, arguments) || this;\n  }\n\n  var _proto = Curve.prototype;\n\n  _proto._arc = function _arc(ctx, points, lineOpacity) {\n    var degree = this.options['arcDegree'] * Math.PI / 180;\n\n    for (var i = 1, l = points.length; i < l; i++) {\n      var c = Canvas._arcBetween(ctx, points[i - 1], points[i], degree);\n\n      var ctrlPoint = [points[i - 1].x + points[i].x - c[0], points[i - 1].y + points[i].y - c[1]];\n      points[i - 1].nextCtrlPoint = ctrlPoint;\n      points[i].prevCtrlPoint = ctrlPoint;\n\n      Canvas._stroke(ctx, lineOpacity);\n    }\n  };\n\n  _proto._quadraticCurve = function _quadraticCurve(ctx, points) {\n    if (points.length <= 2) {\n      Canvas._path(ctx, points);\n\n      return;\n    }\n\n    var i, l;\n\n    for (i = 2, l = points.length; i < l; i += 2) {\n      ctx.quadraticCurveTo(points[i - 1].x, points[i - 1].y, points[i].x, points[i].y);\n    }\n\n    i -= 1;\n\n    if (i < l) {\n      for (; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n    }\n  };\n\n  _proto._bezierCurve = function _bezierCurve(ctx, points) {\n    if (points.length <= 3) {\n      Canvas._path(ctx, points);\n\n      return;\n    }\n\n    var i, l;\n\n    for (i = 1, l = points.length; i + 2 < l; i += 3) {\n      ctx.bezierCurveTo(points[i].x, points[i].y, points[i + 1].x, points[i + 1].y, points[i + 2].x, points[i + 2].y);\n    }\n\n    if (i < l) {\n      for (; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n    }\n  };\n\n  _proto._getCurveArrowPoints = function _getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, step) {\n    var l = segments.length;\n    var i;\n\n    for (i = step; i < l; i += step) {\n      var arrow = this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance);\n\n      if (arrow) {\n        arrows.push(arrow);\n      }\n    }\n\n    i -= step;\n\n    if (i < l - 1) {\n      for (i += 1; i < l; i++) {\n        var _arrow = this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance);\n\n        if (_arrow) {\n          arrows.push(_arrow);\n        }\n      }\n    }\n  };\n\n  return Curve;\n}(LineString);\n\nCurve.mergeOptions(options$9);\n\nvar options$a = {\n  'arcDegree': 90\n};\n\nvar ArcCurve = function (_Curve) {\n  _inheritsLoose(ArcCurve, _Curve);\n\n  function ArcCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  var _proto = ArcCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'ArcCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n\n    this._arc(ctx, points, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  ArcCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var arc = new ArcCurve(feature['geometry']['coordinates'], json['options']);\n    arc.setProperties(feature['properties']);\n    return arc;\n  };\n\n  return ArcCurve;\n}(Curve);\n\nArcCurve.registerJSONType('ArcCurve');\nArcCurve.mergeOptions(options$a);\n\nvar CubicBezierCurve = function (_Curve) {\n  _inheritsLoose(CubicBezierCurve, _Curve);\n\n  function CubicBezierCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  CubicBezierCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var curve = new CubicBezierCurve(feature['geometry']['coordinates'], json['options']);\n    curve.setProperties(feature['properties']);\n    return curve;\n  };\n\n  var _proto = CubicBezierCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'CubicBezierCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    this._bezierCurve(ctx, points);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  _proto._getArrowPoints = function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 3);\n  };\n\n  return CubicBezierCurve;\n}(Curve);\n\nCubicBezierCurve.registerJSONType('CubicBezierCurve');\n\nvar QuadBezierCurve = function (_Curve) {\n  _inheritsLoose(QuadBezierCurve, _Curve);\n\n  function QuadBezierCurve() {\n    return _Curve.apply(this, arguments) || this;\n  }\n\n  QuadBezierCurve.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var curve = new QuadBezierCurve(feature['geometry']['coordinates'], json['options']);\n    curve.setProperties(feature['properties']);\n    return curve;\n  };\n\n  var _proto = QuadBezierCurve.prototype;\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'QuadBezierCurve'\n    };\n  };\n\n  _proto._paintOn = function _paintOn(ctx, points, lineOpacity) {\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    this._quadraticCurve(ctx, points, lineOpacity);\n\n    Canvas._stroke(ctx, lineOpacity);\n\n    this._paintArrow(ctx, points, lineOpacity);\n  };\n\n  _proto._getArrowPoints = function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 2);\n  };\n\n  return QuadBezierCurve;\n}(Curve);\n\nQuadBezierCurve.registerJSONType('QuadBezierCurve');\n\nvar defaultSymbol$1 = {\n  'textFaceName': 'monospace',\n  'textSize': 12,\n  'textLineSpacing': 8,\n  'textWrapCharacter': '\\n',\n  'textHorizontalAlignment': 'middle',\n  'textVerticalAlignment': 'middle'\n};\nvar defaultBoxSymbol = {\n  'markerType': 'square',\n  'markerLineColor': '#000',\n  'markerLineWidth': 2,\n  'markerLineOpacity': 1,\n  'markerFill': '#fff',\n  'markerOpacity': 1\n};\n\nvar TextMarker = function (_Marker) {\n  _inheritsLoose(TextMarker, _Marker);\n\n  function TextMarker() {\n    return _Marker.apply(this, arguments) || this;\n  }\n\n  var _proto = TextMarker.prototype;\n\n  _proto.getContent = function getContent() {\n    return this._content;\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this._content;\n    this._content = escapeSpecialChars(content);\n\n    this._refresh();\n\n    this._fireEvent('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    return this;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this._refresh();\n  };\n\n  _proto.toJSON = function toJSON() {\n    var json = _Marker.prototype.toJSON.call(this);\n\n    delete json['symbol'];\n    return json;\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    if (this._refreshing || !symbol) {\n      return _Marker.prototype.setSymbol.call(this, symbol);\n    }\n\n    var s = this._parseSymbol(symbol);\n\n    if (this.setTextStyle) {\n      var style = this.getTextStyle() || {};\n      style.symbol = s[0];\n      this.setTextStyle(style);\n    } else if (this.setTextSymbol) {\n      this.setTextSymbol(s[0]);\n    }\n\n    if (this.setBoxStyle) {\n      var _style = this.getBoxStyle() || {};\n\n      _style.symbol = s[1];\n      this.setBoxStyle(_style);\n    } else if (this.setBoxSymbol) {\n      this.setBoxSymbol(s[1]);\n    }\n\n    return this;\n  };\n\n  _proto._parseSymbol = function _parseSymbol(symbol) {\n    var t = {};\n    var b = {};\n\n    for (var p in symbol) {\n      if (hasOwn(symbol, p)) {\n        if (p.indexOf('text') === 0) {\n          t[p] = symbol[p];\n        } else {\n          b[p] = symbol[p];\n        }\n      }\n    }\n\n    return [t, b];\n  };\n\n  _proto._getTextSize = function _getTextSize(symbol) {\n    return splitTextToRow(this._content, symbol)['size'];\n  };\n\n  _proto._getInternalSymbol = function _getInternalSymbol() {\n    return this._symbol;\n  };\n\n  _proto._getDefaultTextSymbol = function _getDefaultTextSymbol() {\n    return extend({}, defaultSymbol$1);\n  };\n\n  _proto._getDefaultBoxSymbol = function _getDefaultBoxSymbol() {\n    return extend({}, defaultBoxSymbol);\n  };\n\n  _proto._getDefaultPadding = function _getDefaultPadding() {\n    return [12, 8];\n  };\n\n  return TextMarker;\n}(Marker);\n\nvar options$b = {\n  'textStyle': {\n    'wrap': true,\n    'padding': [12, 8],\n    'verticalAlignment': 'middle',\n    'horizontalAlignment': 'middle'\n  },\n  'boxSymbol': null\n};\n\nvar TextBox = function (_TextMarker) {\n  _inheritsLoose(TextBox, _TextMarker);\n\n  function TextBox(content, coordinates, width, height, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _TextMarker.call(this, coordinates, options) || this;\n    _this._content = escapeSpecialChars(content);\n    _this._width = isNil(width) ? 100 : width;\n    _this._height = isNil(height) ? 40 : height;\n\n    if (options.boxSymbol) {\n      _this.setBoxSymbol(options.boxSymbol);\n    }\n\n    if (options.textStyle) {\n      _this.setTextStyle(options.textStyle);\n    }\n\n    _this._refresh();\n\n    return _this;\n  }\n\n  var _proto = TextBox.prototype;\n\n  _proto.getWidth = function getWidth() {\n    return this._width;\n  };\n\n  _proto.setWidth = function setWidth(width) {\n    this._width = width;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getHeight = function getHeight() {\n    return this._height;\n  };\n\n  _proto.setHeight = function setHeight(height) {\n    this._height = height;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getBoxSymbol = function getBoxSymbol() {\n    return extend({}, this.options.boxSymbol);\n  };\n\n  _proto.setBoxSymbol = function setBoxSymbol(symbol) {\n    this.options.boxSymbol = symbol ? extend({}, symbol) : symbol;\n\n    if (this.getSymbol()) {\n      this._refresh();\n    }\n\n    return this;\n  };\n\n  _proto.getTextStyle = function getTextStyle() {\n    if (!this.options.textStyle) {\n      return null;\n    }\n\n    return extend({}, this.options.textStyle);\n  };\n\n  _proto.setTextStyle = function setTextStyle(style) {\n    this.options.textStyle = style ? extend({}, style) : style;\n\n    if (this.getSymbol()) {\n      this._refresh();\n    }\n\n    return this;\n  };\n\n  TextBox.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var textBox = new TextBox(json['content'], feature['geometry']['coordinates'], json['width'], json['height'], json['options']);\n    textBox.setProperties(feature['properties']);\n    textBox.setId(feature['id']);\n\n    if (json['symbol']) {\n      textBox.setSymbol(json['symbol']);\n    }\n\n    return textBox;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'width': this.getWidth(),\n      'height': this.getHeight(),\n      'subType': 'TextBox',\n      'content': this._content\n    };\n  };\n\n  _proto._refresh = function _refresh() {\n    var textStyle = this.getTextStyle() || {},\n        padding = textStyle['padding'] || [12, 8],\n        maxWidth = this._width - 2 * padding[0],\n        maxHeight = this._height - 2 * padding[1];\n    var symbol = extend({}, textStyle.symbol || this._getDefaultTextSymbol(), this.options.boxSymbol || this._getDefaultBoxSymbol(), {\n      'textName': this._content,\n      'markerWidth': this._width,\n      'markerHeight': this._height,\n      'textHorizontalAlignment': 'middle',\n      'textVerticalAlignment': 'middle',\n      'textMaxWidth': maxWidth,\n      'textMaxHeight': maxHeight\n    });\n\n    if (textStyle['wrap'] && !symbol['textWrapWidth']) {\n      symbol['textWrapWidth'] = maxWidth;\n    }\n\n    var hAlign = textStyle['horizontalAlignment'];\n    symbol['textDx'] = symbol['markerDx'] || 0;\n    var offsetX = symbol['markerWidth'] / 2 - padding[0];\n\n    if (hAlign === 'left') {\n      symbol['textHorizontalAlignment'] = 'right';\n      symbol['textDx'] = symbol['textDx'] - offsetX;\n    } else if (hAlign === 'right') {\n      symbol['textHorizontalAlignment'] = 'left';\n      symbol['textDx'] = symbol['textDx'] + offsetX;\n    }\n\n    var vAlign = textStyle['verticalAlignment'];\n    symbol['textDy'] = symbol['markerDy'] || 0;\n    var offsetY = symbol['markerHeight'] / 2 - padding[1];\n\n    if (vAlign === 'top') {\n      symbol['textVerticalAlignment'] = 'bottom';\n      symbol['textDy'] -= offsetY;\n    } else if (vAlign === 'bottom') {\n      symbol['textVerticalAlignment'] = 'top';\n      symbol['textDy'] += offsetY;\n    }\n\n    this._refreshing = true;\n    this.updateSymbol(symbol);\n    delete this._refreshing;\n  };\n\n  return TextBox;\n}(TextMarker);\n\nTextBox.mergeOptions(options$b);\nTextBox.registerJSONType('TextBox');\n\nvar options$c = {\n  'boxStyle': null,\n  textSymbol: null\n};\n\nvar Label = function (_TextMarker) {\n  _inheritsLoose(Label, _TextMarker);\n\n  function Label(content, coordinates, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _TextMarker.call(this, coordinates, options) || this;\n\n    if (options.textSymbol) {\n      _this.setTextSymbol(options.textSymbol);\n    }\n\n    if (options.boxStyle) {\n      _this.setBoxStyle(options.boxStyle);\n    }\n\n    _this._content = escapeSpecialChars(content);\n\n    _this._refresh();\n\n    return _this;\n  }\n\n  var _proto = Label.prototype;\n\n  _proto.getBoxStyle = function getBoxStyle() {\n    if (!this.options.boxStyle) {\n      return null;\n    }\n\n    return extend({}, this.options.boxStyle);\n  };\n\n  _proto.setBoxStyle = function setBoxStyle(style) {\n    this.options.boxStyle = style ? extend({}, style) : style;\n\n    this._refresh();\n\n    return this;\n  };\n\n  _proto.getTextSymbol = function getTextSymbol() {\n    return extend({}, this._getDefaultTextSymbol(), this.options.textSymbol);\n  };\n\n  _proto.setTextSymbol = function setTextSymbol(symbol) {\n    this.options.textSymbol = symbol ? extend({}, symbol) : symbol;\n\n    this._refresh();\n\n    return this;\n  };\n\n  Label.fromJSON = function fromJSON(json) {\n    var feature = json['feature'];\n    var label = new Label(json['content'], feature['geometry']['coordinates'], json['options']);\n    label.setProperties(feature['properties']);\n    label.setId(feature['id']);\n\n    if (json['symbol']) {\n      label.setSymbol(json['symbol']);\n    }\n\n    return label;\n  };\n\n  _proto._canEdit = function _canEdit() {\n    return false;\n  };\n\n  _proto._toJSON = function _toJSON(options) {\n    return {\n      'feature': this.toGeoJSON(options),\n      'subType': 'Label',\n      'content': this._content\n    };\n  };\n\n  _proto._refresh = function _refresh() {\n    var symbol = extend({}, this.getTextSymbol(), {\n      'textName': this._content\n    });\n    var boxStyle = this.getBoxStyle();\n\n    if (boxStyle) {\n      extend(symbol, boxStyle.symbol);\n\n      var sizes = this._getBoxSize(symbol),\n          textSize = sizes[1],\n          padding = boxStyle['padding'] || this._getDefaultPadding();\n\n      var boxSize = sizes[0];\n      symbol['markerWidth'] = boxSize['width'];\n      symbol['markerHeight'] = boxSize['height'];\n\n      var dx = symbol['textDx'] || 0,\n          dy = symbol['textDy'] || 0,\n          textAlignPoint = getAlignPoint(textSize, symbol['textHorizontalAlignment'], symbol['textVerticalAlignment'])._add(dx, dy);\n\n      var hAlign = boxStyle['horizontalAlignment'] || 'middle';\n      symbol['markerDx'] = textAlignPoint.x;\n\n      if (hAlign === 'left') {\n        symbol['markerDx'] += symbol['markerWidth'] / 2 - padding[0];\n      } else if (hAlign === 'right') {\n        symbol['markerDx'] -= symbol['markerWidth'] / 2 - textSize['width'] - padding[0];\n      } else {\n        symbol['markerDx'] += textSize['width'] / 2;\n      }\n\n      var vAlign = boxStyle['verticalAlignment'] || 'middle';\n      symbol['markerDy'] = textAlignPoint.y;\n\n      if (vAlign === 'top') {\n        symbol['markerDy'] += symbol['markerHeight'] / 2 - padding[1];\n      } else if (vAlign === 'bottom') {\n        symbol['markerDy'] -= symbol['markerHeight'] / 2 - textSize['height'] - padding[1] + 1;\n      } else {\n        symbol['markerDy'] += textSize['height'] / 2;\n      }\n    }\n\n    this._refreshing = true;\n    this.updateSymbol(symbol);\n    delete this._refreshing;\n  };\n\n  _proto._getBoxSize = function _getBoxSize(symbol) {\n    if (!symbol['markerType']) {\n      symbol['markerType'] = 'square';\n    }\n\n    var boxStyle = this.getBoxStyle();\n\n    var size = this._getTextSize(symbol);\n\n    var width, height;\n\n    var padding = boxStyle['padding'] || this._getDefaultPadding();\n\n    width = size['width'] + padding[0] * 2;\n    height = size['height'] + padding[1] * 2;\n\n    if (boxStyle['minWidth']) {\n      if (!width || width < boxStyle['minWidth']) {\n        width = boxStyle['minWidth'];\n      }\n    }\n\n    if (boxStyle['minHeight']) {\n      if (!height || height < boxStyle['minHeight']) {\n        height = boxStyle['minHeight'];\n      }\n    }\n\n    return [new Size(width, height), size];\n  };\n\n  return Label;\n}(TextMarker);\n\nLabel.mergeOptions(options$c);\nLabel.registerJSONType('Label');\n\nvar Connectable = function Connectable(Base) {\n  return function (_Base) {\n    _inheritsLoose(_class, _Base);\n\n    function _class() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    _class._hasConnectors = function _hasConnectors(geometry) {\n      return !isNil(geometry.__connectors) && geometry.__connectors.length > 0;\n    };\n\n    _class._getConnectors = function _getConnectors(geometry) {\n      return geometry.__connectors;\n    };\n\n    var _proto = _class.prototype;\n\n    _proto.getConnectSource = function getConnectSource() {\n      return this._connSource;\n    };\n\n    _proto.setConnectSource = function setConnectSource(src) {\n      var target = this._connTarget;\n      this.onRemove();\n      this._connSource = src;\n      this._connTarget = target;\n      this.onAdd();\n      return this;\n    };\n\n    _proto.getConnectTarget = function getConnectTarget() {\n      return this._connTarget;\n    };\n\n    _proto.setConnectTarget = function setConnectTarget(target) {\n      var src = this._connSource;\n      this.onRemove();\n      this._connSource = src;\n      this._connTarget = target;\n\n      this._updateCoordinates();\n\n      this._registerEvents();\n\n      return this;\n    };\n\n    _proto._updateCoordinates = function _updateCoordinates() {\n      var map = this.getMap();\n\n      if (!map && this._connSource) {\n        map = this._connSource.getMap();\n      }\n\n      if (!map && this._connTarget) {\n        map = this._connTarget.getMap();\n      }\n\n      if (!map) {\n        return;\n      }\n\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      var srcPoints = this._connSource._getConnectPoints();\n\n      var targetPoints = this._connTarget._getConnectPoints();\n\n      var minDist = 0;\n      var oldCoordinates = this.getCoordinates();\n      var c1, c2;\n\n      for (var i = 0, len = srcPoints.length; i < len; i++) {\n        var p1 = srcPoints[i];\n\n        for (var j = 0, length = targetPoints.length; j < length; j++) {\n          var p2 = targetPoints[j];\n          var dist = map.computeLength(p1, p2);\n\n          if (i === 0 && j === 0) {\n            c1 = p1;\n            c2 = p2;\n            minDist = dist;\n          } else if (dist < minDist) {\n            c1 = p1;\n            c2 = p2;\n          }\n        }\n      }\n\n      if (!isArrayHasData(oldCoordinates) || !oldCoordinates[0].equals(c1) || !oldCoordinates[1].equals(c2)) {\n        this.setCoordinates([c1, c2]);\n      }\n    };\n\n    _proto.onAdd = function onAdd() {\n      this._registerEvents();\n\n      this._updateCoordinates();\n    };\n\n    _proto.onRemove = function onRemove() {\n      if (this._connSource) {\n        if (this._connSource.__connectors) {\n          removeFromArray(this, this._connSource.__connectors);\n        }\n\n        this._connSource.off('dragging positionchange', this._updateCoordinates, this).off('remove', this.onRemove, this);\n\n        this._connSource.off('dragstart mousedown mouseover', this._showConnect, this);\n\n        this._connSource.off('dragend mouseup mouseout', this.hide, this);\n\n        this._connSource.off('show', this._showConnect, this).off('hide', this.hide, this);\n\n        delete this._connSource;\n      }\n\n      if (this._connTarget) {\n        removeFromArray(this, this._connTarget.__connectors);\n\n        this._connTarget.off('dragging positionchange', this._updateCoordinates, this).off('remove', this.onRemove, this);\n\n        this._connTarget.off('show', this._showConnect, this).off('hide', this.hide, this);\n\n        delete this._connTarget;\n      }\n\n      if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n        var map = this.getMap();\n\n        if (map) {\n          map.off('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n        }\n      }\n    };\n\n    _proto._showConnect = function _showConnect() {\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      if (this._connSource.isVisible() && this._connTarget.isVisible()) {\n        this._updateCoordinates();\n\n        this.show();\n      }\n    };\n\n    _proto._registerEvents = function _registerEvents() {\n      if (!this._connSource || !this._connTarget) {\n        return;\n      }\n\n      if (!this._connSource.__connectors) {\n        this._connSource.__connectors = [];\n      }\n\n      if (!this._connTarget.__connectors) {\n        this._connTarget.__connectors = [];\n      }\n\n      this._connSource.__connectors.push(this);\n\n      this._connTarget.__connectors.push(this);\n\n      this._connSource.on('dragging positionchange', this._updateCoordinates, this).on('remove', this.remove, this);\n\n      this._connTarget.on('dragging positionchange', this._updateCoordinates, this).on('remove', this.remove, this);\n\n      this._connSource.on('show', this._showConnect, this).on('hide', this.hide, this);\n\n      this._connTarget.on('show', this._showConnect, this).on('hide', this.hide, this);\n\n      var trigger = this.options['showOn'];\n      this.hide();\n\n      if (trigger === 'moving') {\n        this._connSource.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n\n        this._connTarget.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n      } else if (trigger === 'click') {\n        this._connSource.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n\n        this._connTarget.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n      } else if (trigger === 'mouseover') {\n        this._connSource.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n\n        this._connTarget.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n      } else {\n        this._showConnect();\n      }\n\n      if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n        var map = this.getMap();\n\n        if (map) {\n          map.on('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n        }\n      }\n    };\n\n    return _class;\n  }(Base);\n};\n\nvar options$d = {\n  showOn: 'always'\n};\n\nvar ConnectorLine = function (_Connectable) {\n  _inheritsLoose(ConnectorLine, _Connectable);\n\n  function ConnectorLine(src, target, options) {\n    var _this;\n\n    _this = _Connectable.call(this, null, options) || this;\n\n    if (arguments.length === 1) {\n      options = src;\n      src = null;\n      target = null;\n    }\n\n    _this._connSource = src;\n    _this._connTarget = target;\n    return _this;\n  }\n\n  return ConnectorLine;\n}(Connectable(LineString));\n\nConnectorLine.mergeOptions(options$d);\nConnectorLine.registerJSONType('ConnectorLine');\n\nvar ArcConnectorLine = function (_Connectable2) {\n  _inheritsLoose(ArcConnectorLine, _Connectable2);\n\n  function ArcConnectorLine(src, target, options) {\n    var _this2;\n\n    _this2 = _Connectable2.call(this, null, options) || this;\n\n    if (arguments.length === 1) {\n      options = src;\n      src = null;\n      target = null;\n    }\n\n    _this2._connSource = src;\n    _this2._connTarget = target;\n    return _this2;\n  }\n\n  return ArcConnectorLine;\n}(Connectable(ArcCurve));\n\nArcConnectorLine.mergeOptions(options$d);\nArcConnectorLine.registerJSONType('ArcConnectorLine');\n\nvar options$e = {\n  'drawImmediate': false\n};\nvar TEMP_EXTENT$3 = new PointExtent();\n\nvar OverlayLayer = function (_Layer) {\n  _inheritsLoose(OverlayLayer, _Layer);\n\n  function OverlayLayer(id, geometries, options) {\n    var _this;\n\n    if (geometries && !(geometries instanceof Geometry) && !Array.isArray(geometries) && GEOJSON_TYPES.indexOf(geometries.type) < 0) {\n      options = geometries;\n      geometries = null;\n    }\n\n    _this = _Layer.call(this, id, options) || this;\n    _this._maxZIndex = 0;\n    _this._minZIndex = 0;\n\n    _this._initCache();\n\n    if (geometries) {\n      _this.addGeometry(geometries);\n    }\n\n    var style = _this.options['style'];\n    delete _this.options['style'];\n\n    if (style) {\n      _this.setStyle(style);\n    }\n\n    return _this;\n  }\n\n  var _proto = OverlayLayer.prototype;\n\n  _proto.getGeometryById = function getGeometryById(id) {\n    if (isNil(id) || id === '') {\n      return null;\n    }\n\n    if (!this._geoMap[id]) {\n      return null;\n    }\n\n    return this._geoMap[id];\n  };\n\n  _proto.getGeometries = function getGeometries(filter, context) {\n    if (!filter) {\n      return this._geoList.slice(0);\n    }\n\n    var result = [];\n    var geometry, filtered;\n\n    for (var i = 0, l = this._geoList.length; i < l; i++) {\n      geometry = this._geoList[i];\n\n      if (context) {\n        filtered = filter.call(context, geometry);\n      } else {\n        filtered = filter(geometry);\n      }\n\n      if (filtered) {\n        result.push(geometry);\n      }\n    }\n\n    return result;\n  };\n\n  _proto.getFirstGeometry = function getFirstGeometry() {\n    if (!this._geoList.length) {\n      return null;\n    }\n\n    return this._geoList[0];\n  };\n\n  _proto.getLastGeometry = function getLastGeometry() {\n    var len = this._geoList.length;\n\n    if (len === 0) {\n      return null;\n    }\n\n    return this._geoList[len - 1];\n  };\n\n  _proto.getCount = function getCount() {\n    return this._geoList.length;\n  };\n\n  _proto.getExtent = function getExtent() {\n    if (this.getCount() === 0) {\n      return null;\n    }\n\n    var extent = new Extent(this.getProjection());\n    this.forEach(function (g) {\n      extent._combine(g.getExtent());\n    });\n    return extent;\n  };\n\n  _proto.forEach = function forEach(fn, context) {\n    var copyOnWrite = this._geoList.slice(0);\n\n    for (var i = 0, l = copyOnWrite.length; i < l; i++) {\n      if (!context) {\n        fn(copyOnWrite[i], i);\n      } else {\n        fn.call(context, copyOnWrite[i], i);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.filter = function filter(fn, context) {\n    var selected = [];\n    var isFn = isFunction(fn);\n    var filter = isFn ? fn : createFilter(fn);\n    this.forEach(function (geometry) {\n      var g = isFn ? geometry : getFilterFeature(geometry);\n\n      if (context ? filter.call(context, g) : filter(g)) {\n        selected.push(geometry);\n      }\n    }, this);\n    return selected;\n  };\n\n  _proto.isEmpty = function isEmpty$$1() {\n    return !this._geoList.length;\n  };\n\n  _proto.addGeometry = function addGeometry(geometries, fitView) {\n    if (!geometries) {\n      return this;\n    }\n\n    if (geometries.type === 'FeatureCollection') {\n      return this.addGeometry(GeoJSON.toGeometry(geometries), fitView);\n    } else if (!Array.isArray(geometries)) {\n      var count = arguments.length;\n      var last = arguments[count - 1];\n      geometries = Array.prototype.slice.call(arguments, 0, count - 1);\n      fitView = last;\n\n      if (last && isObject(last) && ('type' in last || last instanceof Geometry)) {\n        geometries.push(last);\n        fitView = false;\n      }\n\n      return this.addGeometry(geometries, fitView);\n    } else if (geometries.length === 0) {\n      return this;\n    }\n\n    this._initCache();\n\n    var extent;\n\n    if (fitView) {\n      extent = new Extent();\n    }\n\n    this._toSort = this._maxZIndex > 0;\n    var geos = [];\n\n    for (var i = 0, l = geometries.length; i < l; i++) {\n      var geo = geometries[i];\n\n      if (!geo) {\n        throw new Error('Invalid geometry to add to layer(' + this.getId() + ') at index:' + i);\n      }\n\n      if (!(geo instanceof Geometry)) {\n        geo = Geometry.fromJSON(geo);\n\n        if (Array.isArray(geo)) {\n          for (var ii = 0, ll = geo.length; ii < ll; ii++) {\n            this._add(geo[ii], extent, i);\n\n            geos.push(geo[ii]);\n          }\n        }\n      }\n\n      if (!Array.isArray(geo)) {\n        this._add(geo, extent, i);\n\n        geos.push(geo);\n      }\n    }\n\n    var map = this.getMap();\n\n    if (map) {\n      this._getRenderer().onGeometryAdd(geos);\n\n      if (extent && !isNil(extent.xmin)) {\n        var center = extent.getCenter();\n        var z = map.getFitZoom(extent);\n\n        if (isObject(fitView)) {\n          var step = isFunction(fitView.step) ? fitView.step : function () {\n            return undefined;\n          };\n          map.animateTo({\n            center: center,\n            zoom: z\n          }, extend({\n            duration: map.options.zoomAnimationDuration,\n            easing: 'out'\n          }, fitView), step);\n        } else if (fitView === true) {\n          map.setCenterAndZoom(center, z);\n        }\n      }\n    }\n\n    this.fire('addgeo', {\n      'geometries': geometries\n    });\n    return this;\n  };\n\n  _proto.getGeoMinZIndex = function getGeoMinZIndex() {\n    return this._minZIndex;\n  };\n\n  _proto.getGeoMaxZIndex = function getGeoMaxZIndex() {\n    return this._maxZIndex;\n  };\n\n  _proto._add = function _add(geo, extent, i) {\n    if (!this._toSort) {\n      this._toSort = geo.getZIndex() !== 0;\n    }\n\n    this._updateZIndex(geo.getZIndex());\n\n    var geoId = geo.getId();\n\n    if (!isNil(geoId)) {\n      if (!isNil(this._geoMap[geoId])) {\n        throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + geoId + ', at index:' + i);\n      }\n\n      this._geoMap[geoId] = geo;\n    }\n\n    var internalId = UID();\n\n    geo._setInternalId(internalId);\n\n    this._geoList.push(geo);\n\n    this.onAddGeometry(geo);\n\n    geo._bindLayer(this);\n\n    if (geo.onAdd) {\n      geo.onAdd();\n    }\n\n    if (extent) {\n      extent._combine(geo.getExtent());\n    }\n\n    geo._fireEvent('add', {\n      'layer': this\n    });\n  };\n\n  _proto.removeGeometry = function removeGeometry(geometries) {\n    if (!Array.isArray(geometries)) {\n      return this.removeGeometry([geometries]);\n    }\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      if (!(geometries[i] instanceof Geometry)) {\n        geometries[i] = this.getGeometryById(geometries[i]);\n      }\n\n      if (!geometries[i] || this !== geometries[i].getLayer()) continue;\n      geometries[i].remove();\n    }\n\n    this.fire('removegeo', {\n      'geometries': geometries\n    });\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this._clearing = true;\n    this.forEach(function (geo) {\n      geo.remove();\n    });\n    this._geoMap = {};\n    var old = this._geoList;\n    this._geoList = [];\n\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryRemove(old);\n    }\n\n    this._clearing = false;\n    this.fire('clear');\n    return this;\n  };\n\n  _proto.onRemoveGeometry = function onRemoveGeometry(geometry) {\n    if (!geometry || this._clearing) {\n      return;\n    }\n\n    if (this !== geometry.getLayer()) {\n      return;\n    }\n\n    var internalId = geometry._getInternalId();\n\n    if (isNil(internalId)) {\n      return;\n    }\n\n    var geoId = geometry.getId();\n\n    if (!isNil(geoId)) {\n      delete this._geoMap[geoId];\n    }\n\n    var idx = this._findInList(geometry);\n\n    if (idx >= 0) {\n      this._geoList.splice(idx, 1);\n    }\n\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryRemove([geometry]);\n    }\n  };\n\n  _proto.getStyle = function getStyle() {\n    if (!this._style) {\n      return null;\n    }\n\n    return this._style;\n  };\n\n  _proto.setStyle = function setStyle(style) {\n    this._style = style;\n    this._cookedStyles = compileStyle(style);\n    this.forEach(function (geometry) {\n      this._styleGeometry(geometry);\n    }, this);\n    this.fire('setstyle', {\n      'style': style\n    });\n    return this;\n  };\n\n  _proto._styleGeometry = function _styleGeometry(geometry) {\n    if (!this._cookedStyles) {\n      return false;\n    }\n\n    var g = getFilterFeature(geometry);\n\n    for (var i = 0, len = this._cookedStyles.length; i < len; i++) {\n      if (this._cookedStyles[i]['filter'](g) === true) {\n        geometry._setExternSymbol(this._cookedStyles[i]['symbol']);\n\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto.removeStyle = function removeStyle() {\n    if (!this._style) {\n      return this;\n    }\n\n    delete this._style;\n    delete this._cookedStyles;\n    this.forEach(function (geometry) {\n      geometry._setExternSymbol(null);\n    }, this);\n    this.fire('removestyle');\n    return this;\n  };\n\n  _proto.onAddGeometry = function onAddGeometry(geo) {\n    var style = this.getStyle();\n\n    if (style) {\n      this._styleGeometry(geo);\n    }\n  };\n\n  _proto.hide = function hide() {\n    for (var i = 0, l = this._geoList.length; i < l; i++) {\n      this._geoList[i].onHide();\n    }\n\n    return Layer.prototype.hide.call(this);\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!(coordinate instanceof Coordinate)) {\n      coordinate = new Coordinate(coordinate);\n    }\n\n    return this._hitGeos(this._geoList, coordinate, options);\n  };\n\n  _proto._hitGeos = function _hitGeos(geometries, coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var filter = options['filter'],\n        tolerance = options['tolerance'],\n        hits = [];\n    var map = this.getMap();\n    var point = map.coordToPoint(coordinate);\n\n    var cp = map._pointToContainerPoint(point, undefined, 0, point);\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      var geo = geometries[i];\n\n      if (!geo || !geo.isVisible() || !geo._getPainter() || !geo.options['interactive']) {\n        continue;\n      }\n\n      if (!(geo instanceof LineString) || !geo._getArrowStyle() && !(geo instanceof Curve)) {\n        var extent = geo.getContainerExtent(TEMP_EXTENT$3);\n\n        if (tolerance) {\n          extent = extent._expand(tolerance);\n        }\n\n        if (!extent || !extent.contains(cp)) {\n          continue;\n        }\n      }\n\n      if (geo._containsPoint(cp, tolerance) && (!filter || filter(geo))) {\n        hits.push(geo);\n\n        if (options['count']) {\n          if (hits.length >= options['count']) {\n            break;\n          }\n        }\n      }\n    }\n\n    return hits;\n  };\n\n  _proto._initCache = function _initCache() {\n    if (!this._geoList) {\n      this._geoList = [];\n      this._geoMap = {};\n    }\n  };\n\n  _proto._updateZIndex = function _updateZIndex() {\n    for (var _len = arguments.length, zIndex = new Array(_len), _key = 0; _key < _len; _key++) {\n      zIndex[_key] = arguments[_key];\n    }\n\n    this._maxZIndex = Math.max(this._maxZIndex, Math.max.apply(Math, zIndex));\n    this._minZIndex = Math.min(this._minZIndex, Math.min.apply(Math, zIndex));\n  };\n\n  _proto._sortGeometries = function _sortGeometries() {\n    var _this2 = this;\n\n    if (!this._toSort) {\n      return;\n    }\n\n    this._maxZIndex = 0;\n    this._minZIndex = 0;\n\n    this._geoList.sort(function (a, b) {\n      _this2._updateZIndex(a.getZIndex(), b.getZIndex());\n\n      return _this2._compare(a, b);\n    });\n\n    this._toSort = false;\n  };\n\n  _proto._compare = function _compare(a, b) {\n    if (a.getZIndex() === b.getZIndex()) {\n      return a._getInternalId() - b._getInternalId();\n    }\n\n    return a.getZIndex() - b.getZIndex();\n  };\n\n  _proto._findInList = function _findInList(geo) {\n    var len = this._geoList.length;\n\n    if (len === 0) {\n      return -1;\n    }\n\n    var low = 0,\n        high = len - 1,\n        middle;\n\n    while (low <= high) {\n      middle = Math.floor((low + high) / 2);\n\n      if (this._geoList[middle] === geo) {\n        return middle;\n      } else if (this._compare(this._geoList[middle], geo) > 0) {\n        high = middle - 1;\n      } else {\n        low = middle + 1;\n      }\n    }\n\n    return -1;\n  };\n\n  _proto._onGeometryEvent = function _onGeometryEvent(param) {\n    if (!param || !param['target']) {\n      return;\n    }\n\n    var type = param['type'];\n\n    if (type === 'idchange') {\n      this._onGeometryIdChange(param);\n    } else if (type === 'zindexchange') {\n      this._onGeometryZIndexChange(param);\n    } else if (type === 'positionchange') {\n      this._onGeometryPositionChange(param);\n    } else if (type === 'shapechange') {\n      this._onGeometryShapeChange(param);\n    } else if (type === 'symbolchange') {\n      this._onGeometrySymbolChange(param);\n    } else if (type === 'show') {\n      this._onGeometryShow(param);\n    } else if (type === 'hide') {\n      this._onGeometryHide(param);\n    } else if (type === 'propertieschange') {\n      this._onGeometryPropertiesChange(param);\n    }\n  };\n\n  _proto._onGeometryIdChange = function _onGeometryIdChange(param) {\n    if (param['new'] === param['old']) {\n      if (this._geoMap[param['old']] && this._geoMap[param['old']] === param['target']) {\n        return;\n      }\n    }\n\n    if (!isNil(param['new'])) {\n      if (this._geoMap[param['new']]) {\n        throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + param['new']);\n      }\n\n      this._geoMap[param['new']] = param['target'];\n    }\n\n    if (!isNil(param['old']) && param['new'] !== param['old']) {\n      delete this._geoMap[param['old']];\n    }\n  };\n\n  _proto._onGeometryZIndexChange = function _onGeometryZIndexChange(param) {\n    if (param['old'] !== param['new']) {\n      this._updateZIndex(param['new']);\n\n      this._toSort = true;\n\n      if (this._getRenderer()) {\n        this._getRenderer().onGeometryZIndexChange(param);\n      }\n    }\n  };\n\n  _proto._onGeometryPositionChange = function _onGeometryPositionChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryPositionChange(param);\n    }\n  };\n\n  _proto._onGeometryShapeChange = function _onGeometryShapeChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryShapeChange(param);\n    }\n  };\n\n  _proto._onGeometrySymbolChange = function _onGeometrySymbolChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometrySymbolChange(param);\n    }\n  };\n\n  _proto._onGeometryShow = function _onGeometryShow(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryShow(param);\n    }\n  };\n\n  _proto._onGeometryHide = function _onGeometryHide(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryHide(param);\n    }\n  };\n\n  _proto._onGeometryPropertiesChange = function _onGeometryPropertiesChange(param) {\n    if (this._getRenderer()) {\n      this._getRenderer().onGeometryPropertiesChange(param);\n    }\n  };\n\n  return OverlayLayer;\n}(Layer);\n\nOverlayLayer.mergeOptions(options$e);\n\nvar options$f = {\n  'debug': false,\n  'enableSimplify': true,\n  'geometryEvents': true,\n  'defaultIconSize': [20, 20],\n  'cacheVectorOnCanvas': true,\n  'cacheSvgOnCanvas': Browser$1.gecko,\n  'enableAltitude': false,\n  'altitudeProperty': 'altitude',\n  'drawAltitude': false\n};\n\nvar VectorLayer = function (_OverlayLayer) {\n  _inheritsLoose(VectorLayer, _OverlayLayer);\n\n  function VectorLayer(id, geometries, options) {\n    return _OverlayLayer.call(this, id, geometries, options) || this;\n  }\n\n  var _proto = VectorLayer.prototype;\n\n  _proto.onConfig = function onConfig(conf) {\n    _OverlayLayer.prototype.onConfig.call(this, conf);\n\n    if (conf['enableAltitude'] || conf['drawAltitude'] || conf['altitudeProperty']) {\n      var renderer = this.getRenderer();\n\n      if (renderer && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var renderer = this.getRenderer();\n\n    if (options['onlyVisible'] && renderer && renderer.identify) {\n      return renderer.identify(coordinate, options);\n    }\n\n    return _OverlayLayer.prototype.identify.call(this, coordinate, options);\n  };\n\n  _proto.toJSON = function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'options': this.config()\n    };\n\n    if ((isNil(options['style']) || options['style']) && this.getStyle()) {\n      profile['style'] = this.getStyle();\n    }\n\n    if (isNil(options['geometries']) || options['geometries']) {\n      var clipExtent;\n\n      if (options['clipExtent']) {\n        var map = this.getMap();\n        var projection = map ? map.getProjection() : null;\n        clipExtent = new Extent(options['clipExtent'], projection);\n      }\n\n      var geoJSONs = [];\n      var geometries = this.getGeometries();\n\n      for (var i = 0, len = geometries.length; i < len; i++) {\n        var geo = geometries[i];\n        var geoExt = geo.getExtent();\n\n        if (!geoExt || clipExtent && !clipExtent.intersects(geoExt)) {\n          continue;\n        }\n\n        var json = geo.toJSON(options['geometries']);\n        geoJSONs.push(json);\n      }\n\n      profile['geometries'] = geoJSONs;\n    }\n\n    return profile;\n  };\n\n  VectorLayer.fromJSON = function fromJSON(json) {\n    if (!json || json['type'] !== 'VectorLayer') {\n      return null;\n    }\n\n    var layer = new VectorLayer(json['id'], json['options']);\n    var geoJSONs = json['geometries'];\n    var geometries = [];\n\n    for (var i = 0; i < geoJSONs.length; i++) {\n      var geo = Geometry.fromJSON(geoJSONs[i]);\n\n      if (geo) {\n        geometries.push(geo);\n      }\n    }\n\n    layer.addGeometry(geometries);\n\n    if (json['style']) {\n      layer.setStyle(json['style']);\n    }\n\n    return layer;\n  };\n\n  return VectorLayer;\n}(OverlayLayer);\n\nVectorLayer.mergeOptions(options$f);\nVectorLayer.registerJSONType('VectorLayer');\n\nvar key = '_map_tool';\n\nvar MapTool = function (_Eventable) {\n  _inheritsLoose(MapTool, _Eventable);\n\n  function MapTool() {\n    return _Eventable.apply(this, arguments) || this;\n  }\n\n  var _proto = MapTool.prototype;\n\n  _proto.addTo = function addTo(map) {\n    if (!map) {\n      return this;\n    }\n\n    this._map = map;\n\n    if (map[key]) {\n      map[key].disable();\n    }\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.enable();\n    map[key] = this;\n\n    this._fireEvent('add');\n\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    return this._map;\n  };\n\n  _proto.enable = function enable() {\n    var map = this._map;\n\n    if (!map || this._enabled) {\n      return this;\n    }\n\n    this._enabled = true;\n\n    this._switchEvents('off');\n\n    this._registerEvents();\n\n    if (this.onEnable) {\n      this.onEnable();\n    }\n\n    this._fireEvent('enable');\n\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this._enabled || !this._map) {\n      return this;\n    }\n\n    this._enabled = false;\n\n    this._switchEvents('off');\n\n    if (this.onDisable) {\n      this.onDisable();\n    }\n\n    this._fireEvent('disable');\n\n    return this;\n  };\n\n  _proto.isEnabled = function isEnabled() {\n    if (!this._enabled) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.remove = function remove() {\n    if (!this._map) {\n      return this;\n    }\n\n    this.disable();\n\n    if (this._map) {\n      delete this._map[key];\n      delete this._map;\n    }\n\n    this._fireEvent('remove');\n\n    return this;\n  };\n\n  _proto._registerEvents = function _registerEvents() {\n    this._switchEvents('on');\n  };\n\n  _proto._switchEvents = function _switchEvents(to) {\n    var events = this.getEvents();\n\n    if (events) {\n      this._map[to](events, this);\n    }\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (!param) {\n      param = {};\n    }\n\n    this.fire(eventName, param);\n  };\n\n  return MapTool;\n}(Eventable(Class));\n\nvar options$g = {\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'polygonFill': '#fff',\n    'polygonOpacity': 0.3\n  },\n  'doubleClickZoom': false,\n  'mode': null,\n  'once': false,\n  'autoPanAtEdge': false,\n  'ignoreMouseleave': true\n};\nvar registeredMode = {};\n\nvar DrawTool = function (_MapTool) {\n  _inheritsLoose(DrawTool, _MapTool);\n\n  DrawTool.registerMode = function registerMode(name, modeAction) {\n    registeredMode[name.toLowerCase()] = modeAction;\n  };\n\n  DrawTool.getRegisterMode = function getRegisterMode(name) {\n    return registeredMode[name.toLowerCase()];\n  };\n\n  function DrawTool(options) {\n    var _this;\n\n    _this = _MapTool.call(this, options) || this;\n\n    _this._checkMode();\n\n    _this._events = {\n      'click': _this._clickHandler,\n      'mousemove': _this._mouseMoveHandler,\n      'dblclick': _this._doubleClickHandler,\n      'mousedown': _this._mouseDownHandler,\n      'mouseup': _this._mouseUpHandler\n    };\n    return _this;\n  }\n\n  var _proto = DrawTool.prototype;\n\n  _proto.getMode = function getMode() {\n    if (this.options['mode']) {\n      return this.options['mode'].toLowerCase();\n    }\n\n    return null;\n  };\n\n  _proto.setMode = function setMode(mode) {\n    if (this._geometry) {\n      this._geometry.remove();\n\n      delete this._geometry;\n    }\n\n    this._clearStage();\n\n    this._switchEvents('off');\n\n    this.options['mode'] = mode;\n\n    this._checkMode();\n\n    if (this.isEnabled()) {\n      this._switchEvents('on');\n\n      this._restoreMapCfg();\n\n      this._saveMapCfg();\n    }\n\n    return this;\n  };\n\n  _proto.getSymbol = function getSymbol() {\n    var symbol = this.options['symbol'];\n\n    if (symbol) {\n      return extendSymbol(symbol);\n    } else {\n      return extendSymbol(this.options['symbol']);\n    }\n  };\n\n  _proto.setSymbol = function setSymbol(symbol) {\n    if (!symbol) {\n      return this;\n    }\n\n    this.options['symbol'] = symbol;\n\n    if (this._geometry) {\n      this._geometry.setSymbol(symbol);\n    }\n\n    return this;\n  };\n\n  _proto.getCurrentGeometry = function getCurrentGeometry() {\n    return this._geometry;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this._checkMode();\n  };\n\n  _proto.onEnable = function onEnable() {\n    this._saveMapCfg();\n\n    this._drawToolLayer = this._getDrawLayer();\n\n    this._clearStage();\n\n    this._loadResources();\n\n    if (this.options['autoPanAtEdge']) {\n      var map = this.getMap();\n      this._mapAutoPanAtEdge = map.options['autoPanAtEdge'];\n\n      if (!this._mapAutoPanAtEdge) {\n        map.config({\n          autoPanAtEdge: true\n        });\n      }\n    }\n\n    return this;\n  };\n\n  _proto.onDisable = function onDisable() {\n    var map = this.getMap();\n\n    this._restoreMapCfg();\n\n    this.endDraw();\n\n    if (this._map) {\n      map.removeLayer(this._getDrawLayer());\n\n      if (this.options['autoPanAtEdge']) {\n        if (!this._mapAutoPanAtEdge) {\n          map.config({\n            autoPanAtEdge: false\n          });\n        }\n      }\n    }\n\n    return this;\n  };\n\n  _proto.undo = function undo() {\n    var registerMode = this._getRegisterMode();\n\n    var action = registerMode.action;\n\n    if (!this._shouldRecordHistory(action) || !this._historyPointer) {\n      return this;\n    }\n\n    var coords = this._clickCoords.slice(0, --this._historyPointer);\n\n    registerMode.update(this.getMap().getProjection(), coords, this._geometry);\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    var registerMode = this._getRegisterMode();\n\n    var action = registerMode.action;\n\n    if (!this._shouldRecordHistory(action) || isNil(this._historyPointer) || this._historyPointer === this._clickCoords.length) {\n      return this;\n    }\n\n    var coords = this._clickCoords.slice(0, ++this._historyPointer);\n\n    registerMode.update(this.getMap().getProjection(), coords, this._geometry);\n    return this;\n  };\n\n  _proto._shouldRecordHistory = function _shouldRecordHistory(actions) {\n    return Array.isArray(actions) && actions[0] === 'click' && actions[1] === 'mousemove' && actions[2] === 'dblclick';\n  };\n\n  _proto._checkMode = function _checkMode() {\n    this._getRegisterMode();\n  };\n\n  _proto._saveMapCfg = function _saveMapCfg() {\n    var map = this.getMap();\n    this._mapDoubleClickZoom = map.options['doubleClickZoom'];\n    map.config({\n      'doubleClickZoom': this.options['doubleClickZoom']\n    });\n\n    var actions = this._getRegisterMode()['action'];\n\n    if (actions.indexOf('mousedown') > -1) {\n      var _map = this.getMap();\n\n      this._mapDraggable = _map.options['draggable'];\n\n      _map.config({\n        'draggable': false\n      });\n    }\n  };\n\n  _proto._restoreMapCfg = function _restoreMapCfg() {\n    var map = this.getMap();\n    map.config({\n      'doubleClickZoom': this._mapDoubleClickZoom\n    });\n\n    if (!isNil(this._mapDraggable)) {\n      map.config('draggable', this._mapDraggable);\n    }\n\n    delete this._mapDraggable;\n    delete this._mapDoubleClickZoom;\n  };\n\n  _proto._loadResources = function _loadResources() {\n    var symbol = this.getSymbol();\n    var resources = getExternalResources(symbol);\n\n    if (resources.length > 0) {\n      this._drawToolLayer._getRenderer().loadResources(resources);\n    }\n  };\n\n  _proto._getProjection = function _getProjection() {\n    return this._map.getProjection();\n  };\n\n  _proto._getRegisterMode = function _getRegisterMode() {\n    var mode = this.getMode();\n    var registerMode = DrawTool.getRegisterMode(mode);\n\n    if (!registerMode) {\n      throw new Error(mode + ' is not a valid mode of DrawTool.');\n    }\n\n    return registerMode;\n  };\n\n  _proto.getEvents = function getEvents() {\n    var action = this._getRegisterMode()['action'];\n\n    var _events = {};\n\n    if (Array.isArray(action)) {\n      for (var i = 0; i < action.length; i++) {\n        _events[action[i]] = this._events[action[i]];\n      }\n\n      return _events;\n    }\n\n    return null;\n  };\n\n  _proto._mouseDownHandler = function _mouseDownHandler(event) {\n    this._createGeometry(event);\n  };\n\n  _proto._mouseUpHandler = function _mouseUpHandler(event) {\n    this.endDraw(event);\n  };\n\n  _proto._clickHandler = function _clickHandler(event) {\n    var registerMode = this._getRegisterMode();\n\n    if (!this._geometry) {\n      this._createGeometry(event);\n    } else {\n      var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n      if (!isNil(this._historyPointer)) {\n        this._clickCoords = this._clickCoords.slice(0, this._historyPointer);\n      }\n\n      this._clickCoords.push(prjCoord);\n\n      this._historyPointer = this._clickCoords.length;\n      event.drawTool = this;\n      registerMode['update'](this.getMap().getProjection(), this._clickCoords, this._geometry, event);\n\n      this._fireEvent('drawvertex', event);\n\n      if (registerMode['clickLimit'] && registerMode['clickLimit'] === this._historyPointer) {\n        this.endDraw(event);\n      }\n    }\n  };\n\n  _proto._createGeometry = function _createGeometry(event) {\n    var mode = this.getMode();\n\n    var registerMode = this._getRegisterMode();\n\n    var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n    var symbol = this.getSymbol();\n\n    if (!this._geometry) {\n      this._clickCoords = [prjCoord];\n      event.drawTool = this;\n      this._geometry = registerMode['create'](this.getMap().getProjection(), this._clickCoords, event);\n\n      if (symbol && mode !== 'point') {\n        this._geometry.setSymbol(symbol);\n      } else if (this.options.hasOwnProperty('symbol')) {\n        this._geometry.setSymbol(this.options['symbol']);\n      }\n\n      this._addGeometryToStage(this._geometry);\n\n      this._fireEvent('drawstart', event);\n    }\n\n    if (mode === 'point') {\n      this.endDraw(event);\n    }\n  };\n\n  _proto._mouseMoveHandler = function _mouseMoveHandler(event) {\n    var map = this.getMap();\n\n    if (!this._geometry || !map || map.isInteracting()) {\n      return;\n    }\n\n    var containerPoint = this._getMouseContainerPoint(event);\n\n    if (!this._isValidContainerPoint(containerPoint)) {\n      return;\n    }\n\n    var prjCoord = this.getMap()._pointToPrj(event['point2d']);\n\n    var projection = map.getProjection();\n    event.drawTool = this;\n\n    var registerMode = this._getRegisterMode();\n\n    if (this._shouldRecordHistory(registerMode.action)) {\n      var path = this._clickCoords.slice(0, this._historyPointer);\n\n      if (path && path.length > 0 && prjCoord.equals(path[path.length - 1])) {\n        return;\n      }\n\n      registerMode['update'](projection, path.concat([prjCoord]), this._geometry, event);\n    } else {\n      registerMode['update'](projection, prjCoord, this._geometry, event);\n    }\n\n    this._fireEvent('mousemove', event);\n  };\n\n  _proto._doubleClickHandler = function _doubleClickHandler(event) {\n    if (!this._geometry) {\n      return;\n    }\n\n    var containerPoint = this._getMouseContainerPoint(event);\n\n    if (!this._isValidContainerPoint(containerPoint)) {\n      return;\n    }\n\n    var registerMode = this._getRegisterMode();\n\n    var clickCoords = this._clickCoords;\n\n    if (clickCoords.length < 2) {\n      return;\n    }\n\n    var projection = this.getMap().getProjection();\n    var path = [clickCoords[0]];\n\n    for (var i = 1, len = clickCoords.length; i < len; i++) {\n      if (clickCoords[i].x !== clickCoords[i - 1].x || clickCoords[i].y !== clickCoords[i - 1].y) {\n        path.push(clickCoords[i]);\n      }\n    }\n\n    if (path.length < 2 || this._geometry && this._geometry instanceof Polygon && path.length < 3) {\n      return;\n    }\n\n    event.drawTool = this;\n    registerMode['update'](projection, path, this._geometry, event);\n    this.endDraw(event);\n  };\n\n  _proto._addGeometryToStage = function _addGeometryToStage(geometry) {\n    var drawLayer = this._getDrawLayer();\n\n    drawLayer.addGeometry(geometry);\n  };\n\n  _proto.endDraw = function endDraw(param) {\n    if (!this._geometry || this._ending) {\n      return this;\n    }\n\n    this._ending = true;\n    var geometry = this._geometry;\n\n    this._clearStage();\n\n    param = param || {};\n    this._geometry = geometry;\n\n    this._fireEvent('drawend', param);\n\n    delete this._geometry;\n\n    if (this.options['once']) {\n      this.disable();\n    }\n\n    delete this._ending;\n    return this;\n  };\n\n  _proto._clearStage = function _clearStage() {\n    this._getDrawLayer().clear();\n\n    delete this._geometry;\n    delete this._clickCoords;\n  };\n\n  _proto._getMouseContainerPoint = function _getMouseContainerPoint(event) {\n    var action = this._getRegisterMode()['action'];\n\n    if (action === 'mousedown') {\n      stopPropagation(event['domEvent']);\n    }\n\n    return event['containerPoint'];\n  };\n\n  _proto._isValidContainerPoint = function _isValidContainerPoint(containerPoint) {\n    var mapSize = this._map.getSize();\n\n    var w = mapSize['width'],\n        h = mapSize['height'];\n\n    if (containerPoint.x < 0 || containerPoint.y < 0) {\n      return false;\n    } else if (containerPoint.x > w || containerPoint.y > h) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto._getDrawLayer = function _getDrawLayer() {\n    var drawLayerId = INTERNAL_LAYER_PREFIX + 'drawtool';\n\n    var drawToolLayer = this._map.getLayer(drawLayerId);\n\n    if (!drawToolLayer) {\n      drawToolLayer = new VectorLayer(drawLayerId, {\n        'enableSimplify': false\n      });\n\n      this._map.addLayer(drawToolLayer);\n    }\n\n    return drawToolLayer;\n  };\n\n  _proto._fireEvent = function _fireEvent(eventName, param) {\n    if (!param) {\n      param = {};\n    }\n\n    if (this._geometry) {\n      param['geometry'] = this._getRegisterMode()['generate'](this._geometry, {\n        drawTool: this\n      });\n    }\n\n    MapTool.prototype._fireEvent.call(this, eventName, param);\n  };\n\n  return DrawTool;\n}(MapTool);\n\nDrawTool.mergeOptions(options$g);\n\nvar MapBoxZoomHander = function (_Handler) {\n  _inheritsLoose(MapBoxZoomHander, _Handler);\n\n  function MapBoxZoomHander(target) {\n    var _this;\n\n    _this = _Handler.call(this, target) || this;\n    _this.drawTool = new DrawTool({\n      'mode': 'boxZoom',\n      'ignoreMouseleave': false\n    });\n    return _this;\n  }\n\n  var _proto = MapBoxZoomHander.prototype;\n\n  _proto.addHooks = function addHooks() {\n    this.target.on('_mousedown', this._onMouseDown, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this.target.off('_mousedown', this._onMouseDown, this);\n\n    if (this.drawTool.isEnabled()) {\n      this.drawTool.remove();\n    }\n  };\n\n  _proto._onMouseDown = function _onMouseDown(param) {\n    if (!this.target.options['boxZoom']) {\n      return;\n    }\n\n    if (param.domEvent.shiftKey) {\n      this.drawTool.setSymbol(this.target.options['boxZoomSymbol']).on('drawend', this._boxZoom, this).addTo(this.target);\n    }\n  };\n\n  _proto._boxZoom = function _boxZoom(param) {\n    var map = this.target;\n    this.drawTool.remove();\n    var geometry = param.geometry,\n        center = geometry.getCenter(),\n        symbol = geometry.getSymbol(),\n        w = symbol.markerWidth,\n        h = symbol.markerHeight;\n    var extent = new Extent(center, map.locateByPoint(center, w, h), map.getProjection());\n    var zoom = map.getFitZoom(extent);\n\n    map._animateTo({\n      center: extent.getCenter(),\n      zoom: zoom\n    });\n  };\n\n  return MapBoxZoomHander;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'boxZoom': true,\n  'boxZoomSymbol': {\n    'markerType': 'rectangle',\n    'markerLineWidth': 3,\n    'markerLineColor': '#1bbc9b',\n    'markerLineDasharray': [10, 5],\n    'markerFillOpacity': 0.1,\n    'markerFill': '#1bbc9b',\n    'markerWidth': 1,\n    'markerHeight': 1\n  }\n});\nMap$1.addOnLoadHook('addHandler', 'boxZoom', MapBoxZoomHander);\n\nvar PANOFFSET = 30;\n\nvar MapAutoPanAtEdgeHandler = function (_Handler) {\n  _inheritsLoose(MapAutoPanAtEdgeHandler, _Handler);\n\n  function MapAutoPanAtEdgeHandler() {\n    return _Handler.apply(this, arguments) || this;\n  }\n\n  var _proto = MapAutoPanAtEdgeHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.on('_mousemove', this._onMouseMove, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    if (!this.target) {\n      return;\n    }\n\n    this.target.off('_mousemove', this._onMouseMove, this);\n  };\n\n  _proto._onMouseMove = function _onMouseMove(event) {\n    var map = this.target;\n\n    if (map.options['autoPanAtEdge']) {\n      var containerPoint = event.containerPoint;\n      var containerExtent = map.getContainerExtent();\n\n      if (containerExtent) {\n        var x = containerPoint.x,\n            y = containerPoint.y;\n        var xmax = containerExtent.xmax,\n            ymax = containerExtent.ymax;\n        var p;\n\n        if (x < PANOFFSET) {\n          p = [Math.abs(x - PANOFFSET), 0];\n        }\n\n        if (y < PANOFFSET) {\n          p = [0, Math.abs(y - PANOFFSET)];\n        }\n\n        if (x + PANOFFSET > xmax) {\n          p = [-Math.abs(x + PANOFFSET - xmax), 0];\n        }\n\n        if (y + PANOFFSET > ymax) {\n          p = [0, -Math.abs(y + PANOFFSET - ymax)];\n        }\n\n        if (p) {\n          map.panBy(p, {\n            duration: 1\n          });\n        }\n      }\n    }\n  };\n\n  return MapAutoPanAtEdgeHandler;\n}(Handler$1);\n\nMap$1.mergeOptions({\n  'autoPanAtEdge': false\n});\nMap$1.addOnLoadHook('addHandler', 'autoPanAtEdge', MapAutoPanAtEdgeHandler);\n\nMap$1.include({\n  animateTo: function animateTo(view, options, step) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    var projection = this.getProjection(),\n        currView = this.getView(),\n        props = {};\n    var empty = true;\n\n    for (var p in view) {\n      if (hasOwn(view, p) && !isNil(view[p]) && (p === 'prjCenter' || !isNil(currView[p]))) {\n        empty = false;\n\n        if (p === 'center') {\n          var from = new Coordinate(currView[p]).toFixed(7),\n              to = new Coordinate(view[p]).toFixed(7);\n\n          if (!from.equals(to)) {\n            props['center'] = [from, to];\n          }\n        } else if (p === 'prjCenter') {\n          var _from = new Coordinate(this._getPrjCenter());\n\n          var _to = new Coordinate(view[p]);\n\n          if (!_from.equals(_to)) {\n            props['prjCenter'] = [_from, _to];\n          }\n        } else if (currView[p] !== view[p] && p !== 'around') {\n          props[p] = [currView[p], view[p]];\n        }\n      }\n    }\n\n    if (empty) {\n      return null;\n    }\n\n    if (this._animPlayer) {\n      if (this._isInternalAnimation) {\n        if (this._animPlayer.playState === 'running') {\n          this._animPlayer.pause();\n\n          this._prevAnimPlayer = this._animPlayer;\n        }\n      } else {\n        delete this._prevAnimPlayer;\n\n        this._stopAnim(this._animPlayer);\n      }\n    }\n\n    var zoomOrigin = view['around'] || new Point(this.width / 2, this.height / 2);\n\n    var renderer = this._getRenderer(),\n        framer = function framer(fn) {\n      renderer.callInNextFrame(fn);\n    };\n\n    var player = this._animPlayer = Animation.animate(props, {\n      'easing': options['easing'] || 'out',\n      'duration': options['duration'] || this.options['zoomAnimationDuration'],\n      'framer': framer\n    }, function (frame) {\n      if (_this.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      if (player.playState === 'running') {\n        if (frame.styles['center']) {\n          var center = frame.styles['center'];\n\n          _this._setPrjCenter(projection.project(center));\n\n          _this.onMoving(_this._parseEventFromCoord(_this.getCenter()));\n        } else if (frame.styles['prjCenter']) {\n          var _center = frame.styles['prjCenter'];\n\n          _this._setPrjCenter(_center);\n\n          _this.onMoving(_this._parseEventFromCoord(_this.getCenter()));\n        }\n\n        if (!isNil(frame.styles['zoom'])) {\n          _this.onZooming(frame.styles['zoom'], zoomOrigin);\n        }\n\n        if (!isNil(frame.styles['pitch'])) {\n          _this.setPitch(frame.styles['pitch']);\n        }\n\n        if (!isNil(frame.styles['bearing'])) {\n          _this.setBearing(frame.styles['bearing']);\n        }\n\n        _this._fireEvent('animating');\n      } else if (player.playState !== 'paused' || player === _this._mapAnimPlayer) {\n        if (!player._interupted) {\n          if (props['center']) {\n            _this._setPrjCenter(projection.project(props['center'][1]));\n          } else if (props['prjCenter']) {\n            _this._setPrjCenter(props['prjCenter'][1]);\n          }\n\n          if (!isNil(props['pitch'])) {\n            _this.setPitch(props['pitch'][1]);\n          }\n\n          if (!isNil(props['bearing'])) {\n            _this.setBearing(props['bearing'][1]);\n          }\n        }\n\n        _this._endAnim(player, props, zoomOrigin, options);\n      }\n\n      if (step) {\n        step(frame);\n      }\n    }, this);\n\n    this._startAnim(props, zoomOrigin);\n\n    return player;\n  },\n  _animateTo: function _animateTo(view, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    this._isInternalAnimation = true;\n    this._mapAnimPlayer = this.animateTo(view, options, step);\n    delete this._isInternalAnimation;\n    return this._mapAnimPlayer;\n  },\n  isAnimating: function isAnimating() {\n    return !!this._animPlayer;\n  },\n  isRotating: function isRotating() {\n    return this.isDragRotating() || !!this._animRotating;\n  },\n  _endAnim: function _endAnim(player, props, zoomOrigin, options) {\n    delete this._animRotating;\n    var evtType = player._interupted ? 'animateinterrupted' : 'animateend';\n\n    if (player === this._animPlayer) {\n      delete this._animPlayer;\n    }\n\n    if (player === this._mapAnimPlayer) {\n      delete this._mapAnimPlayer;\n    }\n\n    if (props['center']) {\n      var endCoord;\n\n      if (player._interupted) {\n        endCoord = this.getCenter();\n      } else {\n        endCoord = props['center'][1];\n      }\n\n      this.onMoveEnd(this._parseEventFromCoord(endCoord));\n    } else if (props['prjCenter']) {\n      var _endCoord;\n\n      if (player._interupted) {\n        _endCoord = this._getPrjCenter();\n      } else {\n        _endCoord = props['prjCenter'][1];\n      }\n\n      var event = this._parseEventFromCoord(this.getProjection().unproject(_endCoord));\n\n      event['point2d'] = this._prjToPoint(_endCoord);\n      this.onMoveEnd(event);\n    }\n\n    if (!isNil(props['zoom'])) {\n      if (player._interupted) {\n        this.onZoomEnd(this.getZoom(), zoomOrigin);\n      } else if (!options['wheelZoom']) {\n        this.onZoomEnd(props['zoom'][1], zoomOrigin);\n      } else {\n        this.onZooming(props['zoom'][1], zoomOrigin);\n      }\n    }\n\n    if (evtType) {\n      this._fireEvent(evtType);\n    }\n\n    if (!isNil(props['pitch']) && !this.getPitch()) {\n      this.getRenderer().setToRedraw();\n    }\n\n    this._resumePrev(player);\n  },\n  _startAnim: function _startAnim(props, zoomOrigin) {\n    if (!this._animPlayer) {\n      return;\n    }\n\n    if (props['center']) {\n      this.onMoveStart();\n    }\n\n    if (props['zoom'] && !this.isZooming()) {\n      this.onZoomStart(props['zoom'][1], zoomOrigin);\n    }\n\n    if (props['pitch'] || props['bearing']) {\n      this._animRotating = true;\n    }\n\n    this._fireEvent('animatestart');\n\n    this._animPlayer.play();\n  },\n  _stopAnim: function _stopAnim(player) {\n    if (!player) {\n      return;\n    }\n\n    delete this._animRotating;\n\n    if (player.playState !== 'finished') {\n      player._interupted = true;\n      player.cancel();\n    }\n\n    if (player === this._animPlayer) {\n      delete this._animPlayer;\n    }\n\n    if (player === this._mapAnimPlayer) {\n      delete this._mapAnimPlayer;\n    }\n  },\n  _resumePrev: function _resumePrev(player) {\n    if (!this._prevAnimPlayer) {\n      return;\n    }\n\n    var prevPlayer = this._prevAnimPlayer;\n\n    if (prevPlayer.playState !== 'paused') {\n      delete this._prevAnimPlayer;\n    }\n\n    if (player !== prevPlayer) {\n      this._animPlayer = prevPlayer;\n      prevPlayer.play();\n    }\n  }\n});\n\nvar events = 'mousedown ' + 'mouseup ' + 'mouseover ' + 'mouseout ' + 'mouseenter ' + 'mouseleave ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'keypress ' + 'touchstart ' + 'touchmove ' + 'touchend ';\nMap$1.include({\n  _registerDomEvents: function _registerDomEvents() {\n    var dom = this._panels.mapWrapper || this._containerDOM;\n    addDomEvent(dom, events, this._handleDOMEvent, this);\n  },\n  _removeDomEvents: function _removeDomEvents() {\n    var dom = this._panels.mapWrapper || this._containerDOM;\n    removeDomEvent(dom, events, this._handleDOMEvent, this);\n  },\n  _handleDOMEvent: function _handleDOMEvent(e) {\n    var type = e.type;\n\n    if (type === 'contextmenu') {\n      preventDefault(e);\n    }\n\n    if (this._ignoreEvent(e)) {\n      return;\n    }\n\n    var mimicClick = false;\n\n    if (type === 'mousedown' || type === 'touchstart' && e.touches.length === 1) {\n      this._mouseDownTime = now();\n    } else if (type === 'click' || type === 'touchend' || type === 'contextmenu') {\n      if (!this._mouseDownTime) {\n        return;\n      } else {\n        var downTime = this._mouseDownTime;\n        delete this._mouseDownTime;\n        var time = now();\n\n        if (time - downTime > 300) {\n          if (type === 'click' || type === 'contextmenu') {\n            return;\n          }\n        } else if (type === 'touchend') {\n          mimicClick = true;\n        }\n      }\n    }\n\n    this._fireDOMEvent(this, e, type);\n\n    if (mimicClick) {\n      if (this._clickTime && now() - this._clickTime <= 300) {\n        delete this._clickTime;\n\n        this._fireDOMEvent(this, e, 'dblclick');\n      } else {\n        this._clickTime = now();\n\n        this._fireDOMEvent(this, e, 'click');\n      }\n    }\n  },\n  _ignoreEvent: function _ignoreEvent(domEvent) {\n    if (!domEvent || !this._panels.control) {\n      return false;\n    }\n\n    if (this._isEventOutMap(domEvent)) {\n      return true;\n    }\n\n    var target = domEvent.srcElement || domEvent.target;\n    var preTarget;\n\n    if (target) {\n      while (target && target !== this._containerDOM) {\n        if (target.className && target.className.indexOf && (target.className.indexOf('maptalks-control') >= 0 || target.className.indexOf('maptalks-ui') >= 0 && !preTarget['eventsPropagation'])) {\n          return true;\n        }\n\n        preTarget = target;\n        target = target.parentNode;\n      }\n    }\n\n    return false;\n  },\n  _isEventOutMap: function _isEventOutMap(domEvent) {\n    if (this.getPitch() > this.options['maxVisualPitch']) {\n      var actualEvent = this._getActualEvent(domEvent);\n\n      var eventPos = getEventContainerPoint(actualEvent, this._containerDOM);\n\n      if (!this.getContainerExtent().contains(eventPos)) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n  _parseEvent: function _parseEvent(e, type) {\n    if (!e) {\n      return null;\n    }\n\n    var eventParam = {\n      'domEvent': e\n    };\n\n    if (type !== 'keypress') {\n      var actual = this._getActualEvent(e);\n\n      if (actual) {\n        var containerPoint = getEventContainerPoint(actual, this._containerDOM);\n        eventParam = extend(eventParam, {\n          'coordinate': this.containerPointToCoord(containerPoint),\n          'containerPoint': containerPoint,\n          'viewPoint': this.containerPointToViewPoint(containerPoint),\n          'point2d': this._containerPointToPoint(containerPoint)\n        });\n      }\n    }\n\n    return eventParam;\n  },\n  _parseEventFromCoord: function _parseEventFromCoord(coord) {\n    var containerPoint = this.coordToContainerPoint(coord),\n        viewPoint = this.containerPointToViewPoint(containerPoint);\n    var e = {\n      'coordinate': coord,\n      'containerPoint': containerPoint,\n      'viewPoint': viewPoint,\n      'point2d': this.coordToPoint(coord)\n    };\n    return e;\n  },\n  _getActualEvent: function _getActualEvent(e) {\n    return e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n  },\n  _fireDOMEvent: function _fireDOMEvent(target, e, type) {\n    if (this.isRemoved()) {\n      return;\n    }\n\n    var eventParam = this._parseEvent(e, type);\n\n    this._fireEvent(type, eventParam);\n  }\n});\nMap$1.addOnLoadHook('_registerDomEvents');\n\nMap$1.include({\n  isFullScreen: function isFullScreen() {\n    return !!(document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement || document.fullscreenElement);\n  },\n  requestFullScreen: function requestFullScreen(dom) {\n    this._fireEvent('fullscreenstart');\n\n    this._requestFullScreen(dom || this._containerDOM);\n\n    this._fireEvent('fullscreenend');\n\n    return this;\n  },\n  cancelFullScreen: function cancelFullScreen() {\n    this._cancelFullScreen();\n\n    this._fireEvent('cancelfullscreen');\n\n    return this;\n  },\n  _requestFullScreen: function _requestFullScreen(dom) {\n    if (dom.requestFullScreen) {\n      dom.requestFullScreen();\n    } else if (dom.mozRequestFullScreen) {\n      dom.mozRequestFullScreen();\n    } else if (dom.webkitRequestFullScreen) {\n      dom.webkitRequestFullScreen();\n    } else if (dom.msRequestFullScreen) {\n      dom.msRequestFullScreen();\n    } else {\n      var features = 'fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,' + 'titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,' + 'width=' + (screen.availWidth - 8) + ',height=' + (screen.availHeight - 45);\n      var newWin = window.open(location.href, '_blank', features);\n\n      if (newWin !== null) {\n        window.opener = null;\n        window.close();\n      }\n    }\n  },\n  _cancelFullScreen: function _cancelFullScreen() {\n    if (document.cancelFullScreen) {\n      document.cancelFullScreen();\n    } else if (document.mozCancelFullScreen) {\n      document.mozCancelFullScreen();\n    } else if (document.webkitCancelFullScreen) {\n      document.webkitCancelFullScreen();\n    } else {\n      var features = 'fullscreen=no,status=yes,resizable=yes,scrollbars=no,' + 'titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes';\n      var newWin = window.open(location.href, '_blank', features);\n\n      if (newWin !== null) {\n        window.opener = null;\n        window.close();\n      }\n    }\n  }\n});\n\nMap$1.include({\n  panTo: function panTo(coordinate, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!coordinate) {\n      return this;\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    coordinate = new Coordinate(coordinate);\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      var prjCoord = this.getProjection().project(coordinate);\n      return this._panAnimation(prjCoord, options['duration'], step);\n    } else {\n      this.setCenter(coordinate);\n    }\n\n    return this;\n  },\n  _panTo: function _panTo(prjCoord, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      return this._panAnimation(prjCoord, options['duration']);\n    } else {\n      this.onMoveStart();\n\n      this._setPrjCenter(prjCoord);\n\n      this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n      return this;\n    }\n  },\n  panBy: function panBy(offset, options, step) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!offset) {\n      return this;\n    }\n\n    if (isFunction(options)) {\n      step = options;\n      options = {};\n    }\n\n    offset = new Point(offset);\n    var containerExtent = this.getContainerExtent();\n    var ymin = containerExtent.ymin;\n\n    if (ymin > 0 && offset.y > 30) {\n      var y = offset.y;\n      offset.y = 30;\n      offset.x = offset.x * 30 / y;\n      console.warn('offset is limited to panBy when pitch is above maxPitch');\n    }\n\n    this.onMoveStart();\n\n    if (typeof options['animation'] === 'undefined' || options['animation']) {\n      offset = offset.multi(-1);\n\n      var target = this._containerPointToPrj(new Point(this.width / 2 + offset.x, this.height / 2 + offset.y));\n\n      this._panAnimation(target, options['duration'], step);\n    } else {\n      this._offsetCenterByPixel(offset);\n\n      this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n    }\n\n    return this;\n  },\n  _panAnimation: function _panAnimation(target, t, cb) {\n    return this._animateTo({\n      'prjCenter': target\n    }, {\n      'duration': t || this.options['panAnimationDuration']\n    }, cb);\n  }\n});\n\nGeometry.fromJSON = function (json) {\n  if (Array.isArray(json)) {\n    var result = [];\n\n    for (var i = 0, len = json.length; i < len; i++) {\n      var c = Geometry.fromJSON(json[i]);\n\n      if (Array.isArray(json)) {\n        result = result.concat(c);\n      } else {\n        result.push(c);\n      }\n    }\n\n    return result;\n  }\n\n  if (json && !json['feature']) {\n    return GeoJSON.toGeometry(json);\n  }\n\n  var geometry;\n\n  if (json['subType']) {\n    geometry = Geometry.getJSONClass(json['subType']).fromJSON(json);\n\n    if (!isNil(json['feature']['id'])) {\n      geometry.setId(json['feature']['id']);\n    }\n  } else {\n    geometry = GeoJSON.toGeometry(json['feature']);\n\n    if (json['options']) {\n      geometry.config(json['options']);\n    }\n  }\n\n  if (json['symbol']) {\n    geometry.setSymbol(json['symbol']);\n  }\n\n  if (json['infoWindow']) {\n    geometry.setInfoWindow(json['infoWindow']);\n  }\n\n  return geometry;\n};\n\nLayer.fromJSON = function (layerJSON) {\n  if (!layerJSON) {\n    return null;\n  }\n\n  var layerType = layerJSON['type'];\n  var clazz = Layer.getJSONClass(layerType);\n\n  if (!clazz || !clazz.fromJSON) {\n    throw new Error('unsupported layer type:' + layerType);\n  }\n\n  return clazz.fromJSON(layerJSON);\n};\n\nMap$1.include({\n  'JSON_VERSION': '1.0',\n  toJSON: function toJSON(options) {\n    if (!options) {\n      options = {};\n    }\n\n    var json = {\n      'jsonVersion': this['JSON_VERSION'],\n      'version': this.VERSION,\n      'extent': this.getExtent().toJSON()\n    };\n    json['options'] = this.config();\n    json['options']['center'] = this.getCenter();\n    json['options']['zoom'] = this.getZoom();\n    json['options']['bearing'] = this.getBearing();\n    json['options']['pitch'] = this.getPitch();\n    var baseLayer = this.getBaseLayer();\n\n    if ((isNil(options['baseLayer']) || options['baseLayer']) && baseLayer) {\n      json['baseLayer'] = baseLayer.toJSON(options['baseLayer']);\n    }\n\n    var extraLayerOptions = {};\n\n    if (options['clipExtent']) {\n      if (options['clipExtent'] === true) {\n        extraLayerOptions['clipExtent'] = this.getExtent();\n      } else {\n        extraLayerOptions['clipExtent'] = options['clipExtent'];\n      }\n    }\n\n    var layersJSON = [];\n\n    if (isNil(options['layers']) || options['layers'] && !Array.isArray(options['layers'])) {\n      var layers = this.getLayers();\n\n      for (var i = 0, len = layers.length; i < len; i++) {\n        if (!layers[i].toJSON) {\n          continue;\n        }\n\n        var opts = extend({}, isObject(options['layers']) ? options['layers'] : {}, extraLayerOptions);\n        layersJSON.push(layers[i].toJSON(opts));\n      }\n\n      json['layers'] = layersJSON;\n    } else if (isArrayHasData(options['layers'])) {\n      var _layers = options['layers'];\n\n      for (var _i = 0; _i < _layers.length; _i++) {\n        var exportOption = _layers[_i];\n        var layer = this.getLayer(exportOption['id']);\n\n        if (!layer.toJSON) {\n          continue;\n        }\n\n        var _opts = extend({}, exportOption['options'], extraLayerOptions);\n\n        layersJSON.push(layer.toJSON(_opts));\n      }\n\n      json['layers'] = layersJSON;\n    } else {\n      json['layers'] = [];\n    }\n\n    return json;\n  }\n});\n\nMap$1.fromJSON = function (container, profile, options) {\n  if (!container || !profile) {\n    return null;\n  }\n\n  if (!options) {\n    options = {};\n  }\n\n  var map = new Map$1(container, profile['options']);\n\n  if (isNil(options['baseLayer']) || options['baseLayer']) {\n    var baseLayer = Layer.fromJSON(profile['baseLayer']);\n\n    if (baseLayer) {\n      map.setBaseLayer(baseLayer);\n    }\n  }\n\n  if (isNil(options['layers']) || options['layers']) {\n    var layers = [];\n    var layerJSONs = profile['layers'];\n\n    for (var i = 0; i < layerJSONs.length; i++) {\n      var layer = Layer.fromJSON(layerJSONs[i]);\n      layers.push(layer);\n    }\n\n    map.addLayer(layers);\n  }\n\n  return map;\n};\n\nMap$1.include({\n  computeLength: function computeLength(coord1, coord2) {\n    if (!this.getProjection()) {\n      return null;\n    }\n\n    var p1 = new Coordinate(coord1),\n        p2 = new Coordinate(coord2);\n\n    if (p1.equals(p2)) {\n      return 0;\n    }\n\n    return this.getProjection().measureLength(p1, p2);\n  },\n  computeGeometryLength: function computeGeometryLength(geometry) {\n    return geometry._computeGeodesicLength(this.getProjection());\n  },\n  computeGeometryArea: function computeGeometryArea(geometry) {\n    return geometry._computeGeodesicArea(this.getProjection());\n  },\n  identify: function identify(opts, callback) {\n    if (!opts) {\n      return this;\n    }\n\n    var reqLayers = opts['layers'];\n\n    if (!isArrayHasData(reqLayers)) {\n      return this;\n    }\n\n    var layers = [];\n\n    for (var i = 0, len = reqLayers.length; i < len; i++) {\n      if (isString(reqLayers[i])) {\n        layers.push(this.getLayer(reqLayers[i]));\n      } else {\n        layers.push(reqLayers[i]);\n      }\n    }\n\n    var coordinate = new Coordinate(opts['coordinate']);\n    var options = extend({}, opts);\n    var hits = [];\n\n    for (var _i = layers.length - 1; _i >= 0; _i--) {\n      if (opts['count'] && hits.length >= opts['count']) {\n        break;\n      }\n\n      var layer = layers[_i];\n\n      if (!layer || !layer.getMap() || !opts['includeInvisible'] && !layer.isVisible() || !opts['includeInternals'] && layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n        continue;\n      }\n\n      var layerHits = layer.identify(coordinate, options);\n\n      if (layerHits) {\n        if (Array.isArray(layerHits)) {\n          pushIn(hits, layerHits);\n        } else {\n          hits.push(layerHits);\n        }\n      }\n    }\n\n    callback.call(this, hits);\n    return this;\n  }\n});\n\nMap$1.include({\n  _zoom: function _zoom(nextZoom, origin) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    origin = this._checkZoomOrigin(origin);\n    nextZoom = this._checkZoom(nextZoom);\n    this.onZoomStart(nextZoom, origin);\n    this._frameZoom = this.getZoom();\n    this.onZoomEnd(nextZoom, origin);\n  },\n  _zoomAnimation: function _zoomAnimation(nextZoom, origin, startScale) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    nextZoom = this._checkZoom(nextZoom);\n\n    if (this.getZoom() === nextZoom) {\n      return;\n    }\n\n    origin = this._checkZoomOrigin(origin);\n\n    this._startZoomAnim(nextZoom, origin, startScale);\n  },\n  _checkZoomOrigin: function _checkZoomOrigin(origin) {\n    if (!origin || this.options['zoomInCenter']) {\n      origin = new Point(this.width / 2, this.height / 2);\n    }\n\n    if (this.options['zoomOrigin']) {\n      origin = new Point(this.options['zoomOrigin']);\n    }\n\n    return origin;\n  },\n  _startZoomAnim: function _startZoomAnim(nextZoom, origin, startScale) {\n    if (isNil(startScale)) {\n      startScale = 1;\n    }\n\n    var endScale = this._getResolution(this._startZoomVal) / this._getResolution(nextZoom);\n\n    var duration = this.options['zoomAnimationDuration'] * Math.abs(endScale - startScale) / Math.abs(endScale - 1);\n    this._frameZoom = this._startZoomVal;\n\n    this._animateTo({\n      'zoom': nextZoom,\n      'around': origin\n    }, {\n      'continueOnViewChanged': true,\n      'duration': duration\n    });\n  },\n  onZoomStart: function onZoomStart(nextZoom, origin) {\n    if (!this.options['zoomable'] || this.isZooming()) {\n      return;\n    }\n\n    if (this._mapAnimPlayer) {\n      this._stopAnim(this._mapAnimPlayer);\n    }\n\n    this._zooming = true;\n    this._startZoomVal = this.getZoom();\n    this._startZoomCoord = this._containerPointToPrj(origin);\n\n    this._fireEvent('zoomstart', {\n      'from': this._startZoomVal,\n      'to': nextZoom\n    });\n  },\n  onZooming: function onZooming(nextZoom, origin, startScale) {\n    if (!this.options['zoomable']) {\n      return;\n    }\n\n    var frameZoom = this._frameZoom;\n\n    if (frameZoom === nextZoom) {\n      return;\n    }\n\n    if (isNil(startScale)) {\n      startScale = 1;\n    }\n\n    this._zoomTo(nextZoom, origin);\n\n    var res = this.getResolution(nextZoom),\n        fromRes = this.getResolution(this._startZoomVal),\n        scale = fromRes / res / startScale,\n        startPoint = this._prjToContainerPoint(this._startZoomCoord, this._startZoomVal);\n\n    var offset = this.getViewPoint();\n\n    if (!this.isRotating() && !startPoint.equals(origin) && scale !== 1) {\n      var pitch = this.getPitch();\n\n      var originOffset = startPoint._sub(origin)._multi(1 / (1 - scale));\n\n      if (pitch) {\n        originOffset.y /= Math.cos(pitch * Math.PI / 180);\n      }\n\n      origin = origin.add(originOffset);\n    }\n\n    var matrix = {\n      'view': [scale, 0, 0, scale, (origin.x - offset.x) * (1 - scale), (origin.y - offset.y) * (1 - scale)]\n    };\n    var dpr = this.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      origin = origin.multi(dpr);\n    }\n\n    matrix['container'] = [scale, 0, 0, scale, origin.x * (1 - scale), origin.y * (1 - scale)];\n\n    this._fireEvent('zooming', {\n      'from': this._startZoomVal,\n      'to': nextZoom,\n      'origin': origin,\n      'matrix': matrix\n    });\n\n    this._frameZoom = nextZoom;\n  },\n  onZoomEnd: function onZoomEnd(nextZoom, origin) {\n    if (!this.options['zoomable']) {\n      return;\n    }\n\n    var startZoomVal = this._startZoomVal;\n\n    this._zoomTo(nextZoom, origin);\n\n    this._zooming = false;\n\n    this._getRenderer().onZoomEnd();\n\n    this._fireEvent('zoomend', {\n      'from': startZoomVal,\n      'to': nextZoom\n    });\n\n    if (!this._verifyExtent(this._getPrjCenter())) {\n      this._panTo(this._prjMaxExtent.getCenter());\n    }\n  },\n  _zoomTo: function _zoomTo(nextZoom, origin) {\n    this._zoomLevel = nextZoom;\n\n    this._calcMatrices();\n\n    if (origin) {\n      this._setPrjCoordAtContainerPoint(this._startZoomCoord, origin);\n    }\n  },\n  _checkZoom: function _checkZoom(nextZoom) {\n    var maxZoom = this.getMaxZoom(),\n        minZoom = this.getMinZoom();\n\n    if (nextZoom < minZoom) {\n      nextZoom = minZoom;\n    }\n\n    if (nextZoom > maxZoom) {\n      nextZoom = maxZoom;\n    }\n\n    return nextZoom;\n  }\n});\n\nfunction perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf = 1 / (near - far);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 2 * far * near * nf;\n  out[15] = 0;\n  return out;\n}\nfunction translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2],\n      a00,\n      a01,\n      a02,\n      a03,\n      a10,\n      a11,\n      a12,\n      a13,\n      a20,\n      a21,\n      a22,\n      a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\nfunction scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\nfunction rotateX(out, a, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad),\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n\n  if (a !== out) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\nfunction rotateZ(out, a, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad),\n      a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n\n  if (a !== out) {\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\nfunction multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11],\n      a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\nfunction invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3],\n      a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7],\n      a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11],\n      a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15],\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\nfunction identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\nfunction copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\nfunction set$2(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\nfunction add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\nfunction subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\nfunction length(a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\nfunction normalize(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    out[0] = a[0] * len;\n    out[1] = a[1] * len;\n    out[2] = a[2] * len;\n  }\n\n  return out;\n}\nfunction dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\nfunction scale$1(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\nfunction cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\nfunction distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot ? Math.hypot(x, y, z) : hypot(x, y, z);\n}\nfunction transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n\nfunction hypot() {\n  var y = 0;\n  var i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n}\n\nfunction applyMatrix(out, v, e) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var w = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]);\n  out[0] = (e[0] * x + e[4] * y + e[8] * z + e[12]) * w;\n  out[1] = (e[1] * x + e[5] * y + e[9] * z + e[13]) * w;\n  out[2] = (e[2] * x + e[6] * y + e[10] * z + e[14]) * w;\n  return out;\n}\nfunction matrixToQuaternion(out, te) {\n  var m11 = te[0],\n      m12 = te[4],\n      m13 = te[8],\n      m21 = te[1],\n      m22 = te[5],\n      m23 = te[9],\n      m31 = te[2],\n      m32 = te[6],\n      m33 = te[10],\n      trace = m11 + m22 + m33;\n  var s;\n\n  if (trace > 0) {\n    s = 0.5 / Math.sqrt(trace + 1.0);\n    out.w = 0.25 / s;\n    out.x = (m32 - m23) * s;\n    out.y = (m13 - m31) * s;\n    out.z = (m21 - m12) * s;\n  } else if (m11 > m22 && m11 > m33) {\n    s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\n    out.w = (m32 - m23) / s;\n    out.x = 0.25 * s;\n    out.y = (m12 + m21) / s;\n    out.z = (m13 + m31) / s;\n  } else if (m22 > m33) {\n    s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\n    out.w = (m13 - m31) / s;\n    out.x = (m12 + m21) / s;\n    out.y = 0.25 * s;\n    out.z = (m23 + m32) / s;\n  } else {\n    s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\n    out.w = (m21 - m12) / s;\n    out.x = (m13 + m31) / s;\n    out.y = (m23 + m32) / s;\n    out.z = 0.25 * s;\n  }\n\n  return this;\n}\nfunction quaternionToMatrix(out, q) {\n  var te = out;\n  var x = q.x,\n      y = q.y,\n      z = q.z,\n      w = q.w;\n  var x2 = x + x,\n      y2 = y + y,\n      z2 = z + z;\n  var xx = x * x2,\n      xy = x * y2,\n      xz = x * z2;\n  var yy = y * y2,\n      yz = y * z2,\n      zz = z * z2;\n  var wx = w * x2,\n      wy = w * y2,\n      wz = w * z2;\n  te[0] = 1 - (yy + zz);\n  te[4] = xy - wz;\n  te[8] = xz + wy;\n  te[1] = xy + wz;\n  te[5] = 1 - (xx + zz);\n  te[9] = yz - wx;\n  te[2] = xz - wy;\n  te[6] = yz + wx;\n  te[10] = 1 - (xx + yy);\n  te[3] = 0;\n  te[7] = 0;\n  te[11] = 0;\n  te[12] = 0;\n  te[13] = 0;\n  te[14] = 0;\n  te[15] = 1;\n  return te;\n}\nfunction setPosition(out, v) {\n  var te = out;\n  te[12] = v[0];\n  te[13] = v[1];\n  te[14] = v[2];\n  return out;\n}\nfunction lookAt(te, eye, target, up) {\n  var x = [0, 0, 0];\n  var y = [0, 0, 0];\n  var z = [0, 0, 0];\n  subtract(z, eye, target);\n\n  if (length(z) === 0) {\n    z[2] = 1;\n  }\n\n  normalize(z, z);\n  cross(x, up, z);\n\n  if (length(z) === 0) {\n    if (Math.abs(up[2]) === 1) {\n      z[0] += 0.0001;\n    } else {\n      z[2] += 0.0001;\n    }\n\n    normalize(z, z);\n    cross(x, up, z);\n  }\n\n  normalize(x, x);\n  cross(y, z, x);\n  te[0] = x[0];\n  te[4] = y[0];\n  te[8] = z[0];\n  te[1] = x[1];\n  te[5] = y[1];\n  te[9] = z[1];\n  te[2] = x[2];\n  te[6] = y[2];\n  te[10] = z[2];\n  return te;\n}\n\nvar RADIAN$1 = Math.PI / 180;\nvar DEFAULT_FOV = 0.6435011087932844;\nvar TEMP_COORD = new Coordinate(0, 0);\nMap$1.include({\n  getFov: function getFov() {\n    if (!this._fov) {\n      this._fov = DEFAULT_FOV;\n    }\n\n    return this._fov / RADIAN$1;\n  },\n  setFov: function setFov(fov) {\n    if (this.isZooming()) {\n      return this;\n    }\n\n    fov = Math.max(0.01, Math.min(60, fov));\n    if (this._fov === fov) return this;\n    var from = this.getFov();\n    this._fov = fov * RADIAN$1;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('fovchange', {\n      'from': from,\n      'to': this.getFov()\n    });\n\n    return this;\n  },\n  getBearing: function getBearing() {\n    if (!this._angle) {\n      return 0;\n    }\n\n    return -this._angle / RADIAN$1;\n  },\n  setBearing: function setBearing(bearing) {\n    if (Browser$1.ie9) {\n      throw new Error('map can\\'t rotate in IE9.');\n    }\n\n    var b = -wrap(bearing, -180, 180) * RADIAN$1;\n    if (this._angle === b) return this;\n    var from = this.getBearing();\n\n    this._fireEvent('rotatestart', {\n      'from': from,\n      'to': b\n    });\n\n    this._angle = b;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('rotate', {\n      'from': from,\n      'to': b\n    });\n\n    this._fireEvent('rotateend', {\n      'from': from,\n      'to': b\n    });\n\n    return this;\n  },\n  getPitch: function getPitch() {\n    if (!this._pitch) {\n      return 0;\n    }\n\n    return this._pitch / Math.PI * 180;\n  },\n  setPitch: function setPitch(pitch) {\n    if (Browser$1.ie9) {\n      throw new Error('map can\\'t tilt in IE9.');\n    }\n\n    var p = clamp(pitch, 0, this.options['maxPitch']) * RADIAN$1;\n    if (this._pitch === p) return this;\n    var from = this.getPitch();\n\n    this._fireEvent('pitchstart', {\n      'from': from,\n      'to': p\n    });\n\n    this._pitch = p;\n\n    this._calcMatrices();\n\n    this._renderLayers();\n\n    this._fireEvent('pitch', {\n      'from': from,\n      'to': p\n    });\n\n    this._fireEvent('pitchend', {\n      'from': from,\n      'to': p\n    });\n\n    return this;\n  },\n  isTransforming: function isTransforming() {\n    return !!(this._pitch || this._angle);\n  },\n  getFrustumAltitude: function getFrustumAltitude() {\n    return this._frustumAltitude;\n  },\n  _calcFrustumAltitude: function _calcFrustumAltitude() {\n    var pitch = 90 - this.getPitch();\n    var fov = this.getFov() / 2;\n    var cameraAlt = this.cameraPosition ? this.cameraPosition[2] : 0;\n\n    if (fov <= pitch) {\n      return cameraAlt;\n    }\n\n    fov = Math.PI * fov / 180;\n    var d1 = new Point(this.cameraPosition).distanceTo(new Point(this.cameraLookAt)),\n        d2 = cameraAlt * Math.tan(fov * 2);\n    var d = Math.tan(fov) * (d1 + d2);\n    return cameraAlt + d;\n  },\n  _pointToContainerPoint: function () {\n    var a = [0, 0, 0];\n    return function (point, zoom, altitude, out) {\n      if (altitude === void 0) {\n        altitude = 0;\n      }\n\n      point = this._pointToPoint(point, zoom, out);\n\n      if (this.isTransforming() || altitude) {\n        altitude *= this._getResolution(zoom) / this._getResolution();\n        var _scale = this._glScale;\n        set$2(a, point.x * _scale, point.y * _scale, altitude * _scale);\n\n        var t = this._projIfBehindCamera(a, this.cameraPosition, this.cameraForward);\n\n        applyMatrix(t, t, this.projViewMatrix);\n        var w2 = this.width / 2,\n            h2 = this.height / 2;\n        t[0] = t[0] * w2 + w2;\n        t[1] = -(t[1] * h2) + h2;\n\n        if (out) {\n          out.x = t[0];\n          out.y = t[1];\n          return out;\n        }\n\n        return new Point(t[0], t[1]);\n      } else {\n        var centerPoint = this._prjToPoint(this._getPrjCenter(), undefined, TEMP_COORD);\n\n        if (out) {\n          out.x = point.x;\n          out.y = point.y;\n        } else {\n          out = point;\n        }\n\n        out._sub(centerPoint.x, centerPoint.y);\n\n        out.set(out.x, -out.y);\n        return out._add(this.width / 2, this.height / 2);\n      }\n    };\n  }(),\n  _projIfBehindCamera: function () {\n    var vectorFromCam = new Array(3);\n    var proj = new Array(3);\n    var sub = new Array(3);\n    return function (position, cameraPos, camForward) {\n      subtract(vectorFromCam, position, cameraPos);\n      var camNormDot = dot(camForward, vectorFromCam);\n\n      if (camNormDot <= 0) {\n        scale$1(proj, camForward, camNormDot * 1.01);\n        add(position, cameraPos, subtract(sub, vectorFromCam, proj));\n      }\n\n      return position;\n    };\n  }(),\n  _containerPointToPoint: function () {\n    var cp = [0, 0, 0],\n        coord0 = [0, 0, 0, 1],\n        coord1 = [0, 0, 0, 1];\n    return function (p, zoom, out) {\n      if (this.isTransforming()) {\n        var w2 = this.width / 2 || 1,\n            h2 = this.height / 2 || 1;\n        set$2(cp, (p.x - w2) / w2, (h2 - p.y) / h2, 0);\n        set$2(coord0, cp[0], cp[1], 0);\n        set$2(coord1, cp[0], cp[1], 1);\n        coord0[3] = coord1[3] = 1;\n        applyMatrix(coord0, coord0, this.projViewMatrixInverse);\n        applyMatrix(coord1, coord1, this.projViewMatrixInverse);\n        var x0 = coord0[0];\n        var x1 = coord1[0];\n        var y0 = coord0[1];\n        var y1 = coord1[1];\n        var z0 = coord0[2];\n        var z1 = coord1[2];\n        var t = z0 === z1 ? 0 : (0 - z0) / (z1 - z0);\n\n        var _x = interpolate(x0, x1, t);\n\n        var _y = interpolate(y0, y1, t);\n\n        if (out) {\n          out.x = _x;\n          out.y = _y;\n        } else {\n          out = new Point(_x, _y);\n        }\n\n        out._multi(1 / this._glScale);\n\n        return zoom === undefined || this.getZoom() === zoom ? out : this._pointToPointAtZoom(out, zoom, out);\n      }\n\n      var centerPoint = this._prjToPoint(this._getPrjCenter(), zoom, out),\n          scale$$1 = zoom !== undefined ? this._getResolution() / this._getResolution(zoom) : 1;\n\n      var x = scale$$1 * (p.x - this.width / 2),\n          y = scale$$1 * (p.y - this.height / 2);\n      return centerPoint._add(x, -y);\n    };\n  }(),\n  _calcMatrices: function () {\n    var m0 = createMat4(),\n        m1 = createMat4();\n    return function () {\n      delete this._mapRes;\n      delete this._mapGlRes;\n      delete this._mapExtent2D;\n      delete this._mapGlExtent2D;\n      var size = this.getSize();\n      var w = size.width || 1,\n          h = size.height || 1;\n      this._glScale = this.getGLScale();\n      var pitch = this.getPitch() * Math.PI / 180;\n\n      var worldMatrix = this._getCameraWorldMatrix();\n\n      var fov = this.getFov() * Math.PI / 180;\n\n      var farZ = this._getCameraFar(fov, this.getPitch());\n\n      this.cameraFar = farZ;\n      this.cameraNear = Math.max(this._glScale * this.getResolution(this.getGLZoom()) * Math.cos(pitch), 0.1);\n      var projMatrix = this.projMatrix || createMat4();\n      perspective(projMatrix, fov, w / h, this.cameraNear, farZ);\n      this.projMatrix = projMatrix;\n      this.viewMatrix = invert(m0, worldMatrix);\n      this.projViewMatrix = multiply(this.projViewMatrix || createMat4(), projMatrix, this.viewMatrix);\n\n      this._calcCascadeMatrixes();\n\n      this.projViewMatrixInverse = multiply(this.projViewMatrixInverse || createMat4(), worldMatrix, invert(m1, projMatrix));\n      this.domCssMatrix = this._calcDomMatrix();\n      this._frustumAltitude = this._calcFrustumAltitude();\n      this._mapRes = this._getResolution();\n      this._mapGlRes = this._getResolution(this.getGLZoom());\n      this._mapExtent2D = this._get2DExtent();\n      this._mapGlExtent2D = this._get2DExtent(this.getGLZoom());\n    };\n  }(),\n  _getCameraFar: function _getCameraFar(fov, pitch) {\n    var cameraCenterDistance = this.cameraCenterDistance = distance(this.cameraPosition, this.cameraLookAt);\n    var farZ = cameraCenterDistance;\n\n    if (pitch > 0) {\n      pitch = pitch * Math.PI / 180;\n      var y;\n\n      if (2 / Math.PI - pitch <= fov / 2) {\n        y = 4 * cameraCenterDistance;\n      } else {\n        var tanFov = Math.tan(fov / 2);\n        var tanP = Math.tan(pitch);\n        y = cameraCenterDistance * tanFov / (1 / tanP - tanFov);\n      }\n\n      farZ += y;\n    }\n\n    return farZ + 1.0;\n  },\n  _calcCascadeMatrixes: function () {\n    var projMatrix = createMat4();\n\n    function cal(curPitch, pitch, out) {\n      var w = this.width;\n      var h = this.height;\n      var fov = this.getFov() * Math.PI / 180;\n\n      var farZ = this._getCameraFar(fov, pitch);\n\n      var cameraCenterDistance = this.cameraCenterDistance;\n      farZ = cameraCenterDistance + (farZ - cameraCenterDistance) / Math.cos((90 - pitch) * Math.PI / 180) * Math.cos((90 - curPitch) * Math.PI / 180);\n      perspective(projMatrix, fov, w / h, 0.1, farZ);\n      var viewMatrix = this.viewMatrix;\n      return multiply(out, projMatrix, viewMatrix);\n    }\n\n    return function () {\n      var pitch = this.getPitch();\n      var cascadePitch0 = this.options['cascadePitches'][0];\n      var cascadePitch1 = this.options['cascadePitches'][1];\n      var projViewMatrix0 = this.cascadeFrustumMatrix0 = this.cascadeFrustumMatrix0 || createMat4();\n      var projViewMatrix1 = this.cascadeFrustumMatrix1 = this.cascadeFrustumMatrix1 || createMat4();\n\n      if (pitch > cascadePitch0) {\n        cal.call(this, pitch, cascadePitch0, projViewMatrix0);\n      } else {\n        copy(this.cascadeFrustumMatrix0, this.projViewMatrix);\n      }\n\n      if (pitch > cascadePitch1) {\n        cal.call(this, pitch, cascadePitch1, projViewMatrix1);\n      } else {\n        copy(this.cascadeFrustumMatrix1, this.cascadeFrustumMatrix0);\n      }\n    };\n  }(),\n  _calcDomMatrix: function () {\n    var m = createMat4(),\n        m1 = createMat4(),\n        minusY = [1, -1, 1],\n        arr = [0, 0, 0];\n    return function () {\n      var width = this.width || 1;\n      var height = this.height || 1;\n      var cameraToCenterDistance = 0.5 / Math.tan(this._fov / 2) * height;\n      scale(m, this.projMatrix, minusY);\n      translate(m, m, set$2(arr, 0, 0, -cameraToCenterDistance));\n\n      if (this._pitch) {\n        rotateX(m, m, this._pitch);\n      }\n\n      if (this._angle) {\n        rotateZ(m, m, this._angle);\n      }\n\n      identity(m1);\n      scale(m1, m1, set$2(arr, width / 2, -height / 2, 1));\n      return multiply(this.domCssMatrix || createMat4(), m1, m);\n    };\n  }(),\n  _getCameraWorldMatrix: function () {\n    var q = {};\n    return function () {\n      var targetZ = this.getGLZoom();\n      var size = this.getSize(),\n          scale$$1 = this.getGLScale();\n\n      var center2D = this._prjToPoint(this._prjCenter, targetZ);\n\n      this.cameraLookAt = set$2(this.cameraLookAt || [0, 0, 0], center2D.x, center2D.y, 0);\n      var pitch = this.getPitch() * RADIAN$1;\n      var bearing = this.getBearing() * RADIAN$1;\n\n      var ratio = this._getFovRatio();\n\n      var z = scale$$1 * (size.height || 1) / 2 / ratio;\n      var cz = z * Math.cos(pitch);\n      var dist = Math.sin(pitch) * z;\n      var cx = center2D.x - dist * Math.sin(bearing);\n      var cy = center2D.y - dist * Math.cos(bearing);\n      this.cameraPosition = set$2(this.cameraPosition || [0, 0, 0], cx, cy, cz);\n      var d = dist || 1;\n      var up = this.cameraUp = set$2(this.cameraUp || [0, 0, 0], Math.sin(bearing) * d, Math.cos(bearing) * d, 0);\n      var m = this.cameraWorldMatrix = this.cameraWorldMatrix || createMat4();\n      lookAt(m, this.cameraPosition, this.cameraLookAt, up);\n      var cameraForward = this.cameraForward || [0, 0, 0];\n      subtract(cameraForward, this.cameraLookAt, this.cameraPosition);\n      this.cameraForward = normalize(cameraForward, cameraForward);\n      matrixToQuaternion(q, m);\n      quaternionToMatrix(m, q);\n      setPosition(m, this.cameraPosition);\n      return m;\n    };\n  }(),\n  _getFovRatio: function _getFovRatio() {\n    var fov = this.getFov();\n    return Math.tan(fov / 2 * RADIAN$1);\n  },\n  _renderLayers: function _renderLayers() {\n    if (this.isInteracting()) {\n      return;\n    }\n\n    var layers = this._getLayers();\n\n    layers.forEach(function (layer) {\n      if (!layer) {\n        return;\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (renderer && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    });\n  }\n});\n\nfunction createMat4() {\n  return identity(new Array(16));\n}\n\nMap$1.include({\n  _onViewChange: function _onViewChange(view) {\n    if (!this._viewHistory) {\n      this._viewHistory = [];\n      this._viewHistoryPointer = 0;\n    }\n\n    var old = this._getCurrentView();\n\n    for (var i = this._viewHistory.length - 1; i >= 0; i--) {\n      if (equalMapView(view, this._viewHistory[i])) {\n        this._viewHistoryPointer = i;\n\n        this._fireViewChange(old, view);\n\n        return;\n      }\n    }\n\n    if (this._viewHistoryPointer < this._viewHistory.length - 1) {\n      this._viewHistory.splice(this._viewHistoryPointer + 1);\n    }\n\n    this._viewHistory.push(view);\n\n    var count = this.options['viewHistoryCount'];\n\n    if (count > 0 && this._viewHistory.length > count) {\n      this._viewHistory.splice(0, this._viewHistory.length - count);\n    }\n\n    this._viewHistoryPointer = this._viewHistory.length - 1;\n\n    this._fireViewChange(old, view);\n  },\n  zoomToPreviousView: function zoomToPreviousView(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!this.hasPreviousView()) {\n      return null;\n    }\n\n    var view = this._viewHistory[--this._viewHistoryPointer];\n\n    this._zoomToView(view, options);\n\n    return view;\n  },\n  hasPreviousView: function hasPreviousView() {\n    if (!this._viewHistory || this._viewHistoryPointer === 0) {\n      return false;\n    }\n\n    return true;\n  },\n  zoomToNextView: function zoomToNextView(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!this.hasNextView()) {\n      return null;\n    }\n\n    var view = this._viewHistory[++this._viewHistoryPointer];\n\n    this._zoomToView(view, options);\n\n    return view;\n  },\n  hasNextView: function hasNextView() {\n    if (!this._viewHistory || this._viewHistoryPointer === this._viewHistory.length - 1) {\n      return false;\n    }\n\n    return true;\n  },\n  _zoomToView: function _zoomToView(view, options) {\n    var _this = this;\n\n    var old = this.getView();\n\n    if (options['animation']) {\n      this._animateTo(view, {\n        'duration': options['duration']\n      }, function (frame) {\n        if (frame.state.playState === 'finished') {\n          _this._fireViewChange(old, view);\n        }\n      });\n    } else {\n      this.setView(view);\n\n      this._fireViewChange(old, view);\n    }\n  },\n  getViewHistory: function getViewHistory() {\n    return this._viewHistory;\n  },\n  _fireViewChange: function _fireViewChange(old, view) {\n    this._fireEvent('viewchange', {\n      'old': old,\n      'new': view\n    });\n  },\n  _getCurrentView: function _getCurrentView() {\n    if (!this._viewHistory) {\n      return null;\n    }\n\n    return this._viewHistory[this._viewHistoryPointer];\n  }\n});\nMap$1.mergeOptions({\n  'viewHistory': true,\n  'viewHistoryCount': 10\n});\n\nvar options$h = {\n  'mode': 'LineString',\n  'language': 'zh-CN',\n  'metric': true,\n  'imperial': false,\n  'symbol': {\n    'lineColor': '#000',\n    'lineWidth': 3,\n    'lineOpacity': 1\n  },\n  'vertexSymbol': {\n    'markerType': 'ellipse',\n    'markerFill': '#fff',\n    'markerLineColor': '#000',\n    'markerLineWidth': 3,\n    'markerWidth': 11,\n    'markerHeight': 11\n  },\n  'labelOptions': {\n    'textSymbol': {\n      'textFaceName': 'monospace',\n      'textLineSpacing': 1,\n      'textHorizontalAlignment': 'right',\n      'textDx': 15\n    },\n    'boxStyle': {\n      'padding': [6, 2],\n      'symbol': {\n        'markerType': 'square',\n        'markerFill': '#fff',\n        'markerFillOpacity': 0.9,\n        'markerLineColor': '#b4b3b3'\n      }\n    }\n  },\n  'clearButtonSymbol': [{\n    'markerType': 'square',\n    'markerFill': '#fff',\n    'markerLineColor': '#b4b3b3',\n    'markerLineWidth': 2,\n    'markerWidth': 15,\n    'markerHeight': 15,\n    'markerDx': 20\n  }, {\n    'markerType': 'x',\n    'markerWidth': 10,\n    'markerHeight': 10,\n    'markerDx': 20\n  }]\n};\n\nvar DistanceTool = function (_DrawTool) {\n  _inheritsLoose(DistanceTool, _DrawTool);\n\n  function DistanceTool(options) {\n    var _this;\n\n    _this = _DrawTool.call(this, options) || this;\n\n    _this.on('enable', _this._afterEnable, _assertThisInitialized(_assertThisInitialized(_this))).on('disable', _this._afterDisable, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._measureLayers = [];\n    return _this;\n  }\n\n  var _proto = DistanceTool.prototype;\n\n  _proto.clear = function clear() {\n    if (isArrayHasData(this._measureLayers)) {\n      for (var i = 0; i < this._measureLayers.length; i++) {\n        this._measureLayers[i].remove();\n      }\n    }\n\n    delete this._lastMeasure;\n    delete this._lastVertex;\n    this._measureLayers = [];\n    return this;\n  };\n\n  _proto.getMeasureLayers = function getMeasureLayers() {\n    return this._measureLayers;\n  };\n\n  _proto.getLastMeasure = function getLastMeasure() {\n    if (!this._lastMeasure) {\n      return 0;\n    }\n\n    return this._lastMeasure;\n  };\n\n  _proto.undo = function undo() {\n    _DrawTool.prototype.undo.call(this);\n\n    var pointer = this._historyPointer;\n\n    if (pointer !== this._vertexes.length) {\n      for (var i = pointer; i < this._vertexes.length; i++) {\n        if (this._vertexes[i].label) {\n          this._vertexes[i].label.remove();\n        }\n\n        this._vertexes[i].marker.remove();\n      }\n    }\n\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    _DrawTool.prototype.redo.call(this);\n\n    var i = this._historyPointer - 1;\n\n    if (this._vertexes[i]) {\n      if (!this._vertexes[i].marker.getLayer()) {\n        if (this._vertexes[i].label) {\n          this._vertexes[i].label.addTo(this._measureMarkerLayer);\n        }\n\n        this._vertexes[i].marker.addTo(this._measureMarkerLayer);\n      }\n    }\n\n    return this;\n  };\n\n  _proto._measure = function _measure(toMeasure) {\n    var map = this.getMap();\n    var length;\n\n    if (toMeasure instanceof Geometry) {\n      length = map.computeGeometryLength(toMeasure);\n    } else if (Array.isArray(toMeasure)) {\n      length = map.getProjection().measureLength(toMeasure);\n    }\n\n    this._lastMeasure = length;\n    var units;\n\n    if (this.options['language'] === 'zh-CN') {\n      units = [' 米', ' 公里', ' 英尺', ' 英里'];\n    } else {\n      units = [' m', ' km', ' feet', ' mile'];\n    }\n\n    var content = '';\n\n    if (this.options['metric']) {\n      content += length < 1000 ? length.toFixed(0) + units[0] : (length / 1000).toFixed(2) + units[1];\n    }\n\n    if (this.options['imperial']) {\n      length *= 3.2808399;\n\n      if (content.length > 0) {\n        content += '\\n';\n      }\n\n      content += length < 5280 ? length.toFixed(0) + units[2] : (length / 5280).toFixed(2) + units[3];\n    }\n\n    return content;\n  };\n\n  _proto._registerMeasureEvents = function _registerMeasureEvents() {\n    this.on('drawstart', this._msOnDrawStart, this).on('drawvertex', this._msOnDrawVertex, this).on('mousemove', this._msOnMouseMove, this).on('drawend', this._msOnDrawEnd, this);\n  };\n\n  _proto._afterEnable = function _afterEnable() {\n    this._registerMeasureEvents();\n  };\n\n  _proto._afterDisable = function _afterDisable() {\n    this.off('drawstart', this._msOnDrawStart, this).off('drawvertex', this._msOnDrawVertex, this).off('mousemove', this._msOnMouseMove, this).off('drawend', this._msOnDrawEnd, this);\n  };\n\n  _proto._msOnDrawStart = function _msOnDrawStart(param) {\n    var map = this.getMap();\n\n    var prjCoord = map._pointToPrj(param['point2d']);\n\n    var uid = UID();\n    var layerId = 'distancetool_' + uid;\n    var markerLayerId = 'distancetool_markers_' + uid;\n\n    if (!map.getLayer(layerId)) {\n      this._measureLineLayer = new VectorLayer(layerId).addTo(map);\n      this._measureMarkerLayer = new VectorLayer(markerLayerId).addTo(map);\n    } else {\n      this._measureLineLayer = map.getLayer(layerId);\n      this._measureMarkerLayer = map.getLayer(markerLayerId);\n    }\n\n    this._measureLayers.push(this._measureLineLayer);\n\n    this._measureLayers.push(this._measureMarkerLayer);\n\n    var marker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    marker._setPrjCoordinates(prjCoord);\n\n    var content = this.options['language'] === 'zh-CN' ? '起点' : 'start';\n    var startLabel = new Label(content, param['coordinate'], this.options['labelOptions']);\n\n    startLabel._setPrjCoordinates(prjCoord);\n\n    this._lastVertex = startLabel;\n\n    this._addVertexMarker(marker, startLabel);\n  };\n\n  _proto._msOnMouseMove = function _msOnMouseMove(param) {\n    var ms = this._measure(this._msGetCoordsToMeasure(param));\n\n    if (!this._tailMarker) {\n      var symbol = extendSymbol(this.options['vertexSymbol']);\n      symbol['markerWidth'] /= 2;\n      symbol['markerHeight'] /= 2;\n      this._tailMarker = new Marker(param['coordinate'], {\n        'symbol': symbol\n      }).addTo(this._measureMarkerLayer);\n      this._tailLabel = new Label(ms, param['coordinate'], this.options['labelOptions']).addTo(this._measureMarkerLayer);\n    }\n\n    var prjCoords = this._geometry._getPrjCoordinates();\n\n    var lastCoord = prjCoords[prjCoords.length - 1];\n\n    this._tailMarker.setCoordinates(param['coordinate']);\n\n    this._tailMarker._setPrjCoordinates(lastCoord);\n\n    this._tailLabel.setContent(ms);\n\n    this._tailLabel.setCoordinates(param['coordinate']);\n\n    this._tailLabel._setPrjCoordinates(lastCoord);\n  };\n\n  _proto._msGetCoordsToMeasure = function _msGetCoordsToMeasure(param) {\n    return param['geometry'].getCoordinates().concat([param['coordinate']]);\n  };\n\n  _proto._msOnDrawVertex = function _msOnDrawVertex(param) {\n    var prjCoords = this._geometry._getPrjCoordinates();\n\n    var lastCoord = prjCoords[prjCoords.length - 1];\n    var geometry = param['geometry'];\n    var marker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    var length = this._measure(geometry);\n\n    var vertexLabel = new Label(length, param['coordinate'], this.options['labelOptions']);\n\n    this._addVertexMarker(marker, vertexLabel);\n\n    vertexLabel._setPrjCoordinates(lastCoord);\n\n    marker._setPrjCoordinates(lastCoord);\n\n    this._lastVertex = vertexLabel;\n  };\n\n  _proto._addVertexMarker = function _addVertexMarker(marker, vertexLabel) {\n    if (!this._vertexes) {\n      this._vertexes = [];\n    }\n\n    this._vertexes.push({\n      label: vertexLabel,\n      marker: marker\n    });\n\n    if (this._historyPointer !== undefined) {\n      this._vertexes.length = this._historyPointer;\n    }\n\n    this._measureMarkerLayer.addGeometry(marker);\n\n    if (vertexLabel) {\n      this._measureMarkerLayer.addGeometry(vertexLabel);\n    }\n  };\n\n  _proto._msOnDrawEnd = function _msOnDrawEnd(param) {\n    this._clearTailMarker();\n\n    var size = this._lastVertex.getSize();\n\n    if (!size) {\n      size = new Size(10, 10);\n    }\n\n    this._addClearMarker(this._lastVertex.getCoordinates(), this._lastVertex._getPrjCoordinates(), size['width']);\n\n    var geo = param['geometry'].copy();\n\n    geo._setPrjCoordinates(param['geometry']._getPrjCoordinates());\n\n    geo.addTo(this._measureLineLayer);\n    this._lastMeasure = geo.getLength();\n  };\n\n  _proto._addClearMarker = function _addClearMarker(coordinates, prjCoord, dx) {\n    var symbol = this.options['clearButtonSymbol'];\n    var dxSymbol = {\n      'markerDx': (symbol['markerDx'] || 0) + dx,\n      'textDx': (symbol['textDx'] || 0) + dx\n    };\n\n    if (Array.isArray(symbol)) {\n      dxSymbol = symbol.map(function (s) {\n        if (s) {\n          return {\n            'markerDx': (s['markerDx'] || 0) + dx,\n            'textDx': (s['textDx'] || 0) + dx\n          };\n        }\n\n        return null;\n      });\n    }\n\n    symbol = extendSymbol(symbol, dxSymbol);\n    var endMarker = new Marker(coordinates, {\n      'symbol': symbol\n    });\n    var measureLineLayer = this._measureLineLayer,\n        measureMarkerLayer = this._measureMarkerLayer;\n    endMarker.on('click', function () {\n      measureLineLayer.remove();\n      measureMarkerLayer.remove();\n      return false;\n    }, this);\n    endMarker.addTo(this._measureMarkerLayer);\n\n    endMarker._setPrjCoordinates(prjCoord);\n  };\n\n  _proto._clearTailMarker = function _clearTailMarker() {\n    if (this._tailMarker) {\n      this._tailMarker.remove();\n\n      delete this._tailMarker;\n    }\n\n    if (this._tailLabel) {\n      this._tailLabel.remove();\n\n      delete this._tailLabel;\n    }\n  };\n\n  return DistanceTool;\n}(DrawTool);\n\nDistanceTool.mergeOptions(options$h);\n\nvar options$i = {\n  'mode': 'Polygon',\n  'symbol': {\n    'lineColor': '#000000',\n    'lineWidth': 2,\n    'lineOpacity': 1,\n    'lineDasharray': '',\n    'polygonFill': '#ffffff',\n    'polygonOpacity': 0.5\n  }\n};\n\nvar AreaTool = function (_DistanceTool) {\n  _inheritsLoose(AreaTool, _DistanceTool);\n\n  function AreaTool(options) {\n    var _this;\n\n    _this = _DistanceTool.call(this, options) || this;\n\n    _this.on('enable', _this._afterEnable, _assertThisInitialized(_assertThisInitialized(_this))).on('disable', _this._afterDisable, _assertThisInitialized(_assertThisInitialized(_this)));\n\n    _this._measureLayers = [];\n    return _this;\n  }\n\n  var _proto = AreaTool.prototype;\n\n  _proto._measure = function _measure(toMeasure) {\n    var map = this.getMap();\n    var area;\n\n    if (toMeasure instanceof Geometry) {\n      area = map.computeGeometryArea(toMeasure);\n    } else if (Array.isArray(toMeasure)) {\n      area = map.getProjection().measureArea(toMeasure);\n    }\n\n    this._lastMeasure = area;\n    var units;\n\n    if (this.options['language'] === 'zh-CN') {\n      units = [' 平方米', ' 平方公里', ' 平方英尺', ' 平方英里'];\n    } else {\n      units = [' sq.m', ' sq.km', ' sq.ft', ' sq.mi'];\n    }\n\n    var content = '';\n\n    if (this.options['metric']) {\n      content += area < 1E6 ? area.toFixed(0) + units[0] : (area / 1E6).toFixed(2) + units[1];\n    }\n\n    if (this.options['imperial']) {\n      area *= 3.2808399;\n\n      if (content.length > 0) {\n        content += '\\n';\n      }\n\n      var sqmi = 5280 * 5280;\n      content += area < sqmi ? area.toFixed(0) + units[2] : (area / sqmi).toFixed(2) + units[3];\n    }\n\n    return content;\n  };\n\n  _proto._msGetCoordsToMeasure = function _msGetCoordsToMeasure(param) {\n    return param['geometry'].getShell().concat([param['coordinate']]);\n  };\n\n  _proto._msOnDrawVertex = function _msOnDrawVertex(param) {\n    var prjCoord = this.getMap()._pointToPrj(param['point2d']);\n\n    var vertexMarker = new Marker(param['coordinate'], {\n      'symbol': this.options['vertexSymbol']\n    });\n\n    vertexMarker._setPrjCoordinates(prjCoord);\n\n    this._measure(param['geometry']);\n\n    this._lastVertex = vertexMarker;\n\n    this._addVertexMarker(vertexMarker);\n  };\n\n  _proto._msOnDrawEnd = function _msOnDrawEnd(param) {\n    this._clearTailMarker();\n\n    var prjCoord = this.getMap()._pointToPrj(param['point2d']);\n\n    var ms = this._measure(param['geometry']);\n\n    var endLabel = new Label(ms, param['coordinate'], this.options['labelOptions']).addTo(this._measureMarkerLayer);\n\n    endLabel._setPrjCoordinates(prjCoord);\n\n    var size = endLabel.getSize();\n\n    if (!size) {\n      size = new Size(10, 10);\n    }\n\n    this._addClearMarker(param['coordinate'], prjCoord, size['width']);\n\n    var geo = param['geometry'].copy();\n\n    geo._setPrjCoordinates(param['geometry']._getPrjCoordinates());\n\n    geo.addTo(this._measureLineLayer);\n    this._lastMeasure = geo.getArea();\n  };\n\n  return AreaTool;\n}(DistanceTool);\n\nAreaTool.mergeOptions(options$i);\n\nvar circleHooks = {\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var circle = new Circle(center, 0);\n\n    circle._setPrjCoordinates(prjCoord[0]);\n\n    return circle;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var map = geometry.getMap();\n    var prjCoord = Array.isArray(prjPath) ? prjPath[prjPath.length - 1] : prjPath;\n    var nextCoord = projection.unproject(prjCoord);\n    var radius = map.computeLength(geometry.getCenter(), nextCoord);\n    geometry.setRadius(radius);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('circle', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, circleHooks));\nDrawTool.registerMode('freeHandCircle', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, circleHooks));\nvar ellipseHooks = {\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var ellipse = new Ellipse(center, 0, 0);\n\n    ellipse._setPrjCoordinates(prjCoord[0]);\n\n    return ellipse;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var map = geometry.getMap();\n    var center = geometry.getCenter();\n    var prjCoord = Array.isArray(prjPath) ? prjPath[prjPath.length - 1] : prjPath;\n    var nextCoord = projection.unproject(prjCoord);\n    var rx = map.computeLength(center, new Coordinate({\n      x: nextCoord.x,\n      y: center.y\n    }));\n    var ry = map.computeLength(center, new Coordinate({\n      x: center.x,\n      y: nextCoord.y\n    }));\n    geometry.setWidth(rx * 2);\n    geometry.setHeight(ry * 2);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('ellipse', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, ellipseHooks));\nDrawTool.registerMode('freeHandEllipse', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, ellipseHooks));\nvar rectangleHooks = {\n  'create': function create(projection, prjCoords) {\n    var rect = new Polygon([]);\n    rect._firstClick = prjCoords[0];\n    return rect;\n  },\n  'update': function update(projection, prjCoords, geometry, param) {\n    var map = geometry.getMap();\n    var containerPoint = param['containerPoint'];\n\n    var firstClick = map._prjToContainerPoint(geometry._firstClick);\n\n    var ring = [[firstClick.x, firstClick.y], [containerPoint.x, firstClick.y], [containerPoint.x, containerPoint.y], [firstClick.x, containerPoint.y]];\n    geometry.setCoordinates(ring.map(function (c) {\n      return map.containerPointToCoord(new Point(c));\n    }));\n\n    geometry._setPrjCoordinates(ring.map(function (c) {\n      return map._containerPointToPrj(new Point(c));\n    }));\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('rectangle', extend({\n  'clickLimit': 2,\n  'action': ['click', 'mousemove', 'click']\n}, rectangleHooks));\nDrawTool.registerMode('freeHandRectangle', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, rectangleHooks));\nDrawTool.registerMode('point', {\n  'clickLimit': 1,\n  'action': ['click'],\n  'create': function create(projection, prjCoord) {\n    var center = projection.unproject(prjCoord[0]);\n    var marker = new Marker(center);\n\n    marker._setPrjCoordinates(prjCoord[0]);\n\n    return marker;\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nvar polygonHooks = {\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var line = new LineString(path);\n\n    line._setPrjCoordinates(prjPath);\n\n    return line;\n  },\n  'update': function update(projection, path, geometry) {\n    var symbol = geometry.getSymbol();\n    var prjCoords;\n\n    if (Array.isArray(path)) {\n      prjCoords = path;\n    } else {\n      prjCoords = geometry._getPrjCoordinates();\n      prjCoords.push(path);\n    }\n\n    var coordinates = prjCoords.map(function (c) {\n      return projection.unproject(c);\n    });\n    geometry.setCoordinates(coordinates);\n\n    geometry._setPrjCoordinates(prjCoords);\n\n    var layer = geometry.getLayer();\n\n    if (layer) {\n      var polygon = layer.getGeometryById('polygon');\n\n      if (!polygon && prjCoords.length >= 3) {\n        polygon = new Polygon([coordinates], {\n          'id': 'polygon'\n        });\n\n        if (symbol) {\n          var pSymbol = extendSymbol(symbol, {\n            'lineOpacity': 0\n          });\n          polygon.setSymbol(pSymbol);\n        }\n\n        polygon.addTo(layer);\n      }\n\n      if (polygon) {\n        polygon._setPrjCoordinates(prjCoords);\n      }\n    }\n  },\n  'generate': function generate(geometry) {\n    var polygon = new Polygon(geometry.getCoordinates(), {\n      'symbol': geometry.getSymbol()\n    });\n\n    polygon._setPrjCoordinates(geometry._getPrjCoordinates());\n\n    polygon._projCode = geometry._projCode;\n    return polygon;\n  }\n};\nDrawTool.registerMode('polygon', extend({\n  'action': ['click', 'mousemove', 'dblclick']\n}, polygonHooks));\nDrawTool.registerMode('freeHandPolygon', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, polygonHooks));\nvar lineStringHooks = {\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var line = new LineString(path);\n\n    line._setPrjCoordinates(prjPath);\n\n    return line;\n  },\n  'update': function update(projection, prjPath, geometry) {\n    var prjCoords;\n\n    if (Array.isArray(prjPath)) {\n      prjCoords = prjPath;\n    } else {\n      prjCoords = geometry._getPrjCoordinates();\n      prjCoords.push(prjPath);\n    }\n\n    var path = prjCoords.map(function (c) {\n      return projection.unproject(c);\n    });\n    geometry.setCoordinates(path);\n\n    geometry._setPrjCoordinates(prjCoords);\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n};\nDrawTool.registerMode('linestring', extend({\n  'action': ['click', 'mousemove', 'dblclick']\n}, lineStringHooks));\nDrawTool.registerMode('freeHandLinestring', extend({\n  'action': ['mousedown', 'mousemove', 'mouseup']\n}, lineStringHooks));\nDrawTool.registerMode('arccurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var arc = new ArcCurve(path);\n\n    arc._setPrjCoordinates(prjPath);\n\n    return arc;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('quadbeziercurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var curve = new QuadBezierCurve(path);\n\n    curve._setPrjCoordinates(prjPath);\n\n    return curve;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('cubicbeziercurve', {\n  'action': ['click', 'mousemove', 'dblclick'],\n  'create': function create(projection, prjPath) {\n    var path = prjPath.map(function (c) {\n      return projection.unproject(c);\n    });\n    var curve = new CubicBezierCurve(path);\n\n    curve._setPrjCoordinates(prjPath);\n\n    return curve;\n  },\n  'update': lineStringHooks.update,\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\nDrawTool.registerMode('boxZoom', {\n  'action': ['mousedown', 'mousemove', 'mouseup'],\n  'create': function create(projection, prjCoord) {\n    prjCoord = prjCoord[0];\n    var center = projection.unproject(prjCoord);\n    var marker = new Marker(center);\n    marker._firstClick = prjCoord;\n    return marker;\n  },\n  'update': function update(projection, prjCoord, geometry, param) {\n    var map = geometry.getMap();\n\n    var p1 = map._prjToContainerPoint(geometry._firstClick),\n        p2 = param['containerPoint'];\n\n    prjCoord = map._containerPointToPrj(new Coordinate(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)));\n    var center = projection.unproject(prjCoord);\n\n    geometry.setCoordinates(center)._setPrjCoordinates(prjCoord);\n\n    geometry.updateSymbol({\n      markerWidth: Math.abs(p1.x - p2.x),\n      markerHeight: Math.abs(p1.y - p2.y)\n    });\n  },\n  'generate': function generate(geometry) {\n    return geometry;\n  }\n});\n\nfunction parse(arcConf) {\n  var tileInfo = arcConf['tileInfo'],\n      tileSize = [tileInfo['cols'], tileInfo['rows']],\n      resolutions = [],\n      lods = tileInfo['lods'];\n\n  for (var i = 0, len = lods.length; i < len; i++) {\n    resolutions.push(lods[i]['resolution']);\n  }\n\n  var fullExtent = arcConf['fullExtent'],\n      origin = tileInfo['origin'],\n      tileSystem = [1, -1, origin['x'], origin['y']];\n  delete fullExtent['spatialReference'];\n  return {\n    'spatialReference': {\n      'resolutions': resolutions,\n      'fullExtent': fullExtent\n    },\n    'tileSystem': tileSystem,\n    'tileSize': tileSize\n  };\n}\n\nSpatialReference.loadArcgis = function (url, cb, options) {\n  if (options === void 0) {\n    options = {\n      'jsonp': true\n    };\n  }\n\n  if (isString(url) && url.substring(0, 1) !== '{') {\n    Ajax.getJSON(url, function (err, json) {\n      if (err) {\n        cb(err);\n        return;\n      }\n\n      var spatialRef = parse(json);\n      cb(null, spatialRef);\n    }, options);\n  } else {\n    if (isString(url)) {\n      url = parseJSON(url);\n    }\n\n    var spatialRef = parse(url);\n    cb(null, spatialRef);\n  }\n\n  return this;\n};\n\nvar options$j = {\n  'eventsPropagation': false,\n  'eventsToStop': null,\n  'dx': 0,\n  'dy': 0,\n  'autoPan': false,\n  'autoPanDuration': 600,\n  'single': true,\n  'animation': 'scale',\n  'animationOnHide': true,\n  'animationDuration': 500,\n  'pitchWithMap': false,\n  'rotateWithMap': false\n};\n\nvar UIComponent = function (_Eventable) {\n  _inheritsLoose(UIComponent, _Eventable);\n\n  function UIComponent(options) {\n    return _Eventable.call(this, options) || this;\n  }\n\n  var _proto = UIComponent.prototype;\n\n  _proto.addTo = function addTo(owner) {\n    this._owner = owner;\n\n    this._switchEvents('on');\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.fire('add');\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    if (!this._owner) {\n      return null;\n    }\n\n    if (this._owner.getBaseLayer) {\n      return this._owner;\n    }\n\n    return this._owner.getMap();\n  };\n\n  _proto.show = function show(coordinate) {\n    var map = this.getMap();\n\n    if (!map) {\n      return this;\n    }\n\n    if (!this._mapEventsOn) {\n      this._switchMapEvents('on');\n    }\n\n    coordinate = coordinate || this._coordinate || this._owner.getCenter();\n    var visible = this.isVisible();\n    this.fire('showstart');\n\n    var container = this._getUIContainer();\n\n    this._coordinate = coordinate;\n\n    this._removePrevDOM();\n\n    var dom = this.__uiDOM = this.buildOn(map);\n    dom['eventsPropagation'] = this.options['eventsPropagation'];\n\n    if (!dom) {\n      this.fire('showend');\n      return this;\n    }\n\n    this._measureSize(dom);\n\n    if (this._singleton()) {\n      map[this._uiDomKey()] = dom;\n    }\n\n    this._setPosition();\n\n    dom.style[TRANSITION] = null;\n    container.appendChild(dom);\n\n    var anim = this._getAnimation();\n\n    if (visible) {\n      anim.ok = false;\n    }\n\n    if (anim.ok) {\n      if (anim.fade) {\n        dom.style.opacity = 0;\n      }\n\n      if (anim.scale) {\n        if (this.getTransformOrigin) {\n          var origin = this.getTransformOrigin();\n          dom.style[TRANSFORMORIGIN] = origin;\n        }\n\n        dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n      }\n    }\n\n    dom.style.display = '';\n\n    if (this.options['eventsToStop']) {\n      on(dom, this.options['eventsToStop'], stopPropagation);\n    }\n\n    if (this.options['autoPan']) {\n      this._autoPan();\n    }\n\n    var transition = anim.transition;\n\n    if (anim.ok && transition) {\n      dom.offsetHeight;\n\n      if (transition) {\n        dom.style[TRANSITION] = transition;\n      }\n\n      if (anim.fade) {\n        dom.style.opacity = 1;\n      }\n\n      if (anim.scale) {\n        dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(1)';\n      }\n    }\n\n    this.fire('showend');\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    var _this = this;\n\n    if (!this.getDOM() || !this.getMap()) {\n      return this;\n    }\n\n    var anim = this._getAnimation(),\n        dom = this.getDOM();\n\n    if (!this.options['animationOnHide']) {\n      anim.ok = false;\n    }\n\n    if (!anim.ok) {\n      dom.style.display = 'none';\n      this.fire('hide');\n    } else {\n      dom.offsetHeight;\n      dom.style[TRANSITION] = anim.transition;\n      setTimeout(function () {\n        dom.style.display = 'none';\n\n        _this.fire('hide');\n      }, this.options['animationDuration']);\n    }\n\n    if (anim.fade) {\n      dom.style.opacity = 0;\n    }\n\n    if (anim.scale) {\n      dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n    }\n\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    var dom = this.getDOM();\n    return this.getMap() && dom && dom.parentNode && dom.style.display !== 'none';\n  };\n\n  _proto.remove = function remove() {\n    delete this._mapEventsOn;\n\n    if (!this._owner) {\n      return this;\n    }\n\n    this.hide();\n\n    this._switchEvents('off');\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    if (!this._singleton() && this.__uiDOM) {\n      this._removePrevDOM();\n    }\n\n    delete this._owner;\n    this.fire('remove');\n    return this;\n  };\n\n  _proto.getSize = function getSize() {\n    if (this._size) {\n      return this._size.copy();\n    } else {\n      return null;\n    }\n  };\n\n  _proto.getOwner = function getOwner() {\n    return this._owner;\n  };\n\n  _proto.getDOM = function getDOM() {\n    return this.__uiDOM;\n  };\n\n  _proto.getPosition = function getPosition() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var p = this._getViewPoint()._round();\n\n    if (this.getOffset) {\n      var o = this.getOffset()._round();\n\n      if (o) {\n        p._add(o);\n      }\n    }\n\n    return p;\n  };\n\n  _proto._getAnimation = function _getAnimation() {\n    var anim = {\n      'fade': false,\n      'scale': false\n    };\n    var animations = this.options['animation'] ? this.options['animation'].split(',') : [];\n\n    for (var i = 0; i < animations.length; i++) {\n      var trimed = trim(animations[i]);\n\n      if (trimed === 'fade') {\n        anim.fade = true;\n      } else if (trimed === 'scale') {\n        anim.scale = true;\n      }\n    }\n\n    var transition = null;\n\n    if (anim.fade) {\n      transition = 'opacity ' + this.options['animationDuration'] + 'ms';\n    }\n\n    if (anim.scale) {\n      transition = transition ? transition + ',' : '';\n      transition += TRANSFORM + ' ' + this.options['animationDuration'] + 'ms';\n    }\n\n    anim.transition = transition;\n    anim.ok = transition !== null;\n    return anim;\n  };\n\n  _proto._getViewPoint = function _getViewPoint() {\n    var alt = 0;\n\n    if (this._owner && this._owner.getAltitude) {\n      var altitude = this._owner.getAltitude();\n\n      if (altitude > 0) {\n        alt = this._meterToPoint(this._coordinate, altitude);\n      }\n    }\n\n    return this.getMap().coordToViewPoint(this._coordinate, undefined, alt)._add(this.options['dx'], this.options['dy']);\n  };\n\n  _proto._meterToPoint = function _meterToPoint(center, altitude) {\n    var map = this.getMap();\n    return map.distanceToPoint(altitude, 0, undefined, center).x * sign(altitude);\n  };\n\n  _proto._autoPan = function _autoPan() {\n    var map = this.getMap(),\n        dom = this.getDOM();\n\n    if (map.isMoving()) {\n      return;\n    }\n\n    var point = this._pos;\n    var mapSize = map.getSize(),\n        mapWidth = mapSize['width'],\n        mapHeight = mapSize['height'];\n    var containerPoint = map.viewPointToContainerPoint(point);\n    var clientWidth = parseInt(dom.clientWidth),\n        clientHeight = parseInt(dom.clientHeight);\n    var left = 0,\n        top = 0;\n\n    if (containerPoint.x < 0) {\n      left = -(containerPoint.x - clientWidth / 2);\n    } else if (containerPoint.x + clientWidth - 35 > mapWidth) {\n      left = mapWidth - (containerPoint.x + clientWidth * 3 / 2);\n    }\n\n    if (containerPoint.y - clientHeight < 0) {\n      top = -(containerPoint.y - clientHeight) + 50;\n    } else if (containerPoint.y > mapHeight) {\n      top = mapHeight - containerPoint.y - clientHeight - 30;\n    }\n\n    if (top !== 0 || left !== 0) {\n      map.panBy(new Point(left, top), {\n        'duration': this.options['autoPanDuration']\n      });\n    }\n  };\n\n  _proto._measureSize = function _measureSize(dom) {\n    var container = this._getUIContainer();\n\n    dom.style.position = 'absolute';\n    dom.style.left = -99999 + 'px';\n    var anchor = dom.style.bottom ? 'bottom' : 'top';\n    dom.style[anchor] = -99999 + 'px';\n    dom.style.display = '';\n    container.appendChild(dom);\n    this._size = new Size(dom.clientWidth, dom.clientHeight);\n    dom.style.display = 'none';\n    dom.style.left = '0px';\n    dom.style[anchor] = '0px';\n    return this._size;\n  };\n\n  _proto._removePrevDOM = function _removePrevDOM() {\n    if (this.onDomRemove) {\n      this.onDomRemove();\n    }\n\n    var eventsToStop = this.options['eventsToStop'];\n\n    if (this._singleton()) {\n      var map = this.getMap(),\n          key = this._uiDomKey();\n\n      if (map[key]) {\n        if (eventsToStop) {\n          off(map[key], eventsToStop, stopPropagation);\n        }\n\n        removeDomNode(map[key]);\n        delete map[key];\n      }\n\n      delete this.__uiDOM;\n    } else if (this.__uiDOM) {\n      if (eventsToStop) {\n        off(this.__uiDOM, eventsToStop, stopPropagation);\n      }\n\n      removeDomNode(this.__uiDOM);\n      delete this.__uiDOM;\n    }\n  };\n\n  _proto._uiDomKey = function _uiDomKey() {\n    return '__ui_' + this._getClassName();\n  };\n\n  _proto._singleton = function _singleton() {\n    return this.options['single'];\n  };\n\n  _proto._getUIContainer = function _getUIContainer() {\n    return this.getMap()._panels['ui'];\n  };\n\n  _proto._getClassName = function _getClassName() {\n    return 'UIComponent';\n  };\n\n  _proto._switchMapEvents = function _switchMapEvents(to) {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    this._mapEventsOn = to === 'on';\n\n    var events = this._getDefaultEvents();\n\n    if (this.getEvents) {\n      extend(events, this.getEvents());\n    }\n\n    if (events) {\n      for (var p in events) {\n        if (events.hasOwnProperty(p)) {\n          map[to](p, events[p], this);\n        }\n      }\n    }\n  };\n\n  _proto._switchEvents = function _switchEvents(to) {\n    this._switchMapEvents(to);\n\n    var ownerEvents = this._getOwnerEvents();\n\n    if (this._owner) {\n      for (var p in ownerEvents) {\n        if (ownerEvents.hasOwnProperty(p)) {\n          this._owner[to](p, ownerEvents[p], this);\n        }\n      }\n    }\n  };\n\n  _proto._getDefaultEvents = function _getDefaultEvents() {\n    return {\n      'zooming rotate pitch': this.onEvent,\n      'zoomend': this.onZoomEnd,\n      'moving': this.onMoving\n    };\n  };\n\n  _proto._getOwnerEvents = function _getOwnerEvents() {\n    var events = {};\n\n    if (this._owner && this._owner instanceof Geometry) {\n      events.positionchange = this.onGeometryPositionChange;\n    }\n\n    if (this.getOwnerEvents) {\n      extend(events, this.getOwnerEvents());\n    }\n\n    return events;\n  };\n\n  _proto.onGeometryPositionChange = function onGeometryPositionChange(param) {\n    if (this._owner && this.isVisible()) {\n      this.show(param['target'].getCenter());\n    }\n  };\n\n  _proto.onMoving = function onMoving() {\n    if (this.isVisible() && this.getMap().isTransforming()) {\n      this._updatePosition();\n    }\n  };\n\n  _proto.onEvent = function onEvent() {\n    if (this.isVisible()) {\n      this._updatePosition();\n    }\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    if (this.isVisible()) {\n      this._setPosition();\n    }\n  };\n\n  _proto._updatePosition = function _updatePosition() {\n    var renderer = this.getMap()._getRenderer();\n\n    renderer.callInNextFrame(this._setPosition.bind(this));\n  };\n\n  _proto._setPosition = function _setPosition() {\n    var dom = this.getDOM();\n    if (!dom) return;\n    dom.style[TRANSITION] = null;\n    var p = this.getPosition();\n    this._pos = p;\n    dom.style[TRANSFORM] = this._toCSSTranslate(p) + ' scale(1)';\n  };\n\n  _proto._toCSSTranslate = function _toCSSTranslate(p) {\n    if (!p) {\n      return '';\n    }\n\n    if (Browser$1.any3d) {\n      var map = this.getMap(),\n          bearing = map ? map.getBearing() : 0,\n          pitch = map ? map.getPitch() : 0;\n      var r = '';\n\n      if (this.options['pitchWithMap'] && pitch) {\n        r += \" rotateX(\" + Math.round(pitch) + \"deg)\";\n      }\n\n      if (this.options['rotateWithMap'] && bearing) {\n        r += \" rotateZ(\" + Math.round(-bearing) + \"deg)\";\n      }\n\n      return 'translate3d(' + p.x + 'px,' + p.y + 'px, 0px)' + r;\n    } else {\n      return 'translate(' + p.x + 'px,' + p.y + 'px)';\n    }\n  };\n\n  UIComponent.isSupport = function isSupport(owner) {\n    if (owner && isFunction(owner.on) && isFunction(owner.off) && isFunction(owner.getCenter)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return UIComponent;\n}(Eventable(Class));\n\nUIComponent.mergeOptions(options$j);\n\nvar options$k = {\n  'containerClass': null,\n  'eventsPropagation': true,\n  'draggable': false,\n  'single': false,\n  'content': null\n};\nvar domEvents = 'mousedown ' + 'mouseup ' + 'mouseenter ' + 'mouseover ' + 'mouseout ' + 'mousemove ' + 'click ' + 'dblclick ' + 'contextmenu ' + 'keypress ' + 'touchstart ' + 'touchmove ' + 'touchend';\n\nvar UIMarker = function (_Handlerable) {\n  _inheritsLoose(UIMarker, _Handlerable);\n\n  function UIMarker(coordinate, options) {\n    var _this;\n\n    _this = _Handlerable.call(this, options) || this;\n    _this._markerCoord = new Coordinate(coordinate);\n    return _this;\n  }\n\n  var _proto = UIMarker.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'UIMarker';\n  };\n\n  _proto.setCoordinates = function setCoordinates(coordinates) {\n    this._markerCoord = coordinates;\n    this.fire('positionchange');\n\n    if (this.isVisible()) {\n      this._coordinate = this._markerCoord;\n\n      this._setPosition();\n    }\n\n    return this;\n  };\n\n  _proto.getCoordinates = function getCoordinates() {\n    return this._markerCoord;\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.show();\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto.onAdd = function onAdd() {\n    this.show();\n  };\n\n  _proto.show = function show() {\n    return _Handlerable.prototype.show.call(this, this._markerCoord);\n  };\n\n  _proto.flash = function flash$$1(interval, count, cb, context) {\n    return flash.call(this, interval, count, cb, context);\n  };\n\n  _proto.buildOn = function buildOn() {\n    var dom;\n\n    if (isString(this.options['content'])) {\n      dom = createEl('div');\n      dom.innerHTML = this.options['content'];\n    } else {\n      dom = this.options['content'];\n    }\n\n    if (this.options['containerClass']) {\n      dom.className = this.options['containerClass'];\n    }\n\n    this._registerDOMEvents(dom);\n\n    return dom;\n  };\n\n  _proto.getOffset = function getOffset() {\n    var size = this.getSize();\n    return new Point(-size.width / 2, -size.height / 2);\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    return 'center center';\n  };\n\n  _proto.onDomRemove = function onDomRemove() {\n    var dom = this.getDOM();\n\n    this._removeDOMEvents(dom);\n  };\n\n  _proto.isDragging = function isDragging() {\n    if (this['draggable']) {\n      return this['draggable'].isDragging();\n    }\n\n    return false;\n  };\n\n  _proto._registerDOMEvents = function _registerDOMEvents(dom) {\n    on(dom, domEvents, this._onDomEvents, this);\n  };\n\n  _proto._onDomEvents = function _onDomEvents(e) {\n    var event = this.getMap()._parseEvent(e, e.type);\n\n    this.fire(e.type, event);\n  };\n\n  _proto._removeDOMEvents = function _removeDOMEvents(dom) {\n    off(dom, domEvents, this._onDomEvents, this);\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var map = this.getMap();\n    var containerPoint = map.coordToContainerPoint(this.getCoordinates());\n    var size = this.getSize(),\n        width = size.width,\n        height = size.height;\n    var anchors = [map.containerPointToCoordinate(containerPoint.add(-width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(0, height / 2)), map.containerPointToCoordinate(containerPoint.add(0, -height / 2))];\n    return anchors;\n  };\n\n  return UIMarker;\n}(Handlerable(UIComponent));\n\nUIMarker.mergeOptions(options$k);\nvar EVENTS$1 = Browser$1.touch ? 'touchstart mousedown' : 'mousedown';\n\nvar UIMarkerDragHandler = function (_Handler) {\n  _inheritsLoose(UIMarkerDragHandler, _Handler);\n\n  function UIMarkerDragHandler(target) {\n    return _Handler.call(this, target) || this;\n  }\n\n  var _proto2 = UIMarkerDragHandler.prototype;\n\n  _proto2.addHooks = function addHooks() {\n    this.target.on(EVENTS$1, this._startDrag, this);\n  };\n\n  _proto2.removeHooks = function removeHooks() {\n    this.target.off(EVENTS$1, this._startDrag, this);\n  };\n\n  _proto2._startDrag = function _startDrag(param) {\n    var domEvent = param['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n      return;\n    }\n\n    if (this.isDragging()) {\n      return;\n    }\n\n    this.target.on('click', this._endDrag, this);\n    this._lastCoord = param['coordinate'];\n    this._lastPoint = param['containerPoint'];\n\n    this._prepareDragHandler();\n\n    this._dragHandler.onMouseDown(param['domEvent']);\n\n    this.target.fire('dragstart', param);\n  };\n\n  _proto2._prepareDragHandler = function _prepareDragHandler() {\n    this._dragHandler = new DragHandler(this.target.getDOM(), {\n      'cancelOn': this._cancelOn.bind(this),\n      'ignoreMouseleave': true\n    });\n\n    this._dragHandler.on('mousedown', this._onMouseDown, this);\n\n    this._dragHandler.on('dragging', this._dragging, this);\n\n    this._dragHandler.on('mouseup', this._endDrag, this);\n\n    this._dragHandler.enable();\n  };\n\n  _proto2._cancelOn = function _cancelOn(domEvent) {\n    var target = domEvent.srcElement || domEvent.target,\n        tagName = target.tagName.toLowerCase();\n\n    if (tagName === 'button' || tagName === 'input' || tagName === 'select' || tagName === 'option' || tagName === 'textarea') {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto2._onMouseDown = function _onMouseDown(param) {\n    stopPropagation(param['domEvent']);\n  };\n\n  _proto2._dragging = function _dragging(param) {\n    var target = this.target,\n        map = target.getMap(),\n        eventParam = map._parseEvent(param['domEvent']),\n        domEvent = eventParam['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1) {\n      return;\n    }\n\n    if (!this._isDragging) {\n      this._isDragging = true;\n      return;\n    }\n\n    var coord = eventParam['coordinate'],\n        point = eventParam['containerPoint'];\n\n    if (!this._lastCoord) {\n      this._lastCoord = coord;\n    }\n\n    if (!this._lastPoint) {\n      this._lastPoint = point;\n    }\n\n    var coordOffset = coord.sub(this._lastCoord),\n        pointOffset = point.sub(this._lastPoint);\n    this._lastCoord = coord;\n    this._lastPoint = point;\n    this.target.setCoordinates(this.target.getCoordinates().add(coordOffset));\n    eventParam['coordOffset'] = coordOffset;\n    eventParam['pointOffset'] = pointOffset;\n    target.fire('dragging', eventParam);\n  };\n\n  _proto2._endDrag = function _endDrag(param) {\n    var target = this.target,\n        map = target.getMap();\n\n    if (this._dragHandler) {\n      target.off('click', this._endDrag, this);\n\n      this._dragHandler.disable();\n\n      delete this._dragHandler;\n    }\n\n    delete this._lastCoord;\n    delete this._lastPoint;\n    this._isDragging = false;\n\n    if (!map) {\n      return;\n    }\n\n    var eventParam = map._parseEvent(param['domEvent']);\n\n    target.fire('dragend', eventParam);\n  };\n\n  _proto2.isDragging = function isDragging() {\n    if (!this._isDragging) {\n      return false;\n    }\n\n    return true;\n  };\n\n  return UIMarkerDragHandler;\n}(Handler$1);\n\nUIMarker.addInitHook('addHandler', 'draggable', UIMarkerDragHandler);\n\nvar options$l = {\n  'containerClass': 'maptalks-msgBox',\n  'autoPan': true,\n  'autoCloseOn': null,\n  'autoOpenOn': 'click',\n  'width': 300,\n  'minHeight': 120,\n  'custom': false,\n  'title': null,\n  'content': null\n};\n\nvar InfoWindow = function (_UIComponent) {\n  _inheritsLoose(InfoWindow, _UIComponent);\n\n  function InfoWindow() {\n    return _UIComponent.apply(this, arguments) || this;\n  }\n\n  var _proto = InfoWindow.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'InfoWindow';\n  };\n\n  _proto.addTo = function addTo(owner) {\n    if (owner instanceof Geometry) {\n      if (owner.getInfoWindow() && owner.getInfoWindow() !== this) {\n        owner.removeInfoWindow();\n      }\n\n      owner._infoWindow = this;\n    }\n\n    return _UIComponent.prototype.addTo.call(this, owner);\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.show(this._coordinate);\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto.setTitle = function setTitle(title) {\n    var old = title;\n    this.options['title'] = title;\n    this.fire('contentchange', {\n      'old': old,\n      'new': title\n    });\n\n    if (this.isVisible()) {\n      this.show(this._coordinate);\n    }\n\n    return this;\n  };\n\n  _proto.getTitle = function getTitle() {\n    return this.options['title'];\n  };\n\n  _proto.buildOn = function buildOn() {\n    if (this.options['custom']) {\n      if (isString(this.options['content'])) {\n        var _dom = createEl('div');\n\n        _dom.innerHTML = this.options['content'];\n        return _dom;\n      } else {\n        return this.options['content'];\n      }\n    }\n\n    var dom = createEl('div');\n\n    if (this.options['containerClass']) {\n      dom.className = this.options['containerClass'];\n    }\n\n    dom.style.width = this._getWindowWidth() + 'px';\n    dom.style.bottom = '0px';\n    var content = '<em class=\"maptalks-ico\"></em>';\n\n    if (this.options['title']) {\n      content += '<h2>' + this.options['title'] + '</h2>';\n    }\n\n    content += '<a href=\"javascript:void(0);\" class=\"maptalks-close\"></a><div class=\"maptalks-msgContent\"></div>';\n    dom.innerHTML = content;\n    var msgContent = dom.querySelector('.maptalks-msgContent');\n\n    if (isString(this.options['content'])) {\n      msgContent.innerHTML = this.options['content'];\n    } else {\n      msgContent.appendChild(this.options['content']);\n    }\n\n    this._onCloseBtnClick = this.hide.bind(this);\n    var closeBtn = dom.querySelector('.maptalks-close');\n    addDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n    return dom;\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    var size = this.getSize();\n    return size.width / 2 + 'px bottom';\n  };\n\n  _proto.getOffset = function getOffset() {\n    var size = this.getSize();\n    var o = new Point(-size['width'] / 2, 0);\n\n    if (!this.options['custom']) {\n      o._sub(4, 12);\n    } else {\n      o._sub(0, size['height']);\n    }\n\n    var owner = this.getOwner();\n\n    if (owner instanceof Marker || owner instanceof MultiPoint) {\n      var painter, markerSize;\n\n      if (owner instanceof Marker) {\n        painter = owner._getPainter();\n        markerSize = owner.getSize();\n      } else {\n        var children = owner.getGeometries();\n\n        if (!children || !children.length) {\n          return o;\n        }\n\n        painter = children[0]._getPainter();\n        markerSize = children[0].getSize();\n      }\n\n      if (painter) {\n        var fixExtent = painter.getFixedExtent();\n\n        o._add(fixExtent.xmax - markerSize.width / 2, fixExtent.ymin);\n      }\n    }\n\n    return o;\n  };\n\n  _proto.show = function show(coordinate) {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (!this.getMap().options['enableInfoWindow']) {\n      return this;\n    }\n\n    return _UIComponent.prototype.show.call(this, coordinate);\n  };\n\n  _proto.getEvents = function getEvents() {\n    if (!this.options['autoCloseOn']) {\n      return null;\n    }\n\n    var events = {};\n    events[this.options['autoCloseOn']] = this.hide;\n    return events;\n  };\n\n  _proto.getOwnerEvents = function getOwnerEvents() {\n    var owner = this.getOwner();\n\n    if (!this.options['autoOpenOn'] || !owner) {\n      return null;\n    }\n\n    var events = {};\n    events[this.options['autoOpenOn']] = this._onAutoOpen;\n    return events;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.onDomRemove();\n  };\n\n  _proto.onDomRemove = function onDomRemove() {\n    if (this._onCloseBtnClick) {\n      var dom = this.getDOM();\n      var closeBtn = dom.childNodes[2];\n      removeDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n      delete this._onCloseBtnClick;\n    }\n  };\n\n  _proto._onAutoOpen = function _onAutoOpen(e) {\n    var _this = this;\n\n    var owner = this.getOwner();\n    setTimeout(function () {\n      if (owner instanceof Marker || owner instanceof UIComponent) {\n        _this.show(owner.getCoordinates());\n      } else if (owner instanceof MultiPoint) {\n        _this.show(owner.findClosest(e.coordinate));\n      } else {\n        _this.show(e.coordinate);\n      }\n    }, 1);\n  };\n\n  _proto._getWindowWidth = function _getWindowWidth() {\n    var defaultWidth = 300;\n    var width = this.options['width'];\n\n    if (!width) {\n      width = defaultWidth;\n    }\n\n    return width;\n  };\n\n  return InfoWindow;\n}(UIComponent);\n\nInfoWindow.mergeOptions(options$l);\n\nvar options$m = {\n  'width': 0,\n  'height': 0,\n  'animation': 'fade',\n  'containerClass': 'maptalks-tooltip',\n  'showTimeout': 400\n};\n\nvar ToolTip = function (_UIComponent) {\n  _inheritsLoose(ToolTip, _UIComponent);\n\n  var _proto = ToolTip.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'ToolTip';\n  };\n\n  function ToolTip(content, options) {\n    var _this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    _this = _UIComponent.call(this, options) || this;\n    _this._content = content;\n    return _this;\n  }\n\n  _proto.addTo = function addTo(owner) {\n    if (ToolTip.isSupport(owner)) {\n      owner.on('mousemove', this.onMouseMove, this);\n      owner.on('mouseout', this.onMouseOut, this);\n      return _UIComponent.prototype.addTo.call(this, owner);\n    } else {\n      throw new Error('Invalid geometry or UIMarker the tooltip is added to.');\n    }\n  };\n\n  _proto.setStyle = function setStyle$$1(cssName) {\n    this.options.containerClass = cssName;\n    return this;\n  };\n\n  _proto.getStyle = function getStyle() {\n    return this.options.containerClass;\n  };\n\n  _proto.getContent = function getContent() {\n    return this._content;\n  };\n\n  _proto.buildOn = function buildOn() {\n    var dom = createEl('div');\n    var options = this.options || {};\n\n    if (options.height) {\n      dom.style.height = options.height + 'px';\n    }\n\n    if (options.width) {\n      dom.style.width = options.width + 'px';\n    }\n\n    var cssName = options.containerClass || options.cssName;\n\n    if (!cssName && options.height) {\n      dom.style.lineHeight = options.height + 'px';\n    }\n\n    dom.innerHTML = \"<div class=\\\"\" + cssName + \"\\\">\" + this._content + \"</div>\";\n    return dom;\n  };\n\n  _proto.onMouseOut = function onMouseOut() {\n    clearTimeout(this._timeout);\n\n    if (this.isVisible()) {\n      this._removePrevDOM();\n    }\n  };\n\n  _proto.onMouseMove = function onMouseMove(e) {\n    var _this2 = this;\n\n    clearTimeout(this._timeout);\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var coord = map.locateByPoint(e.coordinate, -5, 25);\n\n    if (this.options['showTimeout'] === 0) {\n      this.show(coord);\n    } else {\n      this._timeout = setTimeout(function () {\n        if (map) {\n          _this2.show(coord);\n        }\n      }, this.options['showTimeout']);\n    }\n  };\n\n  _proto.onRemove = function onRemove() {\n    clearTimeout(this._timeout);\n\n    if (this._owner) {\n      this._owner.off('mouseover', this.onMouseOver, this);\n\n      this._owner.off('mouseout', this.onMouseOut, this);\n    }\n  };\n\n  return ToolTip;\n}(UIComponent);\n\nToolTip.mergeOptions(options$m);\n\nvar defaultOptions = {\n  'containerClass': 'maptalks-menu',\n  'animation': null,\n  'animationDelay': 10,\n  'animationOnHide': false,\n  'autoPan': false,\n  'width': 160,\n  'maxHeight': 0,\n  'custom': false,\n  'items': []\n};\n\nvar Menu = function (_UIComponent) {\n  _inheritsLoose(Menu, _UIComponent);\n\n  function Menu(options) {\n    return _UIComponent.call(this, options) || this;\n  }\n\n  var _proto = Menu.prototype;\n\n  _proto._getClassName = function _getClassName() {\n    return 'Menu';\n  };\n\n  _proto.addTo = function addTo(owner) {\n    if (owner._menu && owner._menu !== this) {\n      owner.removeMenu();\n    }\n\n    owner._menu = this;\n    return UIComponent.prototype.addTo.apply(this, arguments);\n  };\n\n  _proto.setItems = function setItems(items) {\n    this.options['items'] = items;\n    return this;\n  };\n\n  _proto.getItems = function getItems() {\n    return this.options['items'] || [];\n  };\n\n  _proto.buildOn = function buildOn() {\n    if (this.options['custom']) {\n      if (isString(this.options['items'])) {\n        var container = createEl('div');\n        container.innerHTML = this.options['items'];\n        return container;\n      } else {\n        return this.options['items'];\n      }\n    } else {\n      var dom = createEl('div');\n\n      if (this.options['containerClass']) {\n        addClass(dom, this.options['containerClass']);\n      }\n\n      dom.style.width = this._getMenuWidth() + 'px';\n\n      var menuItems = this._createMenuItemDom();\n\n      dom.appendChild(menuItems);\n      on(dom, 'contextmenu', preventDefault);\n      return dom;\n    }\n  };\n\n  _proto.getOffset = function getOffset() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var mapSize = this.getMap().getSize(),\n        p = this.getMap().viewPointToContainerPoint(this._getViewPoint()),\n        size = this.getSize();\n    var dx = 0,\n        dy = 0;\n\n    if (p.x + size['width'] > mapSize['width']) {\n      dx = -size['width'];\n    }\n\n    if (p.y + size['height'] > mapSize['height']) {\n      dy = -size['height'];\n    }\n\n    return new Point(dx, dy);\n  };\n\n  _proto.getTransformOrigin = function getTransformOrigin() {\n    var p = this.getOffset()._multi(-1);\n\n    return p.x + 'px ' + p.y + 'px';\n  };\n\n  _proto.getEvents = function getEvents() {\n    return {\n      '_zoomstart _zoomend _movestart _dblclick _click': this._removePrevDOM\n    };\n  };\n\n  _proto._createMenuItemDom = function _createMenuItemDom() {\n    var me = this;\n    var map = this.getMap();\n    var ul = createEl('ul');\n    addClass(ul, 'maptalks-menu-items');\n    var items = this.getItems();\n\n    function onMenuClick(index) {\n      return function (e) {\n        var param = map._parseEvent(e, 'click');\n\n        param['target'] = me;\n        param['owner'] = me._owner;\n        param['index'] = index;\n\n        var result = this._callback(param);\n\n        if (result === false) {\n          return;\n        }\n\n        me.hide();\n      };\n    }\n\n    var item, itemDOM;\n\n    for (var i = 0, len = items.length; i < len; i++) {\n      item = items[i];\n\n      if (item === '-' || item === '_') {\n        itemDOM = createEl('li');\n        addClass(itemDOM, 'maptalks-menu-splitter');\n      } else {\n        itemDOM = createEl('li');\n        var itemTitle = item['item'];\n\n        if (isFunction(itemTitle)) {\n          itemTitle = itemTitle({\n            'owner': this._owner,\n            'index': i\n          });\n        }\n\n        itemDOM.innerHTML = itemTitle;\n        itemDOM._callback = item['click'];\n        on(itemDOM, 'click', onMenuClick(i));\n      }\n\n      ul.appendChild(itemDOM);\n    }\n\n    var maxHeight = this.options['maxHeight'] || 0;\n\n    if (maxHeight > 0) {\n      setStyle(ul, 'max-height: ' + maxHeight + 'px; overflow-y: auto;');\n    }\n\n    return ul;\n  };\n\n  _proto._getMenuWidth = function _getMenuWidth() {\n    var defaultWidth = 160;\n    var width = this.options['width'] || defaultWidth;\n    return width;\n  };\n\n  return Menu;\n}(UIComponent);\n\nMenu.mergeOptions(defaultOptions);\n\nvar Menuable = {\n  setMenu: function setMenu(options) {\n    this._menuOptions = options;\n\n    if (this._menu) {\n      this._menu.setOptions(options);\n    } else {\n      this.on('contextmenu', this._defaultOpenMenu, this);\n    }\n\n    return this;\n  },\n  openMenu: function openMenu(coordinate) {\n    var map = this instanceof Map$1 ? this : this.getMap();\n\n    if (!coordinate) {\n      coordinate = this.getCenter();\n    }\n\n    if (!this._menu) {\n      if (this._menuOptions && map) {\n        this._bindMenu(this._menuOptions);\n\n        this._menu.show(coordinate);\n      }\n    } else {\n      this._menu.show(coordinate);\n    }\n\n    return this;\n  },\n  setMenuItems: function setMenuItems(items) {\n    if (!this._menuOptions) {\n      this._menuOptions = {};\n    }\n\n    if (Array.isArray(items)) {\n      this._menuOptions['custom'] = false;\n    }\n\n    this._menuOptions['items'] = items;\n    this.setMenu(this._menuOptions);\n    return this;\n  },\n  getMenuItems: function getMenuItems() {\n    if (this._menu) {\n      return this._menu.getItems();\n    } else if (this._menuOptions) {\n      return this._menuOptions['items'] || [];\n    }\n\n    return [];\n  },\n  closeMenu: function closeMenu() {\n    if (this._menu) {\n      this._menu.hide();\n    }\n\n    return this;\n  },\n  removeMenu: function removeMenu() {\n    this.off('contextmenu', this._defaultOpenMenu, this);\n\n    this._unbindMenu();\n\n    delete this._menuOptions;\n    return this;\n  },\n  _bindMenu: function _bindMenu(options) {\n    this._menu = new Menu(options);\n\n    this._menu.addTo(this);\n\n    return this;\n  },\n  _unbindMenu: function _unbindMenu() {\n    if (this._menu) {\n      this.closeMenu();\n\n      this._menu.remove();\n\n      delete this._menu;\n    }\n\n    return this;\n  },\n  _defaultOpenMenu: function _defaultOpenMenu(param) {\n    if (this.listens('contextmenu') > 1) {\n      return true;\n    } else {\n      this.openMenu(param['coordinate']);\n      return false;\n    }\n  }\n};\nMap$1.include(Menuable);\nGeometry.include(Menuable);\n\n\n\nvar index$4 = /*#__PURE__*/Object.freeze({\n  UIComponent: UIComponent,\n  UIMarker: UIMarker,\n  InfoWindow: InfoWindow,\n  ToolTip: ToolTip,\n  Menuable: Menuable,\n  Menu: Menu\n});\n\nvar Control = function (_Eventable) {\n  _inheritsLoose(Control, _Eventable);\n\n  function Control(options) {\n    if (options && options['position'] && !isString(options['position'])) {\n      options['position'] = extend({}, options['position']);\n    }\n\n    return _Eventable.call(this, options) || this;\n  }\n\n  var _proto = Control.prototype;\n\n  _proto.addTo = function addTo(map) {\n    this.remove();\n\n    if (!map.options['control']) {\n      return this;\n    }\n\n    this._map = map;\n    var controlContainer = map._panels.control;\n    this.__ctrlContainer = createEl('div');\n    setStyle(this.__ctrlContainer, 'position:absolute;overflow:visible;');\n    this.update();\n    controlContainer.appendChild(this.__ctrlContainer);\n\n    if (this.onAdd) {\n      this.onAdd();\n    }\n\n    this.fire('add', {\n      'dom': controlContainer\n    });\n    return this;\n  };\n\n  _proto.update = function update() {\n    this.__ctrlContainer.innerHTML = '';\n    this._controlDom = this.buildOn(this.getMap());\n\n    if (this._controlDom) {\n      this._updatePosition();\n\n      this.__ctrlContainer.appendChild(this._controlDom);\n    }\n\n    return this;\n  };\n\n  _proto.getMap = function getMap() {\n    return this._map;\n  };\n\n  _proto.getPosition = function getPosition() {\n    return extend({}, this._parse(this.options['position']));\n  };\n\n  _proto.setPosition = function setPosition(position) {\n    if (isString(position)) {\n      this.options['position'] = position;\n    } else {\n      this.options['position'] = extend({}, position);\n    }\n\n    this._updatePosition();\n\n    return this;\n  };\n\n  _proto.getContainerPoint = function getContainerPoint() {\n    var position = this.getPosition();\n    var size = this.getMap().getSize();\n    var x, y;\n\n    if (!isNil(position['left'])) {\n      x = parseInt(position['left']);\n    } else if (!isNil(position['right'])) {\n      x = size['width'] - parseInt(position['right']);\n    }\n\n    if (!isNil(position['top'])) {\n      y = parseInt(position['top']);\n    } else if (!isNil(position['bottom'])) {\n      y = size['height'] - parseInt(position['bottom']);\n    }\n\n    return new Point(x, y);\n  };\n\n  _proto.getContainer = function getContainer() {\n    return this.__ctrlContainer;\n  };\n\n  _proto.getDOM = function getDOM() {\n    return this._controlDom;\n  };\n\n  _proto.show = function show() {\n    this.__ctrlContainer.style.display = '';\n    return this;\n  };\n\n  _proto.hide = function hide() {\n    this.__ctrlContainer.style.display = 'none';\n    return this;\n  };\n\n  _proto.isVisible = function isVisible() {\n    return this.__ctrlContainer && this.__ctrlContainer.style.display === '';\n  };\n\n  _proto.remove = function remove() {\n    if (!this._map) {\n      return this;\n    }\n\n    removeDomNode(this.__ctrlContainer);\n\n    if (this.onRemove) {\n      this.onRemove();\n    }\n\n    delete this._map;\n    delete this.__ctrlContainer;\n    delete this._controlDom;\n    this.fire('remove');\n    return this;\n  };\n\n  _proto._parse = function _parse(position) {\n    var p = position;\n\n    if (isString(position)) {\n      p = Control['positions'][p];\n    }\n\n    return p;\n  };\n\n  _proto._updatePosition = function _updatePosition() {\n    var position = this.getPosition();\n\n    if (!position) {\n      position = {\n        'top': 20,\n        'left': 20\n      };\n    }\n\n    for (var p in position) {\n      if (position.hasOwnProperty(p)) {\n        position[p] = parseInt(position[p]);\n        this.__ctrlContainer.style[p] = position[p] + 'px';\n      }\n    }\n\n    this.fire('positionchange', {\n      'position': extend({}, position)\n    });\n  };\n\n  return Control;\n}(Eventable(Class));\n\nControl.positions = {\n  'top-left': {\n    'top': 20,\n    'left': 20\n  },\n  'top-right': {\n    'top': 20,\n    'right': 20\n  },\n  'bottom-left': {\n    'bottom': 20,\n    'left': 20\n  },\n  'bottom-right': {\n    'bottom': 20,\n    'right': 20\n  }\n};\nMap$1.mergeOptions({\n  'control': true\n});\nMap$1.include({\n  addControl: function addControl(control) {\n    if (this._containerDOM.getContext) {\n      return this;\n    }\n\n    control.addTo(this);\n    return this;\n  },\n  removeControl: function removeControl(control) {\n    if (!control || control.getMap() !== this) {\n      return this;\n    }\n\n    control.remove();\n    return this;\n  }\n});\n\nvar options$n = {\n  'position': {\n    'bottom': 0,\n    'left': 0\n  },\n  'content': '<a href=\"http://maptalks.org\" target=\"_blank\">maptalks</a>'\n};\nvar layerEvents = 'addlayer removelayer setbaselayer baselayerremove';\n\nvar Attribution = function (_Control) {\n  _inheritsLoose(Attribution, _Control);\n\n  function Attribution() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Attribution.prototype;\n\n  _proto.buildOn = function buildOn() {\n    this._attributionContainer = createEl('div');\n    this._attributionContainer.className = 'maptalks-attribution';\n\n    this._update();\n\n    return this._attributionContainer;\n  };\n\n  _proto.onAdd = function onAdd() {\n    this.getMap().on(layerEvents, this._update, this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off(layerEvents, this._update, this);\n  };\n\n  _proto._update = function _update() {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var attributions = map._getLayers(function (layer) {\n      return layer.options['attribution'];\n    }).reverse().map(function (layer) {\n      return layer.options['attribution'];\n    });\n\n    var content = this.options['content'] + (attributions.length > 0 ? ' - ' + attributions.join(', ') : '');\n    this._attributionContainer.innerHTML = '<span style=\"padding:0px 4px\">' + content + '</span>';\n  };\n\n  return Attribution;\n}(Control);\n\nAttribution.mergeOptions(options$n);\nMap$1.mergeOptions({\n  'attribution': true\n});\nMap$1.addOnLoadHook(function () {\n  var a = this.options['attribution'] || this.options['attributionControl'];\n\n  if (a) {\n    this.attributionControl = new Attribution(a);\n    this.addControl(this.attributionControl);\n  }\n});\n\nvar options$o = {\n  'position': 'top-right',\n  'baseTitle': 'Base Layers',\n  'overlayTitle': 'Layers',\n  'excludeLayers': [],\n  'containerClass': 'maptalks-layer-switcher'\n};\n\nvar LayerSwitcher = function (_Control) {\n  _inheritsLoose(LayerSwitcher, _Control);\n\n  function LayerSwitcher() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = LayerSwitcher.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var container = this.container = createEl('div', this.options['containerClass']),\n        panel = this.panel = createEl('div', 'panel'),\n        button = this.button = createEl('button');\n    container.appendChild(button);\n    container.appendChild(panel);\n    return container;\n  };\n\n  _proto.onAdd = function onAdd() {\n    on(this.button, 'mouseover', this._show, this);\n    on(this.panel, 'mouseleave', this._hide, this);\n    on(this.getMap(), 'click', this._hide, this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    if (this.panel) {\n      off(this.button, 'mouseover', this._show, this);\n      off(this.panel, 'mouseleave', this._hide, this);\n      off(this.getMap(), 'click', this._hide, this);\n      removeDomNode(this.panel);\n      removeDomNode(this.button);\n      delete this.panel;\n      delete this.button;\n      delete this.container;\n    }\n  };\n\n  _proto._show = function _show() {\n    if (!hasClass(this.container, 'shown')) {\n      addClass(this.container, 'shown');\n\n      this._createPanel();\n    }\n  };\n\n  _proto._hide = function _hide(e) {\n    if (!this.panel.contains(e.toElement || e.relatedTarget)) {\n      setClass(this.container, this.options['containerClass']);\n    }\n  };\n\n  _proto._createPanel = function _createPanel() {\n    this.panel.innerHTML = '';\n    var ul = createEl('ul');\n    this.panel.appendChild(ul);\n\n    this._renderLayers(this.getMap(), ul);\n  };\n\n  _proto._renderLayers = function _renderLayers(map, elm) {\n    var base = map.getBaseLayer(),\n        layers = map.getLayers(),\n        len = layers.length;\n\n    if (base) {\n      var baseLayers = base.layers || [base],\n          li = createEl('li', 'group'),\n          ul = createEl('ul'),\n          label = createEl('label');\n      label.innerHTML = this.options['baseTitle'];\n      li.appendChild(label);\n\n      for (var i = 0, _len = baseLayers.length; i < _len; i++) {\n        var layer = baseLayers[i];\n\n        if (this._isExcluded(layer)) {\n          ul.appendChild(this._renderLayer(baseLayers[i], true));\n          li.appendChild(ul);\n          elm.appendChild(li);\n        }\n      }\n    }\n\n    if (len) {\n      var _li = createEl('li', 'group'),\n          _ul = createEl('ul'),\n          _label = createEl('label');\n\n      _label.innerHTML = this.options['overlayTitle'];\n\n      _li.appendChild(_label);\n\n      for (var _i = 0; _i < len; _i++) {\n        var _layer = layers[_i];\n\n        if (this._isExcluded(_layer)) {\n          _ul.appendChild(this._renderLayer(_layer));\n        }\n      }\n\n      _li.appendChild(_ul);\n\n      elm.appendChild(_li);\n    }\n  };\n\n  _proto._isExcluded = function _isExcluded(layer) {\n    var id = layer.getId(),\n        excludeLayers = this.options['excludeLayers'];\n    return !(excludeLayers.length && excludeLayers.indexOf(id) >= 0);\n  };\n\n  _proto._renderLayer = function _renderLayer(layer, isBase) {\n    var _this = this;\n\n    var li = createEl('li', 'layer'),\n        label = createEl('label'),\n        input = createEl('input'),\n        map = this.getMap();\n    var visible = layer.options['visible'];\n    layer.options['visible'] = true;\n    var enabled = layer.isVisible();\n    layer.options['visible'] = visible;\n    li.className = 'layer';\n\n    if (isBase) {\n      input.type = 'radio';\n      input.name = 'base';\n    } else {\n      input.type = 'checkbox';\n    }\n\n    input.checked = visible && enabled;\n\n    if (!enabled) {\n      input.setAttribute('disabled', 'disabled');\n    }\n\n    input.onchange = function (e) {\n      if (e.target.type === 'radio') {\n        var baseLayer = map.getBaseLayer(),\n            baseLayers = baseLayer.layers;\n\n        if (baseLayers) {\n          for (var i = 0, len = baseLayers.length; i < len; i++) {\n            var _baseLayer = baseLayers[i];\n\n            _baseLayer[_baseLayer === layer ? 'show' : 'hide']();\n          }\n        } else if (!baseLayer.isVisible()) {\n          baseLayer.show();\n        }\n\n        map._fireEvent('setbaselayer');\n      } else {\n        layer[e.target.checked ? 'show' : 'hide']();\n      }\n\n      _this.fire('layerchange', {\n        target: layer\n      });\n    };\n\n    li.appendChild(input);\n    label.innerHTML = layer.getId();\n    li.appendChild(label);\n    return li;\n  };\n\n  return LayerSwitcher;\n}(Control);\n\nLayerSwitcher.mergeOptions(options$o);\nMap$1.mergeOptions({\n  'layerSwitcherControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['layerSwitcherControl']) {\n    this.layerSwitcherControl = new LayerSwitcher(this.options['layerSwitcherControl']);\n    this.addControl(this.layerSwitcherControl);\n  }\n});\n\nvar options$p = {\n  'level': 4,\n  'position': {\n    'right': 1,\n    'bottom': 1\n  },\n  'size': [300, 200],\n  'maximize': true,\n  'symbol': {\n    'lineWidth': 3,\n    'lineColor': '#1bbc9b',\n    'polygonFill': '#1bbc9b',\n    'polygonOpacity': 0.4\n  },\n  'containerClass': 'maptalks-overview',\n  'buttonClass': 'maptalks-overview-button'\n};\n\nvar Overview = function (_Control) {\n  _inheritsLoose(Overview, _Control);\n\n  function Overview() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Overview.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var size = this.options['size'];\n\n    if (!this.options['maximize']) {\n      size = [0, 0];\n    }\n\n    var container = createEl('div');\n    var mapContainer = this.mapContainer = createEl('div');\n    mapContainer.style.width = size[0] + 'px';\n    mapContainer.style.height = size[1] + 'px';\n    mapContainer.className = this.options['containerClass'];\n    var button = this.button = createEl('div');\n    button.className = this.options['buttonClass'];\n    container.appendChild(mapContainer);\n    container.appendChild(button);\n    return container;\n  };\n\n  _proto.onAdd = function onAdd() {\n    if (this.options['maximize']) {\n      this._createOverview();\n    }\n\n    this.getMap().on('resize moving zooming rotate dragrotating viewchange', this._update, this).on('setbaselayer', this._updateBaseLayer, this).on('spatialreferencechange', this._updateSpatialReference, this);\n    on(this.button, 'click', this._onButtonClick, this);\n\n    this._updateButtonText();\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('resize moving zooming rotate dragrotating viewchange', this._update, this).off('setbaselayer', this._updateBaseLayer, this).off('spatialreferencechange', this._updateSpatialReference, this);\n\n    if (this._overview) {\n      this._overview.remove();\n\n      delete this._overview;\n      delete this._perspective;\n    }\n\n    off(this.button, 'click', this._onButtonClick, this);\n  };\n\n  _proto.maxmize = function maxmize() {\n    var size = this.options['size'];\n    var dom = this.mapContainer;\n    dom.style.width = size[0] + 'px';\n    dom.style.height = size[1] + 'px';\n\n    this._createOverview();\n\n    return this;\n  };\n\n  _proto.minimize = function minimize() {\n    if (this._overview) {\n      this._overview.remove();\n    }\n\n    delete this._overview;\n    delete this._perspective;\n    var dom = this.mapContainer;\n    dom.style.width = 0 + 'px';\n    dom.style.height = 0 + 'px';\n    return this;\n  };\n\n  _proto.getOverviewMap = function getOverviewMap() {\n    return this._overview;\n  };\n\n  _proto._onButtonClick = function _onButtonClick() {\n    if (!this._overview) {\n      this.maxmize();\n    } else {\n      this.minimize();\n    }\n\n    this._updateButtonText();\n  };\n\n  _proto._updateButtonText = function _updateButtonText() {\n    if (this._overview) {\n      this.button.innerHTML = '-';\n    } else {\n      this.button.innerHTML = '+';\n    }\n  };\n\n  _proto._createOverview = function _createOverview() {\n    var map = this.getMap(),\n        dom = this.mapContainer;\n    var options = map.config();\n    extend(options, {\n      'center': map.getCenter(),\n      'zoom': this._getOverviewZoom(),\n      'zoomAnimationDuration': 150,\n      'pitch': 0,\n      'bearing': 0,\n      'scrollWheelZoom': false,\n      'checkSize': false,\n      'doubleClickZoom': false,\n      'touchZoom': false,\n      'control': false,\n      'draggable': false,\n      'maxExtent': null\n    });\n    this._overview = new Map$1(dom, options);\n\n    this._updateBaseLayer();\n\n    this._perspective = new Polygon(this._getPerspectiveCoords(), {\n      'draggable': true,\n      'cursor': 'move',\n      'symbol': this.options['symbol']\n    }).on('dragend', this._onDragEnd, this);\n    new VectorLayer('perspective_layer', this._perspective).addTo(this._overview);\n    this.fire('load');\n  };\n\n  _proto._getOverviewZoom = function _getOverviewZoom() {\n    var map = this.getMap(),\n        zoom = map.getZoom(),\n        minZoom = map.getMinZoom(),\n        level = this.options['level'];\n\n    if (level > 0) {\n      for (var i = level; i > 0; i--) {\n        if (zoom - i >= minZoom) {\n          return zoom - i;\n        }\n      }\n    } else {\n      for (var _i = level; _i < 0; _i++) {\n        if (zoom - _i >= minZoom) {\n          return zoom - _i;\n        }\n      }\n    }\n\n    return zoom;\n  };\n\n  _proto._onDragEnd = function _onDragEnd() {\n    var center = this._perspective.getCenter();\n\n    this._overview.setCenter(center);\n\n    this.getMap().panTo(center);\n  };\n\n  _proto._getPerspectiveCoords = function _getPerspectiveCoords() {\n    var map = this.getMap();\n    return map.getContainerExtent().toArray().map(function (c) {\n      return map.containerPointToCoordinate(c);\n    });\n  };\n\n  _proto._update = function _update() {\n    if (!this._overview) {\n      return;\n    }\n\n    computeDomPosition(this._overview._containerDOM);\n\n    var coords = this._getPerspectiveCoords();\n\n    this._perspective.setCoordinates(coords);\n\n    this._overview.setCenterAndZoom(this.getMap().getCenter(), this._getOverviewZoom());\n  };\n\n  _proto._updateSpatialReference = function _updateSpatialReference() {\n    if (!this._overview) {\n      return;\n    }\n\n    var map = this.getMap();\n    var spatialRef = map.options['spatialReference'];\n\n    this._overview.setSpatialReference(spatialRef);\n  };\n\n  _proto._updateBaseLayer = function _updateBaseLayer() {\n    if (!this._overview) {\n      return;\n    }\n\n    var map = this.getMap(),\n        baseLayer = map.getBaseLayer();\n\n    if (!baseLayer) {\n      this._overview.setBaseLayer(null);\n\n      return;\n    }\n\n    var layers = baseLayer.layers;\n    var showIndex = 0;\n\n    if (layers) {\n      for (var i = 0, l = layers.length; i < l; i++) {\n        var _layer = layers[i];\n\n        if (_layer.isVisible()) {\n          showIndex = i;\n          break;\n        }\n      }\n    }\n\n    var json = baseLayer.toJSON();\n    var options = null;\n\n    if (layers) {\n      options = json.layers[showIndex].options;\n      options.visible = true;\n    } else {\n      options = json.options;\n    }\n\n    this._overview.setMinZoom(options.minZoom || null).setMaxZoom(options.maxZoom || null);\n\n    delete options.minZoom;\n    delete options.maxZoom;\n    delete json.options.canvas;\n    json.options.visible = true;\n    json.options.renderer = 'canvas';\n    var layer = Layer.fromJSON(json);\n\n    for (var p in baseLayer) {\n      if (isFunction(baseLayer[p]) && baseLayer.hasOwnProperty(p) && baseLayer[p] !== baseLayer.constructor.prototype[p]) {\n        layer[p] = baseLayer[p];\n      }\n    }\n\n    this._overview.setBaseLayer(layer);\n  };\n\n  return Overview;\n}(Control);\n\nOverview.mergeOptions(options$p);\nMap$1.mergeOptions({\n  'overviewControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['overviewControl']) {\n    this.overviewControl = new Overview(this.options['overviewControl']);\n    this.addControl(this.overviewControl);\n  }\n});\n\nvar options$q = {\n  'position': 'top-right',\n  'draggable': true,\n  'custom': false,\n  'content': '',\n  'closeButton': true\n};\n\nvar Panel = function (_Control) {\n  _inheritsLoose(Panel, _Control);\n\n  function Panel() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Panel.prototype;\n\n  _proto.buildOn = function buildOn() {\n    var dom;\n\n    if (this.options['custom']) {\n      if (isString(this.options['content'])) {\n        dom = createEl('div');\n        dom.innerHTML = this.options['content'];\n      } else {\n        dom = this.options['content'];\n      }\n    } else {\n      dom = createEl('div', 'maptalks-panel');\n\n      if (this.options['closeButton']) {\n        var closeButton = createEl('a', 'maptalks-close');\n        closeButton.href = 'javascript:;';\n\n        closeButton.onclick = function () {\n          dom.style.display = 'none';\n        };\n\n        dom.appendChild(closeButton);\n      }\n\n      var panelContent = createEl('div', 'maptalks-panel-content');\n      panelContent.innerHTML = this.options['content'];\n      dom.appendChild(panelContent);\n    }\n\n    this.draggable = new DragHandler(dom, {\n      'cancelOn': this._cancelOn.bind(this),\n      'ignoreMouseleave': true\n    });\n    this.draggable.on('dragstart', this._onDragStart, this).on('dragging', this._onDragging, this).on('dragend', this._onDragEnd, this);\n\n    if (this.options['draggable']) {\n      this.draggable.enable();\n    }\n\n    return dom;\n  };\n\n  _proto.update = function update() {\n    if (this.draggable) {\n      this.draggable.disable();\n      delete this.draggable;\n    }\n\n    return Control.prototype.update.call(this);\n  };\n\n  _proto.setContent = function setContent(content) {\n    var old = this.options['content'];\n    this.options['content'] = content;\n    this.fire('contentchange', {\n      'old': old,\n      'new': content\n    });\n\n    if (this.isVisible()) {\n      this.update();\n    }\n\n    return this;\n  };\n\n  _proto.getContent = function getContent() {\n    return this.options['content'];\n  };\n\n  _proto._cancelOn = function _cancelOn(domEvent) {\n    var target = domEvent.srcElement || domEvent.target,\n        tagName = target.tagName.toLowerCase();\n\n    if (tagName === 'button' || tagName === 'input' || tagName === 'select' || tagName === 'option' || tagName === 'textarea') {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto._onDragStart = function _onDragStart(param) {\n    this._startPos = param['mousePos'];\n    this._startPosition = extend({}, this.getPosition());\n    this.fire('dragstart', param);\n  };\n\n  _proto._onDragging = function _onDragging(param) {\n    var pos = param['mousePos'];\n    var offset = pos.sub(this._startPos);\n    var startPosition = this._startPosition;\n    var position = this.getPosition();\n\n    if (!isNil(position['top'])) {\n      position['top'] = parseInt(startPosition['top']) + offset.y;\n    }\n\n    if (!isNil(position['bottom'])) {\n      position['bottom'] = parseInt(startPosition['bottom']) - offset.y;\n    }\n\n    if (!isNil(position['left'])) {\n      position['left'] = parseInt(startPosition['left']) + offset.x;\n    }\n\n    if (!isNil(position['right'])) {\n      position['right'] = parseInt(startPosition['right']) - offset.x;\n    }\n\n    this.setPosition(position);\n    this.fire('dragging', param);\n  };\n\n  _proto._onDragEnd = function _onDragEnd(param) {\n    delete this._startPos;\n    delete this._startPosition;\n    this.fire('dragend', param);\n  };\n\n  _proto._getConnectPoints = function _getConnectPoints() {\n    var map = this.getMap();\n    var containerPoint = this.getContainerPoint();\n    var dom = this.getDOM(),\n        width = parseInt(dom.clientWidth),\n        height = parseInt(dom.clientHeight);\n    var anchors = [map.containerPointToCoordinate(containerPoint.add(width / 2, 0)), map.containerPointToCoordinate(containerPoint.add(width, height / 2)), map.containerPointToCoordinate(containerPoint.add(width / 2, height)), map.containerPointToCoordinate(containerPoint.add(0, height / 2))];\n    return anchors;\n  };\n\n  return Panel;\n}(Control);\n\nPanel.mergeOptions(options$q);\n\nvar options$r = {\n  'position': 'bottom-left',\n  'maxWidth': 100,\n  'metric': true,\n  'imperial': false,\n  'containerClass': null\n};\n\nvar Scale = function (_Control) {\n  _inheritsLoose(Scale, _Control);\n\n  function Scale() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Scale.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    this._map = map;\n    this._scaleContainer = createEl('div', this.options['containerClass']);\n\n    this._addScales();\n\n    map.on('zoomend', this._update, this);\n\n    if (this._map._loaded) {\n      this._update();\n    }\n\n    return this._scaleContainer;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('zoomend', this._update, this);\n  };\n\n  _proto._addScales = function _addScales() {\n    var css = 'border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 0px;' + 'color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden' + ';-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);';\n\n    if (this.options['metric']) {\n      this._mScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n    }\n\n    if (this.options['imperial']) {\n      this._iScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n    }\n  };\n\n  _proto._update = function _update() {\n    var map = this._map;\n    var maxMeters = map.pixelToDistance(this.options['maxWidth'], 0);\n\n    this._updateScales(maxMeters);\n  };\n\n  _proto._updateScales = function _updateScales(maxMeters) {\n    if (this.options['metric'] && maxMeters) {\n      this._updateMetric(maxMeters);\n    }\n\n    if (this.options['imperial'] && maxMeters) {\n      this._updateImperial(maxMeters);\n    }\n  };\n\n  _proto._updateMetric = function _updateMetric(maxMeters) {\n    var meters = this._getRoundNum(maxMeters),\n        label = meters < 1000 ? meters + ' m' : meters / 1000 + ' km';\n\n    this._updateScale(this._mScale, label, meters / maxMeters);\n  };\n\n  _proto._updateImperial = function _updateImperial(maxMeters) {\n    var maxFeet = maxMeters * 3.2808399;\n    var maxMiles, miles, feet;\n\n    if (maxFeet > 5280) {\n      maxMiles = maxFeet / 5280;\n      miles = this._getRoundNum(maxMiles);\n\n      this._updateScale(this._iScale, miles + ' mile', miles / maxMiles);\n    } else {\n      feet = this._getRoundNum(maxFeet);\n\n      this._updateScale(this._iScale, feet + ' feet', feet / maxFeet);\n    }\n  };\n\n  _proto._updateScale = function _updateScale(scale, text, ratio) {\n    scale['style']['width'] = Math.round(this.options['maxWidth'] * ratio) + 'px';\n    scale['innerHTML'] = text;\n  };\n\n  _proto._getRoundNum = function _getRoundNum(num) {\n    var pow10 = Math.pow(10, (Math.floor(num) + '').length - 1);\n    var d = num / pow10;\n    d = d >= 10 ? 10 : d >= 5 ? 5 : d >= 3 ? 3 : d >= 2 ? 2 : 1;\n    return pow10 * d;\n  };\n\n  return Scale;\n}(Control);\n\nScale.mergeOptions(options$r);\nMap$1.mergeOptions({\n  'scaleControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['scaleControl']) {\n    this.scaleControl = new Scale(this.options['scaleControl']);\n    this.addControl(this.scaleControl);\n  }\n});\n\nvar options$s = {\n  'height': 28,\n  'vertical': false,\n  'position': 'top-right',\n  'reverseMenu': false,\n  'items': {}\n};\n\nvar Toolbar = function (_Control) {\n  _inheritsLoose(Toolbar, _Control);\n\n  function Toolbar() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Toolbar.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    this._map = map;\n    var dom = createEl('div');\n    var ul = createEl('ul', 'maptalks-toolbar-hx');\n    dom.appendChild(ul);\n\n    if (this.options['vertical']) {\n      addClass(dom, 'maptalks-toolbar-vertical');\n    } else {\n      addClass(dom, 'maptalks-toolbar-horizonal');\n    }\n\n    var me = this;\n\n    function onButtonClick(fn, index, childIndex, targetDom) {\n      var item = me._getItems()[index];\n\n      return function (e) {\n        stopPropagation(e);\n        return fn({\n          'target': item,\n          'index': index,\n          'childIndex': childIndex,\n          'dom': targetDom\n        });\n      };\n    }\n\n    var items = this.options['items'];\n\n    if (isArrayHasData(items)) {\n      for (var i = 0, len = items.length; i < len; i++) {\n        var item = items[i];\n        var li = createEl('li');\n\n        if (this.options['height'] !== 28) {\n          li.style.lineHeight = this.options['height'] + 'px';\n        }\n\n        li.style.height = this.options['height'] + 'px';\n        li.style.cursor = 'pointer';\n\n        if (isHTML(item['item'])) {\n          li.style.textAlign = 'center';\n          var itemSize = measureDom('div', item['item']);\n          li.innerHTML = '<div style=\"margin-top:' + (this.options['height'] - itemSize['height']) / 2 + 'px;\">' + item['item'] + '</div>';\n        } else {\n          li.innerHTML = item['item'];\n        }\n\n        if (item['click']) {\n          on(li, 'click', onButtonClick(item['click'], i, null, li));\n        }\n\n        if (isArrayHasData(item['children'])) {\n          var dropMenu = this._createDropMenu(i);\n\n          li.appendChild(dropMenu);\n          li._menu = dropMenu;\n          on(li, 'mouseover', function () {\n            this._menu.style.display = '';\n          });\n          on(li, 'mouseout', function () {\n            this._menu.style.display = 'none';\n          });\n        }\n\n        ul.appendChild(li);\n      }\n    }\n\n    return dom;\n  };\n\n  _proto._createDropMenu = function _createDropMenu(index) {\n    var me = this;\n\n    function onButtonClick(fn, index, childIndex) {\n      var item = me._getItems()[index]['children'][childIndex];\n\n      return function (e) {\n        stopPropagation(e);\n        return fn({\n          'target': item,\n          'index': index,\n          'childIndex': childIndex\n        });\n      };\n    }\n\n    var menuDom = createEl('div', 'maptalks-dropMenu'),\n        items = this._getItems(),\n        len = items.length,\n        menuUL = createEl('ul'),\n        children = items[index]['children'];\n\n    if (index === len - 1 && children) {\n      menuDom.style.cssText = 'right: 0px;';\n      menuUL.style.cssText = 'right: 0px;position: absolute;';\n\n      if (this.options['reverseMenu']) {\n        menuUL.style.bottom = 0;\n      }\n    }\n\n    menuDom.appendChild(createEl('em', 'maptalks-ico'));\n    var liWidth = 0;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      var size = stringLength(children[i]['item'], '12px');\n\n      if (size.width > liWidth) {\n        liWidth = size.width;\n      }\n    }\n\n    for (var _i = 0, _l = children.length; _i < _l; _i++) {\n      var child = children[_i];\n      var li = createEl('li');\n      li.innerHTML = '<a href=\"javascript:;\">' + child['item'] + '</a>';\n      li.style.cursor = 'pointer';\n      li.style.width = liWidth + 24 + 'px';\n      on(li.childNodes[0], 'click', onButtonClick(child['click'], index, _i));\n      menuUL.appendChild(li);\n    }\n\n    if (this.options['vertical']) {\n      var width = liWidth < 95 ? 95 : liWidth;\n\n      if (this.options['reverseMenu']) {\n        menuDom.style.right = -(width + 10 * 2) + 'px';\n      } else {\n        menuDom.style.left = -(width + 10 * 2) + 'px';\n      }\n    } else if (this.options['reverseMenu']) {\n      menuDom.style.bottom = '28px';\n    } else {\n      menuDom.style.top = '28px';\n    }\n\n    menuDom.appendChild(menuUL);\n    menuDom.style.display = 'none';\n    return menuDom;\n  };\n\n  _proto._getItems = function _getItems() {\n    return this.options['items'] || [];\n  };\n\n  return Toolbar;\n}(Control);\n\nToolbar.mergeOptions(options$s);\n\nvar options$t = {\n  'position': 'top-left',\n  'slider': true,\n  'zoomLevel': true,\n  'seamless': false\n};\nvar UNIT = 10;\n\nvar Zoom = function (_Control) {\n  _inheritsLoose(Zoom, _Control);\n\n  function Zoom() {\n    return _Control.apply(this, arguments) || this;\n  }\n\n  var _proto = Zoom.prototype;\n\n  _proto.buildOn = function buildOn(map) {\n    var options = this.options;\n    var dom = createEl('div', 'maptalks-zoom');\n\n    if (options['zoomLevel']) {\n      var levelDOM = createEl('span', 'maptalks-zoom-zoomlevel');\n      dom.appendChild(levelDOM);\n      this._levelDOM = levelDOM;\n    }\n\n    var zoomDOM = createEl('div', 'maptalks-zoom-slider');\n    var zoomInButton = createEl('i', 'maptalks-zoom-zoomin el-icon-plus');\n//    zoomInButton.href = 'javascript:;';\n//    zoomInButton.innerHTML = '+';\n    zoomDOM.appendChild(zoomInButton);\n    this._zoomInButton = zoomInButton;\n\n    if (options['slider']) {\n      var box = createEl('div', 'maptalks-zoom-slider-box');\n      var ruler = createEl('div', 'maptalks-zoom-slider-ruler');\n      var reading = createEl('span', 'maptalks-zoom-slider-reading');\n      var dot = createEl('span', 'maptalks-zoom-slider-dot');\n      ruler.appendChild(reading);\n      box.appendChild(ruler);\n      box.appendChild(dot);\n      zoomDOM.appendChild(box);\n      this._sliderBox = box;\n      this._sliderRuler = ruler;\n      this._sliderReading = reading;\n      this._sliderDot = dot;\n    }\n\n    var zoomOutButton = createEl('i', 'maptalks-zoom-zoomout el-icon-minus');\n//    zoomOutButton.href = 'javascript:;';\n//    zoomOutButton.innerHTML = '-';\n    zoomDOM.appendChild(zoomOutButton);\n    this._zoomOutButton = zoomOutButton;\n    dom.appendChild(zoomDOM);\n    map.on('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n    this._update();\n\n    this._registerDomEvents();\n\n    return dom;\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.getMap().off('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n    if (this._zoomInButton) {\n      off(this._zoomInButton, 'click', this._onZoomInClick, this);\n    }\n\n    if (this._zoomOutButton) {\n      off(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n    }\n\n    if (this._sliderRuler) {\n      off(this._sliderRuler, 'click', this._onClickRuler, this);\n      this.dotDragger.disable();\n      delete this.dotDragger;\n    }\n  };\n\n  _proto._update = function _update() {\n    var map = this.getMap();\n\n    if (this._sliderBox) {\n      var totalRange = (map.getMaxZoom() - map.getMinZoom()) * UNIT;\n      this._sliderBox.style.height = totalRange + 16 + 'px';\n      this._sliderRuler.style.height = totalRange + 8 + 'px';\n      this._sliderRuler.style.cursor = 'pointer';\n      var zoomRange = (map.getMaxZoom() - map.getZoom()) * UNIT;\n      this._sliderReading.style.height = (map.getZoom() - map.getMinZoom() + 1) * UNIT + 'px';\n      this._sliderDot.style.top = zoomRange + 'px';\n    }\n\n    this._updateText();\n  };\n\n  _proto._updateText = function _updateText() {\n    if (this._levelDOM) {\n      var map = this.getMap();\n      var zoom = map.getZoom();\n\n      if (!isInteger(zoom)) {\n        zoom = Math.floor(zoom * 10) / 10;\n      }\n\n      this._levelDOM.innerHTML = zoom;\n    }\n  };\n\n  _proto._registerDomEvents = function _registerDomEvents() {\n    if (this._zoomInButton) {\n      on(this._zoomInButton, 'click', this._onZoomInClick, this);\n    }\n\n    if (this._zoomOutButton) {\n      on(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n    }\n\n    if (this._sliderRuler) {\n      on(this._sliderRuler, 'click', this._onClickRuler, this);\n      this.dotDragger = new DragHandler(this._sliderDot, {\n        'ignoreMouseleave': true\n      });\n      this.dotDragger.on('dragstart', this._onDotDragstart, this).on('dragging dragend', this._onDotDrag, this).enable();\n    }\n  };\n\n  _proto._onZoomInClick = function _onZoomInClick(e) {\n    preventDefault(e);\n    this.getMap().zoomIn();\n  };\n\n  _proto._onZoomOutClick = function _onZoomOutClick(e) {\n    preventDefault(e);\n    this.getMap().zoomOut();\n  };\n\n  _proto._onClickRuler = function _onClickRuler(e) {\n    preventDefault(e);\n    var map = this.getMap(),\n        point = getEventContainerPoint(e, this._sliderRuler),\n        h = point.y;\n    var maxZoom = map.getMaxZoom(),\n        zoom = Math.floor(maxZoom - h / UNIT);\n    map.setZoom(zoom);\n  };\n\n  _proto._onDotDragstart = function _onDotDragstart(e) {\n    preventDefault(e.domEvent);\n\n    var map = this.getMap(),\n        origin = map.getSize().toPoint()._multi(1 / 2);\n\n    map.onZoomStart(map.getZoom(), origin);\n  };\n\n  _proto._onDotDrag = function _onDotDrag(e) {\n    preventDefault(e.domEvent);\n\n    var map = this.getMap(),\n        origin = map.getSize().toPoint()._multi(1 / 2),\n        point = getEventContainerPoint(e.domEvent, this._sliderRuler),\n        maxZoom = map.getMaxZoom(),\n        minZoom = map.getMinZoom();\n\n    var top = point.y,\n        z = maxZoom - top / UNIT;\n\n    if (maxZoom < z) {\n      z = maxZoom;\n      top = 0;\n    } else if (minZoom > z) {\n      z = minZoom;\n      top = (maxZoom - minZoom) * UNIT;\n    }\n\n    if (e.type === 'dragging') {\n      map.onZooming(z, origin, 1);\n    } else if (e.type === 'dragend') {\n      if (this.options['seamless']) {\n        map.onZoomEnd(z, origin);\n      } else {\n        map.onZoomEnd(Math.round(z), origin);\n      }\n    }\n\n    this._sliderDot.style.top = top + 'px';\n    this._sliderReading.style.height = (map.getZoom() - minZoom + 1) * UNIT + 'px';\n\n    this._updateText();\n  };\n\n  return Zoom;\n}(Control);\n\nZoom.mergeOptions(options$t);\nMap$1.mergeOptions({\n  'zoomControl': false\n});\nMap$1.addOnLoadHook(function () {\n  if (this.options['zoomControl']) {\n    this.zoomControl = new Zoom(this.options['zoomControl']);\n    this.addControl(this.zoomControl);\n  }\n});\n\n\n\nvar index$5 = /*#__PURE__*/Object.freeze({\n  Control: Control,\n  Attribution: Attribution,\n  LayerSwitcher: LayerSwitcher,\n  Overview: Overview,\n  Panel: Panel,\n  Scale: Scale,\n  Toolbar: Toolbar,\n  Zoom: Zoom\n});\n\nvar TileSystem = function () {\n  function TileSystem(sx, sy, ox, oy) {\n    if (Array.isArray(sx)) {\n      this.scale = {\n        x: sx[0],\n        y: sx[1]\n      };\n      this.origin = {\n        x: sx[2],\n        y: sx[3]\n      };\n    } else {\n      this.scale = {\n        x: sx,\n        y: sy\n      };\n      this.origin = {\n        x: ox,\n        y: oy\n      };\n    }\n  }\n\n  TileSystem.getDefault = function getDefault(projection) {\n    if (projection['code'].toLowerCase() === 'baidu') {\n      return 'baidu';\n    } else if (projection['code'].toLowerCase() === 'EPSG:4326'.toLowerCase()) {\n      return 'tms-global-geodetic';\n    } else if (projection['code'].toLowerCase() === 'identity') {\n      return [1, -1, 0, 0];\n    } else {\n      return 'web-mercator';\n    }\n  };\n\n  return TileSystem;\n}();\n\nvar semiCircum = 6378137 * Math.PI;\nextend(TileSystem, {\n  'web-mercator': new TileSystem([1, -1, -semiCircum, semiCircum]),\n  'tms-global-mercator': new TileSystem([1, 1, -semiCircum, -semiCircum]),\n  'tms-global-geodetic': new TileSystem([1, 1, -180, -90]),\n  'baidu': new TileSystem([1, 1, 0, 0])\n});\n\nvar TileConfig = function () {\n  function TileConfig(map, tileSystem, fullExtent, tileSize) {\n    this.map = map;\n    this.tileSize = tileSize;\n    this.fullExtent = fullExtent;\n    this.prepareTileInfo(tileSystem, fullExtent);\n    this._xScale = fullExtent['right'] >= fullExtent['left'] ? 1 : -1;\n    this._yScale = fullExtent['top'] >= fullExtent['bottom'] ? 1 : -1;\n    this._pointOrigin = map._prjToPoint(new Point(this.tileSystem['origin']), map.getGLZoom());\n    this._glRes = map.getResolution(map.getGLZoom());\n  }\n\n  var _proto = TileConfig.prototype;\n\n  _proto.prepareTileInfo = function prepareTileInfo(tileSystem, fullExtent) {\n    if (isString(tileSystem)) {\n      tileSystem = TileSystem[tileSystem.toLowerCase()];\n    } else if (Array.isArray(tileSystem)) {\n      tileSystem = new TileSystem(tileSystem);\n    }\n\n    if (!tileSystem) {\n      throw new Error('Invalid TileSystem');\n    }\n\n    this.tileSystem = tileSystem;\n    var a = fullExtent['right'] > fullExtent['left'] ? 1 : -1,\n        b = fullExtent['top'] > fullExtent['bottom'] ? -1 : 1,\n        c = tileSystem['origin']['x'],\n        d = tileSystem['origin']['y'];\n    this.transformation = new Transformation([a, b, c, d]);\n  };\n\n  _proto._getTileNum = function _getTileNum(point, res) {\n    var tileSystem = this.tileSystem,\n        tileSize = this['tileSize'],\n        delta = 1E-7;\n    var tileX = Math.floor(delta * tileSystem['scale']['x'] + point.x / (tileSize['width'] * res));\n    var tileY = Math.ceil(delta * tileSystem['scale']['y'] + point.y / (tileSize['height'] * res));\n    return {\n      'x': tileSystem['scale']['x'] * tileX,\n      'y': tileSystem['scale']['y'] * tileY\n    };\n  };\n\n  _proto.getTileIndex = function getTileIndex(pCoord, res, repeatWorld) {\n    var tileSystem = this.tileSystem;\n    var point = this.transformation.transform(pCoord, 1);\n\n    var tileIndex = this._getTileNum(point, res);\n\n    if (tileSystem['scale']['x'] < 0) {\n      tileIndex['x'] -= 1;\n    }\n\n    if (tileSystem['scale']['y'] > 0) {\n      tileIndex['y'] -= 1;\n    }\n\n    return this.getNeighorTileIndex(tileIndex['x'], tileIndex['y'], 0, 0, res, repeatWorld);\n  };\n\n  _proto.getNeighorTileIndex = function getNeighorTileIndex(tileX, tileY, offsetX, offsetY, res, repeatWorld) {\n    var tileSystem = this.tileSystem;\n    var x = tileX + tileSystem['scale']['x'] * offsetX;\n    var y = tileY - tileSystem['scale']['y'] * offsetY;\n    var out = false;\n    var idx = x;\n    var idy = y;\n\n    var ext = this._getTileFullIndex(res);\n\n    if (repeatWorld) {\n      if (repeatWorld === true || repeatWorld === 'x') {\n        if (ext['xmax'] === ext['xmin']) {\n          x = ext['xmin'];\n        } else if (x < ext['xmin']) {\n          x = ext['xmax'] - (ext['xmin'] - x) % (ext['xmax'] - ext['xmin']);\n\n          if (x === ext['xmax']) {\n            x = ext['xmin'];\n          }\n        } else if (x >= ext['xmax']) {\n          x = ext['xmin'] + (x - ext['xmin']) % (ext['xmax'] - ext['xmin']);\n        }\n      }\n\n      if (repeatWorld === true || repeatWorld === 'y') {\n        if (ext['ymax'] === ext['ymin']) {\n          y = ext['ymin'];\n        } else if (y >= ext['ymax']) {\n          y = ext['ymin'] + (y - ext['ymin']) % (ext['ymax'] - ext['ymin']);\n        } else if (y < ext['ymin']) {\n          y = ext['ymax'] - (ext['ymin'] - y) % (ext['ymax'] - ext['ymin']);\n\n          if (y === ext['ymax']) {\n            y = ext['ymin'];\n          }\n        }\n      }\n    }\n\n    if (x < ext['xmin'] || x > ext['xmax'] || y > ext['ymax'] || y < ext['ymin']) {\n      out = true;\n    }\n\n    return {\n      'x': x,\n      'y': y,\n      'idx': idx,\n      'idy': idy,\n      out: out\n    };\n  };\n\n  _proto._getTileFullIndex = function _getTileFullIndex(res) {\n    if (!this._tileFullIndex) {\n      this._tileFullIndex = {};\n    }\n\n    if (this._tileFullIndex[res]) {\n      return this._tileFullIndex[res];\n    }\n\n    var ext = this.fullExtent;\n    var transformation = this.transformation;\n\n    var nwIndex = this._getTileNum(transformation.transform(new Coordinate(ext['left'], ext['top']), 1), res);\n\n    var seIndex = this._getTileNum(transformation.transform(new Coordinate(ext['right'], ext['bottom']), 1), res);\n\n    var tileSystem = this.tileSystem;\n\n    if (tileSystem['scale']['x'] < 0) {\n      nwIndex.x -= 1;\n      seIndex.x -= 1;\n    }\n\n    if (tileSystem['scale']['y'] > 0) {\n      nwIndex.y -= 1;\n      seIndex.y -= 1;\n    }\n\n    this._tileFullIndex[res] = new Extent(nwIndex, seIndex);\n    return this._tileFullIndex[res];\n  };\n\n  _proto.getTilePrjNW = function getTilePrjNW(tileX, tileY, res) {\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * res * tileSize['height'];\n    var x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * res * tileSize['width'];\n    return new Coordinate(x, y);\n  };\n\n  _proto.getTilePointNW = function getTilePointNW(tileX, tileY, res) {\n    var scale = this._glRes / res;\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = this._pointOrigin.y * scale + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * tileSize['height'];\n    var x = this._pointOrigin.x * scale + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * tileSize['width'];\n    return new Point(x, y);\n  };\n\n  _proto.getTilePrjSE = function getTilePrjSE(tileX, tileY, res) {\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * res * tileSize['height'];\n    var x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * res * tileSize['width'];\n    return new Coordinate(x, y);\n  };\n\n  _proto.getTilePointSE = function getTilePointSE(tileX, tileY, res) {\n    var scale = this._glRes / res;\n    var tileSystem = this.tileSystem;\n    var tileSize = this['tileSize'];\n    var y = this._pointOrigin.y * scale + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * tileSize['height'];\n    var x = this._pointOrigin.x * scale + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * tileSize['width'];\n    return new Point(x, y);\n  };\n\n  _proto.getTilePrjExtent = function getTilePrjExtent(tileX, tileY, res) {\n    var nw = this.getTilePrjNW(tileX, tileY, res),\n        se = this.getTilePrjSE(tileX, tileY, res);\n    return new Extent(nw, se);\n  };\n\n  return TileConfig;\n}();\n\nvar planes = [];\n\nfor (var i = 0; i < 6; i++) {\n  planes[i] = [];\n}\nvar p = [];\nfunction intersectsBox(matrix, box, mask) {\n  setPlanes(matrix);\n\n  for (var i = 0; i < 6; i++) {\n    if (mask && mask.charAt(i) === '0') {\n      continue;\n    }\n\n    var plane = planes[i];\n    p[0] = plane[0] > 0 ? box[1][0] : box[0][0];\n    p[1] = plane[1] > 0 ? box[1][1] : box[0][1];\n    p[2] = plane[2] > 0 ? box[1][2] : box[0][2];\n\n    if (distanceToPoint(plane, p) < 0) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction setPlanes(m) {\n  var me = m;\n  var me0 = me[0],\n      me1 = me[1],\n      me2 = me[2],\n      me3 = me[3];\n  var me4 = me[4],\n      me5 = me[5],\n      me6 = me[6],\n      me7 = me[7];\n  var me8 = me[8],\n      me9 = me[9],\n      me10 = me[10],\n      me11 = me[11];\n  var me12 = me[12],\n      me13 = me[13],\n      me14 = me[14],\n      me15 = me[15];\n  setComponents(planes[0], me3 - me0, me7 - me4, me11 - me8, me15 - me12);\n  setComponents(planes[1], me3 + me0, me7 + me4, me11 + me8, me15 + me12);\n  setComponents(planes[2], me3 + me1, me7 + me5, me11 + me9, me15 + me13);\n  setComponents(planes[3], me3 - me1, me7 - me5, me11 - me9, me15 - me13);\n  setComponents(planes[4], me3 - me2, me7 - me6, me11 - me10, me15 - me14);\n  setComponents(planes[5], me3 + me2, me7 + me6, me11 + me10, me15 + me14);\n}\n\nfunction setComponents(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  var length = distance$1(out);\n  out[0] /= length;\n  out[1] /= length;\n  out[2] /= length;\n  out[3] /= length;\n  return out;\n}\n\nfunction distanceToPoint(plane, p) {\n  return plane[0] * p[0] + plane[1] * p[1] + plane[2] * p[2] + plane[3];\n}\n\nfunction distance$1(v3) {\n  return Math.sqrt(v3[0] * v3[0] + v3[1] * v3[1] + v3[2] * v3[2]);\n}\n\nvar isSetAvailable = typeof Set !== 'undefined';\n\nvar TileHashset = function () {\n  function TileHashset() {\n    this._table = isSetAvailable ? new Set() : {};\n  }\n\n  var _proto = TileHashset.prototype;\n\n  _proto.add = function add$$1(key) {\n    if (isSetAvailable) {\n      this._table.add(key);\n    } else {\n      this._table[key] = true;\n    }\n  };\n\n  _proto.has = function has(key) {\n    if (isSetAvailable) {\n      return this._table.has(key);\n    } else {\n      return this._table[key];\n    }\n  };\n\n  _proto.reset = function reset() {\n    if (isSetAvailable) {\n      this._table.clear();\n    } else {\n      this._table = {};\n    }\n  };\n\n  return TileHashset;\n}();\n\nvar options$u = {\n  'urlTemplate': null,\n  'subdomains': null,\n  'repeatWorld': true,\n  'background': true,\n  'backgroundZoomDiff': 6,\n  'loadingLimitOnInteracting': 3,\n  'tileRetryCount': 0,\n  'placeholder': false,\n  'crossOrigin': null,\n  'tileSize': [256, 256],\n  'offset': [0, 0],\n  'tileSystem': null,\n  'fadeAnimation': !IS_NODE,\n  'debug': false,\n  'spatialReference': null,\n  'maxCacheSize': 256,\n  'renderer': function () {\n    return Browser$1.webgl ? 'gl' : 'canvas';\n  }(),\n  'clipByPitch': true,\n  'maxAvailableZoom': null,\n  'cascadeTiles': true,\n  'zoomOffset': 0\n};\nvar URL_PATTERN = /\\{ *([\\w_]+) *\\}/g;\nvar TEMP_POINT = new Point(0, 0);\nvar TEMP_POINT0$3 = new Point(0, 0);\nvar TEMP_POINT1$1 = new Point(0, 0);\nvar TEMP_POINT2 = new Point(0, 0);\nvar TEMP_POINT3 = new Point(0, 0);\nvar TEMP_POINT4 = new Point(0, 0);\nvar TEMP_POINT5 = new Point(0, 0);\nvar TEMP_POINT6 = new Point(0, 0);\nvar TILE_BOX = [[0, 0, 0], [0, 0, 0]];\nvar ARR3 = [];\n\nvar TileLayer = function (_Layer) {\n  _inheritsLoose(TileLayer, _Layer);\n\n  function TileLayer() {\n    return _Layer.apply(this, arguments) || this;\n  }\n\n  TileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'TileLayer') {\n      return null;\n    }\n\n    return new TileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  var _proto2 = TileLayer.prototype;\n\n  _proto2.getTileSize = function getTileSize() {\n    var size = this.options['tileSize'];\n\n    if (isNumber(size)) {\n      size = [size, size];\n    }\n\n    return new Size(size);\n  };\n\n  _proto2.getTiles = function getTiles(z, parentLayer) {\n    var map = this.getMap();\n    var pitch = map.getPitch();\n    var parentRenderer = parentLayer && parentLayer.getRenderer();\n    var mapExtent = map.getContainerExtent();\n    var tileGrids = [];\n    var count = 0;\n    var minZoom = this.getMinZoom();\n    var cascadePitch0 = map.options['cascadePitches'][0];\n    var cascadePitch1 = map.options['cascadePitches'][1];\n    var visualHeight1 = Math.floor(map._getVisualHeight(cascadePitch1));\n    var tileZoom = isNil(z) ? this._getTileZoom(map.getZoom()) : z;\n    this._visitedTiles = new TileHashset();\n    this._coordCache = {};\n\n    if (!isNil(z) || !this.options['cascadeTiles'] || pitch <= cascadePitch0 || !isNil(minZoom) && tileZoom <= minZoom) {\n      var containerExtent = pitch <= cascadePitch1 ? mapExtent : new PointExtent(0, map.height - visualHeight1, map.width, map.height);\n\n      var _currentTiles = this._getTiles(tileZoom, containerExtent, 2, parentRenderer);\n\n      if (_currentTiles) {\n        count += _currentTiles.tiles.length;\n        tileGrids.push(_currentTiles);\n      }\n\n      return {\n        tileGrids: tileGrids,\n        count: count\n      };\n    }\n\n    var visualHeight0 = Math.floor(map._getVisualHeight(cascadePitch0));\n    var extent0 = new PointExtent(0, map.height - visualHeight0, map.width, map.height);\n\n    var currentTiles = this._getTiles(tileZoom, extent0, 0, parentRenderer);\n\n    count += currentTiles ? currentTiles.tiles.length : 0;\n    tileGrids.push(currentTiles);\n    var cascadeHeight = extent0.ymin;\n    var d = map.getSpatialReference().getZoomDirection();\n    var cascadeLevels = d;\n    var cascadeTiles1;\n\n    if (pitch > cascadePitch1) {\n      if (tileZoom - cascadeLevels <= minZoom) {\n        cascadeLevels = 0;\n      }\n\n      var extent1 = new PointExtent(0, map.height - visualHeight1, map.width, cascadeHeight);\n      cascadeTiles1 = this._getTiles(tileZoom - cascadeLevels, extent1, 1, parentRenderer);\n      count += cascadeTiles1 ? cascadeTiles1.tiles.length : 0;\n      cascadeHeight = extent1.ymin;\n      cascadeLevels += 4 * d;\n    }\n\n    var cascadeTiles2;\n\n    if (tileZoom - cascadeLevels >= minZoom) {\n      var extent2 = new PointExtent(0, mapExtent.ymin, map.width, cascadeHeight);\n      cascadeTiles2 = this._getTiles(tileZoom - cascadeLevels, extent2, 2, parentRenderer);\n      count += cascadeTiles2 ? cascadeTiles2.tiles.length : 0;\n      tileGrids.push(cascadeTiles2);\n    }\n\n    if (cascadeTiles1 && cascadeTiles2) {\n      tileGrids[1] = cascadeTiles2;\n      tileGrids[2] = cascadeTiles1;\n    }\n\n    return {\n      tileGrids: tileGrids,\n      count: count\n    };\n  };\n\n  _proto2.getTileUrl = function getTileUrl(x, y, z) {\n    var urlTemplate = this.options['urlTemplate'];\n    var domain = '';\n\n    if (this.options['subdomains']) {\n      var subdomains = this.options['subdomains'];\n\n      if (isArrayHasData(subdomains)) {\n        var length$$1 = subdomains.length;\n        var s = (x + y) % length$$1;\n\n        if (s < 0) {\n          s = 0;\n        }\n\n        domain = subdomains[s];\n      }\n    }\n\n    if (isFunction(urlTemplate)) {\n      return urlTemplate(x, y, z, domain);\n    }\n\n    var data = {\n      'x': x,\n      'y': y,\n      'z': z,\n      's': domain\n    };\n    return urlTemplate.replace(URL_PATTERN, function (str, key) {\n      var value = data[key];\n\n      if (value === undefined) {\n        throw new Error('No value provided for variable ' + str);\n      } else if (typeof value === 'function') {\n        value = value(data);\n      }\n\n      return value;\n    });\n  };\n\n  _proto2.clear = function clear() {\n    if (this._renderer) {\n      this._renderer.clear();\n    }\n\n    this.fire('clear');\n    return this;\n  };\n\n  _proto2.toJSON = function toJSON() {\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'options': this.config()\n    };\n    return profile;\n  };\n\n  _proto2.getSpatialReference = function getSpatialReference() {\n    var map = this.getMap();\n\n    if (map && (!this.options['spatialReference'] || SpatialReference.equals(this.options['spatialReference'], map.options['spatialReference']))) {\n      return map.getSpatialReference();\n    }\n\n    this._sr = this._sr || new SpatialReference(this.options['spatialReference']);\n\n    if (this._srMinZoom === undefined) {\n      this._srMinZoom = this._sr.getMinZoom();\n      this._srMaxZoom = this._sr.getMaxZoom();\n    }\n\n    return this._sr;\n  };\n\n  _proto2.getMinZoom = function getMinZoom() {\n    var sr = this.getSpatialReference();\n\n    if (sr !== this.getMap().getSpatialReference()) {\n      return Math.max(_Layer.prototype.getMinZoom.call(this), this._srMinZoom);\n    }\n\n    return _Layer.prototype.getMinZoom.call(this);\n  };\n\n  _proto2.getMaxZoom = function getMaxZoom() {\n    var sr = this.getSpatialReference();\n\n    if (sr !== this.getMap().getSpatialReference()) {\n      return Math.min(_Layer.prototype.getMaxZoom.call(this), this._srMaxZoom);\n    }\n\n    return _Layer.prototype.getMaxZoom.call(this);\n  };\n\n  _proto2._getTileZoom = function _getTileZoom(zoom) {\n    if (!isInteger(zoom)) {\n      zoom = Math.round(zoom);\n    }\n\n    var maxZoom = this.options['maxAvailableZoom'];\n\n    if (!isNil(maxZoom) && zoom > maxZoom) {\n      zoom = maxZoom;\n    }\n\n    return zoom;\n  };\n\n  _proto2._getTiles = function _getTiles(tileZoom, containerExtent, cascadeLevel, parentRenderer) {\n    var _this = this;\n\n    var map = this.getMap();\n    var z = tileZoom;\n    var frustumMatrix = map.projViewMatrix;\n\n    if (cascadeLevel < 2) {\n      if (cascadeLevel === 0) {\n        z -= 1;\n      }\n\n      frustumMatrix = cascadeLevel === 0 ? map.cascadeFrustumMatrix0 : cascadeLevel === 1 ? map.cascadeFrustumMatrix1 : map.projViewMatrix;\n    }\n\n    var zoom = z + this.options['zoomOffset'];\n\n    var offset = this._getTileOffset(zoom),\n        hasOffset = offset[0] || offset[1];\n\n    var emptyGrid = {\n      'zoom': z,\n      'extent': null,\n      'offset': offset,\n      'tiles': []\n    };\n\n    if (zoom < 0) {\n      return emptyGrid;\n    }\n\n    var minZoom = this.getMinZoom(),\n        maxZoom = this.getMaxZoom();\n\n    if (!map || !this.isVisible() || !map.width || !map.height) {\n      return emptyGrid;\n    }\n\n    if (!isNil(minZoom) && z < minZoom || !isNil(maxZoom) && z > maxZoom) {\n      return emptyGrid;\n    }\n\n    var tileConfig = this._getTileConfig();\n\n    if (!tileConfig) {\n      return emptyGrid;\n    }\n\n    var sr = this.getSpatialReference();\n    var mapSR = map.getSpatialReference();\n    var res = sr.getResolution(zoom);\n    var glScale = map.getGLScale(z);\n    var repeatWorld = sr === mapSR && this.options['repeatWorld'];\n    var extent2d = containerExtent.convertTo(function (c) {\n      var result;\n\n      if (c.y > 0 && c.y < map.height) {\n        var key = (c.x === 0 ? 0 : 1) + c.y;\n\n        if (!_this._coordCache[key]) {\n          _this._coordCache[key] = map._containerPointToPoint(c);\n        }\n\n        result = _this._coordCache[key];\n      }\n\n      result = map._containerPointToPoint(c, undefined, TEMP_POINT);\n      return result;\n    });\n\n    extent2d._add(offset);\n\n    var maskExtent = this._getMask2DExtent();\n\n    if (maskExtent) {\n      var intersection = maskExtent.intersection(extent2d);\n\n      if (!intersection) {\n        return emptyGrid;\n      }\n\n      containerExtent = intersection.convertTo(function (c) {\n        return map._pointToContainerPoint(c, undefined, 0, TEMP_POINT);\n      });\n    }\n\n    var prjCenter = map._containerPointToPrj(containerExtent.getCenter(), TEMP_POINT0$3);\n\n    var centerPoint = map._prjToPoint(prjCenter, undefined, TEMP_POINT1$1);\n\n    var c;\n\n    if (hasOffset) {\n      c = this._project(map._pointToPrj(centerPoint._add(offset), undefined, TEMP_POINT1$1), TEMP_POINT1$1);\n    } else {\n      c = this._project(prjCenter, TEMP_POINT1$1);\n    }\n\n    TEMP_POINT2.x = extent2d.xmin;\n    TEMP_POINT2.y = extent2d.ymax;\n    TEMP_POINT3.x = extent2d.xmax;\n    TEMP_POINT3.y = extent2d.ymin;\n\n    var pmin = this._project(map._pointToPrj(TEMP_POINT2, undefined, TEMP_POINT2), TEMP_POINT2);\n\n    var pmax = this._project(map._pointToPrj(TEMP_POINT3, undefined, TEMP_POINT3), TEMP_POINT3);\n\n    var centerTile = tileConfig.getTileIndex(c, res, repeatWorld);\n    var ltTile = tileConfig.getTileIndex(pmin, res, repeatWorld);\n    var rbTile = tileConfig.getTileIndex(pmax, res, repeatWorld);\n    var top = Math.ceil(Math.abs(centerTile.idy - ltTile.idy)),\n        left = Math.ceil(Math.abs(centerTile.idx - ltTile.idx)),\n        bottom = Math.ceil(Math.abs(centerTile.idy - rbTile.idy)),\n        right = Math.ceil(Math.abs(centerTile.idx - rbTile.idx));\n    var allCount = (top + bottom + 1) * (left + right + 1);\n    var tileSize = this.getTileSize();\n\n    var renderer = this.getRenderer() || parentRenderer,\n        scale = this._getTileConfig().tileSystem.scale;\n\n    var tiles = [],\n        extent = new PointExtent();\n\n    for (var i = -top; i <= bottom; i++) {\n      var j = -left;\n      var leftVisitEnd = -Infinity;\n      var rightVisitEnd = false;\n\n      while (j >= leftVisitEnd && j <= right) {\n        var idx = tileConfig.getNeighorTileIndex(centerTile.idx, centerTile.idy, j, i, res, repeatWorld);\n\n        if (leftVisitEnd === -Infinity) {\n          j++;\n        } else {\n          j--;\n        }\n\n        var tileId = this._getTileId(idx.idx, idx.idy, z);\n\n        if (idx.out || this._visitedTiles && this._visitedTiles.has(tileId)) {\n          continue;\n        }\n\n        var tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n\n        if (tileInfo) {\n          tileInfo = tileInfo.info;\n        }\n\n        var p = void 0;\n\n        if (tileInfo) {\n          var _tileInfo = tileInfo,\n              point0 = _tileInfo.point0;\n          p = tileInfo.point.set(point0.x, point0.y);\n        } else if (!this._hasOwnSR) {\n          p = tileConfig.getTilePointNW(idx.x, idx.y, res);\n        } else {\n          var pnw = tileConfig.getTilePrjNW(idx.x, idx.y, res);\n          p = map._prjToPoint(this._unproject(pnw, TEMP_POINT3), z);\n        }\n\n        var width = void 0,\n            height = void 0;\n\n        if (sr === mapSR) {\n          width = tileSize.width;\n          height = tileSize.height;\n        } else {\n          var pp = void 0;\n\n          if (!this._hasOwnSR) {\n            pp = tileConfig.getTilePointSE(idx.x, idx.y, res);\n          } else {\n            var pse = tileConfig.getTilePrjSE(idx.x, idx.y, res);\n            pp = map._prjToPoint(this._unproject(pse, TEMP_POINT3), z, TEMP_POINT3);\n          }\n\n          width = Math.ceil(Math.abs(pp.x - p.x));\n          height = Math.ceil(Math.abs(pp.y - p.y));\n        }\n\n        var dx = scale.x * (idx.idx - idx.x) * width,\n            dy = scale.y * (idx.idy - idx.y) * height;\n\n        if (dx || dy) {\n          p._add(dx, dy);\n        }\n\n        if (hasOffset) {\n          p._sub(offset);\n        }\n\n        var tileExtent = tileInfo && tileInfo.extent2d || new PointExtent(p.x, p.y, p.x + width, p.y - height);\n\n        if (allCount <= 4 || rightVisitEnd || this._isTileInExtent(frustumMatrix, tileExtent, glScale)) {\n          if (this._visitedTiles && cascadeLevel === 0) {\n            this._visitedTiles.add(tileId);\n          }\n\n          if (cascadeLevel === 0) {\n            this._splitTiles(frustumMatrix, tiles, renderer, idx, z + 1, tileExtent, offset, dx, dy);\n\n            extent._combine(tileExtent);\n          } else {\n            if (!tileInfo) {\n              tileInfo = {\n                'point0': p.add(offset)._sub(dx, dy),\n                'point': p,\n                'z': z,\n                'x': idx.x,\n                'y': idx.y,\n                'extent2d': tileExtent,\n                'mask': cascadeLevel,\n                'size': [width, height],\n                'id': tileId,\n                'dupKey': tileId,\n                'layer': this.getId(),\n                'url': this.getTileUrl(idx.x, idx.y, zoom)\n              };\n            }\n\n            if (hasOffset) {\n              tileExtent.set(p.x, p.y, p.x + width, p.y - height);\n              tileInfo.point = p._add(offset);\n\n              tileExtent._add(offset);\n            }\n\n            tiles.push(tileInfo);\n\n            extent._combine(tileExtent);\n          }\n\n          if (leftVisitEnd === -Infinity) {\n            leftVisitEnd = j;\n            j = right;\n          } else if (!rightVisitEnd) {\n            rightVisitEnd = true;\n          }\n        }\n      }\n    }\n\n    if (tiles.length) {\n      var center = map._containerPointToPoint(containerExtent.getCenter(), z, TEMP_POINT)._add(offset);\n\n      tiles.sort(function (a, b) {\n        return a.point.distanceTo(center) - b.point.distanceTo(center);\n      });\n    }\n\n    return {\n      'offset': offset,\n      'zoom': tileZoom,\n      'extent': extent,\n      'tiles': tiles\n    };\n  };\n\n  _proto2._splitTiles = function _splitTiles(frustumMatrix, tiles, renderer, tileIdx, z, tileExtent, offset, dx, dy) {\n    var yOrder = this._getTileConfig().tileSystem.scale.y;\n\n    var glScale = this.getMap().getGLScale(z);\n    var corner = TEMP_POINT4.set(tileExtent.xmin * 2, yOrder < 0 ? tileExtent.ymax * 2 : tileExtent.ymin * 2);\n\n    var corner0 = TEMP_POINT5.set(tileExtent.xmin, yOrder < 0 ? tileExtent.ymax : tileExtent.ymin)._add(offset)._sub(dx, dy)._multi(2);\n\n    var w = tileExtent.getWidth();\n    var h = tileExtent.getHeight();\n    var idx = tileIdx.idx * 2;\n    var idy = tileIdx.idy * 2;\n    var x = tileIdx.x * 2;\n    var y = tileIdx.y * 2;\n\n    var tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 0, 0, w, h, corner, corner0, offset, glScale);\n\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 0, 1, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 1, 0, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n    tile = this._checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, 1, 1, w, h, corner, corner0, offset, glScale);\n    if (tile) tiles.push(tile);\n  };\n\n  _proto2._checkAndAddTile = function _checkAndAddTile(frustumMatrix, renderer, idx, idy, x, y, z, i, j, w, h, corner, corner0, offset, glScale) {\n    var tileId = this._getTileId(idx + i, idy + j, z);\n\n    if (this._visitedTiles && this._visitedTiles.has(tileId)) {\n      return null;\n    }\n\n    var yOrder = this._getTileConfig().tileSystem.scale.y;\n\n    var childExtent = new PointExtent(corner.x + i * w, corner.y + yOrder * j * h, corner.x + (i + 1) * w, corner.y + yOrder * (j + 1) * h);\n\n    if (!this._isSplittedTileInExtent(frustumMatrix, childExtent, glScale)) {\n      return null;\n    }\n\n    var hasOffset = offset[0] || offset[1];\n    var tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n\n    if (!tileInfo) {\n      tileInfo = {\n        'point0': corner0.add(i * w, Math.max(yOrder * j * h, yOrder * (j + 1) * h)),\n        'point': new Point(childExtent.xmin, childExtent.ymax),\n        'z': z,\n        'x': x + i,\n        'y': y + j,\n        'extent2d': childExtent,\n        'size': [w, h],\n        'id': tileId,\n        'dupKey': tileId,\n        'layer': this.getId(),\n        'url': this.getTileUrl(x + i, y + j, z + this.options['zoomOffset'])\n      };\n    } else {\n      tileInfo = tileInfo.info;\n    }\n\n    if (hasOffset) {\n      tileInfo.extent2d = childExtent;\n\n      tileInfo.extent2d._add(offset);\n\n      tileInfo.point.set(childExtent.xmin, childExtent.ymax)._add(offset);\n    }\n\n    return tileInfo;\n  };\n\n  _proto2._getTileOffset = function _getTileOffset(z) {\n    var map = this.getMap();\n\n    var scale = map._getResolution() / map._getResolution(z);\n\n    var offset = this.options['offset'];\n\n    if (isFunction(offset)) {\n      offset = offset(this);\n    }\n\n    offset[0] *= scale;\n    offset[1] *= scale;\n    return offset;\n  };\n\n  _proto2._getTileId = function _getTileId(x, y, zoom, id) {\n    return (id || this.getId()) + \"_\" + y + \"_\" + x + \"_\" + zoom;\n  };\n\n  _proto2._project = function _project(pcoord, out) {\n    if (this._hasOwnSR) {\n      var map = this.getMap();\n      var mapProjection = map.getProjection();\n      var projection = this.getSpatialReference().getProjection();\n      return projection.project(mapProjection.unproject(pcoord, out), out);\n    } else {\n      return pcoord;\n    }\n  };\n\n  _proto2._unproject = function _unproject(pcoord, out) {\n    if (this._hasOwnSR) {\n      var map = this.getMap();\n      var sr = this.getSpatialReference();\n      var mapProjection = map.getProjection();\n      var projection = sr.getProjection();\n      return mapProjection.project(projection.unproject(pcoord, out), out);\n    } else {\n      return pcoord;\n    }\n  };\n\n  _proto2._initTileConfig = function _initTileConfig() {\n    var map = this.getMap(),\n        tileSize = this.getTileSize();\n    var sr = this.getSpatialReference();\n    var projection = sr.getProjection(),\n        fullExtent = sr.getFullExtent();\n    this._defaultTileConfig = new TileConfig(map, TileSystem.getDefault(projection), fullExtent, tileSize);\n\n    if (this.options['tileSystem']) {\n      this._tileConfig = new TileConfig(map, this.options['tileSystem'], fullExtent, tileSize);\n    }\n\n    if (map && !this._tileConfig && map.getSpatialReference() === sr && map.getBaseLayer() && map.getBaseLayer() !== this && map.getBaseLayer()._getTileConfig) {\n      var base = map.getBaseLayer()._getTileConfig();\n\n      this._tileConfig = new TileConfig(map, base.tileSystem, base.fullExtent, tileSize);\n    }\n\n    this._hasOwnSR = sr !== map.getSpatialReference();\n  };\n\n  _proto2._getTileConfig = function _getTileConfig() {\n    if (!this._defaultTileConfig) {\n      this._initTileConfig();\n    }\n\n    return this._tileConfig || this._defaultTileConfig;\n  };\n\n  _proto2._bindMap = function _bindMap(map) {\n    var baseLayer = map.getBaseLayer();\n\n    if (baseLayer === this) {\n      if (!baseLayer.options.hasOwnProperty('forceRenderOnMoving')) {\n        this.config({\n          'forceRenderOnMoving': true\n        });\n      }\n    }\n\n    return _Layer.prototype._bindMap.apply(this, arguments);\n  };\n\n  _proto2._isTileInExtent = function _isTileInExtent(frustumMatrix, tileExtent, glScale) {\n    var map = this.getMap();\n    var matrix;\n\n    if (frustumMatrix !== map.projViewMatrix) {\n      var tileCenter = tileExtent.getCenter(TEMP_POINT6)._multi(glScale);\n\n      set$2(ARR3, tileCenter.x, tileCenter.y, 0);\n      var ndc = transformMat4(ARR3, ARR3, map.projViewMatrix);\n      matrix = ndc[1] < 0 ? map.projViewMatrix : frustumMatrix;\n    } else {\n      matrix = map.projViewMatrix;\n    }\n\n    TILE_BOX[0][0] = tileExtent.xmin * glScale;\n    TILE_BOX[0][1] = tileExtent.ymin * glScale;\n    TILE_BOX[1][0] = tileExtent.xmax * glScale;\n    TILE_BOX[1][1] = tileExtent.ymax * glScale;\n    return intersectsBox(matrix, TILE_BOX);\n  };\n\n  _proto2._isSplittedTileInExtent = function _isSplittedTileInExtent(frustumMatrix, tileExtent, glScale) {\n    var map = this.getMap();\n    TILE_BOX[0][0] = tileExtent.xmin * glScale;\n    TILE_BOX[0][1] = tileExtent.ymin * glScale;\n    TILE_BOX[1][0] = tileExtent.xmax * glScale;\n    TILE_BOX[1][1] = tileExtent.ymax * glScale;\n    return intersectsBox(map.projViewMatrix, TILE_BOX);\n  };\n\n  _proto2.getEvents = function getEvents() {\n    return {\n      'spatialreferencechange': this._onSpatialReferenceChange\n    };\n  };\n\n  _proto2._onSpatialReferenceChange = function _onSpatialReferenceChange() {\n    delete this._tileConfig;\n    delete this._defaultTileConfig;\n    delete this._sr;\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.clear();\n    }\n  };\n\n  return TileLayer;\n}(Layer);\n\nTileLayer.registerJSONType('TileLayer');\nTileLayer.mergeOptions(options$u);\n\nvar GroupTileLayer = function (_TileLayer) {\n  _inheritsLoose(GroupTileLayer, _TileLayer);\n\n  GroupTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'GroupTileLayer') {\n      return null;\n    }\n\n    var layers = layerJSON['layers'].map(function (json) {\n      return Layer.fromJSON(json);\n    });\n    return new GroupTileLayer(layerJSON['id'], layers, layerJSON['options']);\n  };\n\n  function GroupTileLayer(id, layers, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id, options) || this;\n    _this.layers = layers || [];\n\n    _this._checkChildren();\n\n    _this.layerMap = {};\n    _this._groupChildren = [];\n    return _this;\n  }\n\n  var _proto = GroupTileLayer.prototype;\n\n  _proto.getLayers = function getLayers() {\n    return this.layers;\n  };\n\n  _proto.toJSON = function toJSON() {\n    var profile = {\n      'type': this.getJSONType(),\n      'id': this.getId(),\n      'layers': this.layers.map(function (layer) {\n        return layer.toJSON();\n      }),\n      'options': this.config()\n    };\n    return profile;\n  };\n\n  _proto.getTiles = function getTiles(z) {\n    var layers = this.layers;\n    var tiles = [];\n    var count = 0;\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var layer = layers[i];\n\n      if (!layer.options['visible']) {\n        continue;\n      }\n\n      var childGrid = layer.getTiles(z, this);\n\n      if (!childGrid || childGrid.count === 0) {\n        continue;\n      }\n\n      count += childGrid.count;\n      pushIn(tiles, childGrid.tileGrids);\n    }\n\n    return {\n      count: count,\n      tileGrids: tiles\n    };\n  };\n\n  _proto.onAdd = function onAdd() {\n    var _this2 = this;\n\n    var map = this.getMap();\n    this.layers.forEach(function (layer) {\n      _this2.layerMap[layer.getId()] = layer;\n\n      if (layer.getChildLayer) {\n        _this2._groupChildren.push(layer);\n      }\n\n      layer._bindMap(map);\n\n      layer.on('show hide', _this2._onLayerShowHide, _this2);\n    });\n\n    _TileLayer.prototype.onAdd.call(this);\n  };\n\n  _proto.onRemove = function onRemove() {\n    var _this3 = this;\n\n    this.layers.forEach(function (layer) {\n      layer._doRemove();\n\n      layer.off('show hide', _this3._onLayerShowHide, _this3);\n    });\n    this.layerMap = {};\n    this._groupChildren = [];\n\n    _TileLayer.prototype.onRemove.call(this);\n  };\n\n  _proto.getChildLayer = function getChildLayer(id) {\n    var layer = this.layerMap[id];\n\n    if (layer) {\n      return layer;\n    }\n\n    for (var i = 0; i < this._groupChildren.length; i++) {\n      var child = this._groupChildren[i].getChildLayer(id);\n\n      if (child) {\n        return child;\n      }\n    }\n\n    return null;\n  };\n\n  _proto._onLayerShowHide = function _onLayerShowHide() {\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.setToRedraw();\n    }\n  };\n\n  _proto.isVisible = function isVisible() {\n    if (!_TileLayer.prototype.isVisible.call(this)) {\n      return false;\n    }\n\n    var children = this.layers;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      if (children[i].isVisible()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._checkChildren = function _checkChildren() {\n    var _this4 = this;\n\n    var ids = {};\n    this.layers.forEach(function (layer) {\n      var layerId = layer.getId();\n\n      if (ids[layerId]) {\n        throw new Error(\"Duplicate child layer id (\" + layerId + \") in the GroupTileLayer (\" + _this4.getId() + \")\");\n      } else {\n        ids[layerId] = 1;\n      }\n    });\n  };\n\n  return GroupTileLayer;\n}(TileLayer);\n\nGroupTileLayer.registerJSONType('GroupTileLayer');\n\nvar options$v = {\n  crs: null,\n  uppercase: false,\n  detectRetina: false\n};\nvar defaultWmsParams = {\n  service: 'WMS',\n  request: 'GetMap',\n  layers: '',\n  styles: '',\n  format: 'image/jpeg',\n  transparent: false,\n  version: '1.1.1'\n};\n\nvar WMSTileLayer = function (_TileLayer) {\n  _inheritsLoose(WMSTileLayer, _TileLayer);\n\n  function WMSTileLayer(id, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id) || this;\n    var wmsParams = extend({}, defaultWmsParams);\n\n    for (var p in options) {\n      if (!(p in _this.options)) {\n        wmsParams[p] = options[p];\n      }\n    }\n\n    _this.setOptions(options);\n\n    _this.setZIndex(options.zIndex);\n\n    var tileSize = _this.getTileSize();\n\n    wmsParams.width = tileSize.width;\n    wmsParams.height = tileSize.height;\n    _this.wmsParams = wmsParams;\n    _this._wmsVersion = parseFloat(wmsParams.version);\n    return _this;\n  }\n\n  var _proto = WMSTileLayer.prototype;\n\n  _proto.onAdd = function onAdd() {\n    var dpr = this.getMap().getDevicePixelRatio();\n    var r = options$v.detectRetina ? dpr : 1;\n    this.wmsParams.width *= r;\n    this.wmsParams.height *= r;\n    var crs = this.options.crs || this.getMap().getProjection().code;\n    var projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';\n    this.wmsParams[projectionKey] = crs;\n\n    _TileLayer.prototype.onAdd.call(this);\n  };\n\n  _proto.getTileUrl = function getTileUrl(x, y, z) {\n    var res = this.getSpatialReference().getResolution(z),\n        tileConfig = this._getTileConfig(),\n        tileExtent = tileConfig.getTilePrjExtent(x, y, res);\n\n    var max = tileExtent.getMax(),\n        min = tileExtent.getMin();\n    var bbox = (this._wmsVersion >= 1.3 && this.wmsParams.crs === 'EPSG:4326' ? [min.y, min.x, max.y, max.x] : [min.x, min.y, max.x, max.y]).join(',');\n\n    var url = _TileLayer.prototype.getTileUrl.call(this, x, y, z);\n\n    return url + getParamString(this.wmsParams, url, this.options.uppercase) + (this.options.uppercase ? '&BBOX=' : '&bbox=') + bbox;\n  };\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'type': 'WMSTileLayer',\n      'id': this.getId(),\n      'options': this.config()\n    };\n  };\n\n  WMSTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'WMSTileLayer') {\n      return null;\n    }\n\n    return new WMSTileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  return WMSTileLayer;\n}(TileLayer);\n\nWMSTileLayer.registerJSONType('WMSTileLayer');\nWMSTileLayer.mergeOptions(options$v);\nfunction getParamString(obj, existingUrl, uppercase) {\n  var params = [];\n\n  for (var i in obj) {\n    params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n  }\n\n  return (!existingUrl || existingUrl.indexOf('?') === -1 ? '?' : '&') + params.join('&');\n}\n\nvar CanvasTileLayer = function (_TileLayer) {\n  _inheritsLoose(CanvasTileLayer, _TileLayer);\n\n  function CanvasTileLayer(id, options) {\n    var _this;\n\n    _this = _TileLayer.call(this, id, options) || this;\n\n    if (!_this.options.hasOwnProperty('forceRenderOnMoving')) {\n      _this.options['forceRenderOnMoving'] = false;\n    }\n\n    return _this;\n  }\n\n  var _proto = CanvasTileLayer.prototype;\n\n  _proto.drawTile = function drawTile() {};\n\n  _proto.toJSON = function toJSON() {\n    return {\n      'type': 'CanvasTileLayer',\n      'id': this.getId(),\n      'options': this.config()\n    };\n  };\n\n  CanvasTileLayer.fromJSON = function fromJSON(layerJSON) {\n    if (!layerJSON || layerJSON['type'] !== 'CanvasTileLayer') {\n      return null;\n    }\n\n    return new CanvasTileLayer(layerJSON['id'], layerJSON['options']);\n  };\n\n  return CanvasTileLayer;\n}(TileLayer);\n\nCanvasTileLayer.registerJSONType('CanvasTileLayer');\n\nfunction createGLContext(canvas, options) {\n  var attributes = {\n    'alpha': true,\n    'stencil': true,\n    'preserveDrawingBuffer': true,\n    'antialias': false\n  };\n  var names = ['webgl', 'experimental-webgl'];\n  var context = null;\n\n  for (var i = 0; i < names.length; ++i) {\n    try {\n      context = canvas.getContext(names[i], options || attributes);\n    } catch (e) {}\n\n    if (context) {\n      break;\n    }\n  }\n\n  return context;\n}\nfunction compileShader(gl, type, source) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n\n  if (!compiled) {\n    var error = gl.getShaderInfoLog(shader);\n    gl.deleteShader(shader);\n    throw new Error('Failed to compile shader: ' + error);\n  }\n\n  return shader;\n}\nfunction createProgram(gl, vert, frag) {\n  var vertexShader = compileShader(gl, gl.VERTEX_SHADER, vert);\n  var fragmentShader = compileShader(gl, gl.FRAGMENT_SHADER, frag);\n\n  if (!vertexShader || !fragmentShader) {\n    return null;\n  }\n\n  var program = gl.createProgram();\n\n  if (!program) {\n    return null;\n  }\n\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  return {\n    program: program,\n    vertexShader: vertexShader,\n    fragmentShader: fragmentShader\n  };\n}\nfunction enableVertexAttrib(gl, program, attributes) {\n  if (Array.isArray(attributes[0])) {\n    var FSIZE = Float32Array.BYTES_PER_ELEMENT;\n    var STRIDE = 0;\n\n    for (var i = 0; i < attributes.length; i++) {\n      STRIDE += attributes[i][1] || 0;\n    }\n\n    var offset = 0;\n\n    for (var _i = 0; _i < attributes.length; _i++) {\n      var attr = gl.getAttribLocation(program, attributes[_i][0]);\n\n      if (attr < 0) {\n        throw new Error('Failed to get the storage location of ' + attributes[_i][0]);\n      }\n\n      gl.vertexAttribPointer(attr, attributes[_i][1], gl[attributes[_i][2] || 'FLOAT'], false, FSIZE * STRIDE, FSIZE * offset);\n      offset += attributes[_i][1] || 0;\n      gl.enableVertexAttribArray(attr);\n    }\n  } else {\n    var _attr = gl.getAttribLocation(program, attributes[0]);\n\n    gl.vertexAttribPointer(_attr, attributes[1], gl[attributes[2] || 'FLOAT'], false, 0, 0);\n    gl.enableVertexAttribArray(_attr);\n  }\n}\n\nvar shaders = {\n  'vertexShader': \"\\n        attribute vec2 a_position;\\n\\n        attribute vec2 a_texCoord;\\n\\n        uniform mat4 u_matrix;\\n\\n        varying vec2 v_texCoord;\\n\\n        void main() {\\n            gl_Position = u_matrix * vec4(a_position, 0., 1.);\\n\\n            v_texCoord = a_texCoord;\\n        }\\n    \",\n  'fragmentShader': \"\\n        precision mediump float;\\n\\n        uniform sampler2D u_image;\\n\\n        uniform float u_opacity;\\n        uniform float u_debug_line;\\n\\n        varying vec2 v_texCoord;\\n\\n        void main() {\\n            if (u_debug_line == 1.) {\\n                gl_FragColor = vec4(0., 1., 0., 1.);\\n            } else {\\n                gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\\n            }\\n        }\\n    \"\n};\nvar v2 = [0, 0],\n    v3 = [0, 0, 0],\n    arr16 = new Array(16);\nvar DEBUG_POINT = new Point(20, 20);\n\nvar ImageGLRenderable = function ImageGLRenderable(Base) {\n  var renderable = function (_Base) {\n    _inheritsLoose(renderable, _Base);\n\n    function renderable() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = renderable.prototype;\n\n    _proto.drawGLImage = function drawGLImage(image, x, y, w, h, scale$$1, opacity, debug) {\n      if (this.gl.program !== this.program) {\n        this.useProgram(this.program);\n      }\n\n      var gl = this.gl;\n      this.loadTexture(image);\n      v3[0] = x || 0;\n      v3[1] = y || 0;\n      var uMatrix = identity(arr16);\n      translate(uMatrix, uMatrix, v3);\n      scale(uMatrix, uMatrix, [scale$$1, scale$$1, 1]);\n      multiply(uMatrix, this.getMap().projViewMatrix, uMatrix);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n      gl.uniform1f(this.program['u_opacity'], opacity);\n      gl.uniform1f(this.program['u_debug_line'], 0);\n      var glBuffer = image.glBuffer;\n\n      if (glBuffer && (glBuffer.width !== w || glBuffer.height !== h)) {\n        this.saveImageBuffer(glBuffer);\n        delete image.glBuffer;\n      }\n\n      if (!image.glBuffer) {\n        image.glBuffer = this.bufferTileData(0, 0, w, h);\n      } else {\n        gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);\n      }\n\n      v2[0] = 'a_position';\n      v2[1] = 2;\n      v2[2] = image.glBuffer.type;\n      this.enableVertexAttrib(v2);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n      if (debug) {\n        this.drawDebug(uMatrix, v2, 0, 0, w, h, debug);\n      }\n    };\n\n    _proto.drawDebug = function drawDebug(uMatrix, attrib, x, y, w, h, debugInfo) {\n      var gl = this.gl;\n      gl.bindBuffer(gl.ARRAY_BUFFER, this._debugBuffer);\n      this.enableVertexAttrib(['a_position', 2, 'FLOAT']);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([x, y, x + w, y, x + w, y - h, x, y - h, x, y]), gl.DYNAMIC_DRAW);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n      gl.uniform1f(this.program['u_debug_line'], 1);\n      gl.drawArrays(gl.LINE_STRIP, 0, 5);\n      var canvas = this._debugInfoCanvas;\n\n      if (!canvas) {\n        var dpr = this.getMap().getDevicePixelRatio() > 1 ? 2 : 1;\n        canvas = this._debugInfoCanvas = document.createElement('canvas');\n        canvas.width = 256 * dpr;\n        canvas.height = 32 * dpr;\n\n        var _ctx = canvas.getContext('2d');\n\n        _ctx.font = '20px monospace';\n\n        _ctx.scale(dpr, dpr);\n      }\n\n      var ctx = canvas.getContext('2d');\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      var color = this.layer.options['debugOutline'];\n      Canvas.fillText(ctx, debugInfo, DEBUG_POINT, color);\n      this.loadTexture(canvas);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);\n      w = 256;\n      h = 32;\n      var x1 = x;\n      var x2 = x + w;\n      var y1 = y;\n      var y2 = y - h;\n      gl.bufferData(gl.ARRAY_BUFFER, this.set8(x1, y1, x1, y2, x2, y1, x2, y2), gl.DYNAMIC_DRAW);\n      gl.uniform1f(this.program['u_debug_line'], 0);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n\n    _proto.bufferTileData = function bufferTileData(x, y, w, h, buffer) {\n      var x1 = x;\n      var x2 = x + w;\n      var y1 = y;\n      var y2 = y - h;\n      var data;\n\n      if (isInteger(x1) && isInteger(x2) && isInteger(y1) && isInteger(y2)) {\n        data = this.set8Int(x1, y1, x1, y2, x2, y1, x2, y2);\n      } else {\n        data = this.set8(x1, y1, x1, y2, x2, y1, x2, y2);\n      }\n\n      var glBuffer = this.loadImageBuffer(data, buffer);\n      glBuffer.width = w;\n      glBuffer.height = h;\n      glBuffer.type = data instanceof Int16Array ? 'SHORT' : 'FLOAT';\n      return glBuffer;\n    };\n\n    _proto.drawTinImage = function drawTinImage(image, vertices, texCoords, indices, opacity) {\n      var gl = this.gl;\n      this.loadTexture(image);\n      gl.uniformMatrix4fv(this.program['u_matrix'], false, this.getMap().projViewMatrix);\n      gl.uniform1f(this.program['u_opacity'], opacity);\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.posBuffer);\n      this.enableVertexAttrib(['a_position', 3]);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.DYNAMIC_DRAW);\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n      this.enableVertexAttrib(['a_texCoord', 2]);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(texCoords), gl.DYNAMIC_DRAW);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.DYNAMIC_DRAW);\n      gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);\n    };\n\n    _proto.createCanvas2 = function createCanvas2() {\n      this.canvas2 = Canvas.createCanvas(this.canvas.width, this.canvas.height);\n    };\n\n    _proto.createGLContext = function createGLContext$$1() {\n      if (this.canvas.gl && this.canvas.gl.wrap) {\n        this.gl = this.canvas.gl.wrap();\n      } else {\n        this.gl = createGLContext(this.canvas2 || this.canvas, this.layer.options['glOptions']);\n      }\n\n      var gl = this.gl;\n      gl.clearColor(0.0, 0.0, 0.0, 0.0);\n      gl.disable(gl.DEPTH_TEST);\n      gl.enable(gl.STENCIL_TEST);\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n      this.program = this.createProgram(shaders['vertexShader'], this.layer.options['fragmentShader'] || shaders['fragmentShader'], ['u_matrix', 'u_image', 'u_opacity', 'u_debug_line']);\n      this._debugBuffer = this.createBuffer();\n      this.useProgram(this.program);\n      this.texBuffer = this.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n      this.enableVertexAttrib(['a_texCoord', 2, 'UNSIGNED_BYTE']);\n      gl.bufferData(gl.ARRAY_BUFFER, new Uint8Array([0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]), gl.STATIC_DRAW);\n      this.enableSampler('u_image');\n      gl.activeTexture(gl['TEXTURE0']);\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n    };\n\n    _proto.resizeGLCanvas = function resizeGLCanvas() {\n      if (this.gl) {\n        this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\n      }\n\n      if (!this.canvas2) {\n        return;\n      }\n\n      if (this.canvas2.width !== this.canvas.width || this.canvas2.height !== this.canvas.height) {\n        this.canvas2.width = this.canvas.width;\n        this.canvas2.height = this.canvas.height;\n      }\n    };\n\n    _proto.clearGLCanvas = function clearGLCanvas() {\n      if (this.gl) {\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.STENCIL_BUFFER_BIT);\n      }\n    };\n\n    _proto.disposeImage = function disposeImage(image) {\n      if (!image) {\n        return;\n      }\n\n      if (image.texture) {\n        this.saveTexture(image.texture);\n      }\n\n      if (image.glBuffer) {\n        this.saveImageBuffer(image.glBuffer);\n      }\n\n      delete image.texture;\n      delete image.glBuffer;\n    };\n\n    _proto._createTexture = function _createTexture(image) {\n      var gl = this.gl;\n      var texture = this.getTexture() || gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n      if (isInteger(log2(image.width)) && isInteger(log2(image.width))) {\n        gl.generateMipmap(gl.TEXTURE_2D);\n      }\n\n      return texture;\n    };\n\n    _proto.getTexture = function getTexture() {\n      if (!this._textures) {\n        this._textures = [];\n      }\n\n      var textures = this._textures;\n      return textures && textures.length > 0 ? textures.pop() : null;\n    };\n\n    _proto.saveTexture = function saveTexture(texture) {\n      this._textures.push(texture);\n    };\n\n    _proto.loadTexture = function loadTexture(image) {\n      var gl = this.gl;\n      var texture = image.texture;\n\n      if (!texture) {\n        texture = this._createTexture(image);\n        image.texture = texture;\n      }\n\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      return texture;\n    };\n\n    _proto.getImageBuffer = function getImageBuffer() {\n      if (!this._imageBuffers) {\n        this._imageBuffers = [];\n      }\n\n      var imageBuffers = this._imageBuffers;\n      return imageBuffers && imageBuffers.length > 0 ? imageBuffers.pop() : null;\n    };\n\n    _proto.saveImageBuffer = function saveImageBuffer(buffer) {\n      this._imageBuffers.push(buffer);\n    };\n\n    _proto.loadImageBuffer = function loadImageBuffer(data, glBuffer) {\n      var gl = this.gl;\n      var buffer = glBuffer || this.createImageBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n      gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n      return buffer;\n    };\n\n    _proto.createImageBuffer = function createImageBuffer() {\n      return this.getImageBuffer() || this.createBuffer();\n    };\n\n    _proto.removeGLCanvas = function removeGLCanvas() {\n      var gl = this.gl;\n\n      if (!gl) {\n        return;\n      }\n\n      if (this._debugBuffer) {\n        gl.deleteBuffer(this._debugBuffer);\n        delete this._debugBuffer;\n      }\n\n      if (this._buffers) {\n        this._buffers.forEach(function (b) {\n          gl.deleteBuffer(b);\n        });\n\n        delete this._buffers;\n      }\n\n      if (this._textures) {\n        this._textures.forEach(function (t) {\n          return gl.deleteTexture(t);\n        });\n\n        delete this._textures;\n      }\n\n      if (this._debugInfoCanvas) {\n        var texture = this._debugInfoCanvas.texture;\n\n        if (texture) {\n          gl.deleteTexture(texture);\n        }\n\n        delete this._debugInfoCanvas.texture;\n        delete this._debugInfoCanvas;\n      }\n\n      var program = gl.program;\n      gl.deleteShader(program.fragmentShader);\n      gl.deleteShader(program.vertexShader);\n      gl.deleteProgram(program);\n      delete this.gl;\n      delete this.canvas2;\n    };\n\n    _proto.createBuffer = function createBuffer() {\n      var gl = this.gl;\n      var buffer = gl.createBuffer();\n\n      if (!buffer) {\n        throw new Error('Failed to create the buffer object');\n      }\n\n      if (!this._buffers) {\n        this._buffers = [];\n      }\n\n      this._buffers.push(buffer);\n\n      return buffer;\n    };\n\n    _proto.enableVertexAttrib = function enableVertexAttrib$$1(attributes) {\n      enableVertexAttrib(this.gl, this.gl.program, attributes);\n    };\n\n    _proto.createProgram = function createProgram$$1(vert, frag, uniforms) {\n      var gl = this.gl;\n\n      var _createProgram2 = createProgram(gl, vert, frag),\n          program = _createProgram2.program,\n          vertexShader = _createProgram2.vertexShader,\n          fragmentShader = _createProgram2.fragmentShader;\n\n      program.vertexShader = vertexShader;\n      program.fragmentShader = fragmentShader;\n\n      this._initUniforms(program, uniforms);\n\n      return program;\n    };\n\n    _proto.useProgram = function useProgram(program) {\n      var gl = this.gl;\n      gl.useProgram(program);\n      gl.program = program;\n      return this;\n    };\n\n    _proto.enableSampler = function enableSampler(sampler, texIdx) {\n      var gl = this.gl;\n\n      var uSampler = this._getUniform(gl.program, sampler);\n\n      if (!texIdx) {\n        texIdx = 0;\n      }\n\n      gl.uniform1i(uSampler, texIdx);\n      return uSampler;\n    };\n\n    _proto._initUniforms = function _initUniforms(program, uniforms) {\n      for (var i = 0; i < uniforms.length; i++) {\n        var name = uniforms[i];\n        var uniform = uniforms[i];\n        var b = name.indexOf('[');\n\n        if (b >= 0) {\n          name = name.substring(0, b);\n\n          if (!IS_NODE) {\n            uniform = uniform.substring(0, b);\n          }\n        }\n\n        program[name] = this._getUniform(program, uniform);\n      }\n    };\n\n    _proto._getUniform = function _getUniform(program, uniformName) {\n      var gl = this.gl;\n      var uniform = gl.getUniformLocation(program, uniformName);\n\n      if (!uniform) {\n        throw new Error('Failed to get the storage location of ' + uniformName);\n      }\n\n      return uniform;\n    };\n\n    return renderable;\n  }(Base);\n\n  extend(renderable.prototype, {\n    set8: function () {\n      var out = Browser$1.ie9 ? null : new Float32Array(8);\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a4;\n        out[5] = a5;\n        out[6] = a6;\n        out[7] = a7;\n        return out;\n      };\n    }(),\n    set8Int: function () {\n      var out = Browser$1.ie9 ? null : new Int16Array(8);\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a4;\n        out[5] = a5;\n        out[6] = a6;\n        out[7] = a7;\n        return out;\n      };\n    }()\n  });\n  return renderable;\n};\n\nvar options$w = {\n  renderer: Browser$1.webgl ? 'gl' : 'canvas',\n  crossOrigin: null\n};\nvar TEMP_POINT$1 = new Point(0, 0);\n\nvar ImageLayer = function (_Layer) {\n  _inheritsLoose(ImageLayer, _Layer);\n\n  function ImageLayer(id, images, options) {\n    var _this;\n\n    if (images && !Array.isArray(images) && !images.url) {\n      options = images;\n      images = null;\n    }\n\n    _this = _Layer.call(this, id, options) || this;\n    _this._images = images;\n    return _this;\n  }\n\n  var _proto = ImageLayer.prototype;\n\n  _proto.onAdd = function onAdd() {\n    this._prepareImages(this._images);\n  };\n\n  _proto.setImages = function setImages(images) {\n    this._images = images;\n\n    this._prepareImages(images);\n\n    return this;\n  };\n\n  _proto.getImages = function getImages() {\n    return this._images;\n  };\n\n  _proto._prepareImages = function _prepareImages(images) {\n    images = images || [];\n\n    if (!Array.isArray(images)) {\n      images = [images];\n    }\n\n    var map = this.getMap();\n    this._imageData = images.map(function (img) {\n      var extent = new Extent(img.extent);\n      return extend({}, img, {\n        extent: extent,\n        extent2d: extent.convertTo(function (c) {\n          return map.coordToPoint(c, map.getGLZoom());\n        })\n      });\n    });\n    this._images = images;\n    var renderer = this.getRenderer();\n\n    if (renderer) {\n      renderer.refreshImages();\n    }\n  };\n\n  return ImageLayer;\n}(Layer);\n\nImageLayer.mergeOptions(options$w);\nvar EMPTY_ARRAY = [];\nvar ImageLayerCanvasRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(ImageLayerCanvasRenderer, _CanvasRenderer);\n\n  function ImageLayerCanvasRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = ImageLayerCanvasRenderer.prototype;\n\n  _proto2.isDrawable = function isDrawable() {\n    if (this.getMap().getPitch()) {\n      if (console) {\n        console.warn('ImageLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n      }\n\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto2.checkResources = function checkResources() {\n    var _this2 = this;\n\n    if (this._imageLoaded) {\n      return EMPTY_ARRAY;\n    }\n\n    var layer = this.layer;\n\n    var urls = layer._imageData.map(function (img) {\n      return [img.url, null, null];\n    });\n\n    if (this.resources) {\n      var unloaded = [];\n      var resources = new ResourceCache();\n      urls.forEach(function (url) {\n        if (_this2.resources.isResourceLoaded(url)) {\n          var img = _this2.resources.getImage(url);\n\n          resources.addResource(url, img);\n        } else {\n          unloaded.push(url);\n        }\n      });\n      this.resources.forEach(function (url, res) {\n        if (!resources.isResourceLoaded(url)) {\n          _this2.retireImage(res.image);\n        }\n      });\n      this.resources = resources;\n      urls = unloaded;\n    }\n\n    this._imageLoaded = true;\n    return urls;\n  };\n\n  _proto2.retireImage = function retireImage() {};\n\n  _proto2.refreshImages = function refreshImages() {\n    this._imageLoaded = false;\n    this.setToRedraw();\n  };\n\n  _proto2.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isZooming() && !map.getPitch()) {\n      return false;\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto2.draw = function draw() {\n    if (!this.isDrawable()) {\n      return;\n    }\n\n    this.prepareCanvas();\n    this._painted = false;\n\n    this._drawImages();\n\n    this.completeRender();\n  };\n\n  _proto2._drawImages = function _drawImages() {\n    var imgData = this.layer._imageData;\n    var map = this.getMap();\n\n    var mapExtent = map._get2DExtent(map.getGLZoom());\n\n    if (imgData && imgData.length) {\n      for (var i = 0; i < imgData.length; i++) {\n        var extent = imgData[i].extent2d;\n        var image = this.resources && this.resources.getImage(imgData[i].url);\n\n        if (image && mapExtent.intersects(extent)) {\n          this._painted = true;\n\n          this._drawImage(image, extent, imgData[i].opacity || 1);\n        }\n      }\n    }\n  };\n\n  _proto2._drawImage = function _drawImage(image, extent, opacity) {\n    var globalAlpha = 0;\n    var ctx = this.context;\n\n    if (opacity < 1) {\n      globalAlpha = ctx.globalAlpha;\n      ctx.globalAlpha = opacity;\n    }\n\n    var map = this.getMap();\n    var nw = TEMP_POINT$1.set(extent.xmin, extent.ymax);\n\n    var point = map._pointToContainerPoint(nw, map.getGLZoom());\n\n    var x = point.x,\n        y = point.y;\n    var bearing = map.getBearing();\n\n    if (bearing) {\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (bearing) {\n        ctx.rotate(-bearing * Math.PI / 180);\n      }\n\n      x = y = 0;\n    }\n\n    var scale = map.getGLScale();\n    ctx.drawImage(image, x, y, extent.getWidth() / scale, extent.getHeight() / scale);\n\n    if (bearing) {\n      ctx.restore();\n    }\n\n    if (globalAlpha) {\n      ctx.globalAlpha = globalAlpha;\n    }\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n  };\n\n  return ImageLayerCanvasRenderer;\n}(CanvasRenderer);\nvar ImageLayerGLRenderer = function (_ImageGLRenderable) {\n  _inheritsLoose(ImageLayerGLRenderer, _ImageGLRenderable);\n\n  function ImageLayerGLRenderer() {\n    return _ImageGLRenderable.apply(this, arguments) || this;\n  }\n\n  var _proto3 = ImageLayerGLRenderer.prototype;\n\n  _proto3.isDrawable = function isDrawable() {\n    return true;\n  };\n\n  _proto3._drawImage = function _drawImage(image, extent, opacity) {\n    this.drawGLImage(image, extent.xmin, extent.ymax, extent.getWidth(), extent.getHeight(), 1, opacity);\n  };\n\n  _proto3.createContext = function createContext() {\n    this.createGLContext();\n  };\n\n  _proto3.resizeCanvas = function resizeCanvas(canvasSize) {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.resizeCanvas.call(this, canvasSize);\n\n    this.resizeGLCanvas();\n  };\n\n  _proto3.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.clearCanvas.call(this);\n\n    this.clearGLCanvas();\n  };\n\n  _proto3.retireImage = function retireImage(image) {\n    this.disposeImage(image);\n  };\n\n  _proto3.onRemove = function onRemove() {\n    this.removeGLCanvas();\n\n    _ImageGLRenderable.prototype.onRemove.call(this);\n  };\n\n  return ImageLayerGLRenderer;\n}(ImageGLRenderable(ImageLayerCanvasRenderer));\nImageLayer.registerRenderer('canvas', ImageLayerCanvasRenderer);\nImageLayer.registerRenderer('gl', ImageLayerGLRenderer);\n\nvar CanvasLayerRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(CanvasLayerRenderer, _CanvasRenderer);\n\n  function CanvasLayerRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasLayerRenderer.prototype;\n\n  _proto.getPrepareParams = function getPrepareParams() {\n    return [];\n  };\n\n  _proto.getDrawParams = function getDrawParams() {\n    return [];\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    if (this.canvas && this.layer.options['doubleBuffer']) {\n      this.buffer = Canvas.createCanvas(this.canvas.width, this.canvas.height, this.getMap().CanvasClass);\n    }\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    if (this.layer.options['animation']) {\n      return true;\n    }\n\n    var map = this.getMap();\n\n    if (map.isInteracting() && !this.layer.drawOnInteracting) {\n      return false;\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto.draw = function draw() {\n    this.prepareCanvas();\n    this.prepareDrawContext();\n\n    this._drawLayer();\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    this._drawLayerOnInteracting();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    var canvasImg = _CanvasRenderer.prototype.getCanvasImage.call(this);\n\n    if (canvasImg && canvasImg.image && this.layer.options['doubleBuffer']) {\n      var canvas = canvasImg.image;\n\n      if (this.buffer.width !== canvas.width || this.buffer.height !== canvas.height) {\n        this.buffer.width = canvas.width;\n        this.buffer.height = canvas.height;\n      }\n\n      var bufferContext = this.buffer.getContext('2d');\n      var prevent = this.layer.doubleBuffer(bufferContext, this.context);\n\n      if (prevent === undefined || prevent) {\n        Canvas.image(bufferContext, canvas, 0, 0);\n        canvasImg.image = this.buffer;\n      }\n    }\n\n    return canvasImg;\n  };\n\n  _proto.remove = function remove() {\n    delete this._drawContext;\n    return _CanvasRenderer.prototype.remove.call(this);\n  };\n\n  _proto.onZoomStart = function onZoomStart(param) {\n    this.layer.onZoomStart(param);\n\n    _CanvasRenderer.prototype.onZoomStart.call(this, param);\n  };\n\n  _proto.onZooming = function onZooming(param) {\n    this.layer.onZooming(param);\n\n    _CanvasRenderer.prototype.onZooming.call(this, param);\n  };\n\n  _proto.onZoomEnd = function onZoomEnd(param) {\n    this.layer.onZoomEnd(param);\n\n    _CanvasRenderer.prototype.onZoomEnd.call(this, param);\n  };\n\n  _proto.onMoveStart = function onMoveStart(param) {\n    this.layer.onMoveStart(param);\n\n    _CanvasRenderer.prototype.onMoveStart.call(this, param);\n  };\n\n  _proto.onMoving = function onMoving(param) {\n    this.layer.onMoving(param);\n\n    _CanvasRenderer.prototype.onMoving.call(this, param);\n  };\n\n  _proto.onMoveEnd = function onMoveEnd(param) {\n    this.layer.onMoveEnd(param);\n\n    _CanvasRenderer.prototype.onMoveEnd.call(this, param);\n  };\n\n  _proto.onResize = function onResize(param) {\n    this.layer.onResize(param);\n\n    _CanvasRenderer.prototype.onResize.call(this, param);\n  };\n\n  _proto.prepareDrawContext = function prepareDrawContext() {\n    if (!this._predrawed) {\n      var params = ensureParams(this.getPrepareParams());\n      this._drawContext = this.layer.prepareToDraw.apply(this.layer, [this.context].concat(params));\n\n      if (!this._drawContext) {\n        this._drawContext = [];\n      }\n\n      if (!Array.isArray(this._drawContext)) {\n        this._drawContext = [this._drawContext];\n      }\n\n      this._predrawed = true;\n    }\n  };\n\n  _proto._prepareDrawParams = function _prepareDrawParams() {\n    if (!this.getMap()) {\n      return null;\n    }\n\n    var view = this.getViewExtent();\n\n    if (view['maskExtent'] && !view['extent'].intersects(view['maskExtent'])) {\n      this.completeRender();\n      return null;\n    }\n\n    var args = [this.context, view];\n    var params = ensureParams(this.getDrawParams());\n    args.push.apply(args, params);\n    args.push.apply(args, this._drawContext);\n    return args;\n  };\n\n  _proto._drawLayer = function _drawLayer() {\n    var args = this._prepareDrawParams();\n\n    if (!args) {\n      return;\n    }\n\n    this.layer.draw.apply(this.layer, args);\n    this.completeRender();\n  };\n\n  _proto._drawLayerOnInteracting = function _drawLayerOnInteracting() {\n    if (!this.layer.drawOnInteracting) {\n      return;\n    }\n\n    var args = this._prepareDrawParams();\n\n    if (!args) {\n      return;\n    }\n\n    this.layer.drawOnInteracting.apply(this.layer, args);\n    this.completeRender();\n  };\n\n  return CanvasLayerRenderer;\n}(CanvasRenderer);\n\nfunction ensureParams(params) {\n  if (!params) {\n    params = [];\n  }\n\n  if (!Array.isArray(params)) {\n    params = [params];\n  }\n\n  return params;\n}\n\nvar options$x = {\n  'doubleBuffer': false,\n  'animation': false\n};\n\nvar CanvasLayer = function (_Layer) {\n  _inheritsLoose(CanvasLayer, _Layer);\n\n  function CanvasLayer() {\n    return _Layer.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasLayer.prototype;\n\n  _proto.isCanvasRender = function isCanvasRender() {\n    return true;\n  };\n\n  _proto.prepareToDraw = function prepareToDraw() {};\n\n  _proto.draw = function draw() {};\n\n  _proto.redraw = function redraw() {\n    if (this._getRenderer()) {\n      this._getRenderer().setToRedraw();\n    }\n\n    return this;\n  };\n\n  _proto.play = function play() {\n    this.config('animation', true);\n    return this;\n  };\n\n  _proto.pause = function pause() {\n    this.config('animation', false);\n    return this;\n  };\n\n  _proto.isPlaying = function isPlaying() {\n    return this.options['animation'];\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (this._getRenderer()) {\n      this._getRenderer().clearCanvas();\n    }\n\n    return this;\n  };\n\n  _proto.requestMapToRender = function requestMapToRender() {\n    if (this._getRenderer()) {\n      this._getRenderer().requestMapToRender();\n    }\n\n    return this;\n  };\n\n  _proto.completeRender = function completeRender() {\n    if (this._getRenderer()) {\n      this._getRenderer().completeRender();\n    }\n\n    return this;\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    return this;\n  };\n\n  _proto.onZoomStart = function onZoomStart() {};\n\n  _proto.onZooming = function onZooming() {};\n\n  _proto.onZoomEnd = function onZoomEnd() {};\n\n  _proto.onMoveStart = function onMoveStart() {};\n\n  _proto.onMoving = function onMoving() {};\n\n  _proto.onMoveEnd = function onMoveEnd() {};\n\n  _proto.onResize = function onResize() {};\n\n  _proto.doubleBuffer = function doubleBuffer(bufferContext) {\n    bufferContext.clearRect(0, 0, bufferContext.canvas.width, bufferContext.canvas.height);\n    return this;\n  };\n\n  return CanvasLayer;\n}(Layer);\n\nCanvasLayer.mergeOptions(options$x);\nCanvasLayer.registerRenderer('canvas', CanvasLayerRenderer);\n\nvar TEMP_POINT$2 = new Point(0, 0);\nvar options$y = {\n  'animation': true\n};\n\nvar ParticleLayer = function (_CanvasLayer) {\n  _inheritsLoose(ParticleLayer, _CanvasLayer);\n\n  function ParticleLayer() {\n    return _CanvasLayer.apply(this, arguments) || this;\n  }\n\n  var _proto = ParticleLayer.prototype;\n\n  _proto.getParticles = function getParticles() {};\n\n  _proto.draw = function draw(context, view) {\n    var points = this.getParticles(now());\n\n    if (!points || points.length === 0) {\n      var renderer = this._getRenderer();\n\n      if (renderer) {\n        this._getRenderer()._shouldClear = true;\n      }\n\n      return;\n    }\n\n    var map = this.getMap();\n    var extent = view.extent;\n\n    if (view.maskExtent) {\n      extent = view.extent.intersection(view.maskExtent);\n    }\n\n    extent = extent.convertTo(function (c) {\n      return map._pointToContainerPoint(c, undefined, 0, TEMP_POINT$2);\n    });\n    var e = 2 * Math.PI;\n\n    for (var i = 0, l = points.length; i < l; i++) {\n      var pos = points[i].point;\n\n      if (extent.contains(pos)) {\n        var color = points[i].color || this.options['lineColor'] || '#fff',\n            r = points[i].r;\n\n        if (context.fillStyle !== color) {\n          context.fillStyle = color;\n        }\n\n        if (r <= 2) {\n          context.fillRect(pos.x - r / 2, pos.y - r / 2, r, r);\n        } else {\n          context.beginPath();\n          context.arc(pos.x, pos.y, r / 2, 0, e);\n          context.fill();\n        }\n      }\n    }\n\n    this._fillCanvas(context);\n  };\n\n  _proto._fillCanvas = function _fillCanvas(context) {\n    var g = context.globalCompositeOperation;\n    context.globalCompositeOperation = 'destination-out';\n    var trail = this.options['trail'] || 30;\n    context.fillStyle = 'rgba(0, 0, 0, ' + 1 / trail + ')';\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height);\n    context.globalCompositeOperation = g;\n  };\n\n  return ParticleLayer;\n}(CanvasLayer);\n\nParticleLayer.mergeOptions(options$y);\nParticleLayer.registerRenderer('canvas', function (_CanvasLayerRenderer) {\n  _inheritsLoose(_class, _CanvasLayerRenderer);\n\n  function _class() {\n    return _CanvasLayerRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = _class.prototype;\n\n  _proto2.draw = function draw() {\n    if (!this.canvas || !this.layer.options['animation'] || this._shouldClear) {\n      this.prepareCanvas();\n      this._shouldClear = false;\n    }\n\n    this.prepareDrawContext();\n\n    this._drawLayer();\n  };\n\n  _proto2.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n    this._shouldClear = false;\n  };\n\n  _proto2.onSkipDrawOnInteracting = function onSkipDrawOnInteracting() {\n    this._shouldClear = true;\n  };\n\n  return _class;\n}(CanvasLayerRenderer));\n\nvar EDIT_STAGE_LAYER_PREFIX = INTERNAL_LAYER_PREFIX + '_edit_stage_';\n\nfunction createHandleSymbol(markerType, opacity) {\n  return {\n    'markerType': markerType,\n    'markerFill': '#fff',\n    'markerLineColor': '#000',\n    'markerLineWidth': 2,\n    'markerWidth': 10,\n    'markerHeight': 10,\n    'opacity': opacity\n  };\n}\n\nvar options$z = {\n  'fixAspectRatio': false,\n  'symbol': null,\n  'removeVertexOn': 'contextmenu',\n  'centerHandleSymbol': createHandleSymbol('ellipse', 1),\n  'vertexHandleSymbol': createHandleSymbol('square', 1),\n  'newVertexHandleSymbol': createHandleSymbol('square', 0.4)\n};\n\nvar GeometryEditor = function (_Eventable) {\n  _inheritsLoose(GeometryEditor, _Eventable);\n\n  function GeometryEditor(geometry, opts) {\n    var _this;\n\n    _this = _Eventable.call(this, opts) || this;\n    _this._geometry = geometry;\n\n    if (!_this._geometry) {\n      return _assertThisInitialized(_this);\n    }\n\n    return _this;\n  }\n\n  var _proto = GeometryEditor.prototype;\n\n  _proto.getMap = function getMap() {\n    return this._geometry.getMap();\n  };\n\n  _proto.prepare = function prepare() {\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    if (this.options['symbol']) {\n      this._originalSymbol = this._geometry.getSymbol();\n\n      this._geometry.setSymbol(this.options['symbol']);\n    }\n\n    this._prepareEditStageLayer();\n  };\n\n  _proto._prepareEditStageLayer = function _prepareEditStageLayer() {\n    var map = this.getMap();\n    var uid = UID();\n    var stageId = EDIT_STAGE_LAYER_PREFIX + uid,\n        shadowId = EDIT_STAGE_LAYER_PREFIX + uid + '_shadow';\n    this._editStageLayer = map.getLayer(stageId);\n    this._shadowLayer = map.getLayer(shadowId);\n\n    if (!this._editStageLayer) {\n      this._editStageLayer = new VectorLayer(stageId);\n      map.addLayer(this._editStageLayer);\n    }\n\n    if (!this._shadowLayer) {\n      this._shadowLayer = new VectorLayer(shadowId);\n      map.addLayer(this._shadowLayer);\n    }\n  };\n\n  _proto.start = function start() {\n    var _this2 = this;\n\n    if (!this._geometry || !this._geometry.getMap() || this._geometry.editing) {\n      return;\n    }\n\n    var map = this.getMap();\n    this.editing = true;\n    var geometry = this._geometry;\n    this._geometryDraggble = geometry.options['draggable'];\n    geometry.config('draggable', false);\n    this.prepare();\n    var shadow = geometry.copy();\n    shadow.setSymbol(geometry._getInternalSymbol());\n    shadow.copyEventListeners(geometry);\n\n    if (geometry._getParent()) {\n      shadow.copyEventListeners(geometry._getParent());\n    }\n\n    shadow._setEventTarget(geometry);\n\n    shadow.setId(null).config({\n      'draggable': false\n    });\n    this._shadow = shadow;\n\n    this._switchGeometryEvents('on');\n\n    geometry.hide();\n\n    if (geometry instanceof Marker || geometry instanceof Circle || geometry instanceof Rectangle || geometry instanceof Ellipse) {\n      this._createOrRefreshOutline();\n    }\n\n    this._shadowLayer.bringToFront().addGeometry(shadow);\n\n    this._editStageLayer.bringToFront();\n\n    this._addListener([map, 'zoomstart', function () {\n      _this2._editStageLayer.hide();\n    }]);\n\n    this._addListener([map, 'zoomend', function () {\n      _this2._editStageLayer.show();\n    }]);\n\n    if (!(geometry instanceof Marker)) {\n      this._createCenterHandle();\n    } else {\n      shadow.config('draggable', true);\n      shadow.on('dragend', this._onMarkerDragEnd, this);\n    }\n\n    if (geometry instanceof Marker) {\n      this.createMarkerEditor();\n    } else if (geometry instanceof Circle) {\n      this.createCircleEditor();\n    } else if (geometry instanceof Rectangle) {\n      this.createEllipseOrRectEditor();\n    } else if (geometry instanceof Ellipse) {\n      this.createEllipseOrRectEditor();\n    } else if (geometry instanceof Sector) ; else if (geometry instanceof Polygon || geometry instanceof LineString) {\n      this.createPolygonEditor();\n    }\n  };\n\n  _proto.stop = function stop() {\n    delete this._history;\n    delete this._historyPointer;\n    delete this._editOutline;\n\n    this._switchGeometryEvents('off');\n\n    var map = this.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    delete this._shadow;\n\n    this._geometry.config('draggable', this._geometryDraggble);\n\n    delete this._geometryDraggble;\n\n    this._geometry.show();\n\n    this._editStageLayer.remove();\n\n    this._shadowLayer.remove();\n\n    this._clearAllListeners();\n\n    this._refreshHooks = [];\n\n    if (this.options['symbol']) {\n      this._geometry.setSymbol(this._originalSymbol);\n\n      delete this._originalSymbol;\n    }\n\n    this.editing = false;\n  };\n\n  _proto.isEditing = function isEditing() {\n    if (isNil(this.editing)) {\n      return false;\n    }\n\n    return this.editing;\n  };\n\n  _proto._getGeometryEvents = function _getGeometryEvents() {\n    return {\n      'symbolchange': this._onGeoSymbolChange,\n      'positionchange shapechange': this._exeAndReset\n    };\n  };\n\n  _proto._switchGeometryEvents = function _switchGeometryEvents(oper) {\n    if (this._geometry) {\n      var events = this._getGeometryEvents();\n\n      for (var p in events) {\n        this._geometry[oper](p, events[p], this);\n      }\n    }\n  };\n\n  _proto._onGeoSymbolChange = function _onGeoSymbolChange(param) {\n    if (this._shadow) {\n      this._shadow.setSymbol(param.target._getInternalSymbol());\n    }\n  };\n\n  _proto._onMarkerDragEnd = function _onMarkerDragEnd() {\n    this._update('setCoordinates', this._shadow.getCoordinates().toArray());\n\n    this._refresh();\n  };\n\n  _proto._createOrRefreshOutline = function _createOrRefreshOutline() {\n    var geometry = this._geometry;\n    var outline = this._editOutline;\n\n    if (!outline) {\n      outline = geometry.getOutline();\n\n      this._editStageLayer.addGeometry(outline);\n\n      this._editOutline = outline;\n\n      this._addRefreshHook(this._createOrRefreshOutline);\n    } else {\n      outline.remove();\n      this._editOutline = outline = geometry.getOutline();\n\n      this._editStageLayer.addGeometry(outline);\n    }\n\n    return outline;\n  };\n\n  _proto._createCenterHandle = function _createCenterHandle() {\n    var _this3 = this;\n\n    var center = this._shadow.getCenter();\n\n    var symbol = this.options['centerHandleSymbol'];\n    var shadow;\n    var handle = this.createHandle(center, {\n      'symbol': symbol,\n      'cursor': 'move',\n      onDown: function onDown() {\n        shadow = _this3._shadow.copy();\n        var symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n        shadow.setSymbol(symbol).addTo(_this3._editStageLayer);\n      },\n      onMove: function onMove(v, param) {\n        var offset = param['coordOffset'];\n        shadow.translate(offset);\n      },\n      onUp: function onUp() {\n        _this3._update('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n\n        shadow.remove();\n\n        _this3._refresh();\n      }\n    });\n\n    this._addRefreshHook(function () {\n      var center = _this3._shadow.getCenter();\n\n      handle.setCoordinates(center);\n    });\n  };\n\n  _proto._createHandleInstance = function _createHandleInstance(coordinate, opts) {\n    var symbol = opts['symbol'];\n    var handle = new Marker(coordinate, {\n      'draggable': true,\n      'dragShadow': false,\n      'dragOnAxis': opts['axis'],\n      'cursor': opts['cursor'],\n      'symbol': symbol\n    });\n    return handle;\n  };\n\n  _proto.createHandle = function createHandle(coordinate, opts) {\n    if (!opts) {\n      opts = {};\n    }\n\n    var map = this.getMap();\n\n    var handle = this._createHandleInstance(coordinate, opts);\n\n    var me = this;\n\n    function onHandleDragstart(param) {\n      if (opts.onDown) {\n        this._geometry.fire('handledragstart');\n\n        opts.onDown.call(me, param['viewPoint'], param);\n      }\n\n      return false;\n    }\n\n    function onHandleDragging(param) {\n      me._hideContext();\n\n      var viewPoint = map._prjToViewPoint(handle._getPrjCoordinates());\n\n      if (opts.onMove) {\n        this._geometry.fire('handledragging');\n\n        opts.onMove.call(me, viewPoint, param);\n      }\n\n      return false;\n    }\n\n    function onHandleDragEnd(ev) {\n      if (opts.onUp) {\n        this._geometry.fire('handledragend');\n\n        opts.onUp.call(me, ev);\n      }\n\n      return false;\n    }\n\n    function onHandleRemove() {\n      handle.config('draggable', false);\n      handle.off('dragstart', onHandleDragstart, me);\n      handle.off('dragging', onHandleDragging, me);\n      handle.off('dragend', onHandleDragEnd, me);\n      handle.off('removestart', onHandleRemove, me);\n      delete handle['maptalks--editor-refresh-fn'];\n    }\n\n    handle.on('dragstart', onHandleDragstart, this);\n    handle.on('dragging', onHandleDragging, this);\n    handle.on('dragend', onHandleDragEnd, this);\n    handle.on('removestart', onHandleRemove, this);\n\n    if (opts.onRefresh) {\n      handle['maptalks--editor-refresh-fn'] = opts.onRefresh;\n    }\n\n    this._editStageLayer.addGeometry(handle);\n\n    return handle;\n  };\n\n  _proto._createResizeHandles = function _createResizeHandles(blackList, onHandleMove, onHandleUp) {\n    var _this4 = this;\n\n    var cursors = ['nw-resize', 'n-resize', 'ne-resize', 'w-resize', 'e-resize', 'sw-resize', 's-resize', 'se-resize'];\n    var axis = [null, 'y', null, 'x', 'x', null, 'y', null];\n    var geometry = this._geometry;\n\n    function getResizeAnchors(ext) {\n      return [new Point(ext['xmin'], ext['ymax']), new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymax']), new Point(ext['xmax'], ext['ymax']), new Point(ext['xmin'], (ext['ymax'] + ext['ymin']) / 2), new Point(ext['xmax'], (ext['ymax'] + ext['ymin']) / 2), new Point(ext['xmin'], ext['ymin']), new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymin']), new Point(ext['xmax'], ext['ymin'])];\n    }\n\n    if (!blackList) {\n      blackList = [];\n    }\n\n    var me = this;\n    var resizeHandles = [],\n        anchorIndexes = {},\n        map = this.getMap(),\n        handleSymbol = this.options['vertexHandleSymbol'];\n\n    var fnLocateHandles = function fnLocateHandles() {\n      var pExt = geometry._getPainter().get2DExtent(),\n          anchors = getResizeAnchors(pExt);\n\n      var _loop = function _loop(i) {\n        if (Array.isArray(blackList)) {\n          var isBlack = blackList.some(function (ele) {\n            return ele === i;\n          });\n\n          if (isBlack) {\n            return \"continue\";\n          }\n        }\n\n        var anchor = anchors[i],\n            coordinate = map.pointToCoordinate(anchor);\n\n        if (resizeHandles.length < anchors.length - blackList.length) {\n          var handle = _this4.createHandle(coordinate, {\n            'symbol': handleSymbol,\n            'cursor': cursors[i],\n            'axis': axis[i],\n            onMove: function (_index) {\n              return function (handleViewPoint) {\n                me._updating = true;\n                onHandleMove(handleViewPoint, _index);\n                geometry.fire('resizing');\n              };\n            }(i),\n            onUp: function onUp() {\n              me._updating = false;\n              onHandleUp();\n\n              _this4._refresh();\n            }\n          });\n\n          handle.setId(i);\n          anchorIndexes[i] = resizeHandles.length;\n          resizeHandles.push(handle);\n        } else {\n          resizeHandles[anchorIndexes[i]].setCoordinates(coordinate);\n        }\n      };\n\n      for (var i = 0; i < anchors.length; i++) {\n        var _ret = _loop(i);\n\n        if (_ret === \"continue\") continue;\n      }\n    };\n\n    fnLocateHandles();\n\n    this._addRefreshHook(fnLocateHandles);\n\n    return resizeHandles;\n  };\n\n  _proto.createMarkerEditor = function createMarkerEditor() {\n    var _this5 = this;\n\n    var geometryToEdit = this._geometry,\n        shadow = this._shadow,\n        map = this.getMap();\n\n    if (!shadow._canEdit()) {\n      if (console) {\n        console.warn('A marker can\\'t be resized with symbol:', shadow.getSymbol());\n      }\n\n      return;\n    }\n\n    if (!this._history) {\n      this._recordHistory(getUpdates());\n    }\n\n    var symbol = shadow._getInternalSymbol();\n\n    var dxdy = new Point(0, 0);\n\n    if (isNumber(symbol['markerDx'])) {\n      dxdy.x = symbol['markerDx'];\n    }\n\n    if (isNumber(symbol['markerDy'])) {\n      dxdy.y = symbol['markerDy'];\n    }\n\n    var blackList = null;\n\n    if (VectorMarkerSymbolizer.test(symbol)) {\n      if (symbol['markerType'] === 'pin' || symbol['markerType'] === 'pie' || symbol['markerType'] === 'bar') {\n        blackList = [5, 6, 7];\n      }\n    } else if (ImageMarkerSymbolizer.test(symbol) || VectorPathMarkerSymbolizer.test(symbol)) {\n      blackList = [5, 6, 7];\n    }\n\n    var resizeAbilities = [2, 1, 2, 0, 0, 2, 1, 2];\n    var aspectRatio;\n\n    if (this.options['fixAspectRatio']) {\n      var size = shadow.getSize();\n      aspectRatio = size.width / size.height;\n    }\n\n    var resizeHandles = this._createResizeHandles(null, function (handleViewPoint, i) {\n      if (blackList && blackList.indexOf(i) >= 0) {\n        var newCoordinates = map.viewPointToCoordinate(handleViewPoint.sub(dxdy));\n        var coordinates = shadow.getCoordinates();\n        newCoordinates.x = coordinates.x;\n        shadow.setCoordinates(newCoordinates);\n\n        _this5._updateCoordFromShadow(true);\n\n        var mirrorHandle = resizeHandles[resizeHandles.length - 1 - i];\n        var mirrorViewPoint = map.coordToViewPoint(mirrorHandle.getCoordinates());\n        handleViewPoint = mirrorViewPoint;\n      }\n\n      var viewCenter = map._pointToViewPoint(shadow._getCenter2DPoint()).add(dxdy),\n          symbol = shadow._getInternalSymbol();\n\n      var wh = handleViewPoint.sub(viewCenter);\n\n      if (blackList && handleViewPoint.y > viewCenter.y) {\n        wh.y = 0;\n      }\n\n      var r = blackList ? 1 : 2;\n      var width = Math.abs(wh.x) * 2,\n          height = Math.abs(wh.y) * r;\n\n      if (aspectRatio) {\n        width = Math.max(width, height * aspectRatio);\n        height = width / aspectRatio;\n      }\n\n      var ability = resizeAbilities[i];\n\n      if (!(shadow instanceof TextBox)) {\n        if (aspectRatio || ability === 0 || ability === 2) {\n          symbol['markerWidth'] = width;\n        }\n\n        if (aspectRatio || ability === 1 || ability === 2) {\n          symbol['markerHeight'] = height;\n        }\n\n        shadow.setSymbol(symbol);\n        geometryToEdit.setSymbol(symbol);\n      } else {\n        if (aspectRatio || ability === 0 || ability === 2) {\n          shadow.setWidth(width);\n          geometryToEdit.setWidth(width);\n        }\n\n        if (aspectRatio || ability === 1 || ability === 2) {\n          shadow.setHeight(height);\n          geometryToEdit.setHeight(height);\n        }\n      }\n    }, function () {\n      _this5._update(getUpdates());\n    });\n\n    function getUpdates() {\n      var updates = [['setCoordinates', shadow.getCoordinates().toArray()]];\n\n      if (shadow instanceof TextBox) {\n        updates.push(['setWidth', shadow.getWidth()]);\n        updates.push(['setHeight', shadow.getHeight()]);\n      } else {\n        updates.push(['setSymbol', shadow.getSymbol()]);\n      }\n\n      return updates;\n    }\n\n    function onZoomEnd() {\n      this._refresh();\n    }\n\n    this._addListener([map, 'zoomend', onZoomEnd]);\n  };\n\n  _proto.createCircleEditor = function createCircleEditor() {\n    var _this6 = this;\n\n    var circle = this._geometry,\n        shadow = this._shadow;\n    var map = this.getMap();\n\n    if (!this._history) {\n      this._recordHistory([['setCoordinates', shadow.getCoordinates().toArray()], ['setRadius', shadow.getRadius()]]);\n    }\n\n    this._createResizeHandles(null, function (handleViewPoint) {\n      var viewCenter = map._pointToViewPoint(shadow._getCenter2DPoint());\n\n      var wh = handleViewPoint.sub(viewCenter);\n      var w = Math.abs(wh.x),\n          h = Math.abs(wh.y);\n      var r;\n\n      if (w > h) {\n        r = map.pixelToDistance(w, 0);\n      } else {\n        r = map.pixelToDistance(0, h);\n      }\n\n      shadow.setRadius(r);\n      circle.setRadius(r);\n    }, function () {\n      _this6._update('setRadius', shadow.getRadius());\n    });\n  };\n\n  _proto.createEllipseOrRectEditor = function createEllipseOrRectEditor() {\n    var _this7 = this;\n\n    var resizeAbilities = [2, 1, 2, 0, 0, 2, 1, 2];\n    var geometryToEdit = this._geometry,\n        shadow = this._shadow;\n\n    if (!this._history) {\n      this._recordHistory(getUpdates());\n    }\n\n    var map = this.getMap();\n    var isRect = this._geometry instanceof Rectangle;\n    var aspectRatio;\n\n    if (this.options['fixAspectRatio']) {\n      aspectRatio = geometryToEdit.getWidth() / geometryToEdit.getHeight();\n    }\n\n    var resizeHandles = this._createResizeHandles(null, function (mouseViewPoint, i) {\n      var r = isRect ? 1 : 2;\n      var pointSub, w, h;\n      var targetPoint = mouseViewPoint;\n      var ability = resizeAbilities[i];\n\n      if (isRect) {\n        var mirror = resizeHandles[7 - i];\n        var mirrorViewPoint = map.coordToViewPoint(mirror.getCoordinates());\n        pointSub = targetPoint.sub(mirrorViewPoint);\n        var absSub = pointSub.abs();\n        w = map.pixelToDistance(absSub.x, 0);\n        h = map.pixelToDistance(0, absSub.y);\n        var size = geometryToEdit.getSize();\n\n        if (ability === 0) {\n          if (aspectRatio) {\n            absSub.y = absSub.x / aspectRatio;\n            size.height = Math.abs(absSub.y);\n            h = w / aspectRatio;\n          }\n\n          targetPoint.y = mirrorViewPoint.y - size.height / 2;\n        } else if (ability === 1) {\n          if (aspectRatio) {\n            absSub.x = absSub.y * aspectRatio;\n            size.width = Math.abs(absSub.x);\n            w = h * aspectRatio;\n          }\n\n          targetPoint.x = mirrorViewPoint.x - size.width / 2;\n        } else if (aspectRatio) {\n          if (w > h * aspectRatio) {\n            h = w / aspectRatio;\n            targetPoint.y = mirrorViewPoint.y + absSub.x * sign(pointSub.y) / aspectRatio;\n          } else {\n            w = h * aspectRatio;\n            targetPoint.x = mirrorViewPoint.x + absSub.y * sign(pointSub.x) * aspectRatio;\n          }\n        }\n\n        var newCoordinates = map.viewPointToCoordinate(new Point(Math.min(targetPoint.x, mirrorViewPoint.x), Math.min(targetPoint.y, mirrorViewPoint.y)));\n        shadow.setCoordinates(newCoordinates);\n\n        _this7._updateCoordFromShadow(true);\n      } else {\n        var viewCenter = map.coordToViewPoint(geometryToEdit.getCenter());\n        pointSub = viewCenter.sub(targetPoint)._abs();\n        w = map.pixelToDistance(pointSub.x, 0);\n        h = map.pixelToDistance(0, pointSub.y);\n\n        if (aspectRatio) {\n          w = Math.max(w, h * aspectRatio);\n          h = w / aspectRatio;\n        }\n      }\n\n      if (aspectRatio || ability === 0 || ability === 2) {\n        shadow.setWidth(w * r);\n        geometryToEdit.setWidth(w * r);\n      }\n\n      if (aspectRatio || ability === 1 || ability === 2) {\n        shadow.setHeight(h * r);\n        geometryToEdit.setHeight(h * r);\n      }\n    }, function () {\n      _this7._update(getUpdates());\n    });\n\n    function getUpdates() {\n      return [['setCoordinates', shadow.getCoordinates().toArray()], ['setWidth', shadow.getWidth()], ['setHeight', shadow.getHeight()]];\n    }\n  };\n\n  _proto.createPolygonEditor = function createPolygonEditor() {\n    var map = this.getMap(),\n        shadow = this._shadow,\n        me = this,\n        projection = map.getProjection();\n\n    if (!this._history) {\n      this._recordHistory('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n    }\n\n    var verticeLimit = shadow instanceof Polygon ? 3 : 2;\n    var propertyOfVertexRefreshFn = 'maptalks--editor-refresh-fn',\n        propertyOfVertexIndex = 'maptalks--editor-vertex-index';\n    var vertexHandles = [],\n        newVertexHandles = [];\n\n    function getVertexCoordinates() {\n      if (shadow instanceof Polygon) {\n        var coordinates = shadow.getCoordinates()[0];\n        return coordinates.slice(0, coordinates.length - 1);\n      } else {\n        return shadow.getCoordinates();\n      }\n    }\n\n    function getVertexPrjCoordinates() {\n      return shadow._getPrjCoordinates();\n    }\n\n    function onVertexAddOrRemove() {\n      for (var i = vertexHandles.length - 1; i >= 0; i--) {\n        vertexHandles[i][propertyOfVertexIndex] = i;\n      }\n\n      for (var _i = newVertexHandles.length - 1; _i >= 0; _i--) {\n        newVertexHandles[_i][propertyOfVertexIndex] = _i;\n      }\n\n      me._updateCoordFromShadow();\n    }\n\n    function removeVertex(param) {\n      var handle = param['target'],\n          index = handle[propertyOfVertexIndex];\n      var prjCoordinates = getVertexPrjCoordinates();\n\n      if (prjCoordinates.length <= verticeLimit) {\n        return;\n      }\n\n      prjCoordinates.splice(index, 1);\n\n      shadow._setPrjCoordinates(prjCoordinates);\n\n      shadow._updateCache();\n\n      vertexHandles.splice(index, 1)[0].remove();\n\n      if (index < newVertexHandles.length) {\n        newVertexHandles.splice(index, 1)[0].remove();\n      }\n\n      var nextIndex;\n\n      if (index === 0) {\n        nextIndex = newVertexHandles.length - 1;\n      } else {\n        nextIndex = index - 1;\n      }\n\n      newVertexHandles.splice(nextIndex, 1)[0].remove();\n      newVertexHandles.splice(nextIndex, 0, createNewVertexHandle.call(me, nextIndex));\n      onVertexAddOrRemove();\n\n      me._refresh();\n    }\n\n    function moveVertexHandle(handleViewPoint, index) {\n      var vertice = getVertexPrjCoordinates();\n\n      var nVertex = map._viewPointToPrj(handleViewPoint);\n\n      var pVertex = vertice[index];\n      pVertex.x = nVertex.x;\n      pVertex.y = nVertex.y;\n\n      shadow._updateCache();\n\n      shadow.onShapeChanged();\n\n      me._updateCoordFromShadow(true);\n\n      var nextIndex;\n\n      if (index === 0) {\n        nextIndex = newVertexHandles.length - 1;\n      } else {\n        nextIndex = index - 1;\n      }\n\n      if (newVertexHandles[index]) {\n        newVertexHandles[index][propertyOfVertexRefreshFn]();\n      }\n\n      if (newVertexHandles[nextIndex]) {\n        newVertexHandles[nextIndex][propertyOfVertexRefreshFn]();\n      }\n    }\n\n    function createVertexHandle(index) {\n      var vertex = getVertexCoordinates()[index];\n      var handle = me.createHandle(vertex, {\n        'symbol': me.options['vertexHandleSymbol'],\n        'cursor': 'pointer',\n        'axis': null,\n        onMove: function onMove(handleViewPoint) {\n          moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex]);\n        },\n        onRefresh: function onRefresh() {\n          vertex = getVertexCoordinates()[handle[propertyOfVertexIndex]];\n          handle.setCoordinates(vertex);\n        },\n        onUp: function onUp() {\n          me._refresh();\n\n          me._updateCoordFromShadow();\n        },\n        onDown: function onDown(param, e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n        }\n      });\n      handle[propertyOfVertexIndex] = index;\n      handle.on(me.options['removeVertexOn'], removeVertex);\n      return handle;\n    }\n\n    function createNewVertexHandle(index) {\n      var vertexCoordinates = getVertexCoordinates();\n      var nextVertex;\n\n      if (index + 1 >= vertexCoordinates.length) {\n        nextVertex = vertexCoordinates[0];\n      } else {\n        nextVertex = vertexCoordinates[index + 1];\n      }\n\n      var vertex = vertexCoordinates[index].add(nextVertex).multi(1 / 2);\n      var handle = me.createHandle(vertex, {\n        'symbol': me.options['newVertexHandleSymbol'],\n        'cursor': 'pointer',\n        'axis': null,\n        onDown: function onDown(param, e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n\n          var prjCoordinates = getVertexPrjCoordinates();\n          var vertexIndex = handle[propertyOfVertexIndex];\n          var pVertex = projection.project(handle.getCoordinates());\n          prjCoordinates.splice(vertexIndex + 1, 0, pVertex);\n\n          shadow._setPrjCoordinates(prjCoordinates);\n\n          shadow._updateCache();\n\n          var symbol = handle.getSymbol();\n          delete symbol['opacity'];\n          handle.setSymbol(symbol);\n          newVertexHandles.splice(vertexIndex, 0, createNewVertexHandle.call(me, vertexIndex), createNewVertexHandle.call(me, vertexIndex + 1));\n        },\n        onMove: function onMove(handleViewPoint) {\n          moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex] + 1);\n        },\n        onUp: function onUp(e) {\n          if (e && e.domEvent && e.domEvent.button === 2) {\n            return;\n          }\n\n          var vertexIndex = handle[propertyOfVertexIndex];\n          removeFromArray(handle, newVertexHandles);\n          handle.remove();\n          vertexHandles.splice(vertexIndex + 1, 0, createVertexHandle.call(me, vertexIndex + 1));\n          onVertexAddOrRemove();\n\n          me._updateCoordFromShadow();\n\n          me._refresh();\n        },\n        onRefresh: function onRefresh() {\n          vertexCoordinates = getVertexCoordinates();\n          var vertexIndex = handle[propertyOfVertexIndex];\n          var nextIndex;\n\n          if (vertexIndex === vertexCoordinates.length - 1) {\n            nextIndex = 0;\n          } else {\n            nextIndex = vertexIndex + 1;\n          }\n\n          var refreshVertex = vertexCoordinates[vertexIndex].add(vertexCoordinates[nextIndex]).multi(1 / 2);\n          handle.setCoordinates(refreshVertex);\n        }\n      });\n      handle[propertyOfVertexIndex] = index;\n      return handle;\n    }\n\n    var vertexCoordinates = getVertexCoordinates();\n\n    for (var i = 0, len = vertexCoordinates.length; i < len; i++) {\n      vertexHandles.push(createVertexHandle.call(this, i));\n\n      if (i < len - 1) {\n        newVertexHandles.push(createNewVertexHandle.call(this, i));\n      }\n    }\n\n    if (shadow instanceof Polygon) {\n      newVertexHandles.push(createNewVertexHandle.call(this, vertexCoordinates.length - 1));\n    }\n\n    this._addRefreshHook(function () {\n      for (var _i2 = newVertexHandles.length - 1; _i2 >= 0; _i2--) {\n        newVertexHandles[_i2][propertyOfVertexRefreshFn]();\n      }\n\n      for (var _i3 = vertexHandles.length - 1; _i3 >= 0; _i3--) {\n        vertexHandles[_i3][propertyOfVertexRefreshFn]();\n      }\n    });\n  };\n\n  _proto._refresh = function _refresh() {\n    if (this._refreshHooks) {\n      for (var i = this._refreshHooks.length - 1; i >= 0; i--) {\n        this._refreshHooks[i].call(this);\n      }\n    }\n  };\n\n  _proto._hideContext = function _hideContext() {\n    if (this._geometry) {\n      this._geometry.closeMenu();\n\n      this._geometry.closeInfoWindow();\n    }\n  };\n\n  _proto._addListener = function _addListener(listener) {\n    if (!this._eventListeners) {\n      this._eventListeners = [];\n    }\n\n    this._eventListeners.push(listener);\n\n    listener[0].on(listener[1], listener[2], this);\n  };\n\n  _proto._clearAllListeners = function _clearAllListeners() {\n    if (this._eventListeners && this._eventListeners.length > 0) {\n      for (var i = this._eventListeners.length - 1; i >= 0; i--) {\n        var listener = this._eventListeners[i];\n        listener[0].off(listener[1], listener[2], this);\n      }\n\n      this._eventListeners = [];\n    }\n  };\n\n  _proto._addRefreshHook = function _addRefreshHook(fn) {\n    if (!fn) {\n      return;\n    }\n\n    if (!this._refreshHooks) {\n      this._refreshHooks = [];\n    }\n\n    this._refreshHooks.push(fn);\n  };\n\n  _proto._update = function _update(method) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    this._exeHistory([method, args]);\n\n    this._recordHistory.apply(this, [method].concat(args));\n  };\n\n  _proto._updateCoordFromShadow = function _updateCoordFromShadow(ignoreRecord) {\n    if (!this._shadow) {\n      return;\n    }\n\n    var coords = this._shadow.getCoordinates();\n\n    var geo = this._geometry;\n    var updating = this._updating;\n    this._updating = true;\n    geo.setCoordinates(coords);\n\n    if (!ignoreRecord) {\n      this._recordHistory('setCoordinates', Coordinate.toNumberArrays(geo.getCoordinates()));\n    }\n\n    this._updating = updating;\n  };\n\n  _proto._recordHistory = function _recordHistory(method) {\n    if (!this._history) {\n      this._history = [];\n      this._historyPointer = 0;\n    }\n\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    if (this._history.length) {\n      var lastOperation = this._history[this._history.length - 1];\n\n      if (lastOperation[0] === method && JSON.stringify(lastOperation[1]) === JSON.stringify(args)) {\n        return;\n      }\n    }\n\n    if (this._historyPointer < this._history.length - 1) {\n      this._history.splice(this._historyPointer + 1);\n    }\n\n    this._history.push([method, args]);\n\n    this._historyPointer = this._history.length - 1;\n\n    this._geometry.fire('editrecord');\n  };\n\n  _proto.cancel = function cancel() {\n    if (!this._history || this._historyPointer === 0) {\n      return this;\n    }\n\n    this._historyPointer = 0;\n    var record = this._history[0];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto.undo = function undo() {\n    if (!this._history || this._historyPointer === 0) {\n      return this;\n    }\n\n    var record = this._history[--this._historyPointer];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto.redo = function redo() {\n    if (!this._history || this._historyPointer === this._history.length - 1) {\n      return this;\n    }\n\n    var record = this._history[++this._historyPointer];\n\n    this._exeAndReset(record);\n\n    return this;\n  };\n\n  _proto._exeAndReset = function _exeAndReset(record) {\n    if (this._updating) {\n      return;\n    }\n\n    this._exeHistory(record);\n\n    var history = this._history,\n        pointer = this._historyPointer;\n    this.stop();\n    this._history = history;\n    this._historyPointer = pointer;\n    this.start();\n  };\n\n  _proto._exeHistory = function _exeHistory(record) {\n    var _this8 = this;\n\n    if (!Array.isArray(record)) {\n      return;\n    }\n\n    var updating = this._updating;\n    this._updating = true;\n    var geo = this._geometry;\n\n    if (Array.isArray(record[0])) {\n      record[0].forEach(function (o) {\n        var m = o[0],\n            args = o.slice(1);\n\n        _this8._shadow[m].apply(_this8._shadow, args);\n\n        geo[m].apply(geo, args);\n      });\n    } else {\n      this._shadow[record[0]].apply(this._shadow, record[1]);\n\n      geo[record[0]].apply(geo, record[1]);\n    }\n\n    this._updating = updating;\n  };\n\n  return GeometryEditor;\n}(Eventable(Class));\n\nGeometryEditor.mergeOptions(options$z);\n\nvar TextEditable = {\n  startEditText: function startEditText() {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    this.hide();\n    this.endEditText();\n\n    this._prepareEditor();\n\n    this._fireEvent('edittextstart');\n\n    return this;\n  },\n  endEditText: function endEditText() {\n    if (this._textEditor) {\n      var html = this._textEditor.innerHTML;\n      html = html.replace(/<p>/ig, '').replace(/<\\/p>/ig, '<br/>');\n      this._textEditor.innerHTML = html;\n\n      var content = this._textEditor.innerText.replace(/[\\r\\n]+$/gi, '');\n\n      this.setContent(content);\n      off(this._textEditor, 'mousedown dblclick', stopPropagation);\n      this.getMap().off('mousedown', this.endEditText, this);\n\n      this._editUIMarker.remove();\n\n      delete this._editUIMarker;\n      this._textEditor.onkeyup = null;\n      delete this._textEditor;\n      this.show();\n\n      this._fireEvent('edittextend');\n    }\n\n    return this;\n  },\n  isEditingText: function isEditingText() {\n    if (this._textEditor) {\n      return true;\n    }\n\n    return false;\n  },\n  getTextEditor: function getTextEditor() {\n    return this._editUIMarker;\n  },\n  _prepareEditor: function _prepareEditor() {\n    var map = this.getMap();\n\n    var editContainer = this._createEditor();\n\n    this._textEditor = editContainer;\n    map.on('mousedown', this.endEditText, this);\n\n    var offset = this._getEditorOffset();\n\n    this._editUIMarker = new UIMarker(this.getCoordinates(), {\n      'animation': null,\n      'content': editContainer,\n      'dx': offset.dx,\n      'dy': offset.dy\n    }).addTo(map);\n\n    this._setCursorToLast(this._textEditor);\n  },\n  _getEditorOffset: function _getEditorOffset() {\n    var symbol = this._getInternalSymbol() || {};\n    var dx = 0,\n        dy = 0;\n    var textAlign = symbol['textHorizontalAlignment'];\n\n    if (textAlign === 'middle' || isNil(textAlign)) {\n      dx = (symbol['textDx'] || 0) - 2;\n      dy = (symbol['textDy'] || 0) - 2;\n    } else {\n      dx = (symbol['markerDx'] || 0) - 2;\n      dy = (symbol['markerDy'] || 0) - 2;\n    }\n\n    return {\n      'dx': dx,\n      'dy': dy\n    };\n  },\n  _createEditor: function _createEditor() {\n    var content = this.getContent();\n    var labelSize = this.getSize(),\n        symbol = this._getInternalSymbol() || {},\n        width = labelSize.width,\n        textColor = symbol['textFill'] || '#000000',\n        textSize = symbol['textSize'] || 12,\n        height = labelSize.height,\n        lineColor = symbol['markerLineColor'] || '#000',\n        fill = symbol['markerFill'] || '#3398CC',\n        spacing = symbol['textLineSpacing'] || 0;\n    var editor = createEl('div');\n    editor.contentEditable = true;\n    editor.style.cssText = \"background:\" + fill + \"; border:1px solid \" + lineColor + \";\\n            color:\" + textColor + \";font-size:\" + textSize + \"px;width:\" + (width - 2) + \"px;height:\" + (height - 2) + \"px;margin: auto;\\n            line-height:\" + (textSize + spacing) + \"px;outline: 0; padding:0; margin:0;word-wrap: break-word;\\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;\";\n    editor.innerText = content;\n    on(editor, 'mousedown dblclick', stopPropagation);\n\n    editor.onkeyup = function (event) {\n      var h = editor.style.height || 0;\n\n      if (event.keyCode === 13) {\n        editor.style.height = parseInt(h) + textSize / 2 + 'px';\n      }\n    };\n\n    return editor;\n  },\n  _setCursorToLast: function _setCursorToLast(obj) {\n    var range;\n\n    if (window.getSelection) {\n      obj.focus();\n      range = window.getSelection();\n      range.selectAllChildren(obj);\n      range.collapseToEnd();\n    } else if (document.selection) {\n      range = document.selection.createRange();\n      range.moveToElementText(obj);\n      range.collapse(false);\n      range.select();\n    }\n  }\n};\nTextMarker.include(TextEditable);\n\nGeometry.include({\n  animate: function animate(styles, options, step) {\n    var _this = this;\n\n    if (this._animPlayer) {\n      this._animPlayer.finish();\n    }\n\n    if (isFunction(options)) {\n      step = options;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    var map = this.getMap(),\n        projection = this._getProjection(),\n        symbol = this.getSymbol() || {},\n        stylesToAnimate = this._prepareAnimationStyles(styles);\n\n    var preTranslate;\n    var isFocusing = options['focus'];\n    delete this._animationStarted;\n\n    if (map) {\n      var renderer = map._getRenderer();\n\n      var framer = function framer(fn) {\n        renderer.callInNextFrame(fn);\n      };\n\n      options['framer'] = framer;\n    }\n\n    var player = Animation.animate(stylesToAnimate, options, function (frame) {\n      if (map && map.isRemoved()) {\n        player.finish();\n        return;\n      }\n\n      if (map && !_this._animationStarted && isFocusing) {\n        map.onMoveStart();\n      }\n\n      var styles = frame.styles;\n\n      for (var p in styles) {\n        if (p !== 'symbol' && p !== 'translate' && styles.hasOwnProperty(p)) {\n          var fnName = 'set' + p[0].toUpperCase() + p.slice(1);\n\n          _this[fnName](styles[p]);\n        }\n      }\n\n      var translate = styles['translate'];\n\n      if (translate) {\n        var toTranslate = translate;\n\n        if (preTranslate) {\n          toTranslate = translate.sub(preTranslate);\n        }\n\n        preTranslate = translate;\n\n        _this.translate(toTranslate);\n      }\n\n      var dSymbol = styles['symbol'];\n\n      if (dSymbol) {\n        _this.setSymbol(extendSymbol(symbol, dSymbol));\n      }\n\n      if (map && isFocusing) {\n        var pcenter = projection.project(_this.getCenter());\n\n        map._setPrjCenter(pcenter);\n\n        var e = map._parseEventFromCoord(projection.unproject(pcenter));\n\n        if (player.playState !== 'running') {\n          map.onMoveEnd(e);\n        } else {\n          map.onMoving(e);\n        }\n      }\n\n      _this._fireAnimateEvent(player.playState);\n\n      if (step) {\n        step(frame);\n      }\n    }, this);\n    this._animPlayer = player;\n    return this._animPlayer.play();\n  },\n  _prepareAnimationStyles: function _prepareAnimationStyles(styles) {\n    var symbol = this._getInternalSymbol();\n\n    var stylesToAnimate = {};\n\n    for (var p in styles) {\n      if (styles.hasOwnProperty(p)) {\n        var v = styles[p];\n\n        if (p !== 'translate' && p !== 'symbol') {\n          var fnName = 'get' + p[0].toUpperCase() + p.substring(1);\n          var current = this[fnName]();\n          stylesToAnimate[p] = [current, v];\n        } else if (p === 'symbol') {\n          var symbolToAnimate = void 0;\n\n          if (Array.isArray(styles['symbol'])) {\n            if (!Array.isArray(symbol)) {\n              throw new Error('geometry\\'symbol isn\\'t a composite symbol, while the symbol in styles is.');\n            }\n\n            symbolToAnimate = [];\n            var symbolInStyles = styles['symbol'];\n\n            for (var i = 0; i < symbolInStyles.length; i++) {\n              if (!symbolInStyles[i]) {\n                symbolToAnimate.push(null);\n                continue;\n              }\n\n              var a = {};\n\n              for (var sp in symbolInStyles[i]) {\n                if (symbolInStyles[i].hasOwnProperty(sp)) {\n                  a[sp] = [symbol[i][sp], symbolInStyles[i][sp]];\n                }\n              }\n\n              symbolToAnimate.push(a);\n            }\n          } else {\n            if (Array.isArray(symbol)) {\n              throw new Error('geometry\\'symbol is a composite symbol, while the symbol in styles isn\\'t.');\n            }\n\n            symbolToAnimate = {};\n\n            for (var _sp in v) {\n              if (v.hasOwnProperty(_sp)) {\n                symbolToAnimate[_sp] = [symbol[_sp], v[_sp]];\n              }\n            }\n          }\n\n          stylesToAnimate['symbol'] = symbolToAnimate;\n        } else if (p === 'translate') {\n          stylesToAnimate['translate'] = new Coordinate(v);\n        }\n      }\n    }\n\n    return stylesToAnimate;\n  },\n  _fireAnimateEvent: function _fireAnimateEvent(playState) {\n    if (playState === 'finished') {\n      delete this._animationStarted;\n\n      this._fireEvent('animateend');\n    } else if (playState === 'running') {\n      if (this._animationStarted) {\n        this._fireEvent('animating');\n      } else {\n        this._fireEvent('animatestart');\n\n        this._animationStarted = true;\n      }\n    }\n  }\n});\n\nvar DRAG_STAGE_LAYER_ID = INTERNAL_LAYER_PREFIX + '_drag_stage';\nvar EVENTS$2 = Browser$1.touch ? 'touchstart mousedown' : 'mousedown';\n\nvar GeometryDragHandler = function (_Handler) {\n  _inheritsLoose(GeometryDragHandler, _Handler);\n\n  function GeometryDragHandler(target) {\n    return _Handler.call(this, target) || this;\n  }\n\n  var _proto = GeometryDragHandler.prototype;\n\n  _proto.addHooks = function addHooks() {\n    this.target.on(EVENTS$2, this._startDrag, this);\n  };\n\n  _proto.removeHooks = function removeHooks() {\n    this._endDrag();\n\n    this.target.off(EVENTS$2, this._startDrag, this);\n    delete this.container;\n  };\n\n  _proto._prepareDragHandler = function _prepareDragHandler() {\n    this._dragHandler = new DragHandler(this.container);\n\n    this._dragHandler.on('dragging', this._dragging, this).on('mouseup', this._endDrag, this).enable();\n  };\n\n  _proto._prepareShadow = function _prepareShadow() {\n    var _this = this;\n\n    var target = this.target;\n\n    this._prepareDragStageLayer();\n\n    if (this._shadow) {\n      this._shadow.remove();\n    }\n\n    var shadow = this._shadow = target.copy();\n\n    if (shadow.getGeometries) {\n      var shadows = shadow.getGeometries();\n      var geos = target.getGeometries();\n      shadows.forEach(function (g, i) {\n        _this._updateShadowSymbol(g, geos[i]);\n      });\n    } else {\n      this._updateShadowSymbol(shadow, target);\n    }\n\n    shadow.setId(null);\n\n    this._prepareShadowConnectors();\n  };\n\n  _proto._updateShadowSymbol = function _updateShadowSymbol(shadow, target) {\n    shadow.setSymbol(target._getInternalSymbol());\n\n    if (target.options['dragShadow']) {\n      var symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n      shadow.setSymbol(symbol);\n    }\n  };\n\n  _proto._prepareShadowConnectors = function _prepareShadowConnectors() {\n    var target = this.target;\n    var shadow = this._shadow;\n\n    var resources = this._dragStageLayer._getRenderer().resources;\n\n    var shadowConnectors = [];\n\n    if (ConnectorLine._hasConnectors(target)) {\n      var connectors = ConnectorLine._getConnectors(target);\n\n      for (var i = 0, l = connectors.length; i < l; i++) {\n        var targetConn = connectors[i];\n\n        var connOptions = targetConn.config(),\n            connSymbol = targetConn._getInternalSymbol();\n\n        connOptions['symbol'] = lowerSymbolOpacity(connSymbol, 0.5);\n        var conn = void 0;\n\n        if (targetConn.getConnectSource() === target) {\n          conn = new targetConn.constructor(shadow, targetConn.getConnectTarget(), connOptions);\n        } else {\n          conn = new targetConn.constructor(targetConn.getConnectSource(), shadow, connOptions);\n        }\n\n        shadowConnectors.push(conn);\n\n        if (targetConn.getLayer() && targetConn.getLayer()._getRenderer()) {\n          resources.merge(targetConn.getLayer()._getRenderer().resources);\n        }\n      }\n    }\n\n    this._shadowConnectors = shadowConnectors;\n    shadowConnectors.push(shadow);\n\n    this._dragStageLayer.bringToFront().addGeometry(shadowConnectors);\n  };\n\n  _proto._onTargetUpdated = function _onTargetUpdated() {\n    if (this._shadow) {\n      this._shadow.setSymbol(this.target._getSymbol());\n    }\n  };\n\n  _proto._prepareDragStageLayer = function _prepareDragStageLayer() {\n    var map = this.target.getMap(),\n        layer = this.target.getLayer();\n    this._dragStageLayer = map.getLayer(DRAG_STAGE_LAYER_ID);\n\n    if (!this._dragStageLayer) {\n      this._dragStageLayer = new VectorLayer(DRAG_STAGE_LAYER_ID, {\n        enableAltitude: layer.options['enableAltitude'],\n        altitudeProperty: layer.options['altitudeProperty']\n      });\n      map.addLayer(this._dragStageLayer);\n    }\n\n    var resources = new ResourceCache();\n    resources.merge(layer._getRenderer().resources);\n    this._dragStageLayer._getRenderer().resources = resources;\n  };\n\n  _proto._startDrag = function _startDrag(param) {\n    var map = this.target.getMap();\n\n    if (!map) {\n      return;\n    }\n\n    var parent = this.target._getParent();\n\n    if (parent) {\n      return;\n    }\n\n    if (this.isDragging()) {\n      return;\n    }\n\n    var domEvent = param['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n      return;\n    }\n\n    this.container = map._panels.mapWrapper || map._containerDOM;\n    this.target.on('click', this._endDrag, this);\n    this._lastCoord = this._correctCoord(param['coordinate']);\n    this._lastPoint = param['containerPoint'];\n\n    this._prepareDragHandler();\n\n    this._dragHandler.onMouseDown(param['domEvent']);\n\n    on(this.container, 'mouseleave', this._endDrag, this);\n    this._startParam = param;\n    this._moved = false;\n    return;\n  };\n\n  _proto._dragging = function _dragging(param) {\n    var target = this.target;\n\n    var map = target.getMap(),\n        e = map._parseEvent(param['domEvent']);\n\n    var domEvent = e['domEvent'];\n\n    if (domEvent.touches && domEvent.touches.length > 1) {\n      return;\n    }\n\n    if (!this._moved) {\n      this._moved = true;\n      target.on('symbolchange', this._onTargetUpdated, this);\n      this._isDragging = true;\n\n      this._prepareShadow();\n\n      if (!target.options['dragShadow']) {\n        target.hide();\n      }\n\n      this._shadow._fireEvent('dragstart', e);\n\n      this.target._fireEvent('dragstart', this._startParam || e);\n\n      delete this._startParam;\n      return;\n    }\n\n    if (!this._shadow) {\n      return;\n    }\n\n    var axis = this._shadow.options['dragOnAxis'],\n        coord = this._correctCoord(e['coordinate']),\n        point = e['containerPoint'];\n\n    this._lastPoint = this._lastPoint || point;\n    this._lastCoord = this._lastCoord || coord;\n    var pointOffset = point.sub(this._lastPoint);\n    var coordOffset = coord.sub(this._lastCoord);\n\n    if (axis === 'x') {\n      pointOffset.y = coordOffset.y = 0;\n    } else if (axis === 'y') {\n      pointOffset.x = coordOffset.x = 0;\n    }\n\n    this._lastPoint = point;\n    this._lastCoord = coord;\n\n    this._shadow.translate(coordOffset);\n\n    if (!target.options['dragShadow']) {\n      target.translate(coordOffset);\n    }\n\n    e['coordOffset'] = coordOffset;\n    e['pointOffset'] = pointOffset;\n\n    this._shadow._fireEvent('dragging', e);\n\n    target._fireEvent('dragging', e);\n  };\n\n  _proto._endDrag = function _endDrag(param) {\n    if (this._dragHandler) {\n      this._dragHandler.disable();\n\n      delete this._dragHandler;\n    }\n\n    if (this.container) {\n      off(this.container, 'mouseleave', this._endDrag, this);\n    }\n\n    if (!this.target) {\n      return;\n    }\n\n    var target = this.target;\n    target.off('click', this._endDrag, this);\n    target.off('symbolchange', this._onTargetUpdated, this);\n    delete this._lastCoord;\n    delete this._lastPoint;\n    this._isDragging = false;\n    var map = target.getMap();\n\n    if (this.enabled() && map) {\n      var e = map._parseEvent(param ? param['domEvent'] : null);\n\n      this._updateTargetAndRemoveShadow(e);\n\n      if (this._moved) {\n        target._fireEvent('dragend', e);\n      }\n    }\n  };\n\n  _proto.isDragging = function isDragging() {\n    if (!this._isDragging) {\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto._updateTargetAndRemoveShadow = function _updateTargetAndRemoveShadow(eventParam) {\n    var target = this.target,\n        map = target.getMap();\n\n    if (!target.options['dragShadow']) {\n      target.show();\n    }\n\n    var shadow = this._shadow;\n\n    if (shadow) {\n      if (target.options['dragShadow']) {\n        if (target.getGeometries) {\n          var shadows = shadow.getGeometries();\n          var geos = target.getGeometries();\n          shadows.forEach(function (g, i) {\n            geos[i].setCoordinates(shadows[i].getCoordinates());\n          });\n        } else {\n          target.setCoordinates(shadow.getCoordinates());\n        }\n      }\n\n      shadow._fireEvent('dragend', eventParam);\n\n      shadow.remove();\n      delete this._shadow;\n    }\n\n    if (this._shadowConnectors) {\n      map.getLayer(DRAG_STAGE_LAYER_ID).removeGeometry(this._shadowConnectors);\n      delete this._shadowConnectors;\n    }\n\n    if (this._dragStageLayer) {\n      this._dragStageLayer.remove();\n    }\n  };\n\n  _proto._correctCoord = function _correctCoord(coord) {\n    var map = this.target.getMap();\n\n    if (!map.getPitch()) {\n      return coord;\n    }\n\n    var painter = this.target._getPainter();\n\n    if (!painter.getMinAltitude()) {\n      return coord;\n    }\n\n    var alt = (painter.getMinAltitude() + painter.getMaxAltitude()) / 2;\n    return map.locateByPoint(coord, 0, -alt);\n  };\n\n  return GeometryDragHandler;\n}(Handler$1);\n\nGeometry.mergeOptions({\n  'draggable': false,\n  'dragShadow': true,\n  'dragOnAxis': null\n});\nGeometry.addInitHook('addHandler', 'draggable', GeometryDragHandler);\nGeometry.include({\n  isDragging: function isDragging() {\n    if (this._getParent()) {\n      return this._getParent().isDragging();\n    }\n\n    if (this['draggable']) {\n      return this['draggable'].isDragging();\n    }\n\n    return false;\n  }\n});\n\nGeometry.include({\n  startEdit: function startEdit(opts) {\n    if (!this.getMap() || !this.options['editable']) {\n      return this;\n    }\n\n    this.endEdit();\n    this._editor = new GeometryEditor(this, opts);\n\n    this._editor.start();\n\n    this.fire('editstart');\n    return this;\n  },\n  endEdit: function endEdit() {\n    if (this._editor) {\n      this._editor.stop();\n\n      delete this._editor;\n      this.fire('editend');\n    }\n\n    return this;\n  },\n  redoEdit: function redoEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.redo();\n\n    this.fire('redoedit');\n    return this;\n  },\n  undoEdit: function undoEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.undo();\n\n    this.fire('undoedit');\n    return this;\n  },\n  cancelEdit: function cancelEdit() {\n    if (!this.isEditing()) {\n      return this;\n    }\n\n    this._editor.cancel();\n\n    this.fire('canceledit');\n    return this;\n  },\n  isEditing: function isEditing() {\n    if (this._editor) {\n      return this._editor.isEditing();\n    }\n\n    return false;\n  }\n});\n\nGeometry.include({\n  _onEvent: function _onEvent(event, type) {\n    if (!this.getMap()) {\n      return;\n    }\n\n    var eventType = type || this._getEventTypeToFire(event);\n\n    if (eventType === 'contextmenu' && this.listens('contextmenu')) {\n      stopPropagation(event);\n      preventDefault(event);\n    }\n\n    var params = this._getEventParams(event);\n\n    this._fireEvent(eventType, params);\n  },\n  _getEventTypeToFire: function _getEventTypeToFire(domEvent) {\n    return domEvent.type;\n  },\n  _getEventParams: function _getEventParams(e) {\n    var map = this.getMap();\n    var eventParam = {\n      'domEvent': e\n    };\n    var actual = e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n\n    if (actual) {\n      var containerPoint = getEventContainerPoint(actual, map._containerDOM);\n      eventParam['coordinate'] = map.containerPointToCoordinate(containerPoint);\n      eventParam['containerPoint'] = containerPoint;\n      eventParam['viewPoint'] = map.containerPointToViewPoint(containerPoint);\n      eventParam['pont2d'] = map._containerPointToPoint(containerPoint);\n    }\n\n    return eventParam;\n  }\n});\n\nGeometry.include({\n  setInfoWindow: function setInfoWindow(options) {\n    this.removeInfoWindow();\n\n    if (options instanceof InfoWindow) {\n      this._infoWindow = options;\n      this._infoWinOptions = extend({}, this._infoWindow.options);\n\n      this._infoWindow.addTo(this);\n\n      return this;\n    }\n\n    this._infoWinOptions = extend({}, options);\n\n    if (this._infoWindow) {\n      this._infoWindow.setOptions(options);\n    } else if (this.getMap()) {\n      this._bindInfoWindow(this._infoWinOptions);\n    }\n\n    return this;\n  },\n  getInfoWindow: function getInfoWindow() {\n    if (!this._infoWindow) {\n      return null;\n    }\n\n    return this._infoWindow;\n  },\n  openInfoWindow: function openInfoWindow(coordinate) {\n    if (!this.getMap()) {\n      return this;\n    }\n\n    if (!coordinate) {\n      coordinate = this.getCenter();\n    }\n\n    if (!this._infoWindow) {\n      if (this._infoWinOptions && this.getMap()) {\n        this._bindInfoWindow(this._infoWinOptions);\n\n        this._infoWindow.show(coordinate);\n      }\n    } else {\n      this._infoWindow.show(coordinate);\n    }\n\n    return this;\n  },\n  closeInfoWindow: function closeInfoWindow() {\n    if (this._infoWindow) {\n      this._infoWindow.hide();\n    }\n\n    return this;\n  },\n  removeInfoWindow: function removeInfoWindow() {\n    this._unbindInfoWindow();\n\n    delete this._infoWinOptions;\n    delete this._infoWindow;\n    return this;\n  },\n  _bindInfoWindow: function _bindInfoWindow(options) {\n    this._infoWindow = new InfoWindow(options);\n\n    this._infoWindow.addTo(this);\n\n    return this;\n  },\n  _unbindInfoWindow: function _unbindInfoWindow() {\n    if (this._infoWindow) {\n      this.closeInfoWindow();\n\n      this._infoWindow.remove();\n\n      delete this._infoWindow;\n    }\n\n    return this;\n  }\n});\n\nvar LRUCache = function () {\n  function LRUCache(max, onRemove) {\n    this.max = max;\n    this.onRemove = onRemove;\n    this.reset();\n  }\n\n  var _proto = LRUCache.prototype;\n\n  _proto.reset = function reset() {\n    for (var key in this.data) {\n      this.onRemove(this.data[key]);\n    }\n\n    this.data = {};\n    this.order = [];\n    return this;\n  };\n\n  _proto.clear = function clear() {\n    this.reset();\n    delete this.onRemove;\n  };\n\n  _proto.add = function add(key, data) {\n    if (this.has(key)) {\n      this.order.splice(this.order.indexOf(key), 1);\n      this.data[key] = data;\n      this.order.push(key);\n    } else {\n      this.data[key] = data;\n      this.order.push(key);\n\n      if (this.order.length > this.max) {\n        var removedData = this.getAndRemove(this.order[0]);\n        if (removedData) this.onRemove(removedData);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.has = function has(key) {\n    return key in this.data;\n  };\n\n  _proto.keys = function keys() {\n    return this.order;\n  };\n\n  _proto.getAndRemove = function getAndRemove(key) {\n    if (!this.has(key)) {\n      return null;\n    }\n\n    var data = this.data[key];\n    delete this.data[key];\n    this.order.splice(this.order.indexOf(key), 1);\n    return data;\n  };\n\n  _proto.get = function get(key) {\n    if (!this.has(key)) {\n      return null;\n    }\n\n    var data = this.data[key];\n    return data;\n  };\n\n  _proto.remove = function remove(key) {\n    if (!this.has(key)) {\n      return this;\n    }\n\n    var data = this.data[key];\n    delete this.data[key];\n    this.onRemove(data);\n    this.order.splice(this.order.indexOf(key), 1);\n    return this;\n  };\n\n  _proto.setMaxSize = function setMaxSize(max) {\n    this.max = max;\n\n    while (this.order.length > this.max) {\n      var removedData = this.getAndRemove(this.order[0]);\n      if (removedData) this.onRemove(removedData);\n    }\n\n    return this;\n  };\n\n  return LRUCache;\n}();\n\nvar TEMP_POINT$3 = new Point(0, 0);\nvar TEMP_POINT1$2 = new Point(0, 0);\nvar TEMP_POINT2$1 = new Point(0, 0);\n\nvar TileLayerCanvasRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(TileLayerCanvasRenderer, _CanvasRenderer);\n\n  function TileLayerCanvasRenderer(layer) {\n    var _this;\n\n    _this = _CanvasRenderer.call(this, layer) || this;\n    _this.tilesInView = {};\n    _this.tilesLoading = {};\n    _this._parentTiles = [];\n    _this._childTiles = [];\n    _this.tileCache = new LRUCache(layer.options['maxCacheSize'], _this.deleteTile.bind(_assertThisInitialized(_assertThisInitialized(_this))));\n    return _this;\n  }\n\n  var _proto = TileLayerCanvasRenderer.prototype;\n\n  _proto.getCurrentTileZoom = function getCurrentTileZoom() {\n    return this._tileZoom;\n  };\n\n  _proto.draw = function draw() {\n    var map = this.getMap();\n\n    if (!this.isDrawable()) {\n      return;\n    }\n\n    var mask2DExtent = this.prepareCanvas();\n\n    if (mask2DExtent) {\n      if (!mask2DExtent.intersects(this.canvasExtent2D)) {\n        this.completeRender();\n        return;\n      }\n    }\n\n    var layer = this.layer;\n    var tileGrids = layer.getTiles().tileGrids;\n\n    if (!tileGrids || !tileGrids.length) {\n      this.completeRender();\n      return;\n    }\n\n    var loadingCount = 0;\n    var loading = false;\n    var checkedTiles = {};\n    var tiles = [],\n        parentTiles = [],\n        parentKeys = {},\n        childTiles = [],\n        childKeys = {},\n        placeholders = [],\n        placeholderKeys = {};\n    var tileQueue = {};\n\n    var preLoadingCount = this._markTiles(),\n        loadingLimit = this._getLoadLimit();\n\n    var l = tileGrids.length;\n    this._tileZoom = tileGrids[0]['zoom'];\n    this._tileOffset = tileGrids[0]['offset'];\n\n    for (var i = 0; i < l; i++) {\n      var tileGrid = tileGrids[i];\n      var allTiles = tileGrid['tiles'];\n\n      var placeholder = this._generatePlaceHolder(tileGrid.zoom);\n\n      for (var _i = 0, _l = allTiles.length; _i < _l; _i++) {\n        var tile = allTiles[_i],\n            tileId = tile['id'];\n        var tileLoading = false;\n\n        if (this._isLoadingTile(tileId)) {\n          tileLoading = loading = true;\n          this.tilesLoading[tileId].current = true;\n        } else {\n          var cached = this._getCachedTile(tileId);\n\n          if (cached) {\n            if (cached.image && this.getTileOpacity(cached.image) < 1) {\n              tileLoading = loading = true;\n            }\n\n            tiles.push(cached);\n          } else {\n            tileLoading = loading = true;\n            var hitLimit = loadingLimit && loadingCount + preLoadingCount[0] > loadingLimit;\n\n            if (!hitLimit && (!map.isInteracting() || map.isMoving() || map.isRotating())) {\n              loadingCount++;\n              tileQueue[tileId + '@' + tile['point'].toArray().join()] = tile;\n            }\n          }\n        }\n\n        if (!tileLoading) continue;\n\n        if (checkedTiles[tileId]) {\n          continue;\n        }\n\n        checkedTiles[tileId] = 1;\n\n        if (placeholder && !placeholderKeys[tileId]) {\n          tile.cache = false;\n          placeholders.push({\n            image: placeholder,\n            info: tile\n          });\n          placeholderKeys[tileId] = 1;\n        }\n\n        var parentTile = this._findParentTile(tile);\n\n        if (parentTile) {\n          var parentId = parentTile.info.id;\n\n          if (parentKeys[parentId] === undefined) {\n            parentKeys[parentId] = parentTiles.length;\n            parentTiles.push(parentTile);\n          }\n        } else if (!parentTiles.length) {\n          var children = this._findChildTiles(tile);\n\n          if (children.length) {\n            children.forEach(function (c) {\n              if (!childKeys[c.info.id]) {\n                childTiles.push(c);\n                childKeys[c.info.id] = 1;\n              }\n            });\n          }\n        }\n      }\n    }\n\n    if (parentTiles.length) {\n      childTiles.length = 0;\n      this._childTiles.length = 0;\n    }\n\n    this._drawTiles(tiles, parentTiles, childTiles, placeholders);\n\n    if (!loadingCount) {\n      if (!loading) {\n        if (!map.isAnimating() && (this._parentTiles.length || this._childTiles.length)) {\n          this._parentTiles = [];\n          this._childTiles = [];\n          this.setToRedraw();\n        }\n\n        this.completeRender();\n      }\n    } else {\n      this.loadTileQueue(tileQueue);\n    }\n\n    this._retireTiles();\n  };\n\n  _proto.isTileCachedOrLoading = function isTileCachedOrLoading(tileId) {\n    return this.tilesLoading[tileId] || this.tilesInView[tileId] || this.tileCache.get(tileId);\n  };\n\n  _proto._drawTiles = function _drawTiles(tiles, parentTiles, childTiles, placeholders) {\n    var _this2 = this;\n\n    if (parentTiles.length) {\n      parentTiles.sort(function (t1, t2) {\n        return Math.abs(t2.info.z - _this2._tileZoom) - Math.abs(t1.info.z - _this2._tileZoom);\n      });\n      this._parentTiles = parentTiles;\n    }\n\n    if (childTiles.length) {\n      this._childTiles = childTiles;\n    }\n\n    var context = {\n      tiles: tiles,\n      parentTiles: this._parentTiles,\n      childTiles: this._childTiles\n    };\n    this.onDrawTileStart(context);\n\n    this._parentTiles.forEach(function (t) {\n      return _this2._drawTileAndCache(t);\n    });\n\n    this._childTiles.forEach(function (t) {\n      return _this2._drawTileOffset(t.info, t.image);\n    });\n\n    placeholders.forEach(function (t) {\n      return _this2._drawTileOffset(t.info, t.image);\n    });\n    var layer = this.layer,\n        map = this.getMap();\n\n    if (!layer.options['cascadeTiles'] || map.getPitch() <= map.options['cascadePitches'][0]) {\n      tiles.forEach(function (t) {\n        return _this2._drawTileAndCache(t);\n      });\n    } else {\n      this.writeZoomStencil();\n      var started = false;\n\n      for (var i = 0, l = tiles.length; i < l; i++) {\n        if (tiles[i].info.z !== this._tileZoom) {\n          if (!started) {\n            this.startZoomStencilTest();\n            started = true;\n          } else {\n            this.resumeZoomStencilTest();\n          }\n        } else if (started) {\n          this.pauseZoomStencilTest();\n        }\n\n        this._drawTileAndCache(tiles[i]);\n      }\n\n      this.endZoomStencilTest();\n    }\n\n    this.onDrawTileEnd(context);\n  };\n\n  _proto.writeZoomStencil = function writeZoomStencil() {};\n\n  _proto.startZoomStencilTest = function startZoomStencilTest() {};\n\n  _proto.endZoomStencilTest = function endZoomStencilTest() {};\n\n  _proto.pauseZoomStencilTest = function pauseZoomStencilTest() {};\n\n  _proto.resumeZoomStencilTest = function resumeZoomStencilTest() {};\n\n  _proto.onDrawTileStart = function onDrawTileStart() {};\n\n  _proto.onDrawTileEnd = function onDrawTileEnd() {};\n\n  _proto._drawTileOffset = function _drawTileOffset(info, image) {\n    if (!image) {\n      return;\n    }\n\n    var offset = this._tileOffset;\n\n    if (!offset[0] && !offset[1]) {\n      this.drawTile(info, image);\n      return;\n    }\n\n    var map = this.getMap();\n\n    var scale = map._getResolution(this._tileZoom) / map._getResolution(info.z);\n\n    offset[0] *= scale;\n    offset[1] *= scale;\n\n    info.point._sub(offset);\n\n    info.extent2d._sub(offset);\n\n    this.drawTile(info, image);\n\n    info.point._add(offset);\n\n    info.extent2d._add(offset);\n\n    offset[0] /= scale;\n    offset[1] /= scale;\n  };\n\n  _proto._drawTileAndCache = function _drawTileAndCache(tile) {\n    tile.current = true;\n    this.tilesInView[tile.info.id] = tile;\n\n    this._drawTileOffset(tile.info, tile.image);\n\n    this.tileCache.add(tile.info.id, tile);\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    this.draw();\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.getPitch()) {\n      return _CanvasRenderer.prototype.needToRedraw.call(this);\n    }\n\n    if (map.isRotating() || map.isZooming()) {\n      return true;\n    }\n\n    if (map.isMoving()) {\n      return !!this.layer.options['forceRenderOnMoving'];\n    }\n\n    return _CanvasRenderer.prototype.needToRedraw.call(this);\n  };\n\n  _proto.hitDetect = function hitDetect() {\n    return false;\n  };\n\n  _proto._getLoadLimit = function _getLoadLimit() {\n    if (this.getMap().isInteracting()) {\n      return this.layer.options['loadingLimitOnInteracting'];\n    }\n\n    return 0;\n  };\n\n  _proto.isDrawable = function isDrawable() {\n    if (this.getMap().getPitch()) {\n      if (console) {\n        console.warn('TileLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n      }\n\n      this.clear();\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.clear = function clear() {\n    this._retireTiles(true);\n\n    this.tileCache.reset();\n    this.tilesInView = {};\n    this.tilesLoading = {};\n    this._parentTiles = [];\n    this._childTiles = [];\n\n    _CanvasRenderer.prototype.clear.call(this);\n  };\n\n  _proto._isLoadingTile = function _isLoadingTile(tileId) {\n    return !!this.tilesLoading[tileId];\n  };\n\n  _proto.clipCanvas = function clipCanvas(context) {\n    return _CanvasRenderer.prototype.clipCanvas.call(this, context);\n  };\n\n  _proto._clipByPitch = function _clipByPitch(ctx) {\n    var map = this.getMap();\n\n    if (map.getPitch() <= map.options['maxVisualPitch']) {\n      return false;\n    }\n\n    if (!this.layer.options['clipByPitch']) {\n      return false;\n    }\n\n    var clipExtent = map.getContainerExtent();\n    var r = map.getDevicePixelRatio();\n    ctx.save();\n    ctx.strokeStyle = 'rgba(0, 0, 0, 0)';\n    ctx.beginPath();\n    ctx.rect(0, Math.ceil(clipExtent.ymin) * r, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(clipExtent.getHeight()) * r);\n    ctx.stroke();\n    ctx.clip();\n    return true;\n  };\n\n  _proto.loadTileQueue = function loadTileQueue(tileQueue) {\n    for (var p in tileQueue) {\n      if (tileQueue.hasOwnProperty(p)) {\n        var tile = tileQueue[p];\n        var tileImage = this.loadTile(tile);\n\n        if (tileImage.loadTime === undefined) {\n          this.tilesLoading[tile['id']] = {\n            image: tileImage,\n            current: true,\n            info: tile\n          };\n        }\n      }\n    }\n  };\n\n  _proto.loadTile = function loadTile(tile) {\n    var tileSize = this.layer.getTileSize();\n    var tileImage = new Image();\n    tileImage.width = tileSize['width'];\n    tileImage.height = tileSize['height'];\n    tileImage.onload = this.onTileLoad.bind(this, tileImage, tile);\n    tileImage.onerror = this.onTileError.bind(this, tileImage, tile);\n    this.loadTileImage(tileImage, tile['url']);\n    return tileImage;\n  };\n\n  _proto.loadTileImage = function loadTileImage(tileImage, url) {\n    var crossOrigin = this.layer.options['crossOrigin'];\n\n    if (!isNil(crossOrigin)) {\n      tileImage.crossOrigin = crossOrigin;\n    }\n\n    return loadImage(tileImage, [url]);\n  };\n\n  _proto.abortTileLoading = function abortTileLoading(tileImage) {\n    if (!tileImage) return;\n    tileImage.onload = falseFn;\n    tileImage.onerror = falseFn;\n    tileImage.src = emptyImageUrl;\n  };\n\n  _proto.onTileLoad = function onTileLoad(tileImage, tileInfo) {\n    if (!this.layer) {\n      return;\n    }\n\n    var id = tileInfo['id'];\n\n    if (!this.tilesInView) {\n      return;\n    }\n\n    var e = {\n      tile: tileInfo,\n      tileImage: tileImage\n    };\n    this.layer.fire('tileload', e);\n    tileImage = e.tileImage;\n    tileImage.loadTime = now();\n    delete this.tilesLoading[id];\n\n    this._addTileToCache(tileInfo, tileImage);\n\n    this.setToRedraw();\n  };\n\n  _proto.onTileError = function onTileError(tileImage, tileInfo) {\n    if (!this.layer) {\n      return;\n    }\n\n    tileImage.onerrorTick = tileImage.onerrorTick || 0;\n    var tileRetryCount = this.layer.options['tileRetryCount'];\n\n    if (tileRetryCount > tileImage.onerrorTick) {\n      tileImage.onerrorTick++;\n      tileImage.src = tileInfo.url;\n      return;\n    }\n\n    if (tileImage instanceof Image) {\n      this.abortTileLoading(tileImage, tileInfo);\n    }\n\n    tileImage.loadTime = 0;\n    delete this.tilesLoading[tileInfo['id']];\n\n    this._addTileToCache(tileInfo, tileImage);\n\n    this.setToRedraw();\n    this.layer.fire('tileerror', {\n      tile: tileInfo\n    });\n  };\n\n  _proto.drawTile = function drawTile(tileInfo, tileImage) {\n    if (!tileImage || !this.getMap()) {\n      return;\n    }\n\n    var point = tileInfo.point,\n        tileZoom = tileInfo.z,\n        tileId = tileInfo.id;\n\n    var map = this.getMap(),\n        tileSize = tileInfo.size,\n        zoom = map.getZoom(),\n        ctx = this.context,\n        cp = map._pointToContainerPoint(point, tileZoom, 0, TEMP_POINT$3),\n        bearing = map.getBearing(),\n        transformed = bearing || zoom !== tileZoom;\n\n    var opacity = this.getTileOpacity(tileImage);\n    var alpha = ctx.globalAlpha;\n\n    if (opacity < 1) {\n      ctx.globalAlpha = opacity;\n      this.setToRedraw();\n    }\n\n    if (!transformed) {\n      cp._round();\n    }\n\n    var x = cp.x,\n        y = cp.y;\n    var w = tileSize[0],\n        h = tileSize[1];\n\n    if (transformed) {\n      ctx.save();\n      ctx.translate(x, y);\n\n      if (bearing) {\n        ctx.rotate(-bearing * Math.PI / 180);\n        w += 0.1;\n        h += 0.1;\n      }\n\n      if (zoom !== tileZoom) {\n        var scale = map._getResolution(tileZoom) / map._getResolution();\n\n        ctx.scale(scale, scale);\n      }\n\n      x = y = 0;\n    }\n\n    Canvas.image(ctx, tileImage, x, y, w, h);\n\n    if (this.layer.options['debug']) {\n      var color = this.layer.options['debugOutline'];\n      ctx.save();\n      ctx.strokeStyle = color;\n      ctx.fillStyle = color;\n      ctx.strokeWidth = 10;\n      ctx.font = '20px monospace';\n\n      var _point = new Point(x, y);\n\n      Canvas.rectangle(ctx, _point, {\n        width: w,\n        height: h\n      }, 1, 0);\n      Canvas.fillText(ctx, this.getDebugInfo(tileId), _point._add(10, 20), color);\n      Canvas.drawCross(ctx, x + w / 2, y + h / 2, 2, color);\n      ctx.restore();\n    }\n\n    if (transformed) {\n      ctx.restore();\n    }\n\n    if (ctx.globalAlpha !== alpha) {\n      ctx.globalAlpha = alpha;\n    }\n\n    this.setCanvasUpdated();\n  };\n\n  _proto.getDebugInfo = function getDebugInfo(tileId) {\n    var xyz = tileId.split('_');\n    var length = xyz.length;\n    return 'x:' + xyz[length - 2] + ', y:' + xyz[length - 3] + ', z:' + xyz[length - 1];\n  };\n\n  _proto._findChildTiles = function _findChildTiles(info) {\n    var layer = this._getLayerOfTile(info.layer);\n\n    if (!layer.options['background']) {\n      return [];\n    }\n\n    var map = this.getMap();\n    var children = [];\n\n    var min = info.extent2d.getMin(),\n        max = info.extent2d.getMax(),\n        pmin = layer._project(map._pointToPrj(min, info.z, TEMP_POINT1$2), TEMP_POINT1$2),\n        pmax = layer._project(map._pointToPrj(max, info.z, TEMP_POINT2$1), TEMP_POINT2$1);\n\n    var zoomDiff = 2;\n\n    for (var i = 1; i < zoomDiff; i++) {\n      this._findChildTilesAt(children, pmin, pmax, layer, info.z + i);\n    }\n\n    return children;\n  };\n\n  _proto._findChildTilesAt = function _findChildTilesAt(children, pmin, pmax, layer, childZoom) {\n    var zoomOffset = layer.options['zoomOffset'];\n    var layerId = layer.getId(),\n        res = layer.getSpatialReference().getResolution(childZoom + zoomOffset);\n\n    if (!res) {\n      return;\n    }\n\n    var dmin = layer._getTileConfig().getTileIndex(pmin, res),\n        dmax = layer._getTileConfig().getTileIndex(pmax, res);\n\n    var sx = Math.min(dmin.idx, dmax.idx),\n        ex = Math.max(dmin.idx, dmax.idx);\n    var sy = Math.min(dmin.idy, dmax.idy),\n        ey = Math.max(dmin.idy, dmax.idy);\n    var id, tile;\n\n    for (var i = sx; i < ex; i++) {\n      for (var ii = sy; ii < ey; ii++) {\n        id = layer._getTileId(i, ii, childZoom + zoomOffset, layerId);\n\n        if (this.tileCache.has(id)) {\n          tile = this.tileCache.getAndRemove(id);\n          children.push(tile);\n          this.tileCache.add(id, tile);\n        }\n      }\n    }\n  };\n\n  _proto._findParentTile = function _findParentTile(info) {\n    var map = this.getMap(),\n        layer = this._getLayerOfTile(info.layer);\n\n    if (!layer.options['background']) {\n      return null;\n    }\n\n    var sr = layer.getSpatialReference();\n    var d = sr.getZoomDirection(),\n        zoomOffset = layer.options['zoomOffset'],\n        zoomDiff = layer.options['backgroundZoomDiff'];\n\n    var center = info.extent2d.getCenter(),\n        prj = layer._project(map._pointToPrj(center, info.z));\n\n    for (var diff = 1; diff <= zoomDiff; diff++) {\n      var z = info.z - d * diff;\n      var res = sr.getResolution(z + zoomOffset);\n      if (!res) continue;\n\n      var tileIndex = layer._getTileConfig().getTileIndex(prj, res);\n\n      var id = layer._getTileId(tileIndex.x, tileIndex.y, z + zoomOffset, info.layer);\n\n      if (this.tileCache.has(id)) {\n        var tile = this.tileCache.getAndRemove(id);\n        this.tileCache.add(id, tile);\n        return tile;\n      }\n    }\n\n    return null;\n  };\n\n  _proto._getLayerOfTile = function _getLayerOfTile(layerId) {\n    return this.layer.getChildLayer ? this.layer.getChildLayer(layerId) : this.layer;\n  };\n\n  _proto._getCachedTile = function _getCachedTile(tileId) {\n    var tilesInView = this.tilesInView;\n    var cached = this.tileCache.getAndRemove(tileId);\n\n    if (cached) {\n      tilesInView[tileId] = cached;\n      var tilesLoading = this.tilesLoading;\n\n      if (tilesLoading && tilesLoading[tileId]) {\n        tilesLoading[tileId].current = false;\n        var _tilesLoading$tileId = tilesLoading[tileId],\n            image = _tilesLoading$tileId.image,\n            info = _tilesLoading$tileId.info;\n        this.abortTileLoading(image, info);\n        console.log('_getCachedTile');\n        delete tilesLoading[tileId];\n      }\n    } else {\n      cached = tilesInView[tileId];\n    }\n\n    return cached;\n  };\n\n  _proto._addTileToCache = function _addTileToCache(tileInfo, tileImage) {\n    this.tilesInView[tileInfo.id] = {\n      image: tileImage,\n      current: true,\n      info: tileInfo\n    };\n  };\n\n  _proto.getTileOpacity = function getTileOpacity(tileImage) {\n    if (!this.layer.options['fadeAnimation'] || !tileImage.loadTime) {\n      return 1;\n    }\n\n    return Math.min(1, (now() - tileImage.loadTime) / (1000 / 60 * 10));\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.clear();\n    delete this.tileCache;\n    delete this._tilePlaceHolder;\n\n    _CanvasRenderer.prototype.onRemove.call(this);\n  };\n\n  _proto._markTiles = function _markTiles() {\n    var a = 0,\n        b = 0;\n\n    if (this.tilesLoading) {\n      for (var p in this.tilesLoading) {\n        this.tilesLoading[p].current = false;\n        a++;\n      }\n    }\n\n    if (this.tilesInView) {\n      for (var _p in this.tilesInView) {\n        this.tilesInView[_p].current = false;\n        b++;\n      }\n    }\n\n    return [a, b];\n  };\n\n  _proto._retireTiles = function _retireTiles(force) {\n    for (var i in this.tilesLoading) {\n      var tile = this.tilesLoading[i];\n\n      if (force || !tile.current) {\n        if (tile.image) {\n          this.abortTileLoading(tile.image, tile.info);\n        }\n\n        this.deleteTile(tile);\n        delete this.tilesLoading[i];\n      }\n    }\n\n    for (var _i2 in this.tilesInView) {\n      var _tile = this.tilesInView[_i2];\n\n      if (!_tile.current) {\n        delete this.tilesInView[_i2];\n\n        if (!this.tileCache.has(_i2)) {\n          this.deleteTile(_tile);\n        }\n      }\n    }\n  };\n\n  _proto.deleteTile = function deleteTile(tile) {\n    if (!tile || !tile.image) {\n      return;\n    }\n\n    tile.image.onload = null;\n    tile.image.onerror = null;\n  };\n\n  _proto._generatePlaceHolder = function _generatePlaceHolder(z) {\n    var map = this.getMap();\n    var placeholder = this.layer.options['placeholder'];\n\n    if (!placeholder || map.getPitch()) {\n      return null;\n    }\n\n    var tileSize = this.layer.getTileSize(),\n        scale = map._getResolution(z) / map._getResolution(),\n        canvas = this._tilePlaceHolder = this._tilePlaceHolder || Canvas.createCanvas(1, 1);\n\n    canvas.width = tileSize.width * scale;\n    canvas.height = tileSize.height * scale;\n\n    if (isFunction(placeholder)) {\n      placeholder(canvas);\n    } else {\n      defaultPlaceholder(canvas);\n    }\n\n    return canvas;\n  };\n\n  return TileLayerCanvasRenderer;\n}(CanvasRenderer);\n\nTileLayer.registerRenderer('canvas', TileLayerCanvasRenderer);\n\nfunction falseFn() {\n  return false;\n}\n\nfunction defaultPlaceholder(canvas) {\n  var ctx = canvas.getContext('2d'),\n      cw = canvas.width,\n      ch = canvas.height,\n      w = cw / 16,\n      h = ch / 16;\n  ctx.beginPath();\n\n  for (var i = 0; i < 16; i++) {\n    ctx.moveTo(0, i * h);\n    ctx.lineTo(cw, i * h);\n    ctx.moveTo(i * w, 0);\n    ctx.lineTo(i * w, ch);\n  }\n\n  ctx.strokeStyle = 'rgba(180, 180, 180, 0.1)';\n  ctx.lineWidth = 1;\n  ctx.stroke();\n  ctx.beginPath();\n  var path = [[0, 0], [cw, 0], [0, ch], [cw, ch], [0, 0], [0, ch], [cw, 0], [cw, ch], [0, ch / 2], [cw, ch / 2], [cw / 2, 0], [cw / 2, ch]];\n\n  for (var _i3 = 1; _i3 < path.length; _i3 += 2) {\n    ctx.moveTo(path[_i3 - 1][0], path[_i3 - 1][1]);\n    ctx.lineTo(path[_i3][0], path[_i3][1]);\n  }\n\n  ctx.lineWidth = 1 * 4;\n  ctx.stroke();\n}\n\nvar TileLayerGLRenderer = function (_ImageGLRenderable) {\n  _inheritsLoose(TileLayerGLRenderer, _ImageGLRenderable);\n\n  function TileLayerGLRenderer() {\n    return _ImageGLRenderable.apply(this, arguments) || this;\n  }\n\n  var _proto = TileLayerGLRenderer.prototype;\n\n  _proto.isDrawable = function isDrawable() {\n    return true;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (this._gl() && !map.getPitch() && map.isZooming() && !map.isMoving() && !map.isRotating()) {\n      return true;\n    }\n\n    return _ImageGLRenderable.prototype.needToRedraw.call(this);\n  };\n\n  _proto.drawTile = function drawTile(tileInfo, tileImage) {\n    var map = this.getMap();\n\n    if (!tileInfo || !map || !tileImage) {\n      return;\n    }\n\n    var scale = tileInfo._glScale = tileInfo._glScale || map.getGLScale(tileInfo.z),\n        w = tileInfo.size[0],\n        h = tileInfo.size[1];\n\n    if (tileInfo.cache !== false) {\n      this._bindGLBuffer(tileImage, w, h);\n    }\n\n    if (!this._gl()) {\n      _ImageGLRenderable.prototype.drawTile.call(this, tileInfo, tileImage);\n\n      return;\n    }\n\n    var point = tileInfo.point;\n    var x = point.x * scale,\n        y = point.y * scale;\n    var opacity = this.getTileOpacity(tileImage);\n    var debugInfo = null;\n\n    if (this.layer.options['debug']) {\n      debugInfo = this.getDebugInfo(tileInfo.id);\n    }\n\n    this.drawGLImage(tileImage, x, y, w, h, scale, opacity, debugInfo);\n\n    if (opacity < 1) {\n      this.setToRedraw();\n    } else {\n      this.setCanvasUpdated();\n    }\n  };\n\n  _proto.writeZoomStencil = function writeZoomStencil() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\n  };\n\n  _proto.startZoomStencilTest = function startZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n  };\n\n  _proto.endZoomStencilTest = function endZoomStencilTest() {\n    this.pauseZoomStencilTest();\n  };\n\n  _proto.pauseZoomStencilTest = function pauseZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n  };\n\n  _proto.resumeZoomStencilTest = function resumeZoomStencilTest() {\n    var gl = this.gl;\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n  };\n\n  _proto._bindGLBuffer = function _bindGLBuffer(image, w, h) {\n    if (!image.glBuffer) {\n      image.glBuffer = this.bufferTileData(0, 0, w, h);\n    }\n  };\n\n  _proto.loadTileImage = function loadTileImage(tileImage, url) {\n    var crossOrigin = this.layer.options['crossOrigin'];\n    tileImage.crossOrigin = crossOrigin !== null ? crossOrigin : '';\n    tileImage.src = url;\n    return;\n  };\n\n  _proto.onCanvasCreate = function onCanvasCreate() {\n    if (!this.canvas.gl || !this.canvas.gl.wrap) {\n      this.createCanvas2();\n    }\n  };\n\n  _proto.createContext = function createContext() {\n    _ImageGLRenderable.prototype.createContext.call(this);\n\n    this.createGLContext();\n  };\n\n  _proto.resizeCanvas = function resizeCanvas(canvasSize) {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.resizeCanvas.call(this, canvasSize);\n\n    this.resizeGLCanvas();\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    _ImageGLRenderable.prototype.clearCanvas.call(this);\n\n    this.clearGLCanvas();\n  };\n\n  _proto.getCanvasImage = function getCanvasImage() {\n    if (!this._gl() || !this.canvas2) {\n      return _ImageGLRenderable.prototype.getCanvasImage.call(this);\n    }\n\n    var img = _ImageGLRenderable.prototype.getCanvasImage.call(this);\n\n    if (img) {\n      img.image = this.canvas2;\n    }\n\n    return img;\n  };\n\n  _proto._gl = function _gl() {\n    if (this.canvas.gl && this.canvas.gl.wrap) {\n      return true;\n    }\n\n    var map = this.getMap();\n    return map && (map.getPitch() || map.getBearing()) || this.layer && !!this.layer.options['fragmentShader'];\n  };\n\n  _proto.deleteTile = function deleteTile(tile) {\n    _ImageGLRenderable.prototype.deleteTile.call(this, tile);\n\n    if (tile && tile.image) {\n      this.disposeImage(tile.image);\n    }\n\n    delete tile.image;\n  };\n\n  _proto.onRemove = function onRemove() {\n    _ImageGLRenderable.prototype.onRemove.call(this);\n\n    this.removeGLCanvas();\n  };\n\n  return TileLayerGLRenderer;\n}(ImageGLRenderable(TileLayerCanvasRenderer));\n\nTileLayer.registerRenderer('gl', TileLayerGLRenderer);\n\nfunction _loadTile(tile) {\n  var tileSize = this.layer.getTileSize(),\n      canvasClass = this.canvas.constructor,\n      map = this.getMap();\n  var r = map.getDevicePixelRatio();\n  var tileCanvas = Canvas.createCanvas(tileSize['width'] * r, tileSize['height'] * r, canvasClass);\n  tileCanvas['layer'] = this.layer;\n  var me = this;\n  var extent = new Extent(map.pointToCoordinate(tile['point']), map.pointToCoordinate(tile['point'].add(tileSize.toPoint())), map.getProjection());\n  this.layer.drawTile(tileCanvas, {\n    'url': tile['url'],\n    'point': tile['point'],\n    'center': map.pointToCoordinate(tile['point'].add(tileSize['width'] / 2, tileSize['height'] / 2)),\n    'extent': extent,\n    'z': tile['z'],\n    'x': tile['x'],\n    'y': tile['y']\n  }, function (error) {\n    if (error) {\n      me.onTileError(tileCanvas, tile);\n      return;\n    }\n\n    me.onTileLoad(tileCanvas, tile);\n  });\n  return tileCanvas;\n}\n\nvar CanvasRenderer$1 = function (_TileLayerCanvasRende) {\n  _inheritsLoose(CanvasRenderer, _TileLayerCanvasRende);\n\n  function CanvasRenderer() {\n    return _TileLayerCanvasRende.apply(this, arguments) || this;\n  }\n\n  var _proto = CanvasRenderer.prototype;\n\n  _proto.loadTile = function loadTile() {\n    return _loadTile.apply(this, arguments);\n  };\n\n  return CanvasRenderer;\n}(TileLayerCanvasRenderer);\n\nvar GLRenderer = function (_TileLayerGLRenderer) {\n  _inheritsLoose(GLRenderer, _TileLayerGLRenderer);\n\n  function GLRenderer() {\n    return _TileLayerGLRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto2 = GLRenderer.prototype;\n\n  _proto2.loadTile = function loadTile() {\n    return _loadTile.apply(this, arguments);\n  };\n\n  return GLRenderer;\n}(TileLayerGLRenderer);\n\nCanvasTileLayer.registerRenderer('canvas', CanvasRenderer$1);\nCanvasTileLayer.registerRenderer('gl', GLRenderer);\n\nvar OverlayLayerRenderer = function (_CanvasRenderer) {\n  _inheritsLoose(OverlayLayerRenderer, _CanvasRenderer);\n\n  function OverlayLayerRenderer() {\n    return _CanvasRenderer.apply(this, arguments) || this;\n  }\n\n  var _proto = OverlayLayerRenderer.prototype;\n\n  _proto.checkResources = function checkResources() {\n    var geometries = this._geosToCheck;\n\n    if (!this._resourceChecked && !geometries) {\n      geometries = this.layer._geoList;\n    }\n\n    if (!isArrayHasData(geometries)) {\n      return [];\n    }\n\n    var resources = [];\n    var cache = {};\n\n    for (var i = geometries.length - 1; i >= 0; i--) {\n      var geo = geometries[i];\n\n      var res = geo._getExternalResources();\n\n      if (!res.length) {\n        continue;\n      }\n\n      if (!this.resources) {\n        resources.push.apply(resources, res);\n      } else {\n        for (var _i = 0; _i < res.length; _i++) {\n          var url = res[_i][0];\n\n          if (!this.resources.isResourceLoaded(res[_i]) && !cache[url]) {\n            resources.push(res[_i]);\n            cache[url] = 1;\n          }\n        }\n      }\n    }\n\n    this._resourceChecked = true;\n    delete this._geosToCheck;\n    return resources;\n  };\n\n  _proto.render = function render() {\n    this.layer._sortGeometries();\n\n    return _CanvasRenderer.prototype.render.apply(this, arguments);\n  };\n\n  _proto._addGeoToCheckRes = function _addGeoToCheckRes(res) {\n    if (!res) {\n      return;\n    }\n\n    if (!Array.isArray(res)) {\n      res = [res];\n    }\n\n    if (!this._geosToCheck) {\n      this._geosToCheck = [];\n    }\n\n    pushIn(this._geosToCheck, res);\n  };\n\n  _proto.onGeometryAdd = function onGeometryAdd(geometries) {\n    this._addGeoToCheckRes(geometries);\n\n    redraw(this);\n  };\n\n  _proto.onGeometryRemove = function onGeometryRemove() {\n    redraw(this);\n  };\n\n  _proto.onGeometrySymbolChange = function onGeometrySymbolChange(e) {\n    this._addGeoToCheckRes(e.target);\n\n    redraw(this);\n  };\n\n  _proto.onGeometryShapeChange = function onGeometryShapeChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryPositionChange = function onGeometryPositionChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryZIndexChange = function onGeometryZIndexChange() {\n    redraw(this);\n  };\n\n  _proto.onGeometryShow = function onGeometryShow() {\n    redraw(this);\n  };\n\n  _proto.onGeometryHide = function onGeometryHide() {\n    redraw(this);\n  };\n\n  _proto.onGeometryPropertiesChange = function onGeometryPropertiesChange() {\n    redraw(this);\n  };\n\n  return OverlayLayerRenderer;\n}(CanvasRenderer);\n\nfunction redraw(renderer) {\n  if (renderer.layer.options['drawImmediate']) {\n    renderer.render();\n  }\n\n  renderer.setToRedraw();\n}\n\nvar TEMP_EXTENT$4 = new PointExtent();\n\nvar VectorLayerRenderer = function (_OverlayLayerCanvasRe) {\n  _inheritsLoose(VectorLayerRenderer, _OverlayLayerCanvasRe);\n\n  function VectorLayerRenderer() {\n    return _OverlayLayerCanvasRe.apply(this, arguments) || this;\n  }\n\n  var _proto = VectorLayerRenderer.prototype;\n\n  _proto.checkResources = function checkResources() {\n    var _this = this;\n\n    var resources = _OverlayLayerCanvasRe.prototype.checkResources.apply(this, arguments);\n\n    var style = this.layer.getStyle();\n\n    if (style) {\n      if (!Array.isArray(style)) {\n        style = [style];\n      }\n\n      style.forEach(function (s) {\n        var res = getExternalResources(s['symbol'], true);\n\n        for (var i = 0, l = res.length; i < l; i++) {\n          if (!_this.resources.isResourceLoaded(res[i])) {\n            resources.push(res[i]);\n          }\n        }\n      });\n    }\n\n    return resources;\n  };\n\n  _proto.needToRedraw = function needToRedraw() {\n    var map = this.getMap();\n\n    if (map.isInteracting() && this.layer.options['enableAltitude']) {\n      return true;\n    }\n\n    if (map.isZooming() && !map.isRotating() && !map.getPitch() && !this._hasPoint && this.layer.constructor === VectorLayer) {\n      return false;\n    }\n\n    return _OverlayLayerCanvasRe.prototype.needToRedraw.call(this);\n  };\n\n  _proto.draw = function draw() {\n    if (!this.getMap()) {\n      return;\n    }\n\n    if (!this.layer.isVisible() || this.layer.isEmpty()) {\n      this.clearCanvas();\n      this.completeRender();\n      return;\n    }\n\n    this.prepareCanvas();\n    this.drawGeos();\n    this.completeRender();\n  };\n\n  _proto.isBlank = function isBlank() {\n    if (!this.context) {\n      return false;\n    }\n\n    return !this.context.canvas._drawn;\n  };\n\n  _proto.drawOnInteracting = function drawOnInteracting() {\n    if (!this._geosToDraw) {\n      return;\n    }\n\n    this._updateDisplayExtent();\n\n    var map = this.getMap();\n    var count = this.layer.getCount();\n    var res = this.getMap().getResolution();\n\n    if (map.isZooming() && map.options['seamlessZoom'] && this._drawnRes !== undefined && res > this._drawnRes * 1.5 && this._geosToDraw.length < count || map.isMoving() || map.isInteracting()) {\n      this.prepareToDraw();\n      this.forEachGeo(this.checkGeo, this);\n      this._drawnRes = res;\n    }\n\n    for (var i = 0, l = this._geosToDraw.length; i < l; i++) {\n      var geo = this._geosToDraw[i];\n\n      if (!geo.isVisible()) {\n        continue;\n      }\n\n      geo._paint(this._displayExtent);\n    }\n  };\n\n  _proto.show = function show() {\n    this.layer.forEach(function (geo) {\n      geo._repaint();\n    });\n\n    _OverlayLayerCanvasRe.prototype.show.apply(this, arguments);\n  };\n\n  _proto.forEachGeo = function forEachGeo(fn, context) {\n    this.layer.forEach(fn, context);\n  };\n\n  _proto.drawGeos = function drawGeos() {\n    this._drawnRes = this.getMap().getResolution();\n\n    this._updateDisplayExtent();\n\n    this.prepareToDraw();\n    this.forEachGeo(this.checkGeo, this);\n\n    for (var i = 0, len = this._geosToDraw.length; i < len; i++) {\n      this._geosToDraw[i]._paint();\n    }\n  };\n\n  _proto.prepareToDraw = function prepareToDraw() {\n    this._hasPoint = false;\n    this._geosToDraw = [];\n  };\n\n  _proto.checkGeo = function checkGeo(geo) {\n    if (!geo || !geo.isVisible() || !geo.getMap() || !geo.getLayer() || !geo.getLayer().isCanvasRender()) {\n      return;\n    }\n\n    var painter = geo._getPainter();\n\n    var extent2D = painter.get2DExtent(this.resources, TEMP_EXTENT$4);\n\n    if (!extent2D || !extent2D.intersects(this._displayExtent)) {\n      return;\n    }\n\n    if (painter.hasPoint()) {\n      this._hasPoint = true;\n    }\n\n    this._geosToDraw.push(geo);\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    delete this.canvasExtent2D;\n\n    _OverlayLayerCanvasRe.prototype.onZoomEnd.apply(this, arguments);\n  };\n\n  _proto.onRemove = function onRemove() {\n    this.forEachGeo(function (g) {\n      g.onHide();\n    });\n    delete this._geosToDraw;\n  };\n\n  _proto.onGeometryPropertiesChange = function onGeometryPropertiesChange(param) {\n    if (param) {\n      this.layer._styleGeometry(param['target']);\n    }\n\n    _OverlayLayerCanvasRe.prototype.onGeometryPropertiesChange.call(this, param);\n  };\n\n  _proto._updateDisplayExtent = function _updateDisplayExtent() {\n    var extent2D = this.canvasExtent2D;\n\n    if (this._maskExtent) {\n      if (!this._maskExtent.intersects(extent2D)) {\n        this.completeRender();\n        return;\n      }\n\n      extent2D = extent2D.intersection(this._maskExtent);\n    }\n\n    this._displayExtent = extent2D;\n  };\n\n  _proto.identify = function identify(coordinate, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var geometries = this._geosToDraw;\n\n    if (!geometries) {\n      return [];\n    }\n\n    return this.layer._hitGeos(geometries, coordinate, options);\n  };\n\n  return VectorLayerRenderer;\n}(OverlayLayerRenderer);\n\nVectorLayer.registerRenderer('canvas', VectorLayerRenderer);\n\nvar MapRenderer = function (_Class) {\n  _inheritsLoose(MapRenderer, _Class);\n\n  function MapRenderer(map) {\n    var _this;\n\n    _this = _Class.call(this) || this;\n    _this.map = map;\n    _this._handlerQueue = {};\n    return _this;\n  }\n\n  var _proto = MapRenderer.prototype;\n\n  _proto.callInNextFrame = function callInNextFrame(fn) {\n    this._handlerQueue.push(fn);\n  };\n\n  _proto.executeFrameCallbacks = function executeFrameCallbacks() {\n    var running = this._handlerQueue;\n    this._handlerQueue = [];\n\n    for (var i = 0, l = running.length; i < l; i++) {\n      running[i]();\n    }\n  };\n\n  _proto.offsetPlatform = function offsetPlatform(offset, force) {\n    if (!this.map._panels.front) {\n      return this;\n    }\n\n    if (!force && offset.x === 0 && offset.y === 0) {\n      return this;\n    }\n\n    var panels = this.map._panels;\n    var hasFront = this._frontCount = panels.back.layerDOM.childElementCount;\n    var hasBack = this._backCount = panels.front.layerDOM.childElementCount;\n    var hasUI = this._uiCount = panels.front.uiDOM.childElementCount;\n\n    if (hasFront || hasBack || hasUI) {\n      var pos = this.map.offsetPlatform();\n\n      if (offset) {\n        pos = pos.add(offset)._round();\n      } else {\n        pos = pos.round();\n      }\n\n      if (hasBack) {\n        offsetDom(panels.back, pos);\n      }\n\n      if (hasFront || hasUI) {\n        offsetDom(panels.front, pos);\n      }\n    }\n\n    return this;\n  };\n\n  _proto.domChanged = function domChanged() {\n    var panels = this.map._panels;\n\n    if (!panels.front) {\n      return false;\n    }\n\n    var frontCount = panels.back.layerDOM.childElementCount;\n\n    if (this._frontCount === undefined || this._frontCount !== frontCount) {\n      return true;\n    }\n\n    var backCount = panels.front.layerDOM.childElementCount;\n\n    if (this._backCount === undefined || this._backCount !== backCount) {\n      return true;\n    }\n\n    var uiCount = panels.front.uiDOM.childElementCount;\n\n    if (this._uiCount === undefined || this._uiCount !== uiCount) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.resetContainer = function resetContainer() {\n    if (!this.map) {\n      return;\n    }\n\n    this.map._resetMapViewPoint();\n\n    if (this.map._panels.front) {\n      var pos = new Point(0, 0);\n      offsetDom(this.map._panels.back, pos);\n      offsetDom(this.map._panels.front, pos);\n    }\n  };\n\n  _proto.onZoomEnd = function onZoomEnd() {\n    this.resetContainer();\n  };\n\n  _proto.onLoad = function onLoad() {\n    this._frameLoop();\n  };\n\n  return MapRenderer;\n}(Class);\n\nvar MapCanvasRenderer = function (_MapRenderer) {\n  _inheritsLoose(MapCanvasRenderer, _MapRenderer);\n\n  function MapCanvasRenderer(map) {\n    var _this;\n\n    _this = _MapRenderer.call(this, map) || this;\n    _this._containerIsCanvas = !!map._containerDOM.getContext;\n\n    _this._registerEvents();\n\n    _this._loopTime = 0;\n    return _this;\n  }\n\n  var _proto = MapCanvasRenderer.prototype;\n\n  _proto.load = function load() {\n    this.initContainer();\n  };\n\n  _proto.renderFrame = function renderFrame(framestamp) {\n    if (!this.map) {\n      return false;\n    }\n\n    delete this._isViewChanged;\n    var map = this.map;\n\n    map._fireEvent('framestart');\n\n    this.updateMapDOM();\n\n    var layers = this._getAllLayerToRender();\n\n    this.drawLayers(layers, framestamp);\n    var updated = this.drawLayerCanvas(layers);\n\n    if (updated) {\n      this._drawCenterCross();\n    }\n\n    map._fireEvent('frameend');\n\n    this._recordView();\n\n    this._mapview = this._getMapView();\n    delete this._spatialRefChanged;\n\n    this._fireLayerLoadEvents();\n\n    this.executeFrameCallbacks();\n    this._canvasUpdated = false;\n    return true;\n  };\n\n  _proto.updateMapDOM = function updateMapDOM() {\n    var map = this.map;\n\n    if (map.isZooming()) {\n      return;\n    }\n\n    var offset = map._getViewPointFrameOffset();\n\n    if (offset) {\n      map.offsetPlatform(offset);\n    } else if (this.domChanged()) {\n      this.offsetPlatform(null, true);\n    }\n  };\n\n  _proto.drawLayers = function drawLayers(layers, framestamp) {\n    var map = this.map,\n        isInteracting = map.isInteracting(),\n        canvasIds = [],\n        updatedIds = [],\n        fps = map.options['fpsOnInteracting'] || 0,\n        timeLimit = fps === 0 ? 0 : 1000 / fps,\n        layerLimit = this.map.options['layerCanvasLimitOnInteracting'],\n        l = layers.length;\n    var baseLayer = map.getBaseLayer();\n    var t = 0;\n\n    for (var i = 0; i < l; i++) {\n      var layer = layers[i];\n\n      if (!layer.isVisible()) {\n        continue;\n      }\n\n      var isCanvas = layer.isCanvasRender();\n\n      if (isCanvas) {\n        canvasIds.push(layer.getId());\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (!renderer) {\n        continue;\n      }\n\n      var needsRedraw = this._checkLayerRedraw(layer);\n\n      if (isCanvas && renderer.isCanvasUpdated()) {\n        if (!needsRedraw) {\n          updatedIds.push(layer.getId());\n        }\n\n        this.setLayerCanvasUpdated();\n      }\n\n      var transformMatrix = renderer.__zoomTransformMatrix;\n      delete renderer.__zoomTransformMatrix;\n\n      if (!needsRedraw) {\n        if (isCanvas && isInteracting) {\n          if (map.isZooming() && !map.getPitch()) {\n            renderer.prepareRender();\n            renderer.__zoomTransformMatrix = this._zoomMatrix;\n          } else if (map.getPitch() || map.isRotating()) {\n            renderer.clearCanvas();\n          }\n        }\n\n        continue;\n      }\n\n      if (isInteracting && isCanvas) {\n        if (layerLimit > 0 && l - 1 - i > layerLimit && layer !== baseLayer) {\n          layer._getRenderer().clearCanvas();\n\n          continue;\n        }\n\n        t += this._drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp);\n      } else if (isInteracting && renderer.drawOnInteracting) {\n        if (renderer.prepareRender) {\n          renderer.prepareRender();\n        }\n\n        if (renderer.checkAndDraw) {\n          renderer.checkAndDraw(renderer.drawOnInteracting, this._eventParam, framestamp);\n        } else {\n          renderer.drawOnInteracting(this._eventParam, framestamp);\n        }\n      } else {\n        renderer.render(framestamp);\n\n        if (isCanvas && transformMatrix && renderer.isLoadingResource()) {\n          renderer.__zoomTransformMatrix = transformMatrix;\n        }\n      }\n\n      if (isCanvas) {\n        updatedIds.push(layer.getId());\n        this.setLayerCanvasUpdated();\n      }\n    }\n\n    var preCanvasIds = this._canvasIds || [];\n    var preUpdatedIds = this._updatedIds || [];\n    this._canvasIds = canvasIds;\n    this._updatedIds = updatedIds;\n\n    if (!this.isLayerCanvasUpdated()) {\n      var sep = '---';\n\n      if (preCanvasIds.join(sep) !== canvasIds.join(sep) || preUpdatedIds.join(sep) !== updatedIds.join(sep)) {\n        this.setLayerCanvasUpdated();\n      }\n    }\n  };\n\n  _proto._checkLayerRedraw = function _checkLayerRedraw(layer) {\n    if (this.isSpatialReferenceChanged()) {\n      return true;\n    }\n\n    var map = this.map;\n\n    var renderer = layer._getRenderer();\n\n    if (layer.isCanvasRender()) {\n      return renderer.testIfNeedRedraw();\n    } else {\n      if (renderer.needToRedraw && renderer.needToRedraw()) {\n        return true;\n      }\n\n      return map.isInteracting() || this.isViewChanged();\n    }\n  };\n\n  _proto._drawCanvasLayerOnInteracting = function _drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp) {\n    var map = this.map,\n        renderer = layer._getRenderer(),\n        drawTime = renderer.getDrawTime(),\n        inTime = timeLimit === 0 || timeLimit > 0 && t + drawTime <= timeLimit;\n\n    if (renderer.mustRenderOnInteracting && renderer.mustRenderOnInteracting()) {\n      renderer.render(framestamp);\n    } else if (renderer.drawOnInteracting && (layer === map.getBaseLayer() || inTime || map.isZooming() && layer.options['forceRenderOnZooming'] || map.isMoving() && layer.options['forceRenderOnMoving'] || map.isRotating() && layer.options['forceRenderOnRotating'])) {\n      renderer.prepareRender();\n      renderer.prepareCanvas();\n\n      if (renderer.checkAndDraw) {\n        renderer.checkAndDraw(renderer.drawOnInteracting, this._eventParam, framestamp);\n      } else {\n        renderer.drawOnInteracting(this._eventParam, framestamp);\n      }\n\n      return drawTime;\n    } else if (map.isZooming() && !map.getPitch() && !map.isRotating()) {\n      renderer.prepareRender();\n      renderer.__zoomTransformMatrix = this._zoomMatrix;\n    } else if (map.getPitch() || map.isRotating()) {\n      renderer.clearCanvas();\n    }\n\n    if (renderer.drawOnInteracting && !inTime) {\n      renderer.onSkipDrawOnInteracting(this._eventParam, framestamp);\n    }\n\n    return 0;\n  };\n\n  _proto._fireLayerLoadEvents = function _fireLayerLoadEvents() {\n    if (this._updatedIds && this._updatedIds.length > 0) {\n      var map = this.map;\n\n      this._updatedIds.reverse().forEach(function (id) {\n        var layer = map.getLayer(id);\n\n        if (!layer) {\n          return;\n        }\n\n        var renderer = layer._getRenderer();\n\n        if (!renderer || !renderer.isRenderComplete()) {\n          return;\n        }\n\n        layer.fire('layerload');\n      });\n    }\n  };\n\n  _proto.isLayerCanvasUpdated = function isLayerCanvasUpdated() {\n    return this._canvasUpdated;\n  };\n\n  _proto.setLayerCanvasUpdated = function setLayerCanvasUpdated() {\n    this._canvasUpdated = true;\n  };\n\n  _proto.drawLayerCanvas = function drawLayerCanvas(layers) {\n    var map = this.map;\n\n    if (!map) {\n      return false;\n    }\n\n    if (!this.isLayerCanvasUpdated() && !this.isViewChanged()) {\n      return false;\n    }\n\n    if (!this.canvas) {\n      this.createCanvas();\n    }\n\n    map._fireEvent('renderstart', {\n      'context': this.context\n    });\n\n    if (!this._updateCanvasSize()) {\n      this.clearCanvas();\n    }\n\n    var interacting = map.isInteracting(),\n        limit = map.options['layerCanvasLimitOnInteracting'];\n    var len = layers.length;\n    var baseLayerImage;\n    var images = [];\n\n    for (var i = 0; i < len; i++) {\n      if (!layers[i].isVisible() || !layers[i].isCanvasRender()) {\n        continue;\n      }\n\n      var renderer = layers[i]._getRenderer();\n\n      if (!renderer) {\n        continue;\n      }\n\n      var layerImage = this._getLayerImage(layers[i]);\n\n      if (layerImage && layerImage['image']) {\n        if (layers[i] === map.getBaseLayer()) {\n          baseLayerImage = [layers[i], layerImage];\n        } else {\n          images.push([layers[i], layerImage]);\n        }\n      }\n    }\n\n    if (baseLayerImage) {\n      this._drawLayerCanvasImage(baseLayerImage[0], baseLayerImage[1]);\n\n      this._drawFog();\n    }\n\n    len = images.length;\n    var start = interacting && limit >= 0 && len > limit ? len - limit : 0;\n\n    for (var _i = start; _i < len; _i++) {\n      this._drawLayerCanvasImage(images[_i][0], images[_i][1]);\n    }\n\n    map._fireEvent('renderend', {\n      'context': this.context\n    });\n\n    return true;\n  };\n\n  _proto.setToRedraw = function setToRedraw() {\n    var layers = this._getAllLayerToRender();\n\n    for (var i = 0, l = layers.length; i < l; i++) {\n      var renderer = layers[i].getRenderer();\n\n      if (renderer && renderer.canvas && renderer.setToRedraw) {\n        renderer.setToRedraw();\n      }\n    }\n  };\n\n  _proto.updateMapSize = function updateMapSize(size) {\n    if (!size || this._containerIsCanvas) {\n      return;\n    }\n\n    var width = size['width'] + 'px',\n        height = size['height'] + 'px';\n    var panels = this.map._panels;\n    panels.mapWrapper.style.width = width;\n    panels.mapWrapper.style.height = height;\n\n    this._updateCanvasSize();\n  };\n\n  _proto.getMainPanel = function getMainPanel() {\n    if (!this.map) {\n      return null;\n    }\n\n    if (this._containerIsCanvas) {\n      return this.map._containerDOM;\n    }\n\n    if (this.map._panels) {\n      return this.map._panels.mapWrapper;\n    }\n\n    return null;\n  };\n\n  _proto.toDataURL = function toDataURL(mimeType) {\n    if (!this.canvas) {\n      return null;\n    }\n\n    return this.canvas.toDataURL(mimeType);\n  };\n\n  _proto.remove = function remove() {\n    if (Browser$1.webgl && typeof document !== 'undefined') {\n      removeDomEvent(document, 'visibilitychange', this._onVisibilitychange, this);\n    }\n\n    if (this._resizeInterval) {\n      clearInterval(this._resizeInterval);\n    }\n\n    delete this.context;\n    delete this.canvas;\n    delete this.map;\n    delete this._spatialRefChanged;\n\n    this._cancelFrameLoop();\n  };\n\n  _proto.hitDetect = function hitDetect(point) {\n    var map = this.map;\n\n    if (!map || !map.options['hitDetect'] || map.isInteracting()) {\n      return;\n    }\n\n    var layers = map._getLayers();\n\n    var cursor = 'default';\n    var limit = map.options['hitDetectLimit'] || 0;\n    var counter = 0;\n\n    for (var i = layers.length - 1; i >= 0; i--) {\n      var layer = layers[i];\n\n      if (!layer.options['hitDetect'] || layer.isEmpty && layer.isEmpty()) {\n        continue;\n      }\n\n      var renderer = layer._getRenderer();\n\n      if (!renderer || !renderer.hitDetect) {\n        continue;\n      }\n\n      if (renderer.isBlank && renderer.isBlank()) {\n        continue;\n      }\n\n      if (layer.options['cursor'] !== 'default' && renderer.hitDetect(point)) {\n        cursor = layer.options['cursor'] || 'pointer';\n        break;\n      }\n\n      counter++;\n\n      if (limit > 0 && counter > limit) {\n        break;\n      }\n    }\n\n    map._trySetCursor(cursor);\n  };\n\n  _proto._getLayerImage = function _getLayerImage(layer) {\n    var renderer = layer._getRenderer();\n\n    if (renderer.getCanvasImage) {\n      return renderer.getCanvasImage();\n    }\n\n    return null;\n  };\n\n  _proto.initContainer = function initContainer() {\n    var panels = this.map._panels;\n\n    function createContainer(name, className, cssText, enableSelect) {\n      var c = createEl('div', className);\n\n      if (cssText) {\n        c.style.cssText = cssText;\n      }\n\n      panels[name] = c;\n\n      if (!enableSelect) {\n        preventSelection(c);\n      }\n\n      return c;\n    }\n\n    var containerDOM = this.map._containerDOM;\n\n    if (this._containerIsCanvas) {\n      return;\n    }\n\n    containerDOM.innerHTML = '';\n    var POSITION0 = 'position:absolute;top:0px;left:0px;';\n    var mapWrapper = createContainer('mapWrapper', 'maptalks-wrapper', 'position:absolute;overflow:hidden;', true),\n        mapAllLayers = createContainer('allLayers', 'maptalks-all-layers', POSITION0 + 'padding:0px;margin:0px;z-index:0;overflow:visible;', true),\n        backStatic = createContainer('backStatic', 'maptalks-back-static', POSITION0 + 'z-index:0;', true),\n        back = createContainer('back', 'maptalks-back', POSITION0 + 'z-index:1;'),\n        backLayer = createContainer('backLayer', 'maptalks-back-layer', POSITION0),\n        canvasContainer = createContainer('canvasContainer', 'maptalks-canvas-layer', POSITION0 + 'border:none;z-index:2;'),\n        frontStatic = createContainer('frontStatic', 'maptalks-front-static', POSITION0 + 'z-index:3;', true),\n        front = createContainer('front', 'maptalks-front', POSITION0 + 'z-index:4;', true),\n        frontLayer = createContainer('frontLayer', 'maptalks-front-layer', POSITION0 + 'z-index:0;'),\n        ui = createContainer('ui', 'maptalks-ui', POSITION0 + 'border:none;z-index:1;', true),\n        control = createContainer('control', 'maptalks-control', 'z-index:1', true);\n    containerDOM.appendChild(mapWrapper);\n    mapAllLayers.appendChild(backStatic);\n    back.appendChild(backLayer);\n    back.layerDOM = backLayer;\n    mapAllLayers.appendChild(back);\n    mapAllLayers.appendChild(canvasContainer);\n    front.appendChild(frontLayer);\n    front.layerDOM = frontLayer;\n    front.uiDOM = ui;\n    mapAllLayers.appendChild(frontStatic);\n    mapAllLayers.appendChild(front);\n    front.appendChild(ui);\n    mapWrapper.appendChild(mapAllLayers);\n    mapWrapper.appendChild(control);\n    this.createCanvas();\n    this.resetContainer();\n\n    var mapSize = this.map._getContainerDomSize();\n\n    this.updateMapSize(mapSize);\n  };\n\n  _proto.isViewChanged = function isViewChanged() {\n    if (this._isViewChanged !== undefined) {\n      return this._isViewChanged;\n    }\n\n    var previous = this._mapview;\n\n    var view = this._getMapView();\n\n    this._isViewChanged = !previous || !equalMapView(previous, view);\n    return this._isViewChanged;\n  };\n\n  _proto._recordView = function _recordView() {\n    var map = this.map;\n\n    if (!map._onViewChange || map.isInteracting() || map.isAnimating()) {\n      return;\n    }\n\n    if (!equalMapView(map.getView(), map._getCurrentView())) {\n      map._onViewChange(map.getView());\n    }\n  };\n\n  _proto.isSpatialReferenceChanged = function isSpatialReferenceChanged() {\n    return this._spatialRefChanged;\n  };\n\n  _proto._getMapView = function _getMapView() {\n    var map = this.map;\n\n    var center = map._getPrjCenter();\n\n    return {\n      x: center.x,\n      y: center.y,\n      zoom: map.getZoom(),\n      pitch: map.getPitch(),\n      bearing: map.getBearing(),\n      width: map.width,\n      height: map.height\n    };\n  };\n\n  _proto._frameLoop = function _frameLoop(framestamp) {\n    var _this2 = this;\n\n    if (!this.map) {\n      this._cancelFrameLoop();\n\n      return;\n    }\n\n    this.renderFrame(framestamp);\n    this._animationFrame = requestAnimFrame(function (framestamp) {\n      _this2._frameLoop(framestamp);\n    });\n  };\n\n  _proto._cancelFrameLoop = function _cancelFrameLoop() {\n    if (this._animationFrame) {\n      cancelAnimFrame(this._animationFrame);\n    }\n  };\n\n  _proto._drawLayerCanvasImage = function _drawLayerCanvasImage(layer, layerImage) {\n    var ctx = this.context;\n    var point = layerImage['point'].round();\n    var dpr = this.map.getDevicePixelRatio();\n\n    if (dpr !== 1) {\n      point._multi(dpr);\n    }\n\n    var canvasImage = layerImage['image'];\n    var width = canvasImage.width,\n        height = canvasImage.height;\n\n    if (point.x + width <= 0 || point.y + height <= 0) {\n      return;\n    }\n\n    var op = layer.options['opacity'];\n\n    if (!isNumber(op)) {\n      op = 1;\n    }\n\n    if (op <= 0) {\n      return;\n    }\n\n    var imgOp = layerImage['opacity'];\n\n    if (!isNumber(imgOp)) {\n      imgOp = 1;\n    }\n\n    if (imgOp <= 0) {\n      return;\n    }\n\n    var alpha = ctx.globalAlpha;\n\n    if (op < 1) {\n      ctx.globalAlpha *= op;\n    }\n\n    if (imgOp < 1) {\n      ctx.globalAlpha *= imgOp;\n    }\n\n    if (layer.options['cssFilter']) {\n      ctx.filter = layer.options['cssFilter'];\n    }\n\n    var renderer = layer.getRenderer();\n    var matrix = renderer.__zoomTransformMatrix;\n    var clipped = renderer.clipCanvas(this.context);\n\n    if (matrix) {\n      ctx.save();\n      ctx.setTransform.apply(ctx, matrix);\n    }\n\n    ctx.drawImage(canvasImage, 0, 0, width, height, point.x, point.y, width, height);\n\n    if (matrix) {\n      ctx.restore();\n    }\n\n    if (clipped) {\n      ctx.restore();\n    }\n\n    if (ctx.filter !== 'none') {\n      ctx.filter = 'none';\n    }\n\n    ctx.globalAlpha = alpha;\n  };\n\n  _proto._drawCenterCross = function _drawCenterCross() {\n    var cross = this.map.options['centerCross'];\n\n    if (cross) {\n      var ctx = this.context;\n      var p = new Point(this.canvas.width / 2, this.canvas.height / 2);\n\n      if (isFunction(cross)) {\n        cross(ctx, p);\n      } else {\n        Canvas.drawCross(this.context, p.x, p.y, 2, '#f00');\n      }\n    }\n  };\n\n  _proto._drawContainerExtent = function _drawContainerExtent() {\n    var cascadePitches = this.map.options.cascadePitches;\n\n    var h30 = this.map.height - this.map._getVisualHeight(cascadePitches[0]);\n\n    var h60 = this.map.height - this.map._getVisualHeight(cascadePitches[1]);\n\n    var extent = this.map.getContainerExtent();\n    var ctx = this.context;\n    ctx.beginPath();\n    ctx.moveTo(0, extent.ymin);\n    ctx.lineTo(extent.xmax, extent.ymin);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, h30);\n    ctx.lineTo(extent.xmax, h30);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, h60);\n    ctx.lineTo(extent.xmax, h60);\n    ctx.stroke();\n  };\n\n  _proto._drawFog = function _drawFog() {\n    var map = this.map;\n\n    if (map.getPitch() <= map.options['maxVisualPitch'] || !map.options['fog']) {\n      return;\n    }\n\n    var fogThickness = 30;\n    var r = map.getDevicePixelRatio();\n    var ctx = this.context,\n        clipExtent = map.getContainerExtent();\n    var top = (map.height - map._getVisualHeight(75)) * r;\n    if (top < 0) top = 0;\n    var bottom = clipExtent.ymin * r,\n        h = Math.ceil(bottom - top),\n        color = map.options['fogColor'].join();\n    var gradient = ctx.createLinearGradient(0, top, 0, bottom + fogThickness);\n    var landscape = 1 - fogThickness / (h + fogThickness);\n    gradient.addColorStop(0, \"rgba(\" + color + \", 0)\");\n    gradient.addColorStop(0.3, \"rgba(\" + color + \", 0.3)\");\n    gradient.addColorStop(landscape, \"rgba(\" + color + \", 1)\");\n    gradient.addColorStop(1, \"rgba(\" + color + \", 0)\");\n    ctx.beginPath();\n    ctx.fillStyle = gradient;\n    ctx.fillRect(0, top, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(h + fogThickness));\n  };\n\n  _proto._getAllLayerToRender = function _getAllLayerToRender() {\n    return this.map._getLayers();\n  };\n\n  _proto.clearCanvas = function clearCanvas() {\n    if (!this.canvas) {\n      return;\n    }\n\n    Canvas.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n  };\n\n  _proto._updateCanvasSize = function _updateCanvasSize() {\n    if (!this.canvas || this._containerIsCanvas) {\n      return false;\n    }\n\n    var map = this.map,\n        mapSize = map.getSize(),\n        canvas = this.canvas,\n        r = map.getDevicePixelRatio();\n\n    if (mapSize['width'] * r === canvas.width && mapSize['height'] * r === canvas.height) {\n      return false;\n    }\n\n    canvas.height = r * mapSize['height'];\n    canvas.width = r * mapSize['width'];\n\n    if (canvas.style) {\n      canvas.style.width = mapSize['width'] + 'px';\n      canvas.style.height = mapSize['height'] + 'px';\n    }\n\n    return true;\n  };\n\n  _proto.createCanvas = function createCanvas() {\n    if (this._containerIsCanvas) {\n      this.canvas = this.map._containerDOM;\n    } else {\n      this.canvas = createEl('canvas');\n\n      this._updateCanvasSize();\n\n      this.map._panels.canvasContainer.appendChild(this.canvas);\n    }\n\n    this.context = this.canvas.getContext('2d');\n  };\n\n  _proto._checkSize = function _checkSize() {\n    if (!this.map || this.map.isInteracting()) {\n      return;\n    }\n\n    computeDomPosition(this.map._containerDOM);\n    this.map.checkSize();\n  };\n\n  _proto._setCheckSizeInterval = function _setCheckSizeInterval(interval) {\n    var _this3 = this;\n\n    clearInterval(this._resizeInterval);\n    this._checkSizeInterval = interval;\n    this._resizeInterval = setInterval(function () {\n      if (!_this3.map || _this3.map.isRemoved()) {\n        clearInterval(_this3._resizeInterval);\n      } else {\n        _this3._checkSize();\n      }\n    }, this._checkSizeInterval);\n  };\n\n  _proto._registerEvents = function _registerEvents() {\n    var _this4 = this;\n\n    var map = this.map;\n\n    if (map.options['checkSize'] && !IS_NODE && typeof window !== 'undefined') {\n      this._setCheckSizeInterval(map.options['checkSizeInterval']);\n    }\n\n    if (!Browser$1.mobile) {\n      map.on('_mousemove', this._onMapMouseMove, this);\n    }\n\n    map.on('_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart', function (param) {\n      _this4._eventParam = param;\n    });\n    map.on('_zooming', function (param) {\n      if (!map.getPitch()) {\n        _this4._zoomMatrix = param['matrix']['container'];\n      }\n\n      _this4._eventParam = param;\n    });\n    map.on('_zoomend', function (param) {\n      _this4._eventParam = param;\n      delete _this4._zoomMatrix;\n    });\n    map.on('_spatialreferencechange', function () {\n      _this4._spatialRefChanged = true;\n    });\n\n    if (Browser$1.webgl && typeof document !== 'undefined') {\n      addDomEvent(document, 'visibilitychange', this._onVisibilitychange, this);\n    }\n  };\n\n  _proto._onMapMouseMove = function _onMapMouseMove(param) {\n    var _this5 = this;\n\n    var map = this.map;\n\n    if (map.isInteracting() || !map.options['hitDetect']) {\n      return;\n    }\n\n    if (this._hitDetectFrame) {\n      cancelAnimFrame(this._hitDetectFrame);\n    }\n\n    this._hitDetectFrame = requestAnimFrame(function () {\n      _this5.hitDetect(param['containerPoint']);\n    });\n  };\n\n  _proto._getCanvasLayers = function _getCanvasLayers() {\n    return this.map._getLayers(function (layer) {\n      return layer.isCanvasRender();\n    });\n  };\n\n  _proto._onVisibilitychange = function _onVisibilitychange() {\n    if (document.visibilityState !== 'visible') {\n      return;\n    }\n\n    this.setToRedraw();\n  };\n\n  return MapCanvasRenderer;\n}(MapRenderer);\n\nMap$1.registerRenderer('canvas', MapCanvasRenderer);\nMap$1.mergeOptions({\n  'fog': false,\n  'fogColor': [233, 233, 233]\n});\n\n\n\nvar index$6 = /*#__PURE__*/Object.freeze({\n  ResourceCache: ResourceCache,\n  CanvasRenderer: CanvasRenderer,\n  ImageGLRenderable: ImageGLRenderable,\n  MapRenderer: MapRenderer,\n  MapCanvasRenderer: MapCanvasRenderer,\n  Renderable: Renderable,\n  ImageLayerCanvasRenderer: ImageLayerCanvasRenderer,\n  ImageLayerGLRenderer: ImageLayerGLRenderer,\n  TileLayerCanvasRenderer: TileLayerCanvasRenderer,\n  TileLayerGLRenderer: TileLayerGLRenderer,\n  CanvasTileLayerCanvasRenderer: CanvasRenderer$1,\n  CanvasTileLayerGLRenderer: GLRenderer,\n  OverlayLayerCanvasRenderer: OverlayLayerRenderer,\n  VectorLayerCanvasRenderer: VectorLayerRenderer,\n  CanvasLayerRenderer: CanvasLayerRenderer\n});\n\nvar CenterPointRenderer = {\n  _getRenderPoints: function _getRenderPoints() {\n    return [[this._getCenter2DPoint(this.getMap().getGLZoom())], null];\n  }\n};\nMarker.include(CenterPointRenderer);\nEllipse.include(CenterPointRenderer);\nCircle.include(CenterPointRenderer);\nSector.include(CenterPointRenderer);\nRectangle.include({\n  _getRenderPoints: function _getRenderPoints(placement) {\n    var map = this.getMap();\n\n    if (placement === 'vertex') {\n      var shell = this._trimRing(this.getShell());\n\n      var points = [];\n\n      for (var i = 0, len = shell.length; i < len; i++) {\n        points.push(map.coordToPoint(shell[i], map.getGLZoom()));\n      }\n\n      return [points, null];\n    } else {\n      var c = map.coordToPoint(this.getCenter(), map.getGLZoom());\n      return [[c], null];\n    }\n  }\n});\nvar PolyRenderer = {\n  _getRenderPoints: function _getRenderPoints(placement) {\n    var map = this.getMap();\n    var glZoom = map.getGLZoom();\n    var points,\n        rotations = null;\n\n    if (placement === 'point') {\n      points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n\n      if (points && points.length > 0 && Array.isArray(points[0])) {\n        points = points[0].concat(points[1]);\n      }\n    } else if (placement === 'vertex') {\n      points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n      rotations = [];\n\n      if (points && points.length > 0 && Array.isArray(points[0])) {\n        for (var i = 0, l = points.length; i < l; i++) {\n          for (var ii = 0, ll = points[i].length; ii < ll; ii++) {\n            if (ii === 0) {\n              rotations.push([points[i][ii], points[i][ii + 1]]);\n            } else {\n              rotations.push([points[i][ii - 1], points[i][ii]]);\n            }\n          }\n        }\n\n        points = points[0].concat(points[1]);\n      } else {\n        for (var _i = 0, _l = points.length; _i < _l; _i++) {\n          if (_i === 0) {\n            rotations.push([points[_i], points[_i + 1]]);\n          } else {\n            rotations.push([points[_i - 1], points[_i]]);\n          }\n        }\n      }\n    } else if (placement === 'line') {\n      points = [];\n      rotations = [];\n\n      var vertice = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom),\n          isSplitted = vertice.length > 0 && Array.isArray(vertice[0]);\n\n      if (isSplitted) {\n        var ring;\n\n        for (var _i2 = 1, _l2 = vertice.length; _i2 < _l2; _i2++) {\n          ring = vertice[_i2];\n\n          if (this instanceof Polygon && ring.length > 0 && !ring[0].equals(ring[ring.length - 1])) {\n            ring.push(ring[0]);\n          }\n\n          for (var _ii = 1, _ll = ring.length; _ii < _ll; _ii++) {\n            points.push(ring[_ii].add(ring[_ii - 1])._multi(0.5));\n            rotations.push([ring[_ii - 1], ring[_ii]]);\n          }\n        }\n      } else {\n        if (this instanceof Polygon && vertice.length > 0 && !vertice[0].equals(vertice[vertice.length - 1])) {\n          vertice.push(vertice[0]);\n        }\n\n        for (var _i3 = 1, _l3 = vertice.length; _i3 < _l3; _i3++) {\n          points.push(vertice[_i3].add(vertice[_i3 - 1])._multi(0.5));\n          rotations.push([vertice[_i3 - 1], vertice[_i3]]);\n        }\n      }\n    } else if (placement === 'vertex-first') {\n      var coords = this._getPrjCoordinates();\n\n      points = coords.length ? [map._prjToPoint(coords[0], glZoom)] : [];\n      rotations = coords.length ? [[map._prjToPoint(coords[0], glZoom), map._prjToPoint(coords[1], glZoom)]] : [];\n    } else if (placement === 'vertex-last') {\n      var _coords = this._getPrjCoordinates();\n\n      var _l4 = _coords.length;\n      points = _l4 ? [map._prjToPoint(_coords[_l4 - 1], glZoom)] : [];\n      var current = _l4 - 1,\n          previous = _l4 > 1 ? _l4 - 2 : _l4 - 1;\n      rotations = _l4 ? [[map._prjToPoint(_coords[previous], glZoom), map._prjToPoint(_coords[current], glZoom)]] : [];\n    } else {\n      var pcenter = this._getProjection().project(this.getCenter());\n\n      points = [map._prjToPoint(pcenter, glZoom)];\n    }\n\n    return [points, rotations];\n  }\n};\nLineString.include(PolyRenderer);\nPolygon.include(PolyRenderer);\n\nGeometry.include({\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return false;\n  },\n  _redrawWhenRotate: function _redrawWhenRotate() {\n    return false;\n  }\n});\nvar el = {\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return true;\n  },\n  _redrawWhenRotate: function _redrawWhenRotate() {\n    return this instanceof Ellipse || this instanceof Sector;\n  },\n  _paintAsPath: function _paintAsPath() {\n    var map = this.getMap();\n\n    var altitude = this._getPainter().getAltitude();\n\n    return altitude > 0 || map.getPitch() || this instanceof Ellipse && map.getBearing();\n  },\n  _getPaintParams: function _getPaintParams() {\n    var map = this.getMap();\n\n    if (this._paintAsPath()) {\n      return Polygon.prototype._getPaintParams.call(this, true);\n    }\n\n    var pcenter = this._getPrjCoordinates();\n\n    var pt = map._prjToPoint(pcenter, map.getGLZoom());\n\n    var size = this._getRenderSize(pt);\n\n    return [pt].concat(size);\n  },\n  _paintOn: function _paintOn() {\n    if (this._paintAsPath()) {\n      return Canvas.polygon.apply(Canvas, arguments);\n    } else {\n      return Canvas.ellipse.apply(Canvas, arguments);\n    }\n  },\n  _getRenderSize: function _getRenderSize(pt) {\n    var map = this.getMap(),\n        z = map.getGLZoom();\n\n    var prjExtent = this._getPrjExtent();\n\n    var pmin = map._prjToPoint(prjExtent.getMin(), z),\n        pmax = map._prjToPoint(prjExtent.getMax(), z);\n\n    return [Math.abs(pmax.x - pmin.x) / 2, Math.abs(pmax.y - pt.y), Math.abs(pt.y - pmin.y)];\n  }\n};\nEllipse.include(el);\nCircle.include(el);\nRectangle.include({\n  _getPaintParams: function _getPaintParams() {\n    var map = this.getMap();\n    var pointZoom = map.getGLZoom();\n\n    var shell = this._getPrjShell();\n\n    var points = this._getPath2DPoints(shell, false, pointZoom);\n\n    return [points];\n  },\n  _paintOn: Canvas.polygon\n});\nSector.include(el, {\n  _redrawWhenPitch: function _redrawWhenPitch() {\n    return true;\n  },\n  _getPaintParams: function _getPaintParams() {\n    if (this._paintAsPath()) {\n      return Polygon.prototype._getPaintParams.call(this, true);\n    }\n\n    var map = this.getMap();\n\n    var pt = map._prjToPoint(this._getPrjCoordinates(), map.getGLZoom());\n\n    var size = this._getRenderSize(pt);\n\n    return [pt, size[0], [this.getStartAngle(), this.getEndAngle()]];\n  },\n  _paintOn: function _paintOn() {\n    if (this._paintAsPath()) {\n      return Canvas.polygon.apply(Canvas, arguments);\n    } else {\n      var r = this.getMap().getBearing();\n      var args = arguments;\n\n      if (r) {\n        args[3] = args[3].slice(0);\n        args[3][0] += r;\n        args[3][1] += r;\n      }\n\n      return Canvas.sector.apply(Canvas, args);\n    }\n  }\n});\nPath.include({\n  _paintAsPath: function _paintAsPath() {\n    return true;\n  }\n});\nLineString.include({\n  arrowStyles: {\n    'classic': [3, 4]\n  },\n  _getArrowShape: function _getArrowShape(prePoint, point, lineWidth, arrowStyle, tolerance) {\n    if (!prePoint || !point || prePoint.equals(point)) {\n      return null;\n    }\n\n    if (!tolerance) {\n      tolerance = 0;\n    }\n\n    var width = lineWidth * arrowStyle[0],\n        height = lineWidth * arrowStyle[1] + tolerance,\n        hw = width / 2 + tolerance;\n    var normal;\n\n    if (point.nextCtrlPoint || point.prevCtrlPoint) {\n      if (point.prevCtrlPoint) {\n        normal = point.sub(new Point(point.prevCtrlPoint));\n      } else {\n        normal = point.sub(new Point(point.nextCtrlPoint));\n      }\n    } else {\n      normal = point.sub(prePoint);\n    }\n\n    normal._unit();\n\n    var p1 = point.sub(normal.multi(height));\n\n    normal._perp();\n\n    var p0 = p1.add(normal.multi(hw));\n\n    normal._multi(-1);\n\n    var p2 = p1.add(normal.multi(hw));\n    return [p0, point, p2, p0];\n  },\n  _getPaintParams: function _getPaintParams() {\n    var prjVertexes = this._getPrjCoordinates();\n\n    var points = this._getPath2DPoints(prjVertexes, false, this.getMap().getGLZoom());\n\n    return [points];\n  },\n  _paintOn: function _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n    if (this.options['smoothness']) {\n      Canvas.paintSmoothLine(ctx, points, lineOpacity, this.options['smoothness'], false, this._animIdx, this._animTailRatio);\n    } else {\n      Canvas.path(ctx, points, lineOpacity, null, dasharray);\n    }\n\n    this._paintArrow(ctx, points, lineOpacity);\n  },\n  _getArrowPlacement: function _getArrowPlacement() {\n    return this.options['arrowPlacement'];\n  },\n  _getArrowStyle: function _getArrowStyle() {\n    var arrowStyle = this.options['arrowStyle'];\n\n    if (arrowStyle) {\n      return Array.isArray(arrowStyle) ? arrowStyle : this.arrowStyles[arrowStyle];\n    }\n\n    return null;\n  },\n  _getArrows: function _getArrows(points, lineWidth, tolerance) {\n    var arrowStyle = this._getArrowStyle();\n\n    if (!arrowStyle || points.length < 2) {\n      return [];\n    }\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n    var segments = isSplitted ? points : [points];\n\n    var placement = this._getArrowPlacement();\n\n    var arrows = [];\n    var map = this.getMap(),\n        first = map.coordToContainerPoint(this.getFirstCoordinate()),\n        last = map.coordToContainerPoint(this.getLastCoordinate());\n\n    for (var i = segments.length - 1; i >= 0; i--) {\n      if (placement === 'vertex-first' || placement === 'vertex-firstlast' && segments[i][0].closeTo(first, 0.01)) {\n        var arrow = this._getArrowShape(segments[i][1], segments[i][0], lineWidth, arrowStyle, tolerance);\n\n        if (arrow) {\n          arrows.push(arrow);\n        }\n      }\n\n      if (placement === 'vertex-last' || placement === 'vertex-firstlast' && segments[i][segments[i].length - 1].closeTo(last, 0.01)) {\n        var _arrow = this._getArrowShape(segments[i][segments[i].length - 2], segments[i][segments[i].length - 1], lineWidth, arrowStyle, tolerance);\n\n        if (_arrow) {\n          arrows.push(_arrow);\n        }\n      } else if (placement === 'point') {\n        this._getArrowPoints(arrows, segments[i], lineWidth, arrowStyle, tolerance);\n      }\n    }\n\n    return arrows;\n  },\n  _getArrowPoints: function _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n    for (var ii = 0, ll = segments.length - 1; ii < ll; ii++) {\n      var arrow = this._getArrowShape(segments[ii], segments[ii + 1], lineWidth, arrowStyle, tolerance);\n\n      if (arrow) {\n        arrows.push(arrow);\n      }\n    }\n  },\n  _paintArrow: function _paintArrow(ctx, points, lineOpacity) {\n    var lineWidth = this._getInternalSymbol()['lineWidth'];\n\n    if (!isNumber(lineWidth) || lineWidth < 3) {\n      lineWidth = 3;\n    }\n\n    var arrows = this._getArrows(points, lineWidth);\n\n    if (!arrows.length) {\n      return;\n    }\n\n    if (ctx.setLineDash) {\n      ctx.setLineDash([]);\n    }\n\n    for (var i = arrows.length - 1; i >= 0; i--) {\n      ctx.fillStyle = ctx.strokeStyle;\n      Canvas.polygon(ctx, arrows[i], lineOpacity, lineOpacity);\n    }\n  }\n});\nPolygon.include({\n  _getPaintParams: function _getPaintParams(disableSimplify) {\n    var maxZoom = this.getMap().getGLZoom();\n\n    var prjVertexes = this._getPrjShell();\n\n    var points = this._getPath2DPoints(prjVertexes, disableSimplify, maxZoom);\n\n    var isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n    if (isSplitted) {\n      points = [[points[0]], [points[1]]];\n    }\n\n    var prjHoles = this._getPrjHoles();\n\n    var holePoints = [];\n\n    if (prjHoles && prjHoles.length > 0) {\n      var simplified = this._simplified;\n\n      for (var i = 0; i < prjHoles.length; i++) {\n        var hole = this._getPath2DPoints(prjHoles[i], disableSimplify, maxZoom);\n\n        if (Array.isArray(hole) && isSplitted) {\n          if (Array.isArray(hole[0])) {\n            points[0].push(hole[0]);\n            points[1].push(hole[1]);\n          } else {\n            points[0].push(hole);\n          }\n        } else {\n          holePoints.push(hole);\n        }\n      }\n\n      if (simplified) {\n        this._simplified = simplified;\n      }\n    }\n\n    if (!isSplitted) {\n      points = [points];\n      pushIn(points, holePoints);\n    }\n\n    return [points];\n  },\n  _paintOn: function _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n    Canvas.polygon(ctx, points, lineOpacity, fillOpacity, dasharray, this.options['smoothness']);\n  }\n});\n\nMap$1.VERSION = version;\n\nexport { index$1 as Util, dom as DomUtil, strings as StringUtil, index as MapboxUtil, Map$1 as Map, index$4 as ui, index$5 as control, index$6 as renderer, index$3 as symbolizer, Animation$1 as animation, Browser$1 as Browser, Ajax, Canvas, Promise$1 as Promise, Class, Eventable, JSONAble, Handlerable, Handler$1 as Handler, DragHandler, MapTool, DrawTool, AreaTool, DistanceTool, SpatialReference, INTERNAL_LAYER_PREFIX, GEOMETRY_COLLECTION_TYPES, GEOJSON_TYPES, RESOURCE_PROPERTIES, RESOURCE_SIZE_PROPERTIES, NUMERICAL_PROPERTIES, COLOR_PROPERTIES, DEFAULT_TEXT_SIZE, projections as projection, index$2 as measurer, Coordinate, CRS, Extent, Point, PointExtent, Size, Transformation, Layer, TileLayer, GroupTileLayer, WMSTileLayer, CanvasTileLayer, ImageLayer, OverlayLayer, VectorLayer, CanvasLayer, ParticleLayer, TileSystem, TileConfig, ArcCurve, Circle, ConnectorLine, ArcConnectorLine, CubicBezierCurve, Curve, Ellipse, GeoJSON, Geometry, GeometryCollection, Label, LineString, Marker, MultiLineString, MultiPoint, MultiPolygon, Polygon, QuadBezierCurve, Rectangle, Sector, TextBox, TextMarker };\n"]}]}