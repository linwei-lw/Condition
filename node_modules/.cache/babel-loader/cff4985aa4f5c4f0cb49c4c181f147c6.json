{"remainingRequest":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\src\\common\\cache\\CacheCarAttr.js","dependencies":[{"path":"D:\\cdRule\\src\\common\\cache\\CacheCarAttr.js","mtime":1677658521356},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import { arrayToMap } from '@/common/util/Arrays.js';\nimport { objCopyTo } from '@/common/util/Objects.js';\nvar BASE_CACHE = null;\nvar base_loading = false;\nexport function getBaseAttrs(callback) {\n  if (BASE_CACHE) {\n    return callback ? callback(BASE_CACHE) : BASE_CACHE;\n  }\n\n  if (callback && base_loading) {\n    //正在请求后台加载中，等1秒再试试\n    return setTimeout(function () {\n      return getBaseAttrs(callback);\n    }, 1000);\n  }\n\n  base_loading = true;\n\n  var fun = function fun(result) {\n    base_loading = false;\n    BASE_CACHE = arrayToMap(result || [], 'carId');\n    return callback ? callback(BASE_CACHE) : BASE_CACHE;\n  };\n\n  return callback ? window.$_main.http.get('mgr/car?getBaseAttrs').then(fun) : fun(window.$_main.http.syncGet('mgr/car?getBaseAttrs'));\n}\nexport function initBaseAttr(result) {\n  BASE_CACHE = arrayToMap(result || [], 'carId');\n}\nexport function getBaseAttrByCarId(carId) {\n  !BASE_CACHE && getBaseAttrs();\n  return BASE_CACHE[carId];\n}\nexport function onBaseAttrAddOrUpdate(attr, car) {\n  if (!BASE_CACHE || !attr) return;\n  attr.carId = car.id;\n  attr.cmpId = car.cmpId;\n  var old = BASE_CACHE[attr.carId];\n\n  if (!old) {\n    BASE_CACHE[attr.carId] = attr;\n  } else {\n    objCopyTo(attr, old);\n  }\n}\nexport function onBaseAttrDelete(carId) {\n  if (!BASE_CACHE || !carId) return;\n  delete BASE_CACHE[carId];\n}\nexport function changeBaseAttr(carId, params) {\n  if (!BASE_CACHE) return;\n  var attr = BASE_CACHE[carId] || {\n    carId: carId,\n    cmpId: $_cache.user.cmpId\n  };\n\n  for (var key in params) {\n    attr[key] = params[key];\n  }\n\n  BASE_CACHE[carId] = attr;\n} //=============================================================================================================================\n\nvar BB_CACHE = null;\nvar bb_loading = false;\nexport function getBbAttrs(callback) {\n  if (BB_CACHE) {\n    return callback ? callback(BB_CACHE) : BB_CACHE;\n  }\n\n  if (callback && bb_loading) {\n    //正在请求后台加载中，等1秒再试试\n    return setTimeout(function () {\n      return getBbAttrs(callback);\n    }, 1000);\n  }\n\n  bb_loading = true;\n\n  var fun = function fun(result) {\n    bb_loading = false;\n    BB_CACHE = arrayToMap(result || [], 'carId');\n    return callback ? callback(BB_CACHE) : BB_CACHE;\n  };\n\n  return callback ? window.$_main.http.get('mgr/car?getBbAttrs').then(fun) : fun(window.$_main.http.syncGet('mgr/car?getBbAttrs'));\n}\nexport function getBbAttrByCarId(carId) {\n  !BB_CACHE && getBbAttrs();\n  return BB_CACHE[carId];\n}\nexport function onBbAttrAddOrUpdate(attr, car) {\n  if (!BB_CACHE || !attr) return;\n  attr.carId = car.id;\n  attr.cmpId = car.cmpId;\n  var old = BB_CACHE[attr.carId];\n\n  if (!old) {\n    BB_CACHE[attr.carId] = attr;\n  } else {\n    objCopyTo(attr, old);\n  }\n}\nexport function onBbAttrDelete(carId) {\n  if (!BB_CACHE || !carId) return;\n  delete BB_CACHE[carId];\n}\nexport function changeBbAttr(carId, params) {\n  if (!BB_CACHE) return;\n  var attr = BB_CACHE[carId] || {\n    carId: carId,\n    cmpId: $_cache.user.cmpId\n  };\n\n  for (var key in params) {\n    attr[key] = params[key];\n  }\n\n  BB_CACHE[carId] = attr;\n}",{"version":3,"sources":["D:\\cdRule\\src\\common\\cache\\CacheCarAttr.js"],"names":["BASE_CACHE","base_loading","callback","setTimeout","getBaseAttrs","fun","arrayToMap","result","window","attr","car","old","objCopyTo","carId","cmpId","$_cache","params","BB_CACHE","bb_loading","getBbAttrs"],"mappings":"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","sourcesContent":["import { arrayToMap } from '@/common/util/Arrays.js';\r\nimport { objCopyTo }  from '@/common/util/Objects.js';\r\n\r\nlet BASE_CACHE = null;\r\nlet base_loading = false;\r\n\r\nexport function getBaseAttrs(callback) {\r\n\tif (BASE_CACHE) {\r\n\t\treturn callback ? callback(BASE_CACHE) : BASE_CACHE;\r\n\t}\r\n\tif (callback && base_loading) {//正在请求后台加载中，等1秒再试试\r\n\t  return setTimeout(()=>getBaseAttrs(callback), 1000);\r\n\t}\r\n\tbase_loading = true;\r\n\tlet fun = result => {\r\n\t\tbase_loading = false;\r\n\t\tBASE_CACHE = arrayToMap(result || [], 'carId');\r\n\t\treturn callback ? callback(BASE_CACHE) : BASE_CACHE;\r\n\t}\r\n\treturn callback ? window.$_main.http.get('mgr/car?getBaseAttrs').then(fun) : fun(window.$_main.http.syncGet('mgr/car?getBaseAttrs'));\r\n}\r\n\r\nexport function initBaseAttr(result) {\r\n\tBASE_CACHE = arrayToMap(result || [], 'carId');\r\n}\r\n\r\nexport function getBaseAttrByCarId(carId) {\r\n\t!BASE_CACHE && getBaseAttrs();\r\n\treturn BASE_CACHE[carId];\r\n}\r\n\r\nexport function onBaseAttrAddOrUpdate(attr, car) {\r\n\tif (!BASE_CACHE || !attr) return;\r\n\tattr.carId = car.id;\r\n\tattr.cmpId = car.cmpId;\r\n\tlet old = BASE_CACHE[attr.carId];\r\n\tif (!old) {\r\n\t\tBASE_CACHE[attr.carId] = attr;\r\n\t} else {\r\n\t\tobjCopyTo(attr, old);\r\n\t}\r\n}\r\n\r\nexport function onBaseAttrDelete(carId) {\r\n\tif (!BASE_CACHE || !carId) return;\r\n\tdelete BASE_CACHE[carId];\r\n}\r\n\r\nexport function changeBaseAttr(carId, params) {\r\n\tif (!BASE_CACHE) return;\r\n\tlet attr = BASE_CACHE[carId] || {carId:carId, cmpId:$_cache.user.cmpId};\r\n\tfor (let key in params) {\r\n\t\tattr[key] = params[key];\r\n\t}\r\n\tBASE_CACHE[carId] = attr;\r\n}\r\n\r\n//=============================================================================================================================\r\n\r\nlet BB_CACHE = null;\r\nlet bb_loading = false;\r\n\r\nexport function getBbAttrs(callback) {\r\n\tif (BB_CACHE) {\r\n\t\treturn callback ? callback(BB_CACHE) : BB_CACHE;\r\n\t}\r\n\tif (callback && bb_loading) {//正在请求后台加载中，等1秒再试试\r\n\t  return setTimeout(()=>getBbAttrs(callback), 1000);\r\n\t}\r\n\tbb_loading = true;\r\n\tlet fun = result => {\r\n\t\tbb_loading = false;\r\n\t\tBB_CACHE = arrayToMap(result || [], 'carId');\r\n\t\treturn callback ? callback(BB_CACHE) : BB_CACHE;\r\n\t}\r\n\treturn callback ? window.$_main.http.get('mgr/car?getBbAttrs').then(fun) : fun(window.$_main.http.syncGet('mgr/car?getBbAttrs'));\r\n}\r\n\r\nexport function getBbAttrByCarId(carId) {\r\n\t!BB_CACHE && getBbAttrs();\r\n\treturn BB_CACHE[carId];\r\n}\r\n\r\nexport function onBbAttrAddOrUpdate(attr, car) {\r\n\tif (!BB_CACHE || !attr) return;\r\n\tattr.carId = car.id;\r\n\tattr.cmpId = car.cmpId;\r\n\tlet old = BB_CACHE[attr.carId];\r\n\tif (!old) {\r\n\t\tBB_CACHE[attr.carId] = attr;\r\n\t} else {\r\n\t\tobjCopyTo(attr, old);\r\n\t}\r\n}\r\n\r\nexport function onBbAttrDelete(carId) {\r\n\tif (!BB_CACHE || !carId) return;\r\n\tdelete BB_CACHE[carId];\r\n}\r\n\r\nexport function changeBbAttr(carId, params) {\r\n\tif (!BB_CACHE) return;\r\n\tlet attr = BB_CACHE[carId] || {carId:carId, cmpId:$_cache.user.cmpId};\r\n\tfor (let key in params) {\r\n\t\tattr[key] = params[key];\r\n\t}\r\n\tBB_CACHE[carId] = attr;\r\n}\r\n"]}]}