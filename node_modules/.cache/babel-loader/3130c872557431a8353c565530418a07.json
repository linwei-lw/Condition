{"remainingRequest":"D:\\cdRule\\node_modules\\thread-loader\\dist\\cjs.js!D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\src\\common\\mixin\\http.js","dependencies":[{"path":"D:\\cdRule\\src\\common\\mixin\\http.js","mtime":1677661236842},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["/**\r\n * http请求后台服务模块\r\n */\nimport axios from 'axios';\nimport qs from 'qs';\naxios.defaults.withCredentials = true;\nlet headers = {\n  'Content-Type': 'application/json;charset=UTF-8'\n};\nlet isTimeout = false;\nconst http = {\n  authorization: token => {\n    headers.Authorization = token;\n  },\n  get: function get(url, params) {\n    let quiet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (isTimeout) return;\n    url += (url.indexOf('?') > 0 ? '&' : '?') + (params ? qs.stringify(params) + '&' : '') + new Date().getTime();\n    return axios({\n      headers: headers,\n      method: 'get',\n      url: `${window.$_domain.WEB_PATH}h5${url}`\n    }).then(r => r.data).then(r => {\n      if (r.status == 1) {\n        return r.result;\n      } else if (r.status == -1) {\n        isTimeout = true;\n        let page = r.result || 'index.html';\n        $_alert.error('您未登录或会话超时，请返回登录界面!', null, () => {\n          location.href = page;\n        }, true);\n      } else {\n        !quiet && $_alert.error(r.result);\n      }\n\n      throw r;\n    });\n  },\n  post: function post(url, params) {\n    let quiet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (isTimeout) return;\n    url += (url.indexOf('?') > 0 ? '&' : '?') + new Date().getTime(); // console.log(`${window.$_domain.WEB_PATH}h5${url}`);\n\n    return axios({\n      headers: headers,\n      method: 'post',\n      url: `${window.$_domain.WEB_PATH}h5${url}`,\n      data: params\n    }).then(r => r.data).then(r => {\n      if (r.status == 1) {\n        return r.result;\n      } else if (r.status == -1) {\n        isTimeout = true;\n        let page = r.result || 'index.html';\n        $_alert.error('您未登录或会话超时，请返回登录界面!', null, () => {\n          location.href = page;\n        }, true);\n      } else {\n        !quiet && $_alert.error(r.result);\n      }\n\n      throw r;\n    }).catch(err => {});\n  },\n  postxhyc: function postxhyc(url, params) {\n    let quiet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (isTimeout) return;\n    url += (url.indexOf('?') > 0 ? '&' : '?') + new Date().getTime(); // console.log(`${window.$_domain.WEB_ROOT}${url}`);\n\n    if (url.indexOf('http://') != -1) {\n      return axios({\n        headers: headers,\n        method: 'post',\n        url: url,\n        data: params\n      }).then(r => {\n        // isTimeout = true;\n        // console.log(r,\"成功\");\n        return r.data;\n      }).then(r => {\n        if (r.status == 1) {\n          if (r.result.hasOwnProperty(encry)) {\n            return result(r.result);\n          } else {\n            return r.result;\n          } // } else if (r.status == -1) {\n          //   isTimeout = true;\n          //   let page = r.result || 'index.html';\n          //   $_alert.error('您未登录或会话超时，请返回登录界面!', null, ()=>{location.href=page}, true);\n\n        } else {\n          $_alert.error($_L.get('请求错误')); //   !quiet && $_alert.error(r.result);\n        }\n      }).catch(err => {// console.log(err,\"返回错误\");\n      });\n    } else {\n      return axios({\n        headers: headers,\n        method: 'post',\n        url: `${window.$_domain.WEB_ROOT}${url}`,\n        data: params\n      }).then(r => {\n        // isTimeout = true;\n        // console.log(r,\"成功\");\n        return r.data;\n      }).then(r => {\n        return r; // if (r.status == 1) {\n        //   if(r.result.hasOwnProperty(encry)){\n        //    return result(r.result)\n        //   }else{\n        //     return r.result;\n        //   }\n        // // } else if (r.status == -1) {\n        //   // isTimeout = true;\n        // //   let page = r.result || 'index.html';\n        // //   $_alert.error('您未登录或会话超时，请返回登录界面!', null, ()=>{location.href=page}, true);\n        // } else {\n        // //   !quiet && $_alert.error(r.result);\n        //   $_alert.error($_L.get('请求错误'))\n        // }\n      }).catch(err => {// console.log(err,\"返回错误\");\n      });\n    }\n  },\n  getxhyc: function getxhyc(url, params) {\n    let quiet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (isTimeout) return;\n    url += (url.indexOf('?') > 0 ? '&' : '?') + (params ? qs.stringify(params) + '&' : '') + new Date().getTime(); // console.log(`${window.$_domain.WEB_ROOT}${url}`);\n\n    if (url.indexOf('http://') != -1) {\n      return axios({\n        headers: headers,\n        method: 'get',\n        url: url\n      }).then(r => {\n        // isTimeout = true;\n        // console.log(r,\"成功\");\n        return r.data;\n      }).then(r => {\n        if (r.status == 1) {\n          if (r.result.hasOwnProperty(encry)) {\n            return result(r.result);\n          } else {\n            return r.result;\n          } // } else if (r.status == -1) {\n          // isTimeout = true;\n          //   let page = r.result || 'index.html';\n          //   $_alert.error('您未登录或会话超时，请返回登录界面!', null, ()=>{location.href=page}, true);\n\n        } else {\n          $_alert.error($_L.get('请求错误')); //   !quiet && $_alert.error(r.result);\n        }\n      }).catch(err => {// console.log(err,\"返回错误\");\n      });\n    } else {\n      return axios({\n        headers: headers,\n        method: 'get',\n        url: `${window.$_domain.WEB_ROOT}${url}`\n      }).then(r => {\n        // isTimeout = true;\n        // console.log(r,\"成功\");\n        return r.data;\n      }).then(r => {\n        if (r.status == 1) {\n          if (r.result.hasOwnProperty(encry)) {\n            return result(r.result);\n          } else {\n            return r.result;\n          } // } else if (r.status == -1) {\n          // isTimeout = true;\n          //   let page = r.result || 'index.html';\n          //   $_alert.error('您未登录或会话超时，请返回登录界面!', null, ()=>{location.href=page}, true);\n\n        } else {\n          $_alert.error($_L.get('请求错误')); //   !quiet && $_alert.error(r.result);\n        }\n      }).catch(err => {// console.log(err,\"返回错误\");\n      });\n    }\n  },\n  syncGet: function syncGet(url, params) {\n    let quiet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (isTimeout) return;\n    url += (url.indexOf('?') > 0 ? '&' : '?') + (params ? qs.stringify(params) + '&' : '') + new Date().getTime();\n    return sync('GET', url, null, quiet);\n  },\n  syncPost: function syncPost(url, params) {\n    let quiet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (isTimeout) return;\n    url += (url.indexOf('?') > 0 ? '&' : '?') + new Date().getTime();\n    return sync('POST', url, JSON.stringify(params), quiet);\n  }\n};\n\nfunction sync(method, url, params, quiet) {\n  let xhr = new XMLHttpRequest();\n\n  if (url.indexOf('http://') != -1) {\n    xhr.open(method, `${url}`, false);\n  } else {\n    xhr.open(method, `${window.$_domain.WEB_PATH}h5${url}`, false);\n  }\n\n  xhr.withCredentials = true;\n  xhr.setRequestHeader('Accept', 'application/json');\n  xhr.setRequestHeader('Content-Type', 'application/json');\n  xhr.setRequestHeader('Authorization', headers.Authorization);\n  xhr.send(params);\n  let r = JSON.parse(xhr.responseText);\n\n  if (r.status == 1) {\n    if (r.result.hasOwnProperty(encry)) {\n      return result(r.result);\n    } else {\n      return r.result;\n    }\n  } else if (r.status == -1) {\n    isTimeout = true;\n    let page = r.result || 'index.html';\n    $_alert.error('您未登录或会话超时，请返回登录界面!', null, () => {\n      location.href = page;\n    }, true);\n  } else {\n    !quiet && $_alert.error(r.result);\n  }\n\n  throw r;\n}\n\nfunction result(_ref) {\n  let encry = _ref.encry,\n      result = _ref.result;\n  if (!encry || !result) return result;\n  let array = [];\n\n  for (let i = 0, len = result.length; i < len; i++) {\n    array.push(result.charCodeAt(i));\n  }\n\n  return JSON.parse(pako.ungzip(new Uint8Array(array), {\n    to: 'string'\n  }));\n}\n\nwindow.$_http = http;",null]}