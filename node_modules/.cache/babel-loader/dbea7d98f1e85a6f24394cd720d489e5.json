{"remainingRequest":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\cdRule\\src\\modules\\RptGpsTrack.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\cdRule\\src\\modules\\RptGpsTrack.vue","mtime":1675482283117},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.set\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Split from '@/components/Split.vue';\nimport _carTree from '@/common/tree/CarTree.vue';\nimport InputDateTime from '@/components/InputDateTime.vue';\nimport ButtonTime from '@/components/ButtonTime.vue';\nimport _AlarmTree from '@/common/tree/AlarmTree.vue';\nimport PoiTree from '@/common/tree/PoiTree.vue';\nimport { getNowDate, splitDate, apartDays } from '@/common/util/Dates.js';\nimport { exportToExcel as _exportToExcel } from \"@/common/util/Exps.js\";\nimport { objClone } from \"@/common/util/Objects.js\";\nimport { getPois } from '@/common/cache/CachePoi.js';\nimport { getFavAlarmType } from '@/common/cache/CacheAlarm.js';\nimport { arrayRemoveFilter, arrayRemoveValue } from '@/common/util/Arrays.js';\nimport { arrayToTree } from '@/common/util/Trees.js';\nimport _Labels from '@/common/gps/Labels.js';\nimport { adjunctFunction } from '@/common/alarm/Labels.js';\nimport QueryCarRunVideoWindow from '@/modules/query/QueryCarRunModule/QueryCarRunVideoWindow.vue';\nimport MediaWindow from '@/common/alarm/MediaWindow';\nimport { initAlarm } from '@/common/cache/CacheAlarm.js';\nimport { getSgnIconUrl } from \"@/common/util/Urls.js\"; //  import md5 from 'js-md5'三环东路/大娄弄 苏E00855F 超速报警 超速预警 苏E00313F\\\n// 三环东路/开元大道 苏E09113F  苏EFN992 车道偏离报警\n\nexport default {\n  name: \"SmsReport\",\n  components: {\n    Split: Split,\n    InputDateTime: InputDateTime,\n    ButtonTime: ButtonTime,\n    QueryCarRunVideoWindow: QueryCarRunVideoWindow\n  },\n  data: function data() {\n    return {\n      sdate: getNowDate() + \" 00:00:00\",\n      edate: getNowDate() + \" 23:59:59\",\n      params: {\n        carIds: [],\n        typeIds: [],\n        pois: [],\n        startTime: getNowDate() + \" 00:00:00\",\n        endTime: getNowDate() + \" 23:59:59\",\n        sessionId: $_main.sessionId\n      },\n      pois: [],\n      srcs: null,\n      toolbarHeight: 48,\n      loading: false,\n      tableData: [],\n      list: [],\n      allList: [],\n      querying: false,\n      btnTxt: $_L.get('查询'),\n      disabled: false,\n      videoShow: true\n    };\n  },\n  watch: {\n    '$store.state.screenWidth': function $storeStateScreenWidth() {\n      this.setToolbarHeight();\n    },\n    videoShow: function videoShow(v) {\n      var _this = this;\n\n      this.$nextTick(function () {\n        return _this.$refs.tableDetail.refreshColumn();\n      });\n    }\n  },\n  updated: function updated() {\n    this.$nextTick(this.setToolbarHeight);\n  },\n  activated: function activated() {\n    this.setToolbarHeight();\n    this.$refs.table.resetResizable();\n  },\n  created: function created() {},\n  computed: {\n    carTree: function carTree() {\n      return _carTree;\n    },\n    exportToExcel: function exportToExcel() {\n      return _exportToExcel;\n    },\n    AlarmTree: function AlarmTree() {\n      return _AlarmTree;\n    },\n    poiTree: function poiTree() {\n      return PoiTree;\n    },\n    Labels: function Labels() {\n      return _Labels;\n    }\n  },\n  methods: {\n    getSgnIconUrl: getSgnIconUrl,\n    setToolbarHeight: function setToolbarHeight() {\n      var sheight = this.$refs.toolbar.$el.scrollWidth > this.$refs.toolbar.$el.clientWidth ? 17 : 0;\n      this.toolbarHeight = this.$refs.toolbar.$el.clientHeight + sheight;\n    },\n    getAlarmSrc: function getAlarmSrc(callback) {\n      var root = {\n        id: '0',\n        name: $_L.get('报警来源')\n      };\n      var children = arrayToTree(this.alarmArray, 'id', 'pid');\n      children.forEach(function (node) {\n        return node.parent = root;\n      });\n      root.children = children;\n      callback(root);\n    },\n    onSearch: function onSearch() {\n      var _this2 = this;\n\n      if (!this.params.carIds || this.params.carIds.length == 0) {\n        $_alert.warn($_L.get('请选择车辆！'), this.$el);\n        return;\n      }\n\n      if (!this.pois || this.pois.length == 0) {\n        $_alert.warn($_L.get('请选择标注！'), this.$el);\n        return;\n      }\n\n      var pois = this.pois || [],\n          poisList = [];\n      pois.forEach(function (el) {\n        if (getPois().map[el] && !('children' in getPois().map[el])) {\n          poisList.push(objClone(getPois().map[el], new Set(['parent'])));\n        }\n      });\n      this.params.pois = poisList;\n\n      if (!this.params.typeIds || this.params.typeIds.length == 0) {\n        $_alert.warn($_L.get('请选择报警类型！'), this.$el);\n        return;\n      }\n\n      if (this.params.startTime > this.params.endTime) return $_alert.warn($_L.get('开始日期不能大于结束日期！'), this.$el);\n\n      if (apartDays(this.params.startTime, this.params.endTime) > 31) {\n        $_alert.warn($_L.get('日期间隔不能超过31天！'), this.$el);\n        return;\n      }\n\n      this.disabled = true;\n      this.tableData = [];\n      this.list = [];\n\n      if (!this.srcs) {\n        this.params.srcs = ['1', '2', '3', '9', '8'];\n      } else {\n        this.params.srcs = this.srcs;\n      }\n\n      $_http.postxhyc('query/alarm', this.params).then(function (res) {\n        _this2.disabled = false;\n\n        if (res && res.result && res.result.length > 0) {\n          _this2.tableData = res.result;\n          _this2.allList = [];\n\n          _this2.tableData.map(function (item) {\n            _this2.allList = _this2.allList.concat(item.alarm);\n          });\n        } else {\n          $_alert.warn($_L.get('暂无数据'));\n        }\n      }); // this.list=[];\n      // let params=[]\n      // var dateData=splitDate(this.params.startTime,this.params.endTime)\n      // for (let i = 0; i < dateData.length; i++) {\n      //     params.push(Object.assign({carIds: this.params.carIds, startTime:dateData[i].sdate,endTime:dateData[i].edate}))\n      // }\n      // this.querying = true;\n      // this.toQuery(params);\n    },\n    toQuery: function toQuery(params) {\n      var _this3 = this;\n\n      var index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      this.btnTxt = parseInt(index * 100 / params.length) + '%';\n      $_http.postxhyc(\"query/alarm\", params[index]).then(function (result) {\n        if (_this3.querying) {\n          if (result) {\n            _this3.list = _this3.list.concat(JSON.parse(JSON.stringify(result)));\n          }\n\n          ++index < params.length ? _this3.toQuery(params, index) : _this3.toFinish();\n        }\n      });\n    },\n    toFinish: function toFinish() {\n      this.querying = false;\n      this.btnTxt = $_L.get(\"查询\");\n      this.list.length == 0 && $_alert.warn($_L.get('暂无数据'));\n    },\n    onTableClick: function onTableClick(_ref) {\n      var row = _ref.row;\n      this.list = row.alarm;\n    },\n    // onItemSelected({row}){\n    //   console.log(Labels.carExtByCarId(row))\n    // },\n    exportEvent: function exportEvent() {\n      if (this.tableData && this.tableData.length > 0) {\n        this.$refs.table.exportData({\n          filename: '标注下查报警统计',\n          type: 'csv',\n          isHeader: true,\n          isFooter: true,\n          data: this.tableData\n        });\n      } else {\n        $_alert.warn($_L.get('暂无数据'));\n      }\n    },\n    exportEventDetail: function exportEventDetail() {\n      if (this.list && this.list.length > 0) {\n        this.$refs.tableDetail.exportData({\n          filename: '标注下查报警明细',\n          type: 'csv',\n          isHeader: true,\n          isFooter: true,\n          data: this.list\n        });\n      } else {\n        $_alert.warn($_L.get('暂无数据'));\n      }\n    },\n    exportEventAllDetail: function exportEventAllDetail() {\n      var _this4 = this;\n\n      if (this.allList && this.allList.length > 0) {\n        this.$nextTick(function () {\n          _this4.$refs.tableAllDetail.exportData({\n            filename: '标注下查所有报警明细',\n            type: 'csv',\n            isHeader: true,\n            isFooter: true,\n            data: _this4.allList\n          });\n        });\n      } else {\n        $_alert.warn($_L.get('暂无数据'));\n      }\n    },\n    onAlarmTreeCheck: function onAlarmTreeCheck(node, ns) {\n      arrayRemoveFilter(ns, function (item) {\n        return !!item.children;\n      });\n    },\n    stateFormatter: function stateFormatter(_ref2) {\n      var cellValue = _ref2.cellValue;\n\n      switch (cellValue) {\n        case '0':\n          return $_L.get('未处理');\n\n        case '1':\n          return $_L.get('处理');\n\n        case '2':\n          return $_L.get('忽略');\n\n        case '3':\n          return $_L.get('误报');\n\n        default:\n          break;\n      }\n    },\n    typeFormatter: function typeFormatter(_ref3) {\n      var cellValue = _ref3.cellValue;\n      return cellValue ? getFavAlarmType().map[cellValue].name : '';\n    },\n    viewTrack: function viewTrack(item) {\n      import('@/modules/mnt/MntTrackModuleForSkip.vue').then(function (component) {\n        $_popup.open(component.default, {\n          title: $_L.get('车辆行车轨迹') + ' -> ' + item.plate,\n          carId: item.carId,\n          stime: item.stime,\n          etime: item.etime,\n          plate: item.plate\n        });\n      });\n    },\n    viewVideo: function viewVideo(item) {\n      $_popup.open(QueryCarRunVideoWindow, {\n        carId: item.carId,\n        stime: item.stime,\n        etime: item.etime\n      });\n    },\n    viewMediaClick: function viewMediaClick(row) {\n      var alarm = row;\n      alarm.typeIds = this.params.typeIds;\n      $_popup.open(MediaWindow, {\n        alarm: alarm\n      });\n    }\n  }\n};",{"version":3,"sources":["RptGpsTrack.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuGA,OAAA,KAAA,MAAA,wBAAA;AACA,OAAA,QAAA,MAAA,2BAAA;AACA,OAAA,aAAA,MAAA,gCAAA;AACA,OAAA,UAAA,MAAA,6BAAA;AACA,OAAA,UAAA,MAAA,6BAAA;AACA,OAAA,OAAA,MAAA,2BAAA;AACA,SAAA,UAAA,EAAA,SAAA,EAAA,SAAA,QAAA,wBAAA;AACA,SAAA,aAAA,IAAA,cAAA,QAAA,uBAAA;AACA,SAAA,QAAA,QAAA,0BAAA;AACA,SAAA,OAAA,QAAA,4BAAA;AACA,SAAA,eAAA,QAAA,8BAAA;AACA,SAAA,iBAAA,EAAA,gBAAA,QAAA,yBAAA;AACA,SAAA,WAAA,QAAA,wBAAA;AACA,OAAA,OAAA,MAAA,wBAAA;AACA,SAAA,eAAA,QAAA,0BAAA;AACA,OAAA,sBAAA,MAAA,8DAAA;AACA,OAAA,WAAA,MAAA,4BAAA;AACA,SAAA,SAAA,QAAA,8BAAA;AACA,SAAA,aAAA,QAAA,uBAAA,C,CAEA;AAEA;;AAKA,eAAA;AACA,EAAA,IAAA,EAAA,WADA;AAEA,EAAA,UAAA,EAAA;AAAA,IAAA,KAAA,EAAA,KAAA;AAAA,IAAA,aAAA,EAAA,aAAA;AAAA,IAAA,UAAA,EAAA,UAAA;AAAA,IAAA,sBAAA,EAAA;AAAA,GAFA;AAGA,EAAA,IAHA,kBAGA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,UAAA,KAAA,WADA;AAEA,MAAA,KAAA,EAAA,UAAA,KAAA,WAFA;AAGA,MAAA,MAAA,EAAA;AAAA,QAAA,MAAA,EAAA,EAAA;AAAA,QAAA,OAAA,EAAA,EAAA;AAAA,QAAA,IAAA,EAAA,EAAA;AAAA,QAAA,SAAA,EAAA,UAAA,KAAA,WAAA;AAAA,QAAA,OAAA,EAAA,UAAA,KAAA,WAAA;AAAA,QAAA,SAAA,EAAA,MAAA,CAAA;AAAA,OAHA;AAIA,MAAA,IAAA,EAAA,EAJA;AAKA,MAAA,IAAA,EAAA,IALA;AAMA,MAAA,aAAA,EAAA,EANA;AAOA,MAAA,OAAA,EAAA,KAPA;AAQA,MAAA,SAAA,EAAA,EARA;AASA,MAAA,IAAA,EAAA,EATA;AAUA,MAAA,OAAA,EAAA,EAVA;AAWA,MAAA,QAAA,EAAA,KAXA;AAYA,MAAA,MAAA,EAAA,GAAA,CAAA,GAAA,CAAA,IAAA,CAZA;AAaA,MAAA,QAAA,EAAA,KAbA;AAcA,MAAA,SAAA,EAAA;AAdA,KAAA;AAgBA,GApBA;AAqBA,EAAA,KAAA,EAAA;AACA,gCAAA,kCAAA;AACA,WAAA,gBAAA;AACA,KAHA;AAIA,IAAA,SAAA,EAAA,mBAAA,CAAA,EAAA;AAAA;;AACA,WAAA,SAAA,CAAA;AAAA,eAAA,KAAA,CAAA,KAAA,CAAA,WAAA,CAAA,aAAA,EAAA;AAAA,OAAA;AACA;AANA,GArBA;AA6BA,EAAA,OA7BA,qBA6BA;AACA,SAAA,SAAA,CAAA,KAAA,gBAAA;AACA,GA/BA;AAgCA,EAAA,SAAA,EAAA,qBAAA;AACA,SAAA,gBAAA;AACA,SAAA,KAAA,CAAA,KAAA,CAAA,cAAA;AACA,GAnCA;AAoCA,EAAA,OApCA,qBAoCA,CACA,CArCA;AAsCA,EAAA,QAAA,EAAA;AACA,IAAA,OAAA,EAAA;AAAA,aAAA,QAAA;AAAA,KADA;AAEA,IAAA,aAAA,EAAA;AAAA,aAAA,cAAA;AAAA,KAFA;AAGA,IAAA,SAAA,EAAA;AAAA,aAAA,UAAA;AAAA,KAHA;AAIA,IAAA,OAAA,EAAA;AAAA,aAAA,OAAA;AAAA,KAJA;AAKA,IAAA,MAAA,EAAA;AAAA,aAAA,OAAA;AAAA;AALA,GAtCA;AA6CA,EAAA,OAAA,EAAA;AACA,IAAA,aAAA,EAAA,aADA;AAEA,IAAA,gBAFA,8BAEA;AACA,UAAA,OAAA,GAAA,KAAA,KAAA,CAAA,OAAA,CAAA,GAAA,CAAA,WAAA,GAAA,KAAA,KAAA,CAAA,OAAA,CAAA,GAAA,CAAA,WAAA,GAAA,EAAA,GAAA,CAAA;AACA,WAAA,aAAA,GAAA,KAAA,KAAA,CAAA,OAAA,CAAA,GAAA,CAAA,YAAA,GAAA,OAAA;AACA,KALA;AAMA,IAAA,WANA,uBAMA,QANA,EAMA;AACA,UAAA,IAAA,GAAA;AAAA,QAAA,EAAA,EAAA,GAAA;AAAA,QAAA,IAAA,EAAA,GAAA,CAAA,GAAA,CAAA,MAAA;AAAA,OAAA;AACA,UAAA,QAAA,GAAA,WAAA,CAAA,KAAA,UAAA,EAAA,IAAA,EAAA,KAAA,CAAA;AACA,MAAA,QAAA,CAAA,OAAA,CAAA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,MAAA,GAAA,IAAA;AAAA,OAAA;AACA,MAAA,IAAA,CAAA,QAAA,GAAA,QAAA;AACA,MAAA,QAAA,CAAA,IAAA,CAAA;AACA,KAZA;AAaA,IAAA,QAbA,sBAaA;AAAA;;AACA,UAAA,CAAA,KAAA,MAAA,CAAA,MAAA,IAAA,KAAA,MAAA,CAAA,MAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,QAAA,CAAA,EAAA,KAAA,GAAA;AACA;AACA;;AACA,UAAA,CAAA,KAAA,IAAA,IAAA,KAAA,IAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,QAAA,CAAA,EAAA,KAAA,GAAA;AACA;AACA;;AACA,UAAA,IAAA,GAAA,KAAA,IAAA,IAAA,EAAA;AAAA,UAAA,QAAA,GAAA,EAAA;AACA,MAAA,IAAA,CAAA,OAAA,CAAA,UAAA,EAAA,EAAA;AAAA,YAAA,OAAA,GAAA,GAAA,CAAA,EAAA,KAAA,EAAA,cAAA,OAAA,GAAA,GAAA,CAAA,EAAA,CAAA,CAAA,EAAA;AAAA,UAAA,QAAA,CAAA,IAAA,CAAA,QAAA,CAAA,OAAA,GAAA,GAAA,CAAA,EAAA,CAAA,EAAA,IAAA,GAAA,CAAA,CAAA,QAAA,CAAA,CAAA,CAAA;AAAA;AAAA,OAAA;AACA,WAAA,MAAA,CAAA,IAAA,GAAA,QAAA;;AACA,UAAA,CAAA,KAAA,MAAA,CAAA,OAAA,IAAA,KAAA,MAAA,CAAA,OAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,UAAA,CAAA,EAAA,KAAA,GAAA;AACA;AACA;;AACA,UAAA,KAAA,MAAA,CAAA,SAAA,GAAA,KAAA,MAAA,CAAA,OAAA,EAAA,OAAA,OAAA,CAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,eAAA,CAAA,EAAA,KAAA,GAAA,CAAA;;AACA,UAAA,SAAA,CAAA,KAAA,MAAA,CAAA,SAAA,EAAA,KAAA,MAAA,CAAA,OAAA,CAAA,GAAA,EAAA,EAAA;AACA,QAAA,OAAA,CAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,cAAA,CAAA,EAAA,KAAA,GAAA;AACA;AACA;;AACA,WAAA,QAAA,GAAA,IAAA;AACA,WAAA,SAAA,GAAA,EAAA;AACA,WAAA,IAAA,GAAA,EAAA;;AACA,UAAA,CAAA,KAAA,IAAA,EAAA;AACA,aAAA,MAAA,CAAA,IAAA,GAAA,CAAA,GAAA,EAAA,GAAA,EAAA,GAAA,EAAA,GAAA,EAAA,GAAA,CAAA;AACA,OAFA,MAEA;AACA,aAAA,MAAA,CAAA,IAAA,GAAA,KAAA,IAAA;AACA;;AACA,MAAA,MAAA,CAAA,QAAA,CAAA,aAAA,EAAA,KAAA,MAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,MAAA,CAAA,QAAA,GAAA,KAAA;;AACA,YAAA,GAAA,IAAA,GAAA,CAAA,MAAA,IAAA,GAAA,CAAA,MAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,GAAA,CAAA,MAAA;AACA,UAAA,MAAA,CAAA,OAAA,GAAA,EAAA;;AACA,UAAA,MAAA,CAAA,SAAA,CAAA,GAAA,CAAA,UAAA,IAAA,EAAA;AACA,YAAA,MAAA,CAAA,OAAA,GAAA,MAAA,CAAA,OAAA,CAAA,MAAA,CAAA,IAAA,CAAA,KAAA,CAAA;AACA,WAFA;AAGA,SANA,MAMA;AACA,UAAA,OAAA,CAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,MAAA,CAAA;AACA;AACA,OAXA,EA7BA,CAyCA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA/DA;AAgEA,IAAA,OAhEA,mBAgEA,MAhEA,EAgEA;AAAA;;AAAA,UAAA,KAAA,uEAAA,CAAA;AACA,WAAA,MAAA,GAAA,QAAA,CAAA,KAAA,GAAA,GAAA,GAAA,MAAA,CAAA,MAAA,CAAA,GAAA,GAAA;AACA,MAAA,MAAA,CAAA,QAAA,CAAA,aAAA,EAAA,MAAA,CAAA,KAAA,CAAA,EAAA,IAAA,CAAA,UAAA,MAAA,EAAA;AACA,YAAA,MAAA,CAAA,QAAA,EAAA;AACA,cAAA,MAAA,EAAA;AACA,YAAA,MAAA,CAAA,IAAA,GAAA,MAAA,CAAA,IAAA,CAAA,MAAA,CAAA,IAAA,CAAA,KAAA,CAAA,IAAA,CAAA,SAAA,CAAA,MAAA,CAAA,CAAA,CAAA;AACA;;AACA,YAAA,KAAA,GAAA,MAAA,CAAA,MAAA,GAAA,MAAA,CAAA,OAAA,CAAA,MAAA,EAAA,KAAA,CAAA,GAAA,MAAA,CAAA,QAAA,EAAA;AACA;AACA,OAPA;AAQA,KA1EA;AA2EA,IAAA,QA3EA,sBA2EA;AACA,WAAA,QAAA,GAAA,KAAA;AACA,WAAA,MAAA,GAAA,GAAA,CAAA,GAAA,CAAA,IAAA,CAAA;AACA,WAAA,IAAA,CAAA,MAAA,IAAA,CAAA,IAAA,OAAA,CAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,MAAA,CAAA,CAAA;AACA,KA/EA;AAgFA,IAAA,YAhFA,8BAgFA;AAAA,UAAA,GAAA,QAAA,GAAA;AACA,WAAA,IAAA,GAAA,GAAA,CAAA,KAAA;AACA,KAlFA;AAmFA;AACA;AACA;AACA,IAAA,WAtFA,yBAsFA;AACA,UAAA,KAAA,SAAA,IAAA,KAAA,SAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,aAAA,KAAA,CAAA,KAAA,CAAA,UAAA,CAAA;AACA,UAAA,QAAA,EAAA,UADA;AAEA,UAAA,IAAA,EAAA,KAFA;AAGA,UAAA,QAAA,EAAA,IAHA;AAIA,UAAA,QAAA,EAAA,IAJA;AAKA,UAAA,IAAA,EAAA,KAAA;AALA,SAAA;AAOA,OARA,MAQA;AACA,QAAA,OAAA,CAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,MAAA,CAAA;AACA;AACA,KAlGA;AAmGA,IAAA,iBAnGA,+BAmGA;AACA,UAAA,KAAA,IAAA,IAAA,KAAA,IAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,aAAA,KAAA,CAAA,WAAA,CAAA,UAAA,CAAA;AACA,UAAA,QAAA,EAAA,UADA;AAEA,UAAA,IAAA,EAAA,KAFA;AAGA,UAAA,QAAA,EAAA,IAHA;AAIA,UAAA,QAAA,EAAA,IAJA;AAKA,UAAA,IAAA,EAAA,KAAA;AALA,SAAA;AAOA,OARA,MAQA;AACA,QAAA,OAAA,CAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,MAAA,CAAA;AACA;AACA,KA/GA;AAgHA,IAAA,oBAhHA,kCAgHA;AAAA;;AAEA,UAAA,KAAA,OAAA,IAAA,KAAA,OAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,aAAA,SAAA,CAAA,YAAA;AACA,UAAA,MAAA,CAAA,KAAA,CAAA,cAAA,CAAA,UAAA,CAAA;AACA,YAAA,QAAA,EAAA,YADA;AAEA,YAAA,IAAA,EAAA,KAFA;AAGA,YAAA,QAAA,EAAA,IAHA;AAIA,YAAA,QAAA,EAAA,IAJA;AAKA,YAAA,IAAA,EAAA,MAAA,CAAA;AALA,WAAA;AAOA,SARA;AASA,OAVA,MAUA;AACA,QAAA,OAAA,CAAA,IAAA,CAAA,GAAA,CAAA,GAAA,CAAA,MAAA,CAAA;AACA;AACA,KA/HA;AAgIA,IAAA,gBAhIA,4BAgIA,IAhIA,EAgIA,EAhIA,EAgIA;AACA,MAAA,iBAAA,CAAA,EAAA,EAAA,UAAA,IAAA;AAAA,eAAA,CAAA,CAAA,IAAA,CAAA,QAAA;AAAA,OAAA,CAAA;AACA,KAlIA;AAmIA,IAAA,cAnIA,iCAmIA;AAAA,UAAA,SAAA,SAAA,SAAA;;AACA,cAAA,SAAA;AACA,aAAA,GAAA;AACA,iBAAA,GAAA,CAAA,GAAA,CAAA,KAAA,CAAA;;AACA,aAAA,GAAA;AACA,iBAAA,GAAA,CAAA,GAAA,CAAA,IAAA,CAAA;;AACA,aAAA,GAAA;AACA,iBAAA,GAAA,CAAA,GAAA,CAAA,IAAA,CAAA;;AACA,aAAA,GAAA;AACA,iBAAA,GAAA,CAAA,GAAA,CAAA,IAAA,CAAA;;AACA;AACA;AAVA;AAYA,KAhJA;AAiJA,IAAA,aAjJA,gCAiJA;AAAA,UAAA,SAAA,SAAA,SAAA;AACA,aAAA,SAAA,GAAA,eAAA,GAAA,GAAA,CAAA,SAAA,EAAA,IAAA,GAAA,EAAA;AACA,KAnJA;AAoJA,IAAA,SApJA,qBAoJA,IApJA,EAoJA;AACA,aAAA,yCAAA,EAAA,IAAA,CAAA,UAAA,SAAA,EAAA;AACA,QAAA,OAAA,CAAA,IAAA,CAAA,SAAA,CAAA,OAAA,EAAA;AACA,UAAA,KAAA,EAAA,GAAA,CAAA,GAAA,CAAA,QAAA,IAAA,MAAA,GAAA,IAAA,CAAA,KADA;AAEA,UAAA,KAAA,EAAA,IAAA,CAAA,KAFA;AAGA,UAAA,KAAA,EAAA,IAAA,CAAA,KAHA;AAIA,UAAA,KAAA,EAAA,IAAA,CAAA,KAJA;AAKA,UAAA,KAAA,EAAA,IAAA,CAAA;AALA,SAAA;AAOA,OARA;AASA,KA9JA;AA+JA,IAAA,SA/JA,qBA+JA,IA/JA,EA+JA;AACA,MAAA,OAAA,CAAA,IAAA,CAAA,sBAAA,EAAA;AACA,QAAA,KAAA,EAAA,IAAA,CAAA,KADA;AAEA,QAAA,KAAA,EAAA,IAAA,CAAA,KAFA;AAGA,QAAA,KAAA,EAAA,IAAA,CAAA;AAHA,OAAA;AAKA,KArKA;AAsKA,IAAA,cAtKA,0BAsKA,GAtKA,EAsKA;AACA,UAAA,KAAA,GAAA,GAAA;AACA,MAAA,KAAA,CAAA,OAAA,GAAA,KAAA,MAAA,CAAA,OAAA;AAEA,MAAA,OAAA,CAAA,IAAA,CAAA,WAAA,EAAA;AAAA,QAAA,KAAA,EAAA;AAAA,OAAA;AACA;AA3KA;AA7CA,CAAA","sourcesContent":["<template>\r\n  <div>\r\n   <div :class=\"$style.header\">\r\n    <!--工具栏-->\r\n    <Toolbar ref=\"toolbar\">\r\n      <div style=\"width:280px\">\r\n        <InputTree :label=\"$_L.get('选择车辆')\" v-model=\"params.carIds\" :tree=\"carTree\" searchable clearable hasOwnField=\"plate\" :treeHeight='9999' :class=\"$style.inputBox\"/>\r\n        <InputTree :label=\"$_L.get('选择标注')\" :tree=\"poiTree\" v-model=\"pois\" clearable :class=\"$style.inputBox\" ref=\"pois\"/>\r\n      </div>  \r\n      <div style=\"width:280px\">\r\n        <InputTree :label=\"$_L.get('报警类型')\" v-model=\"params.typeIds\" :tree=\"AlarmTree\" :placeholder=\"$_L.get('默认全部')\" clearable :treeHeight=\"500\" :setting=\"{callback:{onCheck:onAlarmTreeCheck}}\"  :class=\"$style.inputBox\"/>\r\n          <InputSelect :label=\"$_L.get('报警来源')\" v-model=\"srcs\" :placeholder=\"$_L.get('默认全部')\" :options=\"[{value:'1',label:$_L.get('终端')},{value:'2',label:$_L.get('平台')},{value:'3',label:$_L.get('政府')},{value:'9',label:$_L.get('其它')},{value:'8',label:$_L.get('下级企业平台')}]\" checkbox clearable :class=\"$style.inputBox\" />\r\n      </div>\r\n      <QuickTime type=\"YMDHNS\" @set=\"(s,e)=>{params.startTime=s;params.endTime=e}\" :height=\"63\" style=\"margin-right:-9px\"/>  \r\n      <div style=\"width:280px\">\r\n        <InputDateTime  :label=\"$_L.get('开始时间')\"        v-model=\"params.startTime\" :class=\"$style.inputBox\"  type=\"YMDHNS\" clearable/>\r\n        <InputDateTime  :label=\"$_L.get('结束时间')\"        v-model=\"params.endTime\" :class=\"$style.inputBox\"  type=\"YMDHNS\"   clearable/>\r\n      </div>\r\n      <Button type=\"primary\" :icon=\"querying?'el-icon-close':'el-icon-search'\" style=\"height:63px;\" @click=\"querying?toFinish():onSearch()\" :disabled=\"disabled\" >{{btnTxt}}</Button>\r\n      <div slot=\"right\">\r\n        <Button radius=\"3px\" type=\"primary\" icon=\"el-icon-download\" ref=\"detailBtn\" :height=\"29\" @click=\"exportEvent\" style=\"display: inline-block;margin-bottom:5px;\">{{$_L.get('统计')}}</Button>\r\n        <Button radius=\"3px\" type=\"primary\" icon=\"el-icon-download\" ref=\"detailBtn\" :height=\"29\" @click=\"exportEventDetail\" style=\"display: inline-block;margin-left:5px\">{{$_L.get('明细')}}</Button>\r\n        <Button radius=\"3px\" type=\"primary\" icon=\"el-icon-download\" ref=\"detailBtn\" :height=\"29\" @click=\"exportEventAllDetail\" style=\"display: block;width:134px\">{{$_L.get('所有明细')}}</Button>\r\n      </div>\r\n    </Toolbar>\r\n\r\n    <!--表格-->\r\n    <div style=\"height:100%;position:relative;flex:1;border:1px solid;\" :style=\"{borderColor:theme.border_color_dark,height:`calc(50% - ${toolbarHeight/2}px)`}\">\r\n      <vxe-table  height=\"auto\" :data=\"tableData\" :class=\"$style.grid\" :style=\"{borderColor:theme.border_color_dark}\" ref=\"table\" id='table-content' @cell-click=\"onTableClick\">\r\n\t\t\t  <vxe-table-column type=\"checkbox\"  width=\"60\"/>\r\n\t\t\t  <vxe-table-column type=\"index\" :title=\"$_L.get('序号')\" width=\"60\"/>\r\n            <vxe-table-column field=\"poiName\" :title=\"$_L.get('标注名称')\" />\r\n            <vxe-table-column field=\"poiLng\" :title=\"$_L.get('标注经度')\"/>\r\n            <vxe-table-column field=\"poiLat\" :title=\"$_L.get('标注纬度')\"/>\r\n            <vxe-table-column field=\"alarmNum\" :title=\"$_L.get('报警个数')\"/>\r\n      </vxe-table>\r\n    </div>\r\n    <div style=\"flex:1;height:100%;position:relative;border:1px solid;\" :style=\"{borderColor:theme.border_color_dark,height:`calc(50% - ${toolbarHeight/2}px)`}\">\r\n      <vxe-table  height=\"auto\" :data=\"list\" :class=\"$style.grid\" :style=\"{borderColor:theme.border_color_dark}\" ref=\"tableDetail\" id='table-content'>\r\n\t\t\t  <vxe-table-column type=\"checkbox\"  width=\"60\"/>\r\n\t\t\t  <vxe-table-column type=\"index\" :title=\"$_L.get('序号')\" width=\"60\"/>\r\n              <vxe-table-column field=\"poiName\" :title=\"$_L.get('标注名称')\" />\r\n              <vxe-table-column field=\"plate\" :title=\"$_L.get('车牌号')\"/>\r\n              <vxe-table-column field=\"companyName\" :title=\"$_L.get('车队名称')\"/>\r\n              <vxe-table-column field=\"addr\" :title=\"$_L.get('地址')\"/>\r\n              <!-- <vxe-table-column field=\"adjunct\" :title=\"$_L.get('接收数/附件数')\" :formater=\"({row})=>{adjunctFunction(row)}\">\r\n                <template v-slot:name_adjunct=\"{ row, column }\">\r\n                  <span @click=\"viewMediaClick(row,column)\" style=\"text-decoration: underline;cursor: pointer;\" :style=\"{color: theme.color}\">{{123+AlarmLabels.adjunctFunction(row)}}</span>\r\n                </template>\r\n              </vxe-table-column> -->\r\n              <vxe-table-column field=\"\" :title=\"$_L.get('接收数/附件数')\">\r\n                <template v-slot=\"{ row, column }\">\r\n                  <span @click=\"viewMediaClick(row,column)\" style=\"text-decoration: underline;cursor: pointer;\">{{row.allfjNum+'/'+row.fjsok}}</span>\r\n                </template>\r\n              </vxe-table-column>\r\n              <vxe-table-column field=\"\" :title=\"$_L.get('轨迹')\" width=\"70px\">\r\n                <template v-slot=\"{ row }\">\r\n                  <Button type=\"light\" :height=\"24\" @click=\"viewTrack(row)\" style=\"font-size:12px\">{{$_L.get('查看')}}</Button>\r\n                </template>\r\n              </vxe-table-column>\r\n              <vxe-table-column field=\"\" :title=\"$_L.get('录像回放')\" width=\"70px\" :visible=\"videoShow\">\r\n                <template v-slot=\"{ row }\">\r\n                  <Button type=\"light\" :height=\"24\" @click=\"viewVideo(row)\" style=\"font-size:12px\" :disabled=\"row.accState=='0'\">{{$_L.get('回放')}}</Button>\r\n                  <img :src=\"getSgnIconUrl(row.accState=='1'?'c31-1':'c31-0')\" style=\"vertical-align: middle;position: absolute;top: 8px;right: 0px;\" :title=\"$_L.get(row.accState=='1'?'当前ACC开':'当前ACC关')\"/>\r\n                </template>\r\n              </vxe-table-column>\r\n              <vxe-table-column field=\"stime\" :title=\"$_L.get('开始时间')\"/>\r\n              <vxe-table-column field=\"etime\" :title=\"$_L.get('结束时间')\"/>\r\n              <vxe-table-column field=\"lng\" :title=\"$_L.get('经度')\"/>\r\n              <vxe-table-column field=\"lat\" :title=\"$_L.get('纬度')\"/>\r\n              <vxe-table-column field=\"speed\" :title=\"$_L.get('速度(km/h)')\"/>\r\n              <vxe-table-column field=\"alarmType\" :title=\"$_L.get('报警类型')\" :formatter=\"typeFormatter\"/>\r\n              <vxe-table-column field=\"solveState\" :title=\"$_L.get('报警处理状态')\" :formatter=\"stateFormatter\"/>\r\n              <vxe-table-column field=\"solveTime\" :title=\"$_L.get('报警处理时间')\"/>\r\n              <vxe-table-column field=\"solveDes\" :title=\"$_L.get('报警处理描述')\"/>\r\n              <vxe-table-column field=\"solveUser\" :title=\"$_L.get('报警处理人')\"/>\r\n      </vxe-table>\r\n    </div>\r\n    <div style=\"flex-shrink:1;height:100%;position:relative;border:1px solid;\" :style=\"{borderColor:theme.border_color_dark}\" v-show=\"false\">\r\n      <vxe-table  height=\"auto\" :data=\"allList\" :class=\"$style.grid\" :style=\"{borderColor:theme.border_color_dark}\" ref=\"tableAllDetail\" id='table-content'>\r\n\t\t\t  <vxe-table-column type=\"checkbox\"  width=\"60\"/>\r\n\t\t\t  <vxe-table-column type=\"index\" :title=\"$_L.get('序号')\" width=\"60\"/>\r\n              <vxe-table-column field=\"poiName\" :title=\"$_L.get('标注名称')\" />\r\n              <vxe-table-column field=\"plate\" :title=\"$_L.get('车牌号')\"/>\r\n              <vxe-table-column field=\"companyName\" :title=\"$_L.get('车队名称')\"/>\r\n              <vxe-table-column field=\"addr\" :title=\"$_L.get('地址')\"/>\r\n              <vxe-table-column field=\"stime\" :title=\"$_L.get('开始时间')\"/>\r\n              <vxe-table-column field=\"etime\" :title=\"$_L.get('结束时间')\"/>\r\n              <vxe-table-column field=\"lng\" :title=\"$_L.get('经度')\"/>\r\n              <vxe-table-column field=\"lat\" :title=\"$_L.get('纬度')\"/>\r\n              <vxe-table-column field=\"speed\" :title=\"$_L.get('速度(km/h)')\"/>\r\n              <vxe-table-column field=\"alarmType\" :title=\"$_L.get('报警类型')\" :formatter=\"typeFormatter\"/>\r\n              <vxe-table-column field=\"solveState\" :title=\"$_L.get('报警处理状态')\" :formatter=\"stateFormatter\"/>\r\n              <vxe-table-column field=\"solveTime\" :title=\"$_L.get('报警处理时间')\"/>\r\n              <vxe-table-column field=\"solveDes\" :title=\"$_L.get('报警处理描述')\"/>\r\n              <vxe-table-column field=\"solveUser\" :title=\"$_L.get('报警处理人')\"/>\r\n      </vxe-table>\r\n    </div>\r\n   </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Split                                    from '@/components/Split.vue';\r\nimport carTree                                  from '@/common/tree/CarTree.vue';\r\nimport InputDateTime                            from '@/components/InputDateTime.vue';\r\nimport ButtonTime                               from '@/components/ButtonTime.vue';\r\nimport AlarmTree                                from '@/common/tree/AlarmTree.vue';\r\nimport PoiTree                                  from '@/common/tree/PoiTree.vue';\r\nimport { getNowDate ,splitDate,apartDays}       from '@/common/util/Dates.js';\r\nimport { exportToExcel }                        from \"@/common/util/Exps.js\";\r\nimport { objClone }                             from \"@/common/util/Objects.js\";\r\nimport { getPois}                               from '@/common/cache/CachePoi.js';\r\nimport { getFavAlarmType}                       from '@/common/cache/CacheAlarm.js';\r\nimport { arrayRemoveFilter,arrayRemoveValue }   from '@/common/util/Arrays.js';\r\nimport { arrayToTree }                          from '@/common/util/Trees.js';\r\nimport Labels                                   from '@/common/gps/Labels.js';\r\nimport {adjunctFunction}                        from '@/common/alarm/Labels.js';\r\nimport QueryCarRunVideoWindow                   from '@/modules/query/QueryCarRunModule/QueryCarRunVideoWindow.vue';\r\nimport MediaWindow                              from '@/common/alarm/MediaWindow'\r\nimport { initAlarm }                            from '@/common/cache/CacheAlarm.js';\r\nimport {getSgnIconUrl}                          from \"@/common/util/Urls.js\";\r\n  \r\n  //  import md5 from 'js-md5'三环东路/大娄弄 苏E00855F 超速报警 超速预警 苏E00313F\\\r\n\r\n  // 三环东路/开元大道 苏E09113F  苏EFN992 车道偏离报警\r\n\r\n\r\n\r\n\r\nexport default {\r\n  name: \"SmsReport\",\r\n  components: {Split,InputDateTime,ButtonTime,QueryCarRunVideoWindow},\r\n  data() {\r\n    return {\r\n        sdate: getNowDate() + \" 00:00:00\",\r\n        edate: getNowDate() + \" 23:59:59\",\r\n        params:{carIds:[],typeIds:[],pois:[],startTime:getNowDate() + \" 00:00:00\",endTime:getNowDate() + \" 23:59:59\",sessionId:$_main.sessionId},\r\n        pois:[],\r\n        srcs:null,\r\n        toolbarHeight: 48,\r\n        loading: false,\r\n        tableData:[],\r\n        list:[],\r\n        allList:[],\r\n        querying: false,\r\n        btnTxt: $_L.get('查询'),\r\n        disabled:false,\r\n        videoShow: true,\r\n    };\r\n  },\r\n    watch: {\r\n      '$store.state.screenWidth': function() {\r\n        this.setToolbarHeight();\r\n      },\r\n      videoShow: function(v) {\r\n        this.$nextTick(()=>this.$refs.tableDetail.refreshColumn());\r\n      },\r\n    },\r\n    updated() {\r\n      this.$nextTick(this.setToolbarHeight);\r\n    },\r\n    activated: function () {\r\n      this.setToolbarHeight();\r\n      this.$refs.table.resetResizable();\r\n    },\r\n    created(){\r\n    },\r\n    computed: {\r\n        carTree: () => carTree ,\r\n        exportToExcel: () => exportToExcel,\r\n        AlarmTree: () => AlarmTree,\r\n        poiTree: () => PoiTree,\r\n        Labels: () => Labels,\r\n    },\r\n    methods: {\r\n        getSgnIconUrl:getSgnIconUrl,\r\n        setToolbarHeight() {\r\n          let sheight = this.$refs.toolbar.$el.scrollWidth > this.$refs.toolbar.$el.clientWidth ? 17 : 0;\r\n          this.toolbarHeight = this.$refs.toolbar.$el.clientHeight + sheight;\r\n        },\r\n        getAlarmSrc(callback){\r\n          let root = {id:'0',name:$_L.get('报警来源')};\r\n          let children = arrayToTree(this.alarmArray,'id','pid')\r\n          children.forEach(node => node.parent = root);\r\n          root.children=children\r\n          callback(root);\r\n        },\r\n        onSearch(){\r\n          if(!this.params.carIds||this.params.carIds.length==0){\r\n            $_alert.warn($_L.get('请选择车辆！'), this.$el);\r\n            return;\r\n          }\r\n          if(!this.pois||this.pois.length==0){\r\n            $_alert.warn($_L.get('请选择标注！'), this.$el);\r\n            return;\r\n          }\r\n          let pois = this.pois||[],poisList=[];\r\n          pois.forEach(el => {if(getPois().map[el]&&!('children' in getPois().map[el])){poisList.push(objClone(getPois().map[el],new Set(['parent'])))}});\r\n          this.params.pois=poisList\r\n          if(!this.params.typeIds||this.params.typeIds.length==0){\r\n            $_alert.warn($_L.get('请选择报警类型！'), this.$el);\r\n            return;\r\n          }\r\n          if (this.params.startTime > this.params.endTime)return $_alert.warn($_L.get('开始日期不能大于结束日期！'), this.$el);\r\n          if(apartDays(this.params.startTime,this.params.endTime)>31){\r\n            $_alert.warn($_L.get('日期间隔不能超过31天！'), this.$el);\r\n            return\r\n          }\r\n          this.disabled=true;\r\n          this.tableData=[];\r\n          this.list=[];\r\n          if(!this.srcs){\r\n            this.params.srcs=['1','2','3','9','8']\r\n          }else{\r\n            this.params.srcs=this.srcs\r\n          }\r\n          $_http.postxhyc('query/alarm',this.params).then(res=>{\r\n            this.disabled=false;\r\n            if(res&&res.result&&res.result.length>0){\r\n              this.tableData=res.result\r\n              this.allList=[]\r\n              this.tableData.map(item=>{\r\n                this.allList=this.allList.concat(item.alarm)\r\n              })\r\n            }else{\r\n              $_alert.warn($_L.get('暂无数据'))\r\n            }\r\n          })\r\n          // this.list=[];\r\n\r\n          // let params=[]\r\n          // var dateData=splitDate(this.params.startTime,this.params.endTime)\r\n          // for (let i = 0; i < dateData.length; i++) {\r\n          //     params.push(Object.assign({carIds: this.params.carIds, startTime:dateData[i].sdate,endTime:dateData[i].edate}))\r\n          // }\r\n          // this.querying = true;\r\n          // this.toQuery(params);\r\n        },\r\n      toQuery(params,index=0) {\r\n        this.btnTxt = parseInt(index * 100 / params.length) + '%';\r\n        $_http.postxhyc(\"query/alarm\", params[index]).then(result => {\r\n          if (this.querying) {\r\n              if(result){\r\n                this.list=this.list.concat(JSON.parse(JSON.stringify(result)))\r\n              }\r\n              (++index < params.length) ? this.toQuery(params, index): this.toFinish();\r\n          }\r\n        })\r\n      },\r\n      toFinish() {\r\n        this.querying = false;\r\n        this.btnTxt = $_L.get(\"查询\");\r\n        this.list.length==0&&$_alert.warn($_L.get('暂无数据'));\r\n      },\r\n      onTableClick({row}){\r\n        this.list=row.alarm;\r\n      },\r\n      // onItemSelected({row}){\r\n      //   console.log(Labels.carExtByCarId(row))\r\n      // },\r\n      exportEvent(){\r\n          if(this.tableData&&this.tableData.length>0){\r\n            this.$refs.table.exportData({\r\n                      filename: '标注下查报警统计',\r\n                      type: 'csv',\r\n                      isHeader: true,\r\n                      isFooter: true,\r\n                      data: this.tableData\r\n                    })\r\n          }else{\r\n            $_alert.warn($_L.get('暂无数据'))\r\n          }\r\n      },\r\n      exportEventDetail(){\r\n          if(this.list&&this.list.length>0){\r\n            this.$refs.tableDetail.exportData({\r\n                      filename: '标注下查报警明细',\r\n                      type: 'csv',\r\n                      isHeader: true,\r\n                      isFooter: true,\r\n                      data: this.list\r\n                    })\r\n          }else{\r\n            $_alert.warn($_L.get('暂无数据'))\r\n          }\r\n      },\r\n      exportEventAllDetail(){\r\n          \r\n          if(this.allList&&this.allList.length>0){\r\n            this.$nextTick(()=>{\r\n              this.$refs.tableAllDetail.exportData({\r\n                        filename: '标注下查所有报警明细',\r\n                        type: 'csv',\r\n                        isHeader: true,\r\n                        isFooter: true,\r\n                        data: this.allList\r\n                      })\r\n            })\r\n          }else{\r\n            $_alert.warn($_L.get('暂无数据'))\r\n          }\r\n      },\r\n      onAlarmTreeCheck(node,ns) {\r\n        arrayRemoveFilter(ns,item => !!item.children);\r\n      },\r\n      stateFormatter({cellValue}){\r\n        switch (cellValue) {\r\n          case '0':\r\n            return $_L.get('未处理')\r\n          case '1':\r\n            return $_L.get('处理')\r\n          case '2':\r\n            return $_L.get('忽略')\r\n          case '3':\r\n            return $_L.get('误报')\r\n          default:\r\n            break;\r\n        }\r\n      },\r\n      typeFormatter({cellValue}){\r\n        return cellValue?getFavAlarmType().map[cellValue].name:''\r\n      },  \r\n      viewTrack(item) {\r\n        import('@/modules/mnt/MntTrackModuleForSkip.vue').then(component => {\r\n          $_popup.open(component.default, {\r\n            title: $_L.get('车辆行车轨迹') + ' -> ' + item.plate,\r\n            carId: item.carId,\r\n            stime: item.stime,\r\n            etime: item.etime,\r\n            plate: item.plate\r\n          });\r\n        });\r\n      },\r\n      viewVideo(item) {\r\n        $_popup.open(QueryCarRunVideoWindow, {\r\n          carId: item.carId,\r\n          stime: item.stime,\r\n          etime: item.etime\r\n        });\r\n      },\r\n      viewMediaClick(row) {\r\n              let alarm=row\r\n              alarm.typeIds=this.params.typeIds\r\n\r\n              $_popup.open(MediaWindow,{alarm:alarm});\r\n      },\r\n    }\r\n};\r\n\r\n</script>\r\n\r\n<style module>\r\n  .header{\r\n      width: 100%;\r\n      height: 100%;\r\n      background-color: #fff;\r\n  }\r\n  .grid {\r\n      border-width: 1px;\r\n      border-style: solid;\r\n      height: 100%;\r\n      width: 100%;\r\n      position:absolute;left:0;top:0;right:0;bottom:0;border:1px solid;border-top:0;border-bottom:0;\r\n  }\r\n  .inputBox {\r\n      display: block;\r\n      /* width: 240px; */\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/modules"}]}