{"remainingRequest":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\cdRule\\src\\common\\tree\\CarGroupSetWindow.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\cdRule\\src\\common\\tree\\CarGroupSetWindow.vue","mtime":1677658521330},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getCarById, resetGroupTree } from '@/common/cache/CacheTeamCar.js';\nimport { arrayRemoveItem } from '@/common/util/Arrays.js';\nexport default {\n  components: {\n    CarTree: function CarTree() {\n      return import('@/common/tree/CarTree.vue'\n      /*webpackChunkName:'CarTree'*/\n      );\n    }\n  },\n  data: function data() {\n    return {\n      groups: [],\n      name: null,\n      waiting: false,\n      height: 0,\n      listable: false,\n      savable: false,\n      delable: false\n    };\n  },\n  created: function created() {\n    this.height = document.body.clientHeight * 5 / 6 - 100;\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    var groups = window.$_cache.userCfg.GROUP_CAR; //[name|carId,carId...]\n\n    groups && (groups = JSON.parse(groups));\n\n    if (groups) {\n      groups.forEach(function (str) {\n        str = str.split('|');\n\n        _this.groups.push({\n          name: str[0],\n          carIds: str[1].split(',')\n        });\n      });\n    }\n\n    this.listable = true;\n  },\n  methods: {\n    onGroupClick: function onGroupClick(item) {\n      this._group = item;\n      this.savable = this.delable = true;\n      this.name = item.name;\n      this.$refs.tree.getTree().checkAllNodes(false);\n\n      if (item.carIds.length > 0) {\n        var cars = [];\n        item.carIds.forEach(function (carId) {\n          var car = getCarById(carId);\n          car && cars.push(car);\n        });\n        cars.length && this.$refs.tree.checkNodes(cars, true, true, true);\n      }\n\n      this.refreshHide();\n    },\n    refreshHide: function refreshHide() {\n      var tree = this.$refs.tree.getTree();\n\n      for (var i = 0, len = this.groups.length, g; i < len; i++) {\n        g = this.groups[i];\n        g.carIds.forEach(function (carId) {\n          var car = getCarById(carId);\n          car && tree.updateNodeHide(car);\n        });\n      }\n    },\n    hideFunction: function hideFunction(node) {\n      if (!node.plate) return false;\n\n      for (var i = 0, len = this.groups.length, g; i < len; i++) {\n        g = this.groups[i];\n        if (g != this._group && g.carIds.indexOf(node.id) != -1) return true;\n      }\n\n      return false;\n    },\n    addClick: function addClick() {\n      this.savable = true;\n      this.delable = false;\n      this.listable = false;\n      this.$refs.list.selectedItem = this._group = null;\n      this.name = null;\n      this.$refs.tree.getTree().checkAllNodes(false);\n      this.refreshHide();\n    },\n    delClick: function delClick() {\n      var _this2 = this;\n\n      $_alert.comfirm($_L.get('确认要删除选中的车辆分组吗？'), function (yes) {\n        if (!yes) return;\n        var item = _this2.$refs.list.selectedItem,\n            items = [];\n\n        _this2.groups.forEach(function (group) {\n          return group != item && items.push(group.name + '|' + group.carIds.join(','));\n        });\n\n        items = JSON.stringify(items);\n        window.$_main.http.post('sys/user?updateUserCfg', {\n          item: 'GROUP_CAR',\n          value: items\n        }).then(function (result) {\n          $_alert.success($_L.get('删除成功'));\n          window.$_cache.userCfg.GROUP_CAR = items;\n          resetGroupTree();\n          arrayRemoveItem(_this2.groups, item);\n          _this2.savable = _this2.delable = false;\n          _this2.name = _this2._group = null;\n\n          _this2.$refs.tree.getTree().checkAllNodes(false);\n\n          _this2.refreshHide();\n        });\n      });\n    },\n    saveClick: function saveClick() {\n      var _this3 = this;\n\n      if (!this.name) return $_alert.warn($_L.get('请填写{0}', $_L.get('分组名称')), this.$el);\n      var carIds = this.$refs.tree.getCheckedNodes(false, false, 'id', 'plate');\n      if (!carIds || carIds.length == 0) return $_alert.warn($_L.get('请勾选车辆！'), this.$el);\n      if (carIds.length > 100) return $_alert.warn($_L.get('勾选的车辆数不能超过100个！'), this.$el);\n      var item = this.$refs.list.selectedItem,\n          items = [],\n          nameExist = false;\n      this.groups.forEach(function (group) {\n        group != item && (items.push(group.name + '|' + group.carIds.join(',')), nameExist = nameExist || group.name == _this3.name);\n      });\n      if (nameExist) return $_alert.warn($_L.get('存在相同的分组名称！'), this.$el);\n      items.push(this.name + '|' + carIds.join(','));\n      items = JSON.stringify(items);\n      var o = {\n        name: this.name,\n        carIds: carIds\n      };\n      window.$_main.http.post('sys/user?updateUserCfg', {\n        item: 'GROUP_CAR',\n        value: items\n      }).then(function (result) {\n        $_alert.success(item ? $_L.get('修改成功') : $_L.get('新增成功'));\n        window.$_cache.userCfg.GROUP_CAR = items;\n        resetGroupTree();\n        !item ? _this3.groups.push(o) : (item.name = o.name, item.carIds = o.carIds);\n        _this3.$refs.list.selectedItem = _this3._group = item || o;\n        _this3.savable = _this3.delable = _this3.listable = true;\n\n        _this3.refreshHide();\n      });\n    }\n  }\n};",{"version":3,"sources":["CarGroupSetWindow.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <Window :title=\"$_L.get('车辆分组管理')\" :width=\"600\" ref=\"w\" :waiting=\"waiting\">\r\n    <div :class=\"$style.content\" style=\"position:relative;\">\r\n      <Panel :title=\"$_L.get('车辆分组列表')\" :disabled=\"!listable\" style=\"width:200px;\" :style=\"[theme.panel, {height:height+'px',borderRadius:theme.popup_radius}]\">\r\n        <List ref=\"list\" :border=\"false\" :list=\"groups\" labelField=\"name\" @click=\"onGroupClick\" :style=\"{height:(height-79)+'px'}\" style=\"width:100%;background-color:#fff;\"/>\r\n        <Toolbar small :border=\"false\" :bgc=\"theme.bg_color\" style=\"position:absolute;bottom:0;left:0\">\r\n          <Button type=\"primary\" style=\"flex-grow:1\" icon=\"el-icon-plus\"  @click=\"addClick()\">{{$_L.get('新增')}}</Button>\r\n          <Button type=\"primary\" style=\"flex-grow:1\" icon=\"el-icon-minus\" @click=\"delClick()\" :disabled=\"!delable\">{{$_L.get('删除')}}</Button>\r\n        </Toolbar>\r\n      </Panel>\r\n      <Panel :title=\"$_L.get('车辆分组参数')\" :disabled=\"!savable\" style=\"width:385px;\" :style=\"[theme.panel, {height:height+'px',borderRadius:theme.popup_radius}]\">\r\n        <InputText :label=\"$_L.get('分组名称')\" trim v-model=\"name\" :reg=\"/\\|/g\" required style=\"margin:5px;width:calc(100% - 10px)\"/>\r\n        <CarTree ref=\"tree\" :border=\"false\" :setting=\"{favshow:false,favset:false,groupshow:false,groupset:false,check:{enable:true},view:{hideFunction:hideFunction}}\" style=\"margin:0 5px 5px 5px;width:calc(100% - 10px)\" :style=\"{height:(height-129)+'px'}\" :toolbarStyle=\"{borderBottom:0,backgroundColor:'#fff',padding:'1px 0',margin:'0 -5px', width:'calc(100% + 10px)'}\"/>\r\n        <Toolbar small :border=\"false\" :bgc=\"theme.bg_color\" :leftStyle=\"{justifyContent:'center'}\" style=\"position:absolute;bottom:0;left:0\">\r\n          <Button style=\"min-width:90px;\" v-if=\"!listable\" @click=\"listable=true\">{{$_L.get('取消')}}</Button>\r\n          <Button type=\"primary\" style=\"min-width:90px;\" @click=\"saveClick()\">{{$_L.get('保存')}}</Button>\r\n        </Toolbar>\r\n      </Panel>\r\n    </div>\r\n  </Window>\r\n</template>\r\n\r\n<script>\r\n  import { getCarById, resetGroupTree } from '@/common/cache/CacheTeamCar.js';\r\n  import { arrayRemoveItem } from '@/common/util/Arrays.js';\r\n\r\n  export default {\r\n    components: {\r\n      CarTree: () => import('@/common/tree/CarTree.vue' /*webpackChunkName:'CarTree'*/),\r\n    },\r\n    data: function() {\r\n      return {\r\n        groups: [],\r\n        name: null,\r\n        waiting: false,\r\n        height: 0,\r\n        listable: false,\r\n        savable: false,\r\n        delable: false,\r\n      };\r\n    },\r\n    created() {\r\n      this.height = document.body.clientHeight * 5 / 6 - 100;\r\n    },\r\n    mounted() {\r\n      let groups = window.$_cache.userCfg.GROUP_CAR;//[name|carId,carId...]\r\n      groups && (groups = JSON.parse(groups));\r\n      if (groups) {\r\n        groups.forEach(str=>{\r\n          str = str.split('|');\r\n          this.groups.push({name:str[0], carIds:str[1].split(',')});\r\n        });\r\n      }\r\n      this.listable = true;\r\n    },\r\n\r\n    methods: {\r\n      onGroupClick(item) {\r\n        this._group = item;\r\n        this.savable = this.delable = true;\r\n        this.name = item.name;\r\n        this.$refs.tree.getTree().checkAllNodes(false);\r\n        if (item.carIds.length > 0) {\r\n          let cars = [];\r\n          item.carIds.forEach(carId => {\r\n            let car = getCarById(carId);\r\n            car && cars.push(car);\r\n          });\r\n          cars.length && this.$refs.tree.checkNodes(cars, true, true, true);\r\n        }\r\n        this.refreshHide();\r\n      },\r\n      refreshHide() {\r\n        let tree = this.$refs.tree.getTree();\r\n        for (let i=0, len=this.groups.length, g; i<len; i++) {\r\n          g = this.groups[i];\r\n          g.carIds.forEach(carId => {\r\n            let car = getCarById(carId);\r\n            car && tree.updateNodeHide(car);\r\n          });\r\n        }\r\n      },\r\n      hideFunction(node) {\r\n        if (!node.plate) return false;\r\n        for (let i=0, len=this.groups.length, g; i<len; i++) {\r\n          g = this.groups[i];\r\n          if (g != this._group && g.carIds.indexOf(node.id) != -1) return true;\r\n        }\r\n        return false;\r\n      },\r\n      addClick() {\r\n        this.savable = true;\r\n        this.delable = false;\r\n        this.listable = false;\r\n        this.$refs.list.selectedItem = this._group = null;\r\n        this.name = null;\r\n        this.$refs.tree.getTree().checkAllNodes(false);\r\n        this.refreshHide();\r\n      },\r\n      delClick() {\r\n        $_alert.comfirm($_L.get('确认要删除选中的车辆分组吗？'), yes => {\r\n          if (!yes) return;\r\n          let item = this.$refs.list.selectedItem, items = [];\r\n          this.groups.forEach(group => group != item && items.push(group.name+'|'+group.carIds.join(',')));\r\n          items = JSON.stringify(items);\r\n          window.$_main.http.post('sys/user?updateUserCfg',{item:'GROUP_CAR',value:items}).then(result => {\r\n            $_alert.success($_L.get('删除成功'));\r\n            window.$_cache.userCfg.GROUP_CAR = items;\r\n            resetGroupTree();\r\n            arrayRemoveItem(this.groups, item);\r\n            this.savable = this.delable = false;\r\n            this.name = this._group = null;\r\n            this.$refs.tree.getTree().checkAllNodes(false);\r\n            this.refreshHide();\r\n          });\r\n        });\r\n      },\r\n      saveClick() {\r\n        if (!this.name) return $_alert.warn($_L.get('请填写{0}', $_L.get('分组名称')), this.$el);\r\n        let carIds = this.$refs.tree.getCheckedNodes(false, false, 'id', 'plate');\r\n        if (!carIds || carIds.length == 0) return $_alert.warn($_L.get('请勾选车辆！'), this.$el);\r\n        if (carIds.length > 100) return $_alert.warn($_L.get('勾选的车辆数不能超过100个！'), this.$el);\r\n        let item = this.$refs.list.selectedItem, items = [], nameExist = false;\r\n        this.groups.forEach(group => {\r\n          group != item && (items.push(group.name+'|'+group.carIds.join(',')), nameExist=nameExist||group.name==this.name);\r\n        });\r\n        if (nameExist) return $_alert.warn($_L.get('存在相同的分组名称！'), this.$el);\r\n        items.push(this.name+'|'+carIds.join(','));\r\n        items = JSON.stringify(items);\r\n        let o = {name:this.name, carIds:carIds};\r\n        window.$_main.http.post('sys/user?updateUserCfg',{item:'GROUP_CAR',value:items}).then(result => {\r\n          $_alert.success(item?$_L.get('修改成功'):$_L.get('新增成功'));\r\n          window.$_cache.userCfg.GROUP_CAR = items;\r\n          resetGroupTree();\r\n          !item ? this.groups.push(o) : (item.name=o.name, item.carIds=o.carIds);\r\n          this.$refs.list.selectedItem = this._group = item || o;\r\n          this.savable = this.delable = this.listable = true;\r\n          this.refreshHide();\r\n        });\r\n      },\r\n    }\r\n  };\r\n</script>\r\n\r\n<style module>\r\n  .content {\r\n    padding: 5px 0 0 5px;\r\n  }\r\n  .content > * {\r\n    margin: 0 5px 5px 0;\r\n    width: calc(100% - 5px);\r\n    float: left;\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/common/tree"}]}