{"remainingRequest":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\src\\common\\mixin\\main.js","dependencies":[{"path":"D:\\cdRule\\src\\common\\mixin\\main.js","mtime":1685090529029},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/web.dom.iterable\";\n/**\r\n * 将通用数据做为全局\r\n */\n// import md5 from 'js-md5'\n\nimport crypto from 'crypto';\nvar seed = 0;\n\nwindow.$_uuid = function (name) {\n  return name + seed++;\n}; //==============================================================================================================\n\n\nwindow.$_main = {\n  userId: null,\n  sessionId: uuid(),\n  page: null,\n  root: null,\n  oldSessionId: null,\n  init: function init(gps_web_url, gps_xxx_url) {\n    domain(gps_web_url);\n    var params = {};\n    gps_xxx_url.split(/[?&#/]/).forEach(function (kv) {\n      kv = kv.split('=');\n      kv.length > 1 && (params[kv[0]] = kv[1]);\n    });\n    if (!params.userId) return alert($_L.get('没有账号参数！'));\n    if (!params.page) return alert($_L.get('没有页面参数！'));\n    window.$_main.userId = params.userId;\n    window.$_main.page = params.page;\n    window.$_main.password = params.password;\n    params.password && (window.$_main.mdPassword = crypto.createHash('md5').update(params.password).digest('hex'));\n    window.$_main.oldSessionId = params.sessionId;\n    window.$_main.root && (window.$_main.sessionId = params.sessionId || window.$_main.sessionId);\n    params.sessionId && (window.$_main.sessionId = params.sessionId || window.$_main.sessionId); // let token;\n    // if (location.host == 'localhost:8081'||location.host == '192.168.2.25:8081') {\n    //   $_main.mdPassword=crypto.createHash('md5').update('passwordszsg').digest('hex')\n    //   window.$_main.sessionId= 'So3Fc3C34Zb4Ws4T14Qf2Nz3Kg4H24Ef4Bg4Yu3V82Ss3Pw3Mz3Jp3G32Dn3Ae2Xc2Uq2Rt3Oa3Li3Iu3Fs2Ce3Zs1Wc3Tp3Qj3Nm3Kc3H83E53Bo3Yt3Vm3S23Pg1M03Js1Gs1Dn1A03Xr1U03Rp1Om1Lh1Is2Fg1Cs2y';\n    // }else{\n    //   token = window.$_main.sessionId\n    // }\n\n    window.$_main.http.authorization(params.sessionId);\n  },\n  exit: function exit() {// window.$_main.http.get('/exit', {sessionId:window.$_main.sessionId}, true);\n  }\n};\n\nfunction uuid() {\n  var S4 = function S4() {\n    return ((1 + Math.random()) * 0x10000 | 0).toString(16).substring(1);\n  };\n\n  return S4() + S4() + S4() + S4() + S4() + S4() + S4() + S4();\n} //==============================================================================================================\n\n\nfunction domain(url) {\n  var WEB_HOST,\n      WEB_NAME = 'gps-web',\n      WEB_HTTP = location.protocol == 'https:' ? 'https' : \"http\"; // 原来\n\n  if (location.host != 'localhost:8081' && document.referrer) {\n    var array = document.referrer.split('/');\n    array.length > 2 && (WEB_HOST = array[2] || WEB_HOST);\n    array.length > 3 && (WEB_NAME = array[3] || WEB_NAME);\n    WEB_NAME = 'gps-web';\n  } else {\n    WEB_HOST = url.split('/')[2];\n    WEB_NAME = url.split('/')[3]; // WEB_HOST = \"192.168.2.75:6779\";\n    // WEB_NAME = \"gps-web\";\n  }\n\n  var ip = WEB_HOST.split(':')[0];\n  window.$_main.domain = {\n    WEB_HTTP: WEB_HTTP,\n    WEB_HOST: WEB_HOST,\n    // ip:port\n    WEB_ROOT: WEB_HTTP + '://' + WEB_HOST + '/',\n    // http://ip:port/\n    WEB_NewROOT: WEB_HTTP + '://' + ip + ':8085/',\n    // http://ip:port/\n    WEB_PATH: WEB_HTTP + '://' + WEB_HOST + '/' + WEB_NAME + '/',\n    // http://ip:port/gps-xxx/\n    WEB_NAME: WEB_NAME // gps-xxx\n\n  };\n\n  if (WEB_HOST == window.$_domain.WEB_HOST) {\n    try {\n      var i = 0,\n          main = window.parent;\n\n      while (main && i++ < 10) {\n        if (main.$_cache) {\n          window.$_main.root = main;\n          break;\n        }\n\n        main = main.parent;\n      }\n    } catch (e) {}\n  }\n} //==============================================================================================================\n\n/**\r\n * http请求后台服务模块\r\n */\n\n\nimport axios from 'axios';\nimport qs from 'qs';\nvar headers = {\n  'Content-Type': 'application/json;charset=UTF-8'\n};\nvar isTimeout = false;\nwindow.$_main.http = {\n  authorization: function authorization(token) {\n    headers.Authorization = token;\n  },\n  get: function get(url, params) {\n    var quiet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false; // console.log(`${window.$_main.domain.WEB_PATH}${url}`);\n\n    if (isTimeout) return;\n    url += (url.indexOf('?') > 0 ? '&' : '?') + (params ? qs.stringify(params) + '&' : '') + new Date().getTime();\n\n    if (url.indexOf('http://') == -1) {\n      url = \"\".concat(window.$_main.domain.WEB_NewROOT).concat(url);\n      console.log(url);\n    }\n\n    return axios({\n      withCredentials: true,\n      headers: headers,\n      method: 'get',\n      url: url\n    }).then(function (r) {\n      return r.data;\n    }).then(function (r) {\n      if (r.status == 1) {\n        return r.result;\n      } else if (r.status == -1) {\n        isTimeout = true;\n        $_alert.error($_L.get('您未登录或会话超时，请重新登录!'), null, null, true);\n      } else {\n        !quiet && $_alert.error(r.result);\n      }\n\n      throw r;\n    });\n  },\n  post: function post(url, params) {\n    var quiet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (isTimeout) return;\n    url += (url.indexOf('?') > 0 ? '&' : '?') + new Date().getTime();\n    return axios({\n      withCredentials: true,\n      headers: headers,\n      method: 'post',\n      url: \"\".concat(window.$_main.domain.WEB_NewROOT).concat(url),\n      data: params\n    }).then(function (r) {\n      return r.data;\n    }).then(function (r) {\n      if (r.status == 1) {\n        return r.result;\n      } else if (r.status == -1) {\n        isTimeout = true;\n        $_alert.error($_L.get('您未登录或会话超时，请重新登录!'), null, null, true);\n      } else {\n        !quiet && $_alert.error(r.result);\n      }\n\n      throw r;\n    });\n  },\n  syncGet: function syncGet(url, params) {\n    var quiet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (isTimeout) return;\n    url += (url.indexOf('?') > 0 ? '&' : '?') + (params ? qs.stringify(params) + '&' : '') + new Date().getTime();\n    return sync('GET', url, null, quiet);\n  },\n  syncPost: function syncPost(url, params) {\n    var quiet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (isTimeout) return;\n    url += (url.indexOf('?') > 0 ? '&' : '?') + new Date().getTime();\n    return sync('POST', url, JSON.stringify(params), quiet);\n  }\n};\n\nfunction sync(method, url, params, quiet) {\n  var xhr = new XMLHttpRequest();\n  xhr.open(method, \"\".concat(window.$_main.domain.WEB_NewROOT).concat(url), false);\n  xhr.withCredentials = true;\n  xhr.setRequestHeader('Accept', 'application/json');\n  xhr.setRequestHeader('Content-Type', 'application/json');\n  xhr.setRequestHeader('Authorization', headers.Authorization);\n  xhr.send(params);\n  var r = JSON.parse(xhr.responseText);\n\n  if (r.status == 1) {\n    return r.result;\n  } else if (r.status == -1) {\n    isTimeout = true;\n    $_alert.error($_L.get('您未登录或会话超时，请返回登录界面!'), null, null, true);\n  } else {\n    !quiet && $_alert.error(r.result);\n  }\n\n  throw r;\n}",{"version":3,"sources":["D:\\cdRule\\src\\common\\mixin\\main.js"],"names":["seed","window","name","userId","sessionId","uuid","page","root","oldSessionId","init","domain","params","gps_xxx_url","kv","alert","$_L","crypto","exit","S4","Math","WEB_NAME","WEB_HTTP","location","document","array","WEB_HOST","url","ip","WEB_ROOT","WEB_NewROOT","WEB_PATH","i","main","headers","isTimeout","authorization","get","quiet","qs","console","withCredentials","method","r","$_alert","post","data","syncGet","sync","syncPost","JSON","xhr"],"mappings":"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","sourcesContent":["/**\r\n * 将通用数据做为全局\r\n */\r\n\r\n// import md5 from 'js-md5'\r\nimport crypto from 'crypto';\r\nlet seed = 0;\r\nwindow.$_uuid = name => name + (seed++);\r\n\r\n//==============================================================================================================\r\n\r\nwindow.$_main = {\r\n  userId: null,\r\n  sessionId: uuid(),\r\n  page: null,\r\n  root: null,\r\n  oldSessionId:null,\r\n  init: (gps_web_url, gps_xxx_url) => {\r\n    domain(gps_web_url);\r\n    let params = {};\r\n    gps_xxx_url.split(/[?&#/]/).forEach(kv => {\r\n      kv = kv.split('=');\r\n      kv.length > 1 && (params[kv[0]] = kv[1]);\r\n    });\r\n    if (!params.userId) return alert($_L.get('没有账号参数！'));\r\n    if (!params.page) return alert($_L.get('没有页面参数！'));\r\n\r\n    window.$_main.userId = params.userId;\r\n    window.$_main.page = params.page;\r\n    window.$_main.password = params.password;\r\n    params.password&&(window.$_main.mdPassword = crypto.createHash('md5').update(params.password).digest('hex'));\r\n    window.$_main.oldSessionId = params.sessionId;\r\n    window.$_main.root && (window.$_main.sessionId = params.sessionId || window.$_main.sessionId);\r\n    params.sessionId && (window.$_main.sessionId = params.sessionId || window.$_main.sessionId);\r\n    // let token;\r\n    // if (location.host == 'localhost:8081'||location.host == '192.168.2.25:8081') {\r\n    //   $_main.mdPassword=crypto.createHash('md5').update('passwordszsg').digest('hex')\r\n    //   window.$_main.sessionId= 'So3Fc3C34Zb4Ws4T14Qf2Nz3Kg4H24Ef4Bg4Yu3V82Ss3Pw3Mz3Jp3G32Dn3Ae2Xc2Uq2Rt3Oa3Li3Iu3Fs2Ce3Zs1Wc3Tp3Qj3Nm3Kc3H83E53Bo3Yt3Vm3S23Pg1M03Js1Gs1Dn1A03Xr1U03Rp1Om1Lh1Is2Fg1Cs2y';\r\n    // }else{\r\n    //   token = window.$_main.sessionId\r\n    // }\r\n    window.$_main.http.authorization(params.sessionId);\r\n  },\r\n\r\n  exit: () => {\r\n    // window.$_main.http.get('/exit', {sessionId:window.$_main.sessionId}, true);\r\n  }\r\n};\r\n\r\nfunction uuid() {\r\n  let S4 = () => (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n  return S4() + S4() + S4() + S4() + S4() + S4() + S4() + S4();\r\n}\r\n\r\n//==============================================================================================================\r\n\r\n\r\nfunction domain(url) {\r\n  let WEB_HOST, WEB_NAME='gps-web', WEB_HTTP = location.protocol == 'https:' ? 'https' : \"http\";\r\n  // 原来\r\n  if (location.host != 'localhost:8081' && document.referrer) {\r\n    let array = document.referrer.split('/');\r\n    array.length > 2 && (WEB_HOST = array[2] || WEB_HOST);\r\n    array.length > 3 && (WEB_NAME = array[3] || WEB_NAME);\r\n    WEB_NAME='gps-web'\r\n  } else {\r\n    WEB_HOST = url.split('/')[2];\r\n    WEB_NAME = url.split('/')[3];\r\n    // WEB_HOST = \"192.168.2.75:6779\";\r\n  // WEB_NAME = \"gps-web\";\r\n  }\r\n\r\n\r\n  let ip=WEB_HOST.split(':')[0]\r\n  window.$_main.domain = {\r\n    WEB_HTTP: WEB_HTTP,\r\n    WEB_HOST: WEB_HOST,                                             // ip:port\r\n    WEB_ROOT: WEB_HTTP + '://' + WEB_HOST + '/',                    // http://ip:port/\r\n    WEB_NewROOT: WEB_HTTP + '://' + ip + ':8085/',                    // http://ip:port/\r\n    WEB_PATH: WEB_HTTP + '://' + WEB_HOST + '/' + WEB_NAME + '/',   // http://ip:port/gps-xxx/\r\n    WEB_NAME: WEB_NAME,                                             // gps-xxx\r\n  };\r\n\r\n  if (WEB_HOST == window.$_domain.WEB_HOST) {\r\n    try {\r\n      let i = 0, main = window.parent;\r\n      while (main && i++ < 10) {\r\n        if (main.$_cache) {\r\n          window.$_main.root = main;\r\n          break;\r\n        }\r\n        main = main.parent;\r\n      }\r\n    } catch (e) {}\r\n  }\r\n}\r\n\r\n\r\n//==============================================================================================================\r\n\r\n\r\n/**\r\n * http请求后台服务模块\r\n */\r\nimport axios from 'axios';\r\nimport qs from 'qs';\r\n\r\nlet headers = {'Content-Type': 'application/json;charset=UTF-8'};\r\nlet isTimeout = false;\r\n\r\nwindow.$_main.http = {\r\n  authorization: (token) => {\r\n    headers.Authorization = token;\r\n  },\r\n\r\n  get: (url, params, quiet=false) => {\r\n    // console.log(`${window.$_main.domain.WEB_PATH}${url}`);\r\n    if (isTimeout) return;\r\n    url += (url.indexOf('?') > 0 ? '&' : '?') + (params ? (qs.stringify(params) + '&') : '') + new Date().getTime();\r\n    if(url.indexOf('http://')==-1){\r\n      url= `${window.$_main.domain.WEB_NewROOT}${url}`\r\n      console.log(url)\r\n    }\r\n    return axios({\r\n      withCredentials: true,\r\n      headers: headers,\r\n      method: 'get',\r\n      url: url\r\n    })\r\n    .then(r => r.data)\r\n    .then(r => {\r\n      if (r.status == 1) {\r\n        return r.result;\r\n      } else if (r.status == -1) {\r\n        isTimeout = true;\r\n        $_alert.error($_L.get('您未登录或会话超时，请重新登录!'), null, null, true);\r\n      } else {\r\n        !quiet && $_alert.error(r.result);\r\n      }\r\n      throw r;\r\n    });\r\n  },\r\n\r\n  post: (url, params, quiet=false) => {\r\n    if (isTimeout) return;\r\n    url += (url.indexOf('?') > 0 ? '&' : '?') + new Date().getTime();\r\n    return axios({\r\n      withCredentials: true,\r\n      headers: headers,\r\n      method: 'post',\r\n      url: `${window.$_main.domain.WEB_NewROOT}${url}`,\r\n      data: params\r\n    })\r\n    .then(r => r.data)\r\n    .then(r => {\r\n      if (r.status == 1) {\r\n        return r.result;\r\n      } else if (r.status == -1) {\r\n        isTimeout = true;\r\n        $_alert.error($_L.get('您未登录或会话超时，请重新登录!'), null, null, true);\r\n      } else {\r\n        !quiet && $_alert.error(r.result);\r\n      }\r\n      throw r;\r\n    });\r\n  },\r\n\r\n  syncGet: (url, params, quiet=false) => {\r\n    if (isTimeout) return;\r\n    url += (url.indexOf('?') > 0 ? '&' : '?') + (params ? (qs.stringify(params) + '&') : '') + new Date().getTime();\r\n    return sync('GET', url, null, quiet);\r\n  },\r\n\r\n  syncPost: (url, params, quiet=false) => {\r\n    if (isTimeout) return;\r\n    url += (url.indexOf('?') > 0 ? '&' : '?') + new Date().getTime();\r\n    return sync('POST', url, JSON.stringify(params), quiet);\r\n  },\r\n}\r\n\r\nfunction sync(method, url, params, quiet) {\r\n  let xhr = new XMLHttpRequest();\r\n  xhr.open(method, `${window.$_main.domain.WEB_NewROOT}${url}`, false);\r\n  xhr.withCredentials = true;\r\n  xhr.setRequestHeader('Accept', 'application/json');\r\n  xhr.setRequestHeader('Content-Type', 'application/json');\r\n  xhr.setRequestHeader('Authorization', headers.Authorization);\r\n  xhr.send(params);\r\n\r\n  let r = JSON.parse(xhr.responseText);\r\n  if (r.status == 1) {\r\n    return r.result;\r\n  } else if (r.status == -1) {\r\n    isTimeout = true;\r\n    $_alert.error($_L.get('您未登录或会话超时，请返回登录界面!'), null, null, true);\r\n  } else {\r\n    !quiet && $_alert.error(r.result);\r\n  }\r\n  throw r;\r\n}\r\n\r\n"]}]}