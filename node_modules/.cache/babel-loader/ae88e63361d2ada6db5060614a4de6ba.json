{"remainingRequest":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\src\\common\\alarm\\Labels.js","dependencies":[{"path":"D:\\cdRule\\src\\common\\alarm\\Labels.js","mtime":1670230781298},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.number.constructor\";\nimport { getAlarmNames, getAlarmType } from '@/common/cache/CacheAlarm.js';\nimport { getAlarmSrcMap, getAlarmStateMap } from '@/common/Vars.js';\nimport { dateNumToFormat, secondsToDHMS, apartDateTimeCnDesc, dateFormat } from '@/common/util/Dates.js';\nvar Labels = {};\nexport default Labels;\n\nLabels.alarmJyfwFunction = function (alarm) {\n  return getExtsField(alarm.exts, \"jyfw\");\n};\n\nLabels.alarmSpeedSetFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  alarm = _getAlarmSpeedSet(alarm); //String\n\n  return alarm && alarm.length > 0 ? alarm : alarm;\n};\n\nLabels.alarmSpeedRatioFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  var speedSet = Number(_getAlarmSpeedSet(alarm)); // let maxSpeed = (isNaN(alarm.maxValue) || Number(alarm.maxValue)==0) ? 0 : Number(alarm.maxValue);\n\n  var speed = isNaN(alarm.speed) || Number(alarm.speed) == 0 ? 0 : Number(alarm.speed); // let mSpeed = (maxSpeed==0 || maxSpeed<=speed) ? speed : maxSpeed;\n\n  var mSpeed = speed;\n\n  if (!isNaN(speedSet) && speedSet != 0 && mSpeed != 0) {\n    return ((mSpeed - speedSet) * 100 / speedSet).toFixed(2);\n  }\n\n  return '';\n};\n\nfunction _getAlarmSpeedSet(alarm) {\n  if (\"1\" == alarm.src) {\n    //终端设置限速值\n    return getExtsField(alarm.exts, \"speedVlv\") || '';\n  } else if (\"2\" == alarm.src) {\n    //平台\n    return getExtsField(alarm.exts, \"speedVlv\") || getExtsField(alarm.rule, \"speedMax\") || '';\n  } else if (\"9\" == alarm.src) {\n    //路网\n    return getExtsField(alarm.exts, \"speedVlv\") || '';\n  }\n}\n\nLabels.alarmRuleNameFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  var auser = getExtsField(alarm.rule, 'auser');\n\n  if (auser != '') {\n    if (auser == $_cache.user.userId || $_cache.user.userRole != 0) {\n      auser = $_L.get(\" | 创建者：\") + auser;\n    } else {\n      auser = $_L.get(\" | 创建者：其他用户\");\n    }\n  }\n\n  return \"2\" == alarm.src ? getExtsField(alarm.rule, 'name') + auser : '';\n};\n\nLabels.alarmRuleAuserFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  var auser = getExtsField(alarm.rule, 'auser');\n\n  if (auser != '') {\n    if (!(auser == $_cache.user.userId || $_cache.user.userRole != 0)) {\n      auser = $_L.get(\"其他用户\");\n    }\n  }\n\n  return \"2\" == alarm.src ? auser : '';\n};\n\nLabels.alarmTypeNameFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  return getAlarmNames()[alarm.typeId];\n};\n\nLabels.alarmSrcFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  return getAlarmSrcMap()[alarm.src];\n};\n\nLabels.alarmLevelFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  return alarm.level != null ? $_L.get(alarm.level + '级报警') : \"\";\n};\n\nLabels.alarmLongFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  return alarm.startTime && alarm.endTime ? apartDateTimeCnDesc(alarm.startTime, alarm.endTime) : '';\n};\n\nLabels.alarmMileFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n\n  if (alarm.typeId === 'lx') {\n    return getExtsField(alarm.exts, 'offDis') || '';\n  }\n\n  return alarm.endMile && alarm.startMile && Number(alarm.endMile) >= Number(alarm.startMile) ? Number((Number(alarm.endMile - alarm.startMile) / 1000).toFixed(2)) : '';\n};\n\nLabels.alarmStateFunction = function (alarm) {\n  //0-未处理;1-已处理;2-处理中;3-将来处理\n  alarm = alarm.row || alarm;\n  return getAlarmStateMap()[alarm.solveState];\n};\n\nLabels.extDescFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  var expire = getExtsField(alarm.exts, 'expire');\n  var desc = getExtsField(alarm.exts, 'desc');\n  var expType = getExtsField(alarm.exts, 'expType');\n  var endType = getExtsField(alarm.exts, 'endType');\n  var show = $_cache.userIsSys();\n\n  if (expType != '') {\n    switch (expType) {\n      case '1':\n        expType = \"报警处理超时\";\n        break;\n\n      case '2':\n        expType = \"报警结束超时\";\n        break;\n\n      case '3':\n        expType = \"报警处理和结束都超时\";\n        break;\n\n      case '4':\n        expType = \"报警最大数限制\";\n        break;\n    }\n  }\n\n  if (endType != '') {\n    switch (endType) {\n      case '1':\n        endType = \"车辆离线超时结束\";\n        break;\n\n      case '2':\n        endType = \"报警结束超时\";\n        break;\n    }\n  }\n\n  var extDesc = expire != '' ? \"TO(\" + secondsToDHMS(expire) + \")\" + (show && \",\" + desc || '') : desc == '' ? '' : isNaN(desc) ? show && desc || '' : \"TO(\" + secondsToDHMS(desc) + \")\";\n\n  if (show) {\n    extDesc = extDesc + (extDesc != '' && expType != '' ? ',' + expType : expType) + (extDesc != '' || expType != '' ? ',' + endType : endType);\n  }\n\n  return extDesc;\n};\n\nLabels.extMarkTimeFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  var markTime = getExtsField(alarm.exts, 'markTime');\n  return markTime;\n};\n\nLabels.alarmGpsTimeFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  return dateNumToFormat(getExtsField(alarm.exts, \"gpsTime\")) || alarm.startTime;\n};\n\nLabels.alarmGpsTimeEndFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  return dateNumToFormat(getExtsField(alarm.exts, \"gpsTimeEnd\")) || alarm.endTime;\n};\n\nLabels.adjunctFunction = function (alarm) {\n  var fjNum = parseInt(Labels.alarmFjNumFunction(alarm) || 0);\n  var jsfjNum = parseInt(Labels.alarmJsFjNumFunction(alarm) || 0);\n  var isShow = Labels.validateTmnAdasAlarm(alarm) && $_cache.sysCfg['sys.type'] != 'gps-tpm' && (fjNum != 0 || jsfjNum != 0);\n  return isShow ? jsfjNum + \"/\" + fjNum : \"\";\n};\n\nLabels.alarmFjNumFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  alarm = getExtsField(alarm.exts, 'marks');\n  return alarm && alarm.length > 0 ? alarm.split('&')[3] : '0';\n};\n\nLabels.alarmJsFjNumFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  var num = getExtsField(alarm.exts, 'fjsok');\n  return num;\n};\n\nLabels.validateTmnAdasAlarm = function (alarm) {\n  alarm = alarm.row || alarm || {};\n  var alarmTypeObj = getAlarmType().map[alarm.typeId] || {};\n  return alarm.src == '1' && alarmTypeObj.type === 'adas';\n};\n\nLabels.validatePlatAlarmExt = function (alarm) {\n  alarm = alarm.row || alarm;\n  return alarm.src == '2' && (alarm.typeId === 'dv' || alarm.typeId === 'dp') && alarm.exts;\n};\n\nLabels.alarmSendFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  alarm = getExtsField(alarm.exts, 'sendTime') || \"\";\n  return alarm;\n};\n\nLabels.B1Function = function (alarm) {\n  alarm = alarm.row || alarm;\n  var b1 = getExtsField(alarm.exts, 'b1');\n  return b1 ? b1 : '';\n};\n\nLabels.alarmDriveBeginTimeFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  var driveBeginTime = getExtsField(alarm.exts, 'driveBeginTime') == '' ? (alarm.typeId == \"f1\" || alarm.typeId == \"f2\") && alarm.startTime ? dateFormat(new Date(new Date(alarm.startTime) - 1000 * 14400), 'YYYY-MM-DD HH:NN:SS') : '' : getExtsField(alarm.exts, 'driveBeginTime');\n  return driveBeginTime;\n};\n\nLabels.alarmDriveEndTimeFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  return alarm.typeId == \"f1\" || alarm.typeId == \"f2\" ? alarm.endTime : \"\";\n};\n\nLabels.alarmDriveLongTimeFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  var driveBeginTime = getExtsField(alarm.exts, 'driveBeginTime') == '' ? (alarm.typeId == \"f1\" || alarm.typeId == \"f2\") && alarm.startTime ? dateFormat(new Date(new Date(alarm.startTime) - 1000 * 14400), 'YYYY-MM-DD HH:NN:SS') : '' : getExtsField(alarm.exts, 'driveBeginTime');\n  return driveBeginTime && alarm.endTime ? apartDateTimeCnDesc(driveBeginTime, alarm.endTime) : '';\n};\n\nLabels.extSolvesFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  var solves = getExtsField(alarm.exts, 'solves');\n  if (!solves) return '';\n  var result = [],\n      target,\n      date = new Date();\n  solves.split('@@').forEach(function (solve) {\n    if (!solve) return;\n    solve = solve.split('|'); //触发|处理人|处理时间|处理类别|处理目标|处理内容\n\n    var item = [];\n    date.setTime(Number(solve[2]));\n    item.push(dateFormat(date, 'YYYY-MM-DD HH:NN:SS'), '  ');\n    item.push(solve[1] == 'ai' ? '' : solve[1]);\n\n    if (solve[3] == '1') {\n      item.push($_L.get('下发文本'), '(');\n      target = [];\n      solve[4].charAt(0) == '1' && target.push($_L.get('紧急'));\n      solve[4].charAt(2) == '1' && target.push($_L.get('显示器显示'));\n      solve[4].charAt(3) == '1' && target.push($_L.get('TTS播读'));\n      solve[4].charAt(4) == '1' && target.push($_L.get('广告屏显示'));\n      item.push(target.join(','), ')');\n    } else if (solve[3] == '2') {\n      item.push($_L.get('发送短信'), '(', solve[4], ')');\n    } else if (solve[3] == '3') {\n      item.push($_L.get('拨打电话'), '(', solve[4], ')');\n    } else if (solve[3] == '4') {\n      item.push($_L.get('发送邮件'), '(', solve[4], ')');\n    } else if (solve[3] == '5') {\n      item.push($_L.get('语音监听'), '(', solve[4], ')');\n    } else if (solve[3] == '6') {\n      item.push($_L.get('下发拍照'), '(', $_L.get('摄像头'), ':', solve[4], ')');\n    }\n\n    solve[5] && item.push(',' + $_L.get('内容'), '(', solve[5], ')');\n    result.push(item.join(''));\n  });\n  return result.join(' | ');\n};\n\nLabels.alarmIsRepairFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  return getExtsField(alarm.exts, 'cb') == '1' ? $_L.get('是') : $_L.get('否');\n};\n\nLabels.aiNumlFunction = function (alarm) {\n  alarm = alarm.row || alarm;\n  var solves = getExtsField(alarm.exts, 'solves');\n  if (!solves) return 0;\n  var num = 0;\n  solves.split('@@').forEach(function (solve) {\n    if (!solve) return;\n    var solveSplit = solve.split('|');\n\n    if (solveSplit[1] == 'ai') {\n      num++;\n    }\n  });\n  return num;\n}; // let qy_adasType = ['6400','6500','6600','6700'], adasType = ['7','8','9','10','14','15','16','19'];\n// function validateAdas (typeId){\n//     return qy_adasType.indexOf(typeId)!=-1 || adasType.indexOf(getAlarmType().map[typeId].pid)!=-1;\n// }\n\n\nfunction getExtsField(exts, field) {\n  try {\n    exts = exts ? JSON.parse(exts) : null;\n  } catch (_unused) {\n    exts = null;\n  }\n\n  exts = exts && exts.hasOwnProperty(field) ? exts[field] : '';\n  return exts;\n}",{"version":3,"sources":["D:\\cdRule\\src\\common\\alarm\\Labels.js"],"names":["Labels","getExtsField","alarm","_getAlarmSpeedSet","speedSet","Number","speed","isNaN","mSpeed","auser","$_cache","$_L","getAlarmNames","getAlarmSrcMap","apartDateTimeCnDesc","getAlarmStateMap","expire","desc","expType","endType","show","extDesc","secondsToDHMS","markTime","dateNumToFormat","fjNum","parseInt","jsfjNum","isShow","num","alarmTypeObj","getAlarmType","b1","driveBeginTime","dateFormat","solves","result","date","solve","item","target","solveSplit","exts","JSON"],"mappings":"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","sourcesContent":["import { getAlarmNames, getAlarmType } from '@/common/cache/CacheAlarm.js';\r\nimport { getAlarmSrcMap, getAlarmStateMap } from '@/common/Vars.js';\r\nimport { dateNumToFormat, secondsToDHMS, apartDateTimeCnDesc, dateFormat } from '@/common/util/Dates.js';\r\n\r\nlet Labels = {};\r\nexport default Labels;\r\n\r\nLabels.alarmJyfwFunction = function (alarm){\r\n    return getExtsField(alarm.exts, \"jyfw\");\r\n}\r\n\r\nLabels.alarmSpeedSetFunction = function (alarm){\r\n    alarm = alarm.row || alarm;\r\n    alarm = _getAlarmSpeedSet(alarm);//String\r\n    return alarm && alarm.length > 0 ? (alarm) : alarm;\r\n}\r\n\r\nLabels.alarmSpeedRatioFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    let speedSet = Number(_getAlarmSpeedSet(alarm));\r\n    // let maxSpeed = (isNaN(alarm.maxValue) || Number(alarm.maxValue)==0) ? 0 : Number(alarm.maxValue);\r\n    let speed =    (isNaN(alarm.speed) || Number(alarm.speed)==0) ? 0 : Number(alarm.speed);\r\n    // let mSpeed = (maxSpeed==0 || maxSpeed<=speed) ? speed : maxSpeed;\r\n    let mSpeed = speed;\r\n    if (!isNaN(speedSet) && speedSet!=0 && mSpeed!=0) {\r\n        return ((mSpeed-speedSet)*100/speedSet).toFixed(2);\r\n    }\r\n    return '';\r\n}\r\n\r\nfunction _getAlarmSpeedSet(alarm) {\r\n    if (\"1\" == alarm.src) {//终端设置限速值\r\n        return getExtsField(alarm.exts, \"speedVlv\") || '';\r\n    } else if (\"2\" == alarm.src) {//平台\r\n        return getExtsField(alarm.exts, \"speedVlv\") || getExtsField(alarm.rule, \"speedMax\") || '';\r\n    } else if (\"9\" == alarm.src) {//路网\r\n        return getExtsField(alarm.exts, \"speedVlv\") || '';\r\n    }\r\n}\r\n\r\nLabels.alarmRuleNameFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    let auser = getExtsField(alarm.rule, 'auser')\r\n    if(auser != ''){\r\n        if(auser == $_cache.user.userId || $_cache.user.userRole != 0){\r\n            auser = $_L.get(\" | 创建者：\") + auser;\r\n        }else{\r\n            auser = $_L.get(\" | 创建者：其他用户\");\r\n        }\r\n    }\r\n\treturn \"2\" == alarm.src ? getExtsField(alarm.rule, 'name') + auser: '';\r\n}\r\n\r\nLabels.alarmRuleAuserFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    let auser = getExtsField(alarm.rule, 'auser')\r\n    if(auser != ''){\r\n        if(!(auser == $_cache.user.userId || $_cache.user.userRole != 0)){\r\n            auser = $_L.get(\"其他用户\");\r\n        }\r\n    }\r\n\treturn \"2\" == alarm.src ? auser: '';\r\n}\r\n\r\nLabels.alarmTypeNameFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    return getAlarmNames()[alarm.typeId];\r\n}\r\n\r\nLabels.alarmSrcFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    return getAlarmSrcMap()[alarm.src];\r\n}\r\n\r\nLabels.alarmLevelFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    return alarm.level != null ? $_L.get(alarm.level+'级报警') : \"\";\r\n}\r\n\r\nLabels.alarmLongFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    return (alarm.startTime && alarm.endTime) ? apartDateTimeCnDesc(alarm.startTime, alarm.endTime) : '';\r\n}\r\n\r\nLabels.alarmMileFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    if(alarm.typeId === 'lx'){\r\n        return getExtsField(alarm.exts, 'offDis') || '';\r\n    }\r\n    return alarm.endMile && alarm.startMile && Number(alarm.endMile) >= Number(alarm.startMile) ? (Number((Number(alarm.endMile - alarm.startMile)/1000).toFixed(2))) : '';\r\n}\r\n\r\nLabels.alarmStateFunction = function (alarm) {//0-未处理;1-已处理;2-处理中;3-将来处理\r\n    alarm = alarm.row || alarm;\r\n    return getAlarmStateMap()[alarm.solveState];\r\n}\r\n\r\nLabels.extDescFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    let expire = getExtsField(alarm.exts,'expire');\r\n    let desc = getExtsField(alarm.exts,'desc');\r\n    let expType = getExtsField(alarm.exts,'expType');\r\n    let endType = getExtsField(alarm.exts,'endType');\r\n    let show = $_cache.userIsSys();\r\n    if(expType!=''){\r\n        switch (expType) {\r\n            case '1':\r\n                expType = \"报警处理超时\";\r\n                break;\r\n            case '2':\r\n                expType = \"报警结束超时\";\r\n                break;\r\n            case '3':\r\n                expType = \"报警处理和结束都超时\";\r\n                break;\r\n            case '4':\r\n                expType = \"报警最大数限制\";\r\n                break;\r\n        } \r\n    }\r\n    if(endType!=''){\r\n        switch (endType) {\r\n            case '1':\r\n                endType = \"车辆离线超时结束\";\r\n                break;\r\n            case '2':\r\n                endType = \"报警结束超时\";\r\n                break;\r\n        } \r\n    }\r\n    let extDesc = expire != ''?(\"TO(\"+secondsToDHMS(expire)+\")\"+(show&&(\",\"+desc)||'')) : (desc==''?'':isNaN(desc)?(show&&desc||''):\"TO(\"+secondsToDHMS(desc)+\")\");\r\n    if(show){\r\n        extDesc = extDesc + ((extDesc!=''&&expType!='')?(','+expType):expType) + ((extDesc!=''||expType!='')?(','+endType):endType)\r\n    }\r\n    return extDesc;\r\n}\r\nLabels.extMarkTimeFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    let markTime = getExtsField(alarm.exts,'markTime');\r\n    return markTime;\r\n}\r\n\r\nLabels.alarmGpsTimeFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    return dateNumToFormat(getExtsField(alarm.exts,\"gpsTime\")) || alarm.startTime;\r\n}\r\n\r\nLabels.alarmGpsTimeEndFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    return dateNumToFormat(getExtsField(alarm.exts,\"gpsTimeEnd\")) || alarm.endTime;\r\n}\r\nLabels.adjunctFunction = function (alarm) {\r\n    let fjNum = parseInt(Labels.alarmFjNumFunction(alarm)||0);\r\n    let jsfjNum = parseInt(Labels.alarmJsFjNumFunction(alarm)||0);\r\n    let isShow = Labels.validateTmnAdasAlarm(alarm)&&$_cache.sysCfg['sys.type']!='gps-tpm'&&(fjNum!=0||jsfjNum!=0)\r\n    return isShow?(jsfjNum+\"/\"+fjNum):\"\";\r\n}\r\nLabels.alarmFjNumFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    alarm = getExtsField(alarm.exts,'marks');\r\n    return (alarm && alarm.length>0)?alarm.split('&')[3]:'0';\r\n}\r\nLabels.alarmJsFjNumFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    let num = getExtsField(alarm.exts,'fjsok');\r\n    return num;\r\n}\r\nLabels.validateTmnAdasAlarm = function (alarm){\r\n    alarm = alarm.row || alarm || {};\r\n    let alarmTypeObj = (getAlarmType().map)[alarm.typeId] || {};\r\n    return alarm.src=='1' && alarmTypeObj.type === 'adas';\r\n}\r\n\r\nLabels.validatePlatAlarmExt = function (alarm){\r\n    alarm = alarm.row || alarm;\r\n    return alarm.src=='2' && (alarm.typeId ==='dv' || alarm.typeId ==='dp') && alarm.exts;\r\n}\r\nLabels.alarmSendFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    alarm = getExtsField(alarm.exts,'sendTime')||\"\";\r\n    return alarm;\r\n}\r\n\r\nLabels.B1Function = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    let b1 = getExtsField(alarm.exts,'b1');\r\n    return b1?(b1):''\r\n}\r\nLabels.alarmDriveBeginTimeFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    let driveBeginTime = getExtsField(alarm.exts,'driveBeginTime')==''?(((alarm.typeId == \"f1\"||alarm.typeId ==\"f2\")&&alarm.startTime)?dateFormat(new Date(new Date(alarm.startTime) - 1000*14400), 'YYYY-MM-DD HH:NN:SS'):''):getExtsField(alarm.exts,'driveBeginTime');\r\n    return driveBeginTime;\r\n}\r\nLabels.alarmDriveEndTimeFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    return (alarm.typeId == \"f1\"||alarm.typeId ==\"f2\")?alarm.endTime:\"\";\r\n}\r\nLabels.alarmDriveLongTimeFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    let driveBeginTime = getExtsField(alarm.exts,'driveBeginTime')==''?(((alarm.typeId == \"f1\"||alarm.typeId ==\"f2\")&&alarm.startTime)?dateFormat(new Date(new Date(alarm.startTime) - 1000*14400), 'YYYY-MM-DD HH:NN:SS'):''):getExtsField(alarm.exts,'driveBeginTime');\r\n    return (driveBeginTime && alarm.endTime) ? apartDateTimeCnDesc(driveBeginTime, alarm.endTime) : '';\r\n}\r\nLabels.extSolvesFunction = function(alarm) {\r\n    alarm = alarm.row || alarm;\r\n    let solves = getExtsField(alarm.exts,'solves');\r\n    if (!solves) return '';\r\n    let result = [], target, date = new Date();\r\n    solves.split('@@').forEach(solve => {\r\n        if (!solve) return;\r\n        solve = solve.split('|');//触发|处理人|处理时间|处理类别|处理目标|处理内容\r\n        let item = [];\r\n        date.setTime(Number(solve[2]));\r\n        item.push(dateFormat(date,'YYYY-MM-DD HH:NN:SS'), '  ');\r\n        item.push(solve[1]=='ai'?'':solve[1]);\r\n        if (solve[3] == '1') {\r\n            item.push($_L.get('下发文本'),'(');\r\n            target = [];\r\n            solve[4].charAt(0) == '1' && target.push($_L.get('紧急'));\r\n            solve[4].charAt(2) == '1' && target.push($_L.get('显示器显示'));\r\n            solve[4].charAt(3) == '1' && target.push($_L.get('TTS播读'));\r\n            solve[4].charAt(4) == '1' && target.push($_L.get('广告屏显示'));\r\n            item.push(target.join(','),')');\r\n        } else if (solve[3] == '2') {\r\n            item.push($_L.get('发送短信'),'(',solve[4],')');\r\n        } else if (solve[3] == '3') {\r\n            item.push($_L.get('拨打电话'),'(',solve[4],')');\r\n        } else if (solve[3] == '4') {\r\n            item.push($_L.get('发送邮件'),'(',solve[4],')');\r\n        } else if (solve[3] == '5') {\r\n            item.push($_L.get('语音监听'),'(',solve[4],')');\r\n        } else if (solve[3] == '6') {\r\n            item.push($_L.get('下发拍照'),'(',$_L.get('摄像头'),':',solve[4],')');\r\n        }\r\n        solve[5] && item.push(','+$_L.get('内容'),'(',solve[5],')');\r\n        result.push(item.join(''));\r\n    });\r\n    return result.join(' | ');\r\n}\r\nLabels.alarmIsRepairFunction = function (alarm) {\r\n    alarm = alarm.row || alarm;\r\n    return getExtsField(alarm.exts,'cb')=='1' ? $_L.get('是') : $_L.get('否');\r\n}\r\nLabels.aiNumlFunction = function(alarm){\r\n    alarm = alarm.row || alarm;\r\n    let solves = getExtsField(alarm.exts,'solves');\r\n    if (!solves) return 0;\r\n    let num = 0;\r\n    solves.split('@@').forEach(solve => {\r\n        if (!solve) return;\r\n        let solveSplit = solve.split('|');\r\n        if(solveSplit[1]=='ai'){\r\n            num++;\r\n        }\r\n    });\r\n    return num;\r\n}\r\n// let qy_adasType = ['6400','6500','6600','6700'], adasType = ['7','8','9','10','14','15','16','19'];\r\n// function validateAdas (typeId){\r\n//     return qy_adasType.indexOf(typeId)!=-1 || adasType.indexOf(getAlarmType().map[typeId].pid)!=-1;\r\n// }\r\n\r\nfunction getExtsField (exts, field) {\r\n    try{\r\n        exts = exts ? JSON.parse(exts) : null;\r\n    }catch{\r\n        exts = null;\r\n    }\r\n    exts = (exts && exts.hasOwnProperty(field)) ? exts[field] : '';\r\n    return exts;\r\n}"]}]}