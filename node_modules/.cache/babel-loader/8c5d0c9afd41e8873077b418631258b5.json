{"remainingRequest":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js!D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\cdRule\\src\\common\\tree\\CarFavSetWindow.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\cdRule\\src\\common\\tree\\CarFavSetWindow.vue","mtime":1677658521312},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\cdRule\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { resetFavTree, getCars, setFavCount } from '@/common/cache/CacheTeamCar.js';\nimport { getCarTreeIconUrl } from '@/common/util/Urls.js';\nimport { getCarTreeCfg } from '@/common/cache/CacheTeamCar.js';\nexport default {\n  data: function data() {\n    return {\n      waiting: false,\n      height: 0\n    };\n  },\n  created: function created() {\n    this.height = document.body.clientHeight * 5 / 6 - 100;\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    this._carTreeCfg = getCarTreeCfg();\n    getCars(function (CARS) {\n      _this.$refs.tree.init(CARS.root);\n\n      var nodes = CARS.fav_root.children;\n      nodes.length && _this.$refs.tree.checkNodes(nodes, true, true);\n    });\n  },\n  methods: {\n    searchFun: function searchFun(node, text, array) {\n      if (node.plate) {\n        //车辆\n        if (text && node.plate.toLowerCase().indexOf(text) >= 0 || array && array.has(node.plate)) return true;\n        if (text && node.name.toLowerCase().indexOf(text) >= 0 || array && array.has(node.name)) return true;\n        if (text && node.tmnKey && node.tmnKey.toLowerCase().indexOf(text) >= 0 || array && node.tmnKey && array.has(node.tmnKey)) return true;\n        if (node.viceKeys && text && node.viceKeys.replace(/\\_va|\\_av|\\_v|\\_a/g, '').indexOf(text) >= 0) return true;\n\n        if (node.viceKeys && array) {\n          node = node.viceKeys.replace(/\\_va|\\_av|\\_v|\\_a/g, '').split(',');\n\n          for (var i = 0; i < node.length; i++) {\n            if (array.has(node[i])) return true;\n          }\n        }\n\n        return false;\n      }\n\n      return text && node.name.toLowerCase().indexOf(text) >= 0 || array && array.has(node.name); //车队\n    },\n    nameFunction: function nameFunction(node) {\n      return node.plate ? node[this._carTreeCfg.sortField] : node.name + ' [' + node.online + '/' + node.carNum + ']';\n    },\n    iconUrlFunction: function iconUrlFunction(node, open) {\n      //车辆\n      return node.plate ? getCarTreeIconUrl(node.state, node.stts, node.cmpId) : null;\n    },\n    iconCssFunction: function iconCssFunction(node, open) {\n      return node.plate ? null : open ? 'ico_open' : 'ico_close';\n    },\n    submit: function submit() {\n      var _this2 = this;\n\n      var ids = [],\n          nodes = this.$refs.tree.getCheckedNodes(true, true);\n      nodes.forEach(function (node) {\n        return node.id != '0' && ids.push(node.plate ? node.id : 't' + node.id);\n      });\n      ids = ids.length == 0 ? null : JSON.stringify(ids); //if (ids && ids.length > 2000) return $_alert.warn($_L.get('不允许收藏太多车辆！'));\n\n      this.waiting = true;\n      window.$_main.http.post('sys/user?updateUserCfg', {\n        item: 'FAV_CAR',\n        value: ids\n      }).then(function (result) {\n        $_alert.success($_L.get('设置成功'));\n        window.$_cache.userCfg.FAV_CAR = ids;\n        resetFavTree();\n        setFavCount();\n\n        _this2.$refs.w.close();\n      }).catch(function (e) {\n        return _this2.waiting = false;\n      });\n    }\n  }\n};",{"version":3,"sources":["CarFavSetWindow.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <Window :title=\"$_L.get('请勾选要收藏的车辆')\" :width=\"400\" ref=\"w\" :waiting=\"waiting\">\r\n    <div :class=\"$style.content\">\r\n      <Tree ref=\"tree\" :searchFun=\"searchFun\" :border=\"false\" :setting=\"{check:{enable:true},view:{nameFunction:nameFunction,iconUrlFunction:iconUrlFunction,iconCssFunction:iconCssFunction}}\" :style=\"{height:height+'px'}\"/>\r\n    </div>\r\n\r\n    <template slot=\"footer\">\r\n       <Button style=\"margin:8px 4px;width:80px;\" @click=\"$refs.w.close()\"> {{$_L.get('取消')}} </Button>\r\n       <Button style=\"margin:8px 4px;width:80px;\" type=\"primary\" @click=\"submit()\"> {{$_L.get('保存')}} </Button>\r\n    </template>\r\n  </Window>\r\n</template>\r\n\r\n<script>\r\n  import { resetFavTree, getCars, setFavCount } from '@/common/cache/CacheTeamCar.js';\r\n  import { getCarTreeIconUrl } from '@/common/util/Urls.js';\r\n  import { getCarTreeCfg } from '@/common/cache/CacheTeamCar.js';\r\n\r\n  export default {\r\n    data: function() {\r\n      return {\r\n        waiting: false,\r\n        height: 0,\r\n      };\r\n    },\r\n    created() {\r\n      this.height = document.body.clientHeight * 5 / 6 - 100;\r\n    },\r\n    mounted() {\r\n      this._carTreeCfg = getCarTreeCfg();\r\n      getCars(CARS => {\r\n        this.$refs.tree.init(CARS.root);\r\n        let nodes = CARS.fav_root.children;\r\n        nodes.length && this.$refs.tree.checkNodes(nodes, true, true);\r\n      });\r\n    },\r\n\r\n    methods: {\r\n      searchFun(node, text, array) {\r\n        if (node.plate) {//车辆\r\n          if ((text && node.plate.toLowerCase().indexOf(text) >= 0) || (array && array.has(node.plate))) return true;\r\n          if ((text && node.name.toLowerCase().indexOf(text) >= 0) || (array && array.has(node.name))) return true;\r\n          if ((text && node.tmnKey && node.tmnKey.toLowerCase().indexOf(text) >= 0) || (array && node.tmnKey && array.has(node.tmnKey))) return true;\r\n          if (node.viceKeys && text && node.viceKeys.replace(/\\_va|\\_av|\\_v|\\_a/g, '').indexOf(text) >= 0) return true;\r\n          if (node.viceKeys && array) {\r\n        \t  node = node.viceKeys.replace(/\\_va|\\_av|\\_v|\\_a/g, '').split(',');\r\n              for (let i=0; i<node.length; i++) {\r\n                if (array.has(node[i])) return true;\r\n              }\r\n          }\r\n          return false;\r\n        }\r\n        return (text && node.name.toLowerCase().indexOf(text) >= 0) || (array && array.has(node.name));//车队\r\n      },\r\n      nameFunction(node) {\r\n        return node.plate ? node[this._carTreeCfg.sortField] : (node.name + ' ['+node.online+'/'+node.carNum+']');\r\n      },\r\n      iconUrlFunction(node, open) {//车辆\r\n        return node.plate ? getCarTreeIconUrl(node.state, node.stts, node.cmpId) : null;\r\n      },\r\n      iconCssFunction(node, open) {\r\n        return node.plate ? null : open ? 'ico_open' : 'ico_close';\r\n      },\r\n      submit() {\r\n        let ids = [], nodes = this.$refs.tree.getCheckedNodes(true, true);\r\n        nodes.forEach(node => node.id != '0' && ids.push(node.plate?node.id:('t'+node.id)));\r\n        ids = ids.length == 0 ? null : JSON.stringify(ids);\r\n        //if (ids && ids.length > 2000) return $_alert.warn($_L.get('不允许收藏太多车辆！'));\r\n        this.waiting = true;\r\n        window.$_main.http.post('sys/user?updateUserCfg',{item:'FAV_CAR',value:ids}).then(result => {\r\n          $_alert.success($_L.get('设置成功'));\r\n          window.$_cache.userCfg.FAV_CAR = ids;\r\n          resetFavTree();\r\n          setFavCount();\r\n          this.$refs.w.close();\r\n        }).catch(e => this.waiting = false);\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style module>\r\n  .content {\r\n    padding: 5px 0 0 5px;\r\n  }\r\n  .content > * {\r\n    margin: 0 5px 5px 0;\r\n    width: calc(100% - 5px);\r\n    float: left;\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/common/tree"}]}